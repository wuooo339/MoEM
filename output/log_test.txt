CUDA extension not installed.
CUDA extension not installed.
Using /home/user/.cache/torch_extensions/py39_cu126 as PyTorch extensions root...
Emitting ninja build file /home/user/.cache/torch_extensions/py39_cu126/prefetch/build.ninja...
Building extension module prefetch...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Do not detect pre-installed ops, use JIT mode
CUDA_VISIBLE_DEVICES: 1
Available devices: ['NVIDIA GeForce RTX 4080 SUPER']
[WARNING] FlashAttention is not available in the current environment. Using default attention.
ninja: no work to do.
Loading extension module prefetch...
Time to load prefetch op: 7.486123085021973 seconds
Loading model from offload_path ...
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From ğŸ‘‰v4.50ğŸ‘ˆ onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
[20250516 22:50:28.861426Z ][74686 ][INFO  ]Create ArcherAioThread for thread:  0 - archer_aio_thread.cpp:12
[20250516 22:50:28.861789Z ][74686 ][INFO  ]Loading index file from  /home/user/offload/deepseek-v2-param/deepseek-v2-lite/archer_index - archer_tensor_handle.cpp:44
[20250516 22:50:28.865603Z ][74686 ][INFO  ]Index file size  5291 - archer_tensor_handle.cpp:50
[20250516 22:50:28.866988Z ][74686 ][INFO  ]Device count  1 - archer_prefetch_handle.cpp:39
[20250516 22:50:28.866990Z ][74686 ][INFO  ]Enabled peer access for all devices - archer_prefetch_handle.cpp:62
[20250516 22:50:31.359793Z ][74686 ][INFO  ]Moving dense parameters to GPU - model_topology.cpp:522
29 left28 left27 left26 left25 left24 left23 left22 left21 left20 left19 left18 left17 left16 left15 left14 left13 left12 left11 left10 left9 left8 left7 left6 left5 left4 left3 left2 left1 left
finished: 30/30
[20250516 22:50:36.525306Z ][74686 ][INFO  ]Moving sparse parameters to CPU - model_topology.cpp:533
1663 left1662 left1661 left1660 left1659 left1658 left1657 left1656 left1655 left1654 left1653 left1652 left1651 left1650 left1649 left1648 left1647 left1646 left1645 left1644 left1643 left1642 left1641 left1640 left1639 left1638 left1637 left1636 left1635 left1634 left1633 left1632 left1631 left1630 left1629 left1628 left1627 left1626 left1625 left1624 left1623 left1622 left1621 left1620 left1619 left1618 left1617 left1616 left1615 left1614 left1613 left1612 left1611 left1610 left1609 left1608 left1607 left1606 left1605 left1604 left1603 left1602 left1601 left1600 left1599 left1598 left1597 left1596 left1595 left1594 left1593 left1592 left1591 left1590 left1589 left1588 left1587 left1586 left1585 left1584 left1583 left1582 left1581 left1580 left1579 left1578 left1577 left1576 left1575 left1574 left1573 left1572 left1571 left1570 left1569 left1568 left1567 left1566 left1565 left1564 left1563 left1562 left1561 left1560 left1559 left1558 left1557 left1556 left1555 left1554 left1553 left1552 left1551 left1550 left1549 left1548 left1547 left1546 left1545 left1544 left1543 left1542 left1541 left1540 left1539 left1538 left1537 left1536 left1535 left1534 left1533 left1532 left1531 left1530 left1529 left1528 left1527 left1526 left1525 left1524 left1523 left1522 left1521 left1520 left1519 left1518 left1517 left1516 left1515 left1514 left1513 left1512 left1511 left1510 left1509 left1508 left1507 left1506 left1505 left1504 left1503 left1502 left1501 left1500 left1499 left1498 left1497 left1496 left1495 left1494 left1493 left1492 left1491 left1490 left1489 left1488 left1487 left1486 left1485 left1484 left1483 left1482 left1481 left1480 left1479 left1478 left1477 left1476 left1475 left1474 left1473 left1472 left1471 left1470 left1469 left1468 left1467 left1466 left1465 left1464 left1463 left1462 left1461 left1460 left1459 left1458 left1457 left1456 left1455 left1454 left1453 left1452 left1451 left1450 left1449 left1448 left1447 left1446 left1445 left1444 left1443 left1442 left1441 left1440 left1439 left1438 left1437 left1436 left1435 left1434 left1433 left1432 left1431 left1430 left1429 left1428 left1427 left1426 left1425 left1424 left1423 left1422 left1421 left1420 left1419 left1418 left1417 left1416 left1415 left1414 left1413 left1412 left1411 left1410 left1409 left1408 left1407 left1406 left1405 left1404 left1403 left1402 left1401 left1400 left1399 left1398 left1397 left1396 left1395 left1394 left1393 left1392 left1391 left1390 left1389 left1388 left1387 left1386 left1385 left1384 left1383 left1382 left1381 left1380 left1379 left1378 left1377 left1376 left1375 left1374 left1373 left1372 left1371 left1370 left1369 left1368 left1367 left1366 left1365 left1364 left1363 left1362 left1361 left1360 left1359 left1358 left1357 left1356 left1355 left1354 left1353 left1352 left1351 left1350 left1349 left1348 left1347 left1346 left1345 left1344 left1343 left1342 left1341 left1340 left1339 left1338 left1337 left1336 left1335 left1334 left1333 left1332 left1331 left1330 left1329 left1328 left1327 left1326 left1325 left1324 left1323 left1322 left1321 left1320 left1319 left1318 left1317 left1316 left1315 left1314 left1313 left1312 left1311 left1310 left1309 left1308 left1307 left1306 left1305 left1304 left1303 left1302 left1301 left1300 left1299 left1298 left1297 left1296 left1295 left1294 left1293 left1292 left1291 left1290 left1289 left1288 left1287 left1286 left1285 left1284 left1283 left1282 left1281 left1280 left1279 left1278 left1277 left1276 left1275 left1274 left1273 left1272 left1271 left1270 left1269 left1268 left1267 left1266 left1265 left1264 left1263 left1262 left1261 left1260 left1259 left1258 left1257 left1256 left1255 left1254 left1253 left1252 left1251 left1250 left1249 left1248 left1247 left1246 left1245 left1244 left1243 left1242 left1241 left1240 left1239 left1238 left1237 left1236 left1235 left1234 left1233 left1232 left1231 left1230 left1229 left1228 left1227 left1226 left1225 left1224 left1223 left1222 left1221 left1220 left1219 left1218 left1217 left1216 left1215 left1214 left1213 left1212 left1211 left1210 left1209 left1208 left1207 left1206 left1205 left1204 left1203 left1202 left1201 left1200 left1199 left1198 left1197 left1196 left1195 left1194 left1193 left1192 left1191 left1190 left1189 left1188 left1187 left1186 left1185 left1184 left1183 left1182 left1181 left1180 left1179 left1178 left1177 left1176 left1175 left1174 left1173 left1172 left1171 left1170 left1169 left1168 left1167 left1166 left1165 left1164 left1163 left1162 left1161 left1160 left1159 left1158 left1157 left1156 left1155 left1154 left1153 left1152 left1151 left1150 left1149 left1148 left1147 left1146 left1145 left1144 left1143 left1142 left1141 left1140 left1139 left1138 left1137 left1136 left1135 left1134 left1133 left1132 left1131 left1130 left1129 left1128 left1127 left1126 left1125 left1124 left1123 left1122 left1121 left1120 left1119 left1118 left1117 left1116 left1115 left1114 left1113 left1112 left1111 left1110 left1109 left1108 left1107 left1106 left1105 left1104 left1103 left1102 left1101 left1100 left1099 left1098 left1097 left1096 left1095 left1094 left1093 left1092 left1091 left1090 left1089 left1088 left1087 left1086 left1085 left1084 left1083 left1082 left1081 left1080 left1079 left1078 left1077 left1076 left1075 left1074 left1073 left1072 left1071 left1070 left1069 left1068 left1067 left1066 left1065 left1064 left1063 left1062 left1061 left1060 left1059 left1058 left1057 left1056 left1055 left1054 left1053 left1052 left1051 left1050 left1049 left1048 left1047 left1046 left1045 left1044 left1043 left1042 left1041 left1040 left1039 left1038 left1037 left1036 left1035 left1034 left1033 left1032 left1031 left1030 left1029 left1028 left1027 left1026 left1025 left1024 left1023 left1022 left1021 left1020 left1019 left1018 left1017 left1016 left1015 left1014 left1013 left1012 left1011 left1010 left1009 left1008 left1007 left1006 left1005 left1004 left1003 left1002 left1001 left1000 left999 left998 left997 left996 left995 left994 left993 left992 left991 left990 left989 left988 left987 left986 left985 left984 left983 left982 left981 left980 left979 left978 left977 left976 left975 left974 left973 left972 left971 left970 left969 left968 left967 left966 left965 left964 left963 left962 left961 left960 left959 left958 left957 left956 left955 left954 left953 left952 left951 left950 left949 left948 left947 left946 left945 left944 left943 left942 left941 left940 left939 left938 left937 left936 left935 left934 left933 left932 left931 left930 left929 left928 left927 left926 left925 left924 left923 left922 left921 left920 left919 left918 left917 left916 left915 left914 left913 left912 left911 left910 left909 left908 left907 left906 left905 left904 left903 left902 left901 left900 left899 left898 left897 left896 left895 left894 left893 left892 left891 left890 left889 left888 left887 left886 left885 left884 left883 left882 left881 left880 left879 left878 left877 left876 left875 left874 left873 left872 left871 left870 left869 left868 left867 left866 left865 left864 left863 left862 left861 left860 left859 left858 left857 left856 left855 left854 left853 left852 left851 left850 left849 left848 left847 left846 left845 left844 left843 left842 left841 left840 left839 left838 left837 left836 left835 left834 left833 left832 left831 left830 left829 left828 left827 left826 left825 left824 left823 left822 left821 left820 left819 left818 left817 left816 left815 left814 left813 left812 left811 left810 left809 left808 left807 left806 left805 left804 left803 left802 left801 left800 left799 left798 left797 left796 left795 left794 left793 left792 left791 left790 left789 left788 left787 left786 left785 left784 left783 left782 left781 left780 left779 left778 left777 left776 left775 left774 left773 left772 left771 left770 left769 left768 left767 left766 left765 left764 left763 left762 left761 left760 left759 left758 left757 left756 left755 left754 left753 left752 left751 left750 left749 left748 left747 left746 left745 left744 left743 left742 left741 left740 left739 left738 left737 left736 left735 left734 left733 left732 left731 left730 left729 left728 left727 left726 left725 left724 left723 left722 left721 left720 left719 left718 left717 left716 left715 left714 left713 left712 left711 left710 left709 left708 left707 left706 left705 left704 left703 left702 left701 left700 left699 left698 left697 left696 left695 left694 left693 left692 left691 left690 left689 left688 left687 left686 left685 left684 left683 left682 left681 left680 left679 left678 left677 left676 left675 left674 left673 left672 left671 left670 left669 left668 left667 left666 left665 left664 left663 left662 left661 left660 left659 left658 left657 left656 left655 left654 left653 left652 left651 left650 left649 left648 left647 left646 left645 left644 left643 left642 left641 left640 left639 left638 left637 left636 left635 left634 left633 left632 left631 left630 left629 left628 left627 left626 left625 left624 left623 left622 left621 left620 left619 left618 left617 left616 left615 left614 left613 left612 left611 left610 left609 left608 left607 left606 left605 left604 left603 left602 left601 left600 left599 left598 left597 left596 left595 left594 left593 left592 left591 left590 left589 left588 left587 left586 left585 left584 left583 left582 left581 left580 left579 left578 left577 left576 left575 left574 left573 left572 left571 left570 left569 left568 left567 left566 left565 left564 left563 left562 left561 left560 left559 left558 left557 left556 left555 left554 left553 left552 left551 left550 left549 left548 left547 left546 left545 left544 left543 left542 left541 left540 left539 left538 left537 left536 left535 left534 left533 left532 left531 left530 left529 left528 left527 left526 left525 left524 left523 left522 left521 left520 left519 left518 left517 left516 left515 left514 left513 left512 left511 left510 left509 left508 left507 left506 left505 left504 left503 left502 left501 left500 left499 left498 left497 left496 left495 left494 left493 left492 left491 left490 left489 left488 left487 left486 left485 left484 left483 left482 left481 left480 left479 left478 left477 left476 left475 left474 left473 left472 left471 left470 left469 left468 left467 left466 left465 left464 left463 left462 left461 left460 left459 left458 left457 left456 left455 left454 left453 left452 left451 left450 left449 left448 left447 left446 left445 left444 left443 left442 left441 left440 left439 left438 left437 left436 left435 left434 left433 left432 left431 left430 left429 left428 left427 left426 left425 left424 left423 left422 left421 left420 left419 left418 left417 left416 left415 left414 left413 left412 left411 left410 left409 left408 left407 left406 left405 left404 left403 left402 left401 left400 left399 left398 left397 left396 left395 left394 left393 left392 left391 left390 left389 left388 left387 left386 left385 left384 left383 left382 left381 left380 left379 left378 left377 left376 left375 left374 left373 left372 left371 left370 left369 left368 left367 left366 left365 left364 left363 left362 left361 left360 left359 left358 left357 left356 left355 left354 left353 left352 left351 left350 left349 left348 left347 left346 left345 left344 left343 left342 left341 left340 left339 left338 left337 left336 left335 left334 left333 left332 left331 left330 left329 left328 left327 left326 left325 left324 left323 left322 left321 left320 left319 left318 left317 left316 left315 left314 left313 left312 left311 left310 left309 left308 left307 left306 left305 left304 left303 left302 left301 left300 left299 left298 left297 left296 left295 left294 left293 left292 left291 left290 left289 left288 left287 left286 left285 left284 left283 left282 left281 left280 left279 left278 left277 left276 left275 left274 left273 left272 left271 left270 left269 left268 left267 left266 left265 left264 left263 left262 left261 left260 left259 left258 left257 left256 left255 left254 left253 left252 left251 left250 left249 left248 left247 left246 left245 left244 left243 left242 left241 left240 left239 left238 left237 left236 left235 left234 left233 left232 left231 left230 left229 left228 left227 left226 left225 left224 left223 left222 left221 left220 left219 left218 left217 left216 left215 left214 left213 left212 left211 left210 left209 left208 left207 left206 left205 left204 left203 left202 left201 left200 left199 left198 left197 left196 left195 left194 left193 left192 left191 left190 left189 left188 left187 left186 left185 left184 left183 left182 left181 left180 left179 left178 left177 left176 left175 left174 left173 left172 left171 left170 left169 left168 left167 left166 left165 left164 left163 left162 left161 left160 left159 left158 left157 left156 left155 left154 left153 left152 left151 left150 left149 left148 left147 left146 left145 left144 left143 left142 left141 left140 left139 left138 left137 left136 left135 left134 left133 left132 left131 left130 left129 left128 left127 left126 left125 left124 left123 left122 left121 left120 left119 left118 left117 left116 left115 left114 left113 left112 left111 left110 left109 left108 left107 left106 left105 left104 left103 left102 left101 left100 left99 left98 left97 left96 left95 left94 left93 left92 left91 left90 left89 left88 left87 left86 left85 left84 left83 left82 left81 left80 left79 left78 left77 left76 left75 left74 left73 left72 left71 left70 left69 left68 left67 left66 left65 left64 left63 left62 left61 left60 left59 left58 left57 left56 left55 left54 left53 left52 left51 left50 left49 left48 left47 left46 left45 left44 left43 left42 left41 left40 left39 left38 left37 left36 left35 left34 left33 left32 left31 left30 left29 left28 left27 left26 left25 left24 left23 left22 left21 The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
DeepseekV2Config {
  "_name_or_path": "/share-data/wzk-1/model/deepseek-v2-lite",
  "architectures": [
    "DeepseekV2ForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "auto_map": {
    "AutoConfig": "configuration_deepseek.DeepseekV2Config",
    "AutoModel": "modeling_deepseek.DeepseekV2Model",
    "AutoModelForCausalLM": "modeling_deepseek.DeepseekV2ForCausalLM"
  },
  "aux_loss_alpha": 0.001,
  "bos_token_id": 100000,
  "eos_token_id": 100001,
  "ep_size": 1,
  "first_k_dense_replace": 1,
  "hidden_act": "silu",
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 10944,
  "kv_lora_rank": 512,
  "max_position_embeddings": 163840,
  "model_type": "deepseek_v2",
  "moe_intermediate_size": 1408,
  "moe_layer_freq": 1,
  "n_group": 1,
  "n_routed_experts": 64,
  "n_shared_experts": 2,
  "norm_topk_prob": false,
  "num_attention_heads": 16,
  "num_experts_per_tok": 6,
  "num_hidden_layers": 27,
  "num_key_value_heads": 16,
  "pretraining_tp": 1,
  "q_lora_rank": null,
  "qk_nope_head_dim": 128,
  "qk_rope_head_dim": 64,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "beta_fast": 32,
    "beta_slow": 1,
    "factor": 40,
    "mscale": 0.707,
    "mscale_all_dim": 0.707,
    "original_max_position_embeddings": 4096,
    "type": "yarn"
  },
  "rope_theta": 10000,
  "routed_scaling_factor": 1.0,
  "scoring_func": "softmax",
  "seq_aux": true,
  "tie_word_embeddings": false,
  "topk_group": 1,
  "topk_method": "greedy",
  "torch_dtype": "bfloat16",
  "transformers_version": "4.46.3",
  "use_cache": true,
  "v_head_dim": 128,
  "vocab_size": 102400
}

------------Priority Setting In Advance------------
input:  è¯·é€æ­¥è§£å†³ä»¥ä¸‹é—®é¢˜ï¼Œå¹¶è§£é‡Šæ¯æ­¥æ¨ç†è¿‡ç¨‹ï¼š
1. è‹¥3å°æœºå™¨5å°æ—¶ç”Ÿäº§180ä¸ªé›¶ä»¶ï¼Œ7å°æœºå™¨8å°æ—¶å¯ç”Ÿäº§å¤šå°‘é›¶ä»¶ï¼Ÿ
2. ç”²æ¯”ä¹™å¤§6å²ï¼Œ5å¹´å‰ç”²å¹´é¾„æ˜¯ä¹™çš„2å€ï¼Œæ±‚ä¸¤äººç°åœ¨å¹´é¾„ã€‚
3. è®¡ç®—ï¼š(2Â³ Ã— âˆš16) Ã· (4â»Â¹ + logâ‚‚8)
4. ä¸€ä¸ªéª°å­è¿ç»­æ·3æ¬¡ï¼Œè‡³å°‘å‡ºç°ä¸€æ¬¡6çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ
5. ç”¨è´å¶æ–¯å®šç†è§£é‡Šï¼šæ–°å† æ£€æµ‹å‡†ç¡®ç‡98%ï¼Œäººç¾¤æ„ŸæŸ“ç‡1%ï¼ŒæŸäººæ£€æµ‹é˜³æ€§æ—¶å®é™…æ‚£ç—…çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ
è¦æ±‚ï¼šåˆ†æ­¥éª¤å±•ç¤ºè®¡ç®—è¿‡ç¨‹ï¼Œæœ€ç»ˆç­”æ¡ˆç”¨ã€ã€‘æ ‡æ³¨ã€‚
inputs ...
torch.Size([1, 168])
outputs_text ...

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m

[1;36m== Layer 2 MLP ==
[0m

[1;36m== Layer 3 MLP ==
[0m

[1;36m== Layer 4 MLP ==
[0m

[1;36m== Layer 5 MLP ==
[0m

[1;36m== Layer 6 MLP ==
[0m
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m

[1;36m== Layer 8 MLP ==
[0m

[1;36m== Layer 9 MLP ==
[0m

[1;36m== Layer 10 MLP ==
[0m

[1;36m== Layer 11 MLP ==
[0m

[1;36m== Layer 12 MLP ==
[0m
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m

[1;36m== Layer 14 MLP ==
[0m

[1;36m== Layer 15 MLP ==
[0m

[1;36m== Layer 16 MLP ==
[0m

[1;36m== Layer 17 MLP ==
[0m

[1;36m== Layer 18 MLP ==
[0m
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m

[1;36m== Layer 20 MLP ==
[0m

[1;36m== Layer 21 MLP ==
[0m

[1;36m== Layer 22 MLP ==
[0m

[1;36m== Layer 23 MLP ==
[0m

[1;36m== Layer 24 MLP ==
[0m
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m

[1;36m== Layer 26 MLP ==
[0m
[94mGlobal dict updated[0m
[9]:1.0 | [34]:1.0 | [54]:1.0 | [56]:1.0 | [57]:1.0 | [14]:1.0 | 
---------------------------------------
return iEAM
write out information.

left20 left19 left18 left17 left16 left15 left14 left13 left12 left11 left10 left9 left8 left7 left6 left5 left4 left3 left2 left1 left
finished: 1664/1664
EnqueuePrefetch: 2659
[1m[33mEnqueueTask: [0m[32mTask: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2903
[1m[33mEnqueueTask: [0m[32mTask: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:1.0 | [11]:1.0 | [31]:1.0 | [50]:1.0 | [57]:1.0 | [12]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[8]:1.0 | [14]:1.0 | [27]:1.0 | [62]:1.0 | [63]:1.0 | [31]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[0]:1.0 | [21]:1.0 | [22]:1.0 | [46]:1.0 | [48]:1.0 | [55]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[3]:1.0 | [18]:1.0 | [22]:1.0 | [34]:1.0 | [60]:1.0 | [13]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[12]:1.0 | [18]:1.0 | [39]:1.0 | [41]:1.0 | [50]:1.0 | [42]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[11]:1.0 | [16]:1.0 | [37]:1.0 | [46]:1.0 | [56]:1.0 | [50]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[11, 16, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[33mExpert  0: 0.000(2620)[0m | [33mExpert  1: 0.000(2623)[0m | [33mExpert  2: 0.000(2656)[0m | [33mExpert  3: 0.000(2689)[0m | 
[33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | [33mExpert  6: 0.000(2788)[0m | [33mExpert  7: 0.000(2803)[0m | 
[33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | [33mExpert 10: 0.000(2626)[0m | [33mExpert 11: 0.000(2629)[0m | 
[33mExpert 12: 0.000(2632)[0m | [33mExpert 13: 0.000(2635)[0m | [33mExpert 14: 0.000(2638)[0m | [33mExpert 15: 0.000(2641)[0m | 
[33mExpert 16: 0.000(2644)[0m | [33mExpert 17: 0.000(2647)[0m | [33mExpert 18: 0.000(2650)[0m | [33mExpert 19: 0.000(2653)[0m | 
[33mExpert 20: 0.000(2659)[0m | [33mExpert 21: 0.000(2662)[0m | [33mExpert 22: 0.000(2665)[0m | [33mExpert 23: 0.000(2668)[0m | 
[33mExpert 24: 0.000(2671)[0m | [33mExpert 25: 0.000(2674)[0m | [33mExpert 26: 0.000(2677)[0m | [33mExpert 27: 0.000(2680)[0m | 
[33mExpert 28: 0.000(2683)[0m | [33mExpert 29: 0.000(2686)[0m | [33mExpert 30: 0.000(2692)[0m | [33mExpert 31: 0.000(2695)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2659, 2662, 2665, 2668, 2671, 2674, 2677, 2680, 2683, 2686, 2692, 2695]
Prefetching [1;36mTensor 2659[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:1.0 | [38]:1.0 | [41]:1.0 | [42]:1.0 | [50]:1.0 | [26]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[6]:1.0 | [8]:1.0 | [33]:1.0 | [45]:1.0 | [55]:1.0 | [10]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[1]:1.0 | [35]:1.0 | [41]:1.0 | [45]:1.0 | [48]:1.0 | [46]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[17]:1.0 | [41]:1.0 | [53]:1.0 | [55]:1.0 | [60]:1.0 | [30]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[8]:1.0 | [35]:1.0 | [43]:1.0 | [47]:1.0 | [54]:1.0 | [28]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[7]:1.0 | [29]:1.0 | [38]:1.0 | [43]:1.0 | [46]:1.0 | [42]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 7, 29, 38, 43, 46, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[33mExpert  0: 0.000(2858)[0m | [33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | 
[33mExpert  4: 0.000(2960)[0m | [33mExpert  5: 0.000(2993)[0m | [33mExpert  6: 0.000(3026)[0m | [33mExpert  7: 0.000(3041)[0m | 
[33mExpert  8: 0.000(3044)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 10: 0.000(2864)[0m | [33mExpert 11: 0.000(2867)[0m | 
[33mExpert 12: 0.000(2870)[0m | [33mExpert 13: 0.000(2873)[0m | [33mExpert 14: 0.000(2876)[0m | [33mExpert 15: 0.000(2879)[0m | 
[33mExpert 16: 0.000(2882)[0m | [33mExpert 17: 0.000(2885)[0m | [33mExpert 18: 0.000(2888)[0m | [33mExpert 19: 0.000(2891)[0m | 
[33mExpert 20: 0.000(2897)[0m | [33mExpert 21: 0.000(2900)[0m | [33mExpert 22: 0.000(2903)[0m | [33mExpert 23: 0.000(2906)[0m | 
[33mExpert 24: 0.000(2909)[0m | [33mExpert 25: 0.000(2912)[0m | [33mExpert 26: 0.000(2915)[0m | [33mExpert 27: 0.000(2918)[0m | 
[33mExpert 28: 0.000(2921)[0m | [33mExpert 29: 0.000(2924)[0m | [33mExpert 30: 0.000(2930)[0m | [33mExpert 31: 0.000(2933)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2897, 2900, 2903, 2906, 2909, 2912, 2915, 2918, 2921, 2924, 2930, 2933]
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2903[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[21]:1.0 | [29]:1.0 | [33]:1.0 | [41]:1.0 | [44]:1.0 | [6]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[9]:1.0 | [15]:1.0 | [28]:1.0 | [30]:1.0 | [33]:1.0 | [25]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[0]:1.0 | [16]:1.0 | [19]:1.0 | [49]:1.0 | [50]:1.0 | [15]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[15]:1.0 | [16]:1.0 | [17]:1.0 | [24]:1.0 | [41]:1.0 | [42]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[18]:1.0 | [25]:1.0 | [40]:1.0 | [55]:1.0 | [62]:1.0 | [26]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[18]:1.0 | [30]:1.0 | [46]:1.0 | [53]:1.0 | [59]:1.0 | [40]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[18, 30, 46, 53, 59, 40]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[33mExpert  0: 0.000(4076)[0m | [33mExpert  1: 0.000(4079)[0m | [33mExpert  2: 0.000(4112)[0m | [33mExpert  3: 0.000(4145)[0m | 
[33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | [33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | 
[33mExpert  8: 0.000(4262)[0m | [33mExpert  9: 0.000(4265)[0m | [33mExpert 10: 0.000(4082)[0m | [33mExpert 11: 0.000(4085)[0m | 
[33mExpert 12: 0.000(4088)[0m | [33mExpert 13: 0.000(4091)[0m | [33mExpert 14: 0.000(4094)[0m | EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4118
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1324,150000002b] (16MB) STATE(0) TENSOR[4117,4118,4116,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4121
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
[33mExpert 15: 0.000(4097)[0m | 
[33mExpert 16: 0.000(4100)[0m | [33mExpert 17: 0.000(4103)[0m | [33mExpert 18: 0.000(4106)[0m | [33mExpert 19: 0.000(4109)[0m | 
[33mExpert 20: 0.000(4115)[0m | [33mExpert 21: 0.000(4118)[0m | [33mExpert 22: 0.000(4121)[0m | [33mExpert 23: 0.000(4124)[0m | 
[33mExpert 24: 0.000(4127)[0m | [33mExpert 25: 0.000(4130)[0m | [33mExpert 26: 0.000(4133)[0m | [33mExpert 27: 0.000(4136)[0m | 
[33mExpert 28: 0.000(4139)[0m | [33mExpert 29: 0.000(4142)[0m | [33mExpert 30: 0.000(4148)[0m | [33mExpert 31: 0.000(4151)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4115, 4118, 4121, 4124, 4127, 4130, 4133, 4136, 4139, 4142, 4148, 4151]
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4118[0m â†’ GPU 0
Prefetching [1;36mTensor 4121[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21: 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:1.0 | [24]:1.0 | [41]:1.0 | [47]:1.0 | [60]:1.0 | [53]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[15]:1.0 | [22]:1.0 | [25]:1.0 | [44]:1.0 | [50]:1.0 | [43]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[14]:1.0 | [17]:1.0 | [27]:1.0 | [48]:1.0 | [62]:1.0 | [51]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[11]:1.0 | [21]:1.0 | [40]:1.0 | [55]:1.0 | [60]:1.0 | [39]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[6]:1.0 | [7]:1.0 | [22]:1.0 | [23]:1.0 | [47]:1.0 | [12]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[22]:1.0 | [28]:1.0 | [37]:1.0 | [50]:1.0 | [61]:1.0 | [52]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[22, 28, 37, 50, 61, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [12]:1.0 | [57]:1.0 | [63]:1.0 | [45]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[26]:1.0 | [30]:1.0 | [34]:2.0 | [36]:1.0 | [56]:2.0 | [1]:1.0 | 
---------------------------------------
return iEAM

EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2659
[1m[33mEnqueueTask: [0m[32mTask: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2903
[1m[33mEnqueueTask: [0m[32mTask: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:2.0 | [11]:2.0 | [31]:2.0 | [50]:2.0 | [57]:2.0 | [47]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[8]:2.0 | [27]:2.0 | [38]:1.0 | [62]:2.0 | [63]:2.0 | [42]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[0]:2.0 | [5]:1.0 | [21]:2.0 | [46]:2.0 | [48]:2.0 | [60]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[3]:2.0 | [18]:2.0 | [22]:2.0 | [34]:2.0 | [60]:2.0 | [29]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[12]:2.0 | [18]:2.0 | [38]:1.0 | [39]:2.0 | [50]:2.0 | [42]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[11]:2.0 | [16]:2.0 | [37]:2.0 | [46]:2.0 | [56]:2.0 | [50]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[11, 16, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  1: 1.000(2623)[0m | [32mExpert 35: 1.000(2707)[0m | [32mExpert 41: 1.000(2728)[0m | [32mExpert 45: 1.000(2740)[0m | 
[32mExpert 46: 1.000(2743)[0m | [32mExpert 48: 1.000(2749)[0m | [33mExpert  0: 0.000(2620)[0m | [33mExpert  2: 0.000(2656)[0m | 
[33mExpert  3: 0.000(2689)[0m | [33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | [33mExpert  6: 0.000(2788)[0m | 
[33mExpert  7: 0.000(2803)[0m | [33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | [33mExpert 10: 0.000(2626)[0m | 
[33mExpert 11: 0.000(2629)[0m | [33mExpert 12: 0.000(2632)[0m | [33mExpert 13: 0.000(2635)[0m | [33mExpert 14: 0.000(2638)[0m | 
[33mExpert 15: 0.000(2641)[0m | [33mExpert 16: 0.000(2644)[0m | [33mExpert 17: 0.000(2647)[0m | [33mExpert 18: 0.000(2650)[0m | 
[33mExpert 19: 0.000(2653)[0m | [33mExpert 20: 0.000(2659)[0m | [33mExpert 21: 0.000(2662)[0m | [33mExpert 22: 0.000(2665)[0m | 
[33mExpert 23: 0.000(2668)[0m | [33mExpert 24: 0.000(2671)[0m | [33mExpert 25: 0.000(2674)[0m | [33mExpert 26: 0.000(2677)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2641, 2644, 2647, 2650, 2653, 2659, 2662, 2665, 2668, 2671, 2674, 2677]
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2659[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[26]:2.0 | [38]:2.0 | [41]:2.0 | [42]:2.0 | [50]:2.0 | [6]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[8]:2.0 | [33]:2.0 | [45]:2.0 | [46]:1.0 | [55]:2.0 | [6]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[35]:2.0 | [41]:2.0 | [45]:2.0 | [46]:2.0 | [48]:2.0 | [1]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[17]:2.0 | [41]:2.0 | [53]:2.0 | [55]:2.0 | [60]:2.0 | [30]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[8]:2.0 | [28]:2.0 | [43]:2.0 | [47]:2.0 | [54]:2.0 | [35]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[7]:2.0 | [29]:2.0 | [38]:2.0 | [42]:2.0 | [46]:2.0 | [41]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 7, 29, 38, 42, 46, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 1.000(2858)[0m | [32mExpert 15: 1.000(2879)[0m | [32mExpert 16: 1.000(2882)[0m | [32mExpert 19: 1.000(2891)[0m | 
[32mExpert 49: 1.000(2990)[0m | [32mExpert 50: 1.000(2996)[0m | [33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | 
[33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | [33mExpert  5: 0.000(2993)[0m | [33mExpert  6: 0.000(3026)[0m | 
[33mExpert  7: 0.000(3041)[0m | [33mExpert  8: 0.000(3044)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 10: 0.000(2864)[0m | 
[33mExpert 11: 0.000(2867)[0m | [33mExpert 12: 0.000(2870)[0m | [33mExpert 13: 0.000(2873)[0m | [33mExpert 14: 0.000(2876)[0m | 
[33mExpert 17: 0.000(2885)[0m | [33mExpert 18: 0.000(2888)[0m | [33mExpert 20: 0.000(2897)[0m | [33mExpert 21: 0.000(2900)[0m | 
[33mExpert 22: 0.000(2903)[0m | [33mExpert 23: 0.000(2906)[0m | [33mExpert 24: 0.000(2909)[0m | [33mExpert 25: 0.000(2912)[0m | 
[33mExpert 26: 0.000(2915)[0m | [33mExpert 27: 0.000(2918)[0m | [33mExpert 28: 0.000(2921)[0m | [33mExpert 29: 0.000(2924)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2885, 2888, 2897, 2900, 2903, 2906, 2909, 2912, 2915, 2918, 2921, 2924]
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2903[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:2.0 | [21]:2.0 | [29]:2.0 | [33]:2.0 | [44]:2.0 | [41]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[9]:2.0 | [15]:2.0 | [28]:2.0 | [30]:2.0 | [33]:2.0 | [25]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[0]:2.0 | [6]:1.0 | [8]:1.0 | [16]:2.0 | [49]:2.0 | [50]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[10]:1.0 | [15]:2.0 | [17]:2.0 | [24]:2.0 | [41]:2.0 | [42]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[15]:1.0 | [25]:2.0 | [40]:2.0 | [52]:1.0 | [62]:2.0 | [55]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[18]:2.0 | [30]:2.0 | [46]:2.0 | [51]:1.0 | [53]:2.0 | [40]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[18, 30, 46, 51, 53, 40]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 14: 1.000(4094)[0m | [32mExpert 17: 1.000(4103)[0m | [32mExpert 27: 1.000(4136)[0m | [32mExpert 48: 1.000(4205)[0m | 
[32mExpert 51: 1.000(4217)[0m | [32mExpert 62: 1.000(4253)[0m | [33mExpert  0: 0.000(4076)[0m | [33mExpert  1: 0.000(4079)[0m | 
[33mExpert  2: 0.000(4112)[0m | [33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | 
[33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | [33mExpert  8: 0.000(4262)[0m | EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4118
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1324,150000002b] (16MB) STATE(0) TENSOR[4117,4118,4116,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4121
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
[33mExpert  9: 0.000(4265)[0m | 
[33mExpert 10: 0.000(4082)[0m | [33mExpert 11: 0.000(4085)[0m | [33mExpert 12: 0.000(4088)[0m | [33mExpert 13: 0.000(4091)[0m | 
[33mExpert 15: 0.000(4097)[0m | [33mExpert 16: 0.000(4100)[0m | [33mExpert 18: 0.000(4106)[0m | [33mExpert 19: 0.000(4109)[0m | 
[33mExpert 20: 0.000(4115)[0m | [33mExpert 21: 0.000(4118)[0m | [33mExpert 22: 0.000(4121)[0m | [33mExpert 23: 0.000(4124)[0m | 
[33mExpert 24: 0.000(4127)[0m | [33mExpert 25: 0.000(4130)[0m | [33mExpert 26: 0.000(4133)[0m | [33mExpert 28: 0.000(4139)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4097, 4100, 4106, 4109, 4115, 4118, 4121, 4124, 4127, 4130, 4133, 4139]
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4118[0m â†’ GPU 0
Prefetching [1;36mTensor 4121[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21: 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:2.0 | [24]:2.0 | [41]:2.0 | [47]:2.0 | [60]:2.0 | [30]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[15]:2.0 | [22]:2.0 | [43]:2.0 | [44]:2.0 | [50]:2.0 | [25]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[13]:1.0 | [14]:2.0 | [17]:2.0 | [27]:2.0 | [62]:2.0 | [54]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[11]:2.0 | [21]:2.0 | [39]:2.0 | [40]:2.0 | [60]:2.0 | [37]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[6]:2.0 | [7]:2.0 | [22]:2.0 | [23]:2.0 | [57]:1.0 | [47]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[22]:2.0 | [28]:2.0 | [37]:2.0 | [50]:2.0 | [61]:2.0 | [10]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[22, 28, 37, 50, 61, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:2.0 | [10]:2.0 | [12]:2.0 | [21]:1.0 | [57]:2.0 | [63]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[26]:2.0 | [30]:2.0 | [34]:3.0 | [36]:2.0 | [56]:3.0 | [1]:2.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2659
[1m[33mEnqueueTask: [0m[32mTask: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2903
[1m[33mEnqueueTask: [0m[32mTask: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:1.0 | [9]:1.0 | [13]:1.0 | [37]:1.0 | [52]:1.0 | [23]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[14]:2.0 | [35]:1.0 | [42]:2.0 | [58]:1.0 | [63]:3.0 | [22]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[0]:3.0 | [7]:1.0 | [17]:1.0 | [42]:1.0 | [48]:3.0 | [50]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[10]:1.0 | [18]:3.0 | [34]:3.0 | [59]:1.0 | [60]:3.0 | [38]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[18]:3.0 | [38]:2.0 | [39]:3.0 | [41]:2.0 | [50]:3.0 | [42]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[6]:1.0 | [19]:1.0 | [37]:3.0 | [46]:3.0 | [56]:3.0 | [50]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 6, 19, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  1: 2.000(2623)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 41: 2.000(2728)[0m | [32mExpert 45: 2.000(2740)[0m | 
[32mExpert 46: 2.000(2743)[0m | [32mExpert 48: 2.000(2749)[0m | [33mExpert  0: 0.000(2620)[0m | [33mExpert  2: 0.000(2656)[0m | 
[33mExpert  3: 0.000(2689)[0m | [33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | [33mExpert  6: 0.000(2788)[0m | 
[33mExpert  7: 0.000(2803)[0m | [33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | [33mExpert 10: 0.000(2626)[0m | 
[33mExpert 11: 0.000(2629)[0m | [33mExpert 12: 0.000(2632)[0m | [33mExpert 13: 0.000(2635)[0m | [33mExpert 14: 0.000(2638)[0m | 
[33mExpert 15: 0.000(2641)[0m | [33mExpert 16: 0.000(2644)[0m | [33mExpert 17: 0.000(2647)[0m | [33mExpert 18: 0.000(2650)[0m | 
[33mExpert 19: 0.000(2653)[0m | [33mExpert 20: 0.000(2659)[0m | [33mExpert 21: 0.000(2662)[0m | [33mExpert 22: 0.000(2665)[0m | 
[33mExpert 23: 0.000(2668)[0m | [33mExpert 24: 0.000(2671)[0m | [33mExpert 25: 0.000(2674)[0m | [33mExpert 26: 0.000(2677)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2641, 2644, 2647, 2650, 2653, 2659, 2662, 2665, 2668, 2671, 2674, 2677]
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2659[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:3.0 | [8]:1.0 | [16]:1.0 | [41]:3.0 | [50]:3.0 | [38]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[8]:3.0 | [32]:1.0 | [45]:3.0 | [46]:2.0 | [49]:1.0 | [33]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[17]:1.0 | [19]:1.0 | [41]:3.0 | [45]:3.0 | [46]:3.0 | [53]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:3.0 | [41]:3.0 | [44]:1.0 | [57]:1.0 | [59]:1.0 | [55]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[16]:1.0 | [23]:1.0 | [28]:3.0 | [31]:1.0 | [43]:3.0 | [47]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[4]:1.0 | [28]:1.0 | [29]:3.0 | [37]:1.0 | [41]:2.0 | [46]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 4, 28, 29, 37, 41, 46]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 2.000(2858)[0m | [32mExpert 16: 2.000(2882)[0m | [32mExpert 49: 2.000(2990)[0m | [32mExpert 50: 2.000(2996)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 15: 1.000(2879)[0m | [32mExpert 19: 1.000(2891)[0m | 
[33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | 
[33mExpert  5: 0.000(2993)[0m | [33mExpert  7: 0.000(3041)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 10: 0.000(2864)[0m | 
[33mExpert 11: 0.000(2867)[0m | [33mExpert 12: 0.000(2870)[0m | [33mExpert 13: 0.000(2873)[0m | [33mExpert 14: 0.000(2876)[0m | 
[33mExpert 17: 0.000(2885)[0m | [33mExpert 18: 0.000(2888)[0m | [33mExpert 20: 0.000(2897)[0m | [33mExpert 21: 0.000(2900)[0m | 
[33mExpert 22: 0.000(2903)[0m | [33mExpert 23: 0.000(2906)[0m | [33mExpert 24: 0.000(2909)[0m | [33mExpert 25: 0.000(2912)[0m | 
[33mExpert 26: 0.000(2915)[0m | [33mExpert 27: 0.000(2918)[0m | [33mExpert 28: 0.000(2921)[0m | [33mExpert 29: 0.000(2924)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2885, 2888, 2897, 2900, 2903, 2906, 2909, 2912, 2915, 2918, 2921, 2924]
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2903[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:3.0 | [17]:1.0 | [18]:1.0 | [29]:3.0 | [44]:3.0 | [5]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[9]:3.0 | [26]:1.0 | [28]:3.0 | [33]:3.0 | [49]:1.0 | [50]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[0]:3.0 | [10]:1.0 | [16]:3.0 | [49]:3.0 | [58]:1.0 | [55]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[5]:1.0 | [8]:1.0 | [16]:2.0 | [24]:3.0 | [41]:3.0 | [21]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[3]:1.0 | [5]:1.0 | [24]:1.0 | [25]:3.0 | [40]:3.0 | [62]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[8]:1.0 | [13]:1.0 | [22]:1.0 | [46]:3.0 | [52]:1.0 | [18]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 8, 13, 22, 46, 52, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 14: 2.000(4094)[0m | EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4118
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1324,150000002b] (16MB) STATE(0) TENSOR[4117,4118,4116,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4121
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
[32mExpert 17: 2.000(4103)[0m | [32mExpert 27: 2.000(4136)[0m | [32mExpert 62: 2.000(4253)[0m | 
[32mExpert 13: 1.000(4091)[0m | [32mExpert 48: 1.000(4205)[0m | [32mExpert 51: 1.000(4217)[0m | [32mExpert 54: 1.000(4226)[0m | 
[33mExpert  0: 0.000(4076)[0m | [33mExpert  1: 0.000(4079)[0m | [33mExpert  2: 0.000(4112)[0m | [33mExpert  3: 0.000(4145)[0m | 
[33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | [33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | 
[33mExpert  8: 0.000(4262)[0m | [33mExpert  9: 0.000(4265)[0m | [33mExpert 10: 0.000(4082)[0m | [33mExpert 11: 0.000(4085)[0m | 
[33mExpert 12: 0.000(4088)[0m | [33mExpert 15: 0.000(4097)[0m | [33mExpert 16: 0.000(4100)[0m | [33mExpert 18: 0.000(4106)[0m | 
[33mExpert 19: 0.000(4109)[0m | [33mExpert 20: 0.000(4115)[0m | [33mExpert 21: 0.000(4118)[0m | [33mExpert 22: 0.000(4121)[0m | 
[33mExpert 23: 0.000(4124)[0m | [33mExpert 24: 0.000(4127)[0m | [33mExpert 25: 0.000(4130)[0m | [33mExpert 26: 0.000(4133)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4097, 4100, 4106, 4109, 4115, 4118, 4121, 4124, 4127, 4130, 4133]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4118[0m â†’ GPU 0
Prefetching [1;36mTensor 4121[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21: 12, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:3.0 | [24]:3.0 | [29]:1.0 | [31]:1.0 | [53]:2.0 | [3]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[6]:1.0 | [15]:3.0 | [43]:3.0 | [50]:3.0 | [55]:1.0 | [60]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[2]:1.0 | [17]:3.0 | [21]:1.0 | [43]:1.0 | [48]:2.0 | [0]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[2]:1.0 | [4]:1.0 | [11]:3.0 | [21]:3.0 | [58]:1.0 | [3]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[13]:1.0 | [22]:3.0 | [35]:1.0 | [47]:3.0 | [54]:1.0 | [33]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[10]:2.0 | [23]:1.0 | [33]:1.0 | [48]:1.0 | [62]:1.0 | [52]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[10, 23, 33, 48, 62, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:1.0 | [25]:1.0 | [48]:1.0 | [54]:1.0 | [62]:1.0 | [47]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[20]:1.0 | [29]:1.0 | [49]:1.0 | [59]:1.0 | [62]:1.0 | [8]:1.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2659
[1m[33mEnqueueTask: [0m[32mTask: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2873
[1m[33mEnqueueTask: [0m[32mTask: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2903
[1m[33mEnqueueTask: [0m[32mTask: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:1.0 | [20]:1.0 | [26]:1.0 | [52]:2.0 | [56]:1.0 | [46]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[35]:2.0 | [38]:2.0 | [42]:3.0 | [57]:1.0 | [63]:4.0 | [14]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[0]:4.0 | [5]:2.0 | [7]:2.0 | [22]:2.0 | [42]:2.0 | [54]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[13]:2.0 | [18]:4.0 | [26]:1.0 | [34]:4.0 | [59]:2.0 | [60]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[38]:3.0 | [39]:4.0 | [40]:1.0 | [41]:3.0 | [50]:4.0 | [10]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[19]:2.0 | [28]:1.0 | [35]:1.0 | [46]:4.0 | [56]:4.0 | [50]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[19, 28, 35, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 3.000(2728)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 46: 3.000(2743)[0m | [32mExpert  1: 2.000(2623)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert 17: 1.000(2647)[0m | [32mExpert 19: 1.000(2653)[0m | 
[32mExpert 53: 1.000(2767)[0m | [33mExpert  0: 0.000(2620)[0m | [33mExpert  2: 0.000(2656)[0m | [33mExpert  3: 0.000(2689)[0m | 
[33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | [33mExpert  6: 0.000(2788)[0m | [33mExpert  7: 0.000(2803)[0m | 
[33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | [33mExpert 10: 0.000(2626)[0m | [33mExpert 11: 0.000(2629)[0m | 
[33mExpert 12: 0.000(2632)[0m | [33mExpert 13: 0.000(2635)[0m | [33mExpert 14: 0.000(2638)[0m | [33mExpert 15: 0.000(2641)[0m | 
[33mExpert 16: 0.000(2644)[0m | [33mExpert 18: 0.000(2650)[0m | [33mExpert 20: 0.000(2659)[0m | [33mExpert 21: 0.000(2662)[0m | 
[33mExpert 22: 0.000(2665)[0m | [33mExpert 23: 0.000(2668)[0m | [33mExpert 24: 0.000(2671)[0m | [33mExpert 25: 0.000(2674)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2632, 2635, 2638, 2641, 2644, 2650, 2659, 2662, 2665, 2668, 2671, 2674]
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2659[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 12, 13, 14, 15, 16, 18, 20, 21, 22, 23, 24, 25 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:2.0 | [41]:4.0 | [42]:3.0 | [50]:4.0 | [55]:1.0 | [26]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[6]:3.0 | [8]:4.0 | [17]:1.0 | [46]:3.0 | [49]:2.0 | [18]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[17]:2.0 | [33]:1.0 | [38]:1.0 | [41]:4.0 | [46]:4.0 | [53]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[30]:4.0 | [41]:4.0 | [50]:1.0 | [55]:4.0 | [57]:2.0 | [51]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[28]:4.0 | [34]:1.0 | [43]:4.0 | [47]:4.0 | [54]:3.0 | [16]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[29]:4.0 | [41]:3.0 | [42]:3.0 | [57]:1.0 | [58]:1.0 | [3]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[29, 41, 42, 57, 58,  3]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 3.000(2858)[0m | [32mExpert 16: 3.000(2882)[0m | [32mExpert 49: 3.000(2990)[0m | [32mExpert 50: 2.000(2996)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 15: 1.000(2879)[0m | 
[32mExpert 19: 1.000(2891)[0m | [32mExpert 55: 1.000(3011)[0m | [32mExpert 58: 1.000(3020)[0m | [33mExpert  1: 0.000(2861)[0m | 
[33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | [33mExpert  5: 0.000(2993)[0m | 
[33mExpert  7: 0.000(3041)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 11: 0.000(2867)[0m | [33mExpert 12: 0.000(2870)[0m | 
[33mExpert 13: 0.000(2873)[0m | [33mExpert 14: 0.000(2876)[0m | [33mExpert 17: 0.000(2885)[0m | [33mExpert 18: 0.000(2888)[0m | 
[33mExpert 20: 0.000(2897)[0m | [33mExpert 21: 0.000(2900)[0m | [33mExpert 22: 0.000(2903)[0m | [33mExpert 23: 0.000(2906)[0m | 
[33mExpert 24: 0.000(2909)[0m | [33mExpert 25: 0.000(2912)[0m | [33mExpert 26: 0.000(2915)[0m | [33mExpert 27: 0.000(2918)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2873, 2876, 2885, 2888, 2897, 2900, 2903, 2906, 2909, 2912, 2915, 2918]
Prefetching [1;36mTensor 2873[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2903[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 13, 14, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:1.0 | [30]:1.0 | [40]:1.0 | [41]:3.0 | [44]:4.0 | [29]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[25]:3.0 | [28]:4.0 | [30]:3.0 | [33]:4.0 | [50]:2.0 | [15]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[0]:4.0 | [15]:2.0 | [16]:4.0 | [49]:4.0 | [59]:1.0 | [55]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[16]:3.0 | [17]:3.0 | [24]:4.0 | [41]:4.0 | [50]:1.0 | [42]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[25]:4.0 | [40]:4.0 | [52]:2.0 | [55]:3.0 | [56]:1.0 | [15]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[8]:2.0 | [18]:4.0 | [46]:4.0 | [51]:2.0 | [53]:3.0 | [28]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 8, 18, 46, 51, 53, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 3.000(4103)[0m | [32mExpert 14: 2.000(4094)[0m | [32mExpert 27: 2.000(4136)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  2: 1.000(4112)[0m | [32mExpert 13: 1.000(4091)[0m | 
[32mExpert 21: 1.000(4118)[0m | [32mExpert 43: 1.000(4190)[0m | [32mExpert 51: 1.000(4217)[0m | [32mExpert 54: 1.000(4226)[0m | 
[33mExpert  1: 0.000(4079)[0m | [33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0mEnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4085
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4121
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
 | [33mExpert  5: 0.000(4211)[0m | 
[33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | [33mExpert  8: 0.000(4262)[0m | [33mExpert  9: 0.000(4265)[0m | 
[33mExpert 10: 0.000(4082)[0m | [33mExpert 11: 0.000(4085)[0m | [33mExpert 12: 0.000(4088)[0m | [33mExpert 15: 0.000(4097)[0m | 
[33mExpert 16: 0.000(4100)[0m | [33mExpert 18: 0.000(4106)[0m | [33mExpert 19: 0.000(4109)[0m | [33mExpert 20: 0.000(4115)[0m | 
[33mExpert 22: 0.000(4121)[0m | [33mExpert 23: 0.000(4124)[0m | [33mExpert 24: 0.000(4127)[0m | [33mExpert 25: 0.000(4130)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4082, 4085, 4088, 4097, 4100, 4106, 4109, 4115, 4121, 4124, 4127, 4130]
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4085[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4121[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21: 10, 11, 12, 15, 16, 18, 19, 20, 22, 23, 24, 25 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:4.0 | [36]:1.0 | [41]:3.0 | [47]:3.0 | [60]:3.0 | [53]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[7]:1.0 | [15]:4.0 | [22]:3.0 | [29]:1.0 | [50]:4.0 | [42]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[9]:1.0 | [14]:3.0 | [30]:1.0 | [35]:1.0 | [55]:1.0 | [17]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[5]:1.0 | [21]:4.0 | [33]:1.0 | [39]:3.0 | [60]:3.0 | [26]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[7]:3.0 | [23]:3.0 | [38]:1.0 | [45]:1.0 | [62]:1.0 | [40]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[28]:3.0 | [52]:3.0 | [58]:1.0 | [60]:1.0 | [61]:3.0 | [10]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[28, 52, 58, 60, 61, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:3.0 | [12]:3.0 | [45]:2.0 | [54]:2.0 | [63]:3.0 | [18]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[1]:3.0 | [12]:1.0 | [30]:3.0 | [51]:1.0 | [56]:4.0 | [27]:1.0 | 
---------------------------------------
return iEAM
1. EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2659
[1m[33mEnqueueTask: [0m[32mTask: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2873
[1m[33mEnqueueTask: [0m[32mTask: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2903
[1m[33mEnqueueTask: [0m[32mTask: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:2.0 | [11]:3.0 | [13]:2.0 | [27]:1.0 | [56]:2.0 | [57]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [14]:4.0 | [29]:1.0 | [38]:3.0 | [11]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[7]:3.0 | [10]:1.0 | [22]:3.0 | [42]:3.0 | [46]:3.0 | [23]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[13]:3.0 | [26]:2.0 | [34]:5.0 | [41]:1.0 | [59]:3.0 | [45]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[15]:1.0 | [38]:4.0 | [40]:2.0 | [41]:4.0 | [50]:5.0 | [39]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[6]:2.0 | [19]:3.0 | [35]:2.0 | [46]:5.0 | [56]:5.0 | [50]:5.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 6, 19, 35, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 4.000(2728)[0m | [32mExpert 46: 4.000(2743)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert  1: 2.000(2623)[0m | 
[32mExpert 17: 2.000(2647)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert 53: 2.000(2767)[0m | 
[32mExpert 19: 1.000(2653)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 38: 1.000(2716)[0m | [33mExpert  0: 0.000(2620)[0m | 
[33mExpert  2: 0.000(2656)[0m | [33mExpert  3: 0.000(2689)[0m | [33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | 
[33mExpert  6: 0.000(2788)[0m | [33mExpert  7: 0.000(2803)[0m | [33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | 
[33mExpert 10: 0.000(2626)[0m | [33mExpert 11: 0.000(2629)[0m | [33mExpert 12: 0.000(2632)[0m | [33mExpert 13: 0.000(2635)[0m | 
[33mExpert 14: 0.000(2638)[0m | [33mExpert 15: 0.000(2641)[0m | [33mExpert 16: 0.000(2644)[0m | [33mExpert 18: 0.000(2650)[0m | 
[33mExpert 20: 0.000(2659)[0m | [33mExpert 21: 0.000(2662)[0m | [33mExpert 22: 0.000(2665)[0m | [33mExpert 23: 0.000(2668)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2626, 2629, 2632, 2635, 2638, 2641, 2644, 2650, 2659, 2662, 2665, 2668]
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2659[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 10, 11, 12, 13, 14, 15, 16, 18, 20, 21, 22, 23 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:3.0 | [16]:2.0 | [26]:4.0 | [41]:5.0 | [50]:5.0 | [42]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[6]:4.0 | [8]:5.0 | [25]:1.0 | [46]:4.0 | [49]:3.0 | [18]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[17]:3.0 | [19]:2.0 | [38]:2.0 | [41]:5.0 | [46]:5.0 | [53]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[30]:5.0 | [41]:5.0 | [50]:2.0 | [51]:2.0 | [59]:2.0 | [0]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[28]:5.0 | [43]:5.0 | [51]:1.0 | [53]:1.0 | [54]:4.0 | [34]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[29]:5.0 | [41]:4.0 | [42]:4.0 | [46]:4.0 | [58]:2.0 | [30]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[29, 41, 42, 46, 58, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 4.000(2858)[0m | [32mExpert 16: 4.000(2882)[0m | [32mExpert 49: 4.000(2990)[0m | [32mExpert 15: 2.000(2879)[0m | 
[32mExpert 50: 2.000(2996)[0m | [32mExpert 55: 2.000(3011)[0m | [32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | 
[32mExpert 10: 1.000(2864)[0m | [32mExpert 19: 1.000(2891)[0m | [32mExpert 58: 1.000(3020)[0m | [32mExpert 59: 1.000(3023)[0m | 
[33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | 
[33mExpert  5: 0.000(2993)[0m | [33mExpert  7: 0.000(3041)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 11: 0.000(2867)[0m | 
[33mExpert 12: 0.000(2870)[0m | [33mExpert 13: 0.000(2873)[0m | [33mExpert 14: 0.000(2876)[0m | [33mExpert 17: 0.000(2885)[0m | 
[33mExpert 18: 0.000(2888)[0m | [33mExpert 20: 0.000(2897)[0m | [33mExpert 21: 0.000(2900)[0m | [33mExpert 22: 0.000(2903)[0m | 
[33mExpert 23: 0.000(2906)[0m | [33mExpert 24: 0.000(2909)[0m | [33mExpert 25: 0.000(2912)[0m | [33mExpert 26: 0.000(2915)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2870, 2873, 2876, 2885, 2888, 2897, 2900, 2903, 2906, 2909, 2912, 2915]
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2873[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2903[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 25, 26 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[30]:2.0 | [33]:3.0 | [39]:1.0 | [40]:2.0 | [44]:5.0 | [41]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[25]:4.0 | [28]:5.0 | [30]:4.0 | [33]:5.0 | [50]:3.0 | [36]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[0]:5.0 | [16]:5.0 | [19]:2.0 | [49]:5.0 | [59]:2.0 | [15]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[15]:3.0 | [24]:5.0 | [41]:5.0 | [50]:2.0 | [58]:1.0 | [48]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[25]:5.0 | [40]:5.0 | [52]:3.0 | [55]:4.0 | [56]:2.0 | [6]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[27]:1.0 | [46]:5.0 | [51]:3.0 | [53]:4.0 | [57]:1.0 | [37]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[27, 46, 51, 53, 57, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 4.000(4103)[0m | [32mExpert 14: 3.000(4094)[0m | [32mExpert 27: 2.000(4136)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  2: 1.000(4112)[0m | [32mExpert  9: 1.000(4265)[0m | 
[32mExpert 13: 1.000(4091)[0m | [32mExpert 21: 1.000(4118)[0m | [32mExpert 30: 1.000(4148)[0m | [32mExpert 35: 1.000(4163)[0m | 
[32mExpert 43: 1.000(4190)[0m | [32mExpert 51: 1.000(4217)[0m | [32mExpert 54: 1.000(4226)[0mEnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4085
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4121
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1325,160000002b] (16MB) STATE(0) TENSOR[4120,4121,4119,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
 | [32mExpert 55: 1.000(4229)[0m | 
[33mExpert  1: 0.000(4079)[0m | [33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | 
[33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | [33mExpert  8: 0.000(4262)[0m | [33mExpert 10: 0.000(4082)[0m | 
[33mExpert 11: 0.000(4085)[0m | [33mExpert 12: 0.000(4088)[0m | [33mExpert 15: 0.000(4097)[0m | [33mExpert 16: 0.000(4100)[0m | 
[33mExpert 18: 0.000(4106)[0m | [33mExpert 19: 0.000(4109)[0m | [33mExpert 20: 0.000(4115)[0m | [33mExpert 22: 0.000(4121)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4244, 4259, 4262, 4082, 4085, 4088, 4097, 4100, 4106, 4109, 4115, 4121]
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4085[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4121[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  7,  8, 10, 11, 12, 15, 16, 18, 19, 20, 22 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:5.0 | [41]:4.0 | [47]:4.0 | [52]:1.0 | [60]:4.0 | [56]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[15]:5.0 | [22]:4.0 | [25]:3.0 | [42]:2.0 | [50]:5.0 | [7]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[14]:4.0 | [27]:3.0 | [35]:2.0 | [54]:2.0 | [55]:2.0 | [37]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[21]:5.0 | [26]:2.0 | [37]:2.0 | [39]:4.0 | [60]:4.0 | [40]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[7]:4.0 | [23]:4.0 | [38]:2.0 | [55]:1.0 | [63]:1.0 | [57]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[21]:1.0 | [28]:4.0 | [37]:3.0 | [50]:3.0 | [57]:1.0 | [19]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[21, 28, 37, 50, 57, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:3.0 | [10]:4.0 | [12]:4.0 | [39]:1.0 | [57]:3.0 | [49]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[30]:4.0 | [34]:4.0 | [36]:3.0 | [44]:1.0 | [48]:1.0 | [5]:1.0 | 
---------------------------------------
return iEAM
è‹¥EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2659
[1m[33mEnqueueTask: [0m[32mTask: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2873
[1m[33mEnqueueTask: [0m[32mTask: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2903
[1m[33mEnqueueTask: [0m[32mTask: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[17]:1.0 | [24]:1.0 | [25]:1.0 | [43]:1.0 | [53]:1.0 | [42]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[34]:1.0 | [38]:4.0 | [42]:4.0 | [57]:2.0 | [61]:1.0 | [7]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[4]:1.0 | [16]:1.0 | [42]:4.0 | [44]:1.0 | [58]:1.0 | [7]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[9]:1.0 | [25]:1.0 | [29]:2.0 | [30]:1.0 | [38]:2.0 | [49]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[14]:1.0 | [35]:1.0 | [36]:1.0 | [38]:5.0 | [41]:5.0 | [20]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[0]:1.0 | [5]:1.0 | [19]:4.0 | [26]:1.0 | [52]:1.0 | [1]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 0,  5, 19, 26, 52,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.000(2728)[0m | [32mExpert 46: 5.000(2743)[0m | [32mExpert 17: 3.000(2647)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert 33: 1.000(2701)[0m | [33mExpert  0: 0.000(2620)[0m | 
[33mExpert  2: 0.000(2656)[0m | [33mExpert  3: 0.000(2689)[0m | [33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | 
[33mExpert  6: 0.000(2788)[0m | [33mExpert  7: 0.000(2803)[0m | [33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | 
[33mExpert 10: 0.000(2626)[0m | [33mExpert 11: 0.000(2629)[0m | [33mExpert 12: 0.000(2632)[0m | [33mExpert 13: 0.000(2635)[0m | 
[33mExpert 14: 0.000(2638)[0m | [33mExpert 15: 0.000(2641)[0m | [33mExpert 16: 0.000(2644)[0m | [33mExpert 18: 0.000(2650)[0m | 
[33mExpert 20: 0.000(2659)[0m | [33mExpert 21: 0.000(2662)[0m | [33mExpert 22: 0.000(2665)[0m | [33mExpert 23: 0.000(2668)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2626, 2629, 2632, 2635, 2638, 2641, 2644, 2650, 2659, 2662, 2665, 2668]
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2659[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 10, 11, 12, 13, 14, 15, 16, 18, 20, 21, 22, 23 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[4]:1.0 | [25]:1.0 | [36]:1.0 | [50]:6.0 | [60]:1.0 | [30]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[17]:2.0 | [21]:1.0 | [26]:1.0 | [40]:1.0 | [49]:4.0 | [27]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[2]:1.0 | [17]:4.0 | [42]:1.0 | [46]:6.0 | [61]:1.0 | [0]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[4]:1.0 | [26]:1.0 | [33]:1.0 | [41]:6.0 | [63]:1.0 | [30]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[10]:1.0 | [22]:1.0 | [30]:1.0 | [46]:1.0 | [53]:2.0 | [61]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[4]:2.0 | [39]:1.0 | [42]:5.0 | [45]:1.0 | [59]:1.0 | [56]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 4, 39, 42, 45, 59, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 49: 5.000(2990)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 19: 2.000(2891)[0m | [32mExpert 50: 2.000(2996)[0m | [32mExpert 55: 2.000(3011)[0m | [32mExpert 59: 2.000(3023)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 58: 1.000(3020)[0m | 
[33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | 
[33mExpert  5: 0.000(2993)[0m | [33mExpert  7: 0.000(3041)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 11: 0.000(2867)[0m | 
[33mExpert 12: 0.000(2870)[0m | [33mExpert 13: 0.000(2873)[0m | [33mExpert 14: 0.000(2876)[0m | [33mExpert 17: 0.000(2885)[0m | 
[33mExpert 18: 0.000(2888)[0m | [33mExpert 20: 0.000(2897)[0m | [33mExpert 21: 0.000(2900)[0m | [33mExpert 22: 0.000(2903)[0m | 
[33mExpert 23: 0.000(2906)[0m | [33mExpert 24: 0.000(2909)[0m | [33mExpert 25: 0.000(2912)[0m | [33mExpert 26: 0.000(2915)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2870, 2873, 2876, 2885, 2888, 2897, 2900, 2903, 2906, 2909, 2912, 2915]
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2873[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2903[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 25, 26 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[12]:1.0 | [30]:3.0 | [34]:1.0 | [40]:3.0 | [58]:1.0 | [47]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[7]:1.0 | [27]:1.0 | [28]:6.0 | [50]:4.0 | [60]:1.0 | [46]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[31]:1.0 | [47]:1.0 | [52]:1.0 | [55]:3.0 | [59]:3.0 | [63]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[7]:1.0 | [9]:1.0 | [36]:1.0 | [59]:1.0 | [62]:1.0 | [63]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[0]:1.0 | [25]:6.0 | [31]:1.0 | [44]:1.0 | [52]:4.0 | [60]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[4]:1.0 | [23]:1.0 | [25]:1.0 | [30]:3.0 | [31]:1.0 | [61]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 4, 23, 25, 30, 31, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 14: 4.000(4094)[0m | [32mExpert 17: 4.000(4103)[0m | [32mExpert 27: 3.000(4136)[0m | [32mExpert 35: 2.000(4163)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 54: 2.000(4226)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert 62: 2.000(4253)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  2: 1.000(4112)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 13: 1.000(4091)[0m | 
[32mExpert 21: 1.000(4118)[0m | [32mExpert 30: 1.000(4148)[0m | [32mExpert 37: 1.000(4169)[0m | EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4085
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
[32mExpert 43: 1.000(4190)[0m | 
[32mExpert 51: 1.000(4217)[0m | [33mExpert  1: 0.000(4079)[0m | [33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | 
[33mExpert  5: 0.000(4211)[0m | [33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | [33mExpert  8: 0.000(4262)[0m | 
[33mExpert 10: 0.000(4082)[0m | [33mExpert 11: 0.000(4085)[0m | [33mExpert 12: 0.000(4088)[0m | [33mExpert 15: 0.000(4097)[0m | 
[33mExpert 16: 0.000(4100)[0m | [33mExpert 18: 0.000(4106)[0m | [33mExpert 19: 0.000(4109)[0m | [33mExpert 20: 0.000(4115)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4211, 4244, 4259, 4262, 4082, 4085, 4088, 4097, 4100, 4106, 4109, 4115]
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4085[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6,  7,  8, 10, 11, 12, 15, 16, 18, 19, 20 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:1.0 | [13]:1.0 | [28]:1.0 | [35]:1.0 | [41]:5.0 | [25]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[9]:1.0 | [19]:1.0 | [42]:3.0 | [46]:1.0 | [53]:1.0 | [31]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[30]:2.0 | [35]:3.0 | [54]:3.0 | [61]:1.0 | [63]:1.0 | [46]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[26]:3.0 | [33]:2.0 | [35]:1.0 | [39]:5.0 | [46]:1.0 | [44]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[7]:5.0 | [14]:1.0 | [45]:2.0 | [55]:2.0 | [61]:1.0 | [3]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[5]:1.0 | [10]:4.0 | [21]:2.0 | [28]:5.0 | [57]:2.0 | [34]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 5, 10, 21, 28, 57, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[18]:2.0 | [34]:1.0 | [54]:3.0 | [59]:1.0 | [63]:4.0 | [29]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[21]:1.0 | [32]:1.0 | [36]:4.0 | [42]:1.0 | [63]:1.0 | [6]:1.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2659
[1m[33mEnqueueTask: [0m[32mTask: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[543,1400000013] (16MB) STATE(0) TENSOR[2658,2659,2657,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2873
[1m[33mEnqueueTask: [0m[32mTask: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2903
[1m[33mEnqueueTask: [0m[32mTask: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[935,160000001f] (16MB) STATE(0) TENSOR[2902,2903,2901,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[1]:1.0 | [3]:3.0 | [13]:3.0 | [40]:1.0 | [59]:1.0 | [46]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[7]:2.0 | [16]:1.0 | [24]:1.0 | [35]:3.0 | [58]:2.0 | [3]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[2]:1.0 | [17]:2.0 | [27]:1.0 | [38]:1.0 | [62]:1.0 | [14]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[10]:2.0 | [37]:1.0 | [40]:1.0 | [45]:2.0 | [47]:1.0 | [33]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[5]:1.0 | [29]:1.0 | [36]:2.0 | [52]:1.0 | [59]:1.0 | [42]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[6]:3.0 | [21]:1.0 | [26]:2.0 | [41]:1.0 | [51]:1.0 | [27]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 6, 21, 26, 41, 51, 27]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.000(2743)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 17: 4.000(2647)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 
[32mExpert 33: 1.000(2701)[0m | [32mExpert 42: 1.000(2731)[0m | [32mExpert 61: 1.000(2794)[0m | [33mExpert  3: 0.000(2689)[0m | 
[33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | [33mExpert  6: 0.000(2788)[0m | [33mExpert  7: 0.000(2803)[0m | 
[33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | [33mExpert 10: 0.000(2626)[0m | [33mExpert 11: 0.000(2629)[0m | 
[33mExpert 12: 0.000(2632)[0m | [33mExpert 13: 0.000(2635)[0m | [33mExpert 14: 0.000(2638)[0m | [33mExpert 15: 0.000(2641)[0m | 
[33mExpert 16: 0.000(2644)[0m | [33mExpert 18: 0.000(2650)[0m | [33mExpert 20: 0.000(2659)[0m | [33mExpert 21: 0.000(2662)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2806, 2809, 2626, 2629, 2632, 2635, 2638, 2641, 2644, 2650, 2659, 2662]
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2659[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  8,  9, 10, 11, 12, 13, 14, 15, 16, 18, 20, 21 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:1.0 | [14]:1.0 | [22]:1.0 | [46]:1.0 | [61]:1.0 | [13]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:1.0 | [7]:1.0 | [28]:1.0 | [32]:2.0 | [44]:1.0 | [26]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[13]:1.0 | [16]:1.0 | [28]:1.0 | [30]:1.0 | [56]:1.0 | [37]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E16 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[5]:1.0 | [18]:1.0 | [21]:1.0 | [25]:1.0 | [57]:3.0 | [13]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[2]:1.0 | [17]:1.0 | [23]:2.0 | [40]:1.0 | [44]:1.0 | [27]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[4]:3.0 | [12]:1.0 | [23]:1.0 | [37]:2.0 | [45]:2.0 | [5]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 4, 12, 23, 37, 45,  5]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 49: 5.000(2990)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 55: 3.000(3011)[0m | [32mExpert 59: 3.000(3023)[0m | [32mExpert 19: 2.000(2891)[0m | [32mExpert 50: 2.000(2996)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 31: 1.000(2933)[0m | 
[32mExpert 47: 1.000(2984)[0m | [32mExpert 52: 1.000(3002)[0m | [32mExpert 58: 1.000(3020)[0m | [32mExpert 63: 1.000(3038)[0m | 
[33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | 
[33mExpert  5: 0.000(2993)[0m | [33mExpert  7: 0.000(3041)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 11: 0.000(2867)[0m | 
[33mExpert 12: 0.000(2870)[0m | [33mExpert 13: 0.000(2873)[0m | [33mExpert 14: 0.000(2876)[0m | [33mExpert 17: 0.000(2885)[0m | 
[33mExpert 18: 0.000(2888)[0m | [33mExpert 20: 0.000(2897)[0m | [33mExpert 21: 0.000(2900)[0m | [33mExpert 22: 0.000(2903)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2993, 3041, 3047, 2867, 2870, 2873, 2876, 2885, 2888, 2897, 2900, 2903]
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2873[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2903[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  7,  9, 11, 12, 13, 14, 17, 18, 20, 21, 22 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:2.0 | [14]:1.0 | [22]:1.0 | [45]:1.0 | [47]:2.0 | [36]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[6]:1.0 | [7]:2.0 | [13]:1.0 | [32]:1.0 | [49]:2.0 | [23]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[7]:1.0 | [10]:2.0 | [17]:1.0 | [26]:1.0 | [58]:2.0 | [40]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E7 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[8]:2.0 | [21]:2.0 | [37]:1.0 | [40]:1.0 | [60]:1.0 | [33]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[3]:2.0 | [5]:2.0 | [13]:1.0 | [17]:1.0 | EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4085
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
[35]:1.0 | [23]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[4]:2.0 | [13]:2.0 | [22]:2.0 | [36]:1.0 | [52]:2.0 | [28]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 4, 13, 22, 36, 52, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 14: 4.000(4094)[0m | [32mExpert 17: 4.000(4103)[0m | [32mExpert 27: 3.000(4136)[0m | [32mExpert 35: 3.000(4163)[0m | 
[32mExpert 54: 3.000(4226)[0m | [32mExpert 30: 2.000(4148)[0m | [32mExpert 48: 2.000(4205)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  2: 1.000(4112)[0m | [32mExpert  9: 1.000(4265)[0m | 
[32mExpert 13: 1.000(4091)[0m | [32mExpert 21: 1.000(4118)[0m | [32mExpert 37: 1.000(4169)[0m | [32mExpert 43: 1.000(4190)[0m | 
[32mExpert 46: 1.000(4199)[0m | [32mExpert 51: 1.000(4217)[0m | [32mExpert 61: 1.000(4250)[0m | [32mExpert 63: 1.000(4256)[0m | 
[33mExpert  1: 0.000(4079)[0m | [33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | 
[33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | [33mExpert  8: 0.000(4262)[0m | [33mExpert 10: 0.000(4082)[0m | 
[33mExpert 11: 0.000(4085)[0m | [33mExpert 12: 0.000(4088)[0m | [33mExpert 15: 0.000(4097)[0m | [33mExpert 16: 0.000(4100)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4079, 4145, 4178, 4211, 4244, 4259, 4262, 4082, 4085, 4088, 4097, 4100]
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4085[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  3,  4,  5,  6,  7,  8, 10, 11, 12, 15, 16 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[3]:2.0 | [31]:2.0 | [35]:2.0 | [42]:1.0 | [58]:1.0 | [22]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[6]:2.0 | [29]:2.0 | [38]:1.0 | [41]:1.0 | [53]:2.0 | [60]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[2]:2.0 | [17]:5.0 | [30]:3.0 | [43]:2.0 | [46]:2.0 | [19]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[2]:2.0 | [4]:2.0 | [6]:1.0 | [33]:3.0 | [44]:2.0 | [42]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:1.0 | [20]:1.0 | [56]:1.0 | [59]:1.0 | [60]:1.0 | [35]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[8]:1.0 | [10]:5.0 | [33]:2.0 | [39]:1.0 | [52]:4.0 | [53]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 8, 10, 33, 39, 52, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[25]:2.0 | [38]:1.0 | [54]:4.0 | [58]:1.0 | [62]:2.0 | [16]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[8]:2.0 | [20]:2.0 | [41]:1.0 | [45]:1.0 | [49]:2.0 | [59]:2.0 | 
---------------------------------------
return iEAM
3å°EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2788
[1m[33mEnqueueTask: [0m[32mTask: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2803
[1m[33mEnqueueTask: [0m[32mTask: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2927
[1m[33mEnqueueTask: [0m[32mTask: node: ID[916,30000001f] (16MB) STATE(0) TENSOR[2926,2927,2925,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2960
[1m[33mEnqueueTask: [0m[32mTask: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2873
[1m[33mEnqueueTask: [0m[32mTask: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[916,30000001f] (16MB) STATE(0) TENSOR[2926,2927,2925,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[926,d0000001f] (16MB) STATE(0) TENSOR[2872,2873,2871,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:1.0 | [15]:1.0 | [17]:2.0 | [19]:1.0 | [33]:1.0 | [18]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[1]:1.0 | [17]:1.0 | [29]:2.0 | [38]:5.0 | [45]:1.0 | [58]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[6]:1.0 | [10]:2.0 | [12]:1.0 | [26]:1.0 | [42]:5.0 | [33]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[0]:1.0 | [4]:1.0 | [11]:1.0 | [32]:1.0 | [47]:2.0 | [10]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[16]:1.0 | [34]:1.0 | [40]:3.0 | [59]:2.0 | [61]:1.0 | [29]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[26]:3.0 | [28]:2.0 | [36]:1.0 | [38]:1.0 | [51]:2.0 | [21]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[26, 28, 36, 38, 51, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.000(2743)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 17: 4.000(2647)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 16: 1.000(2644)[0m | [32mExpert 28: 1.000(2683)[0m | [32mExpert 30: 1.000(2692)[0m | 
[32mExpert 33: 1.000(2701)[0m | [32mExpert 37: 1.000(2713)[0m | [32mExpert 42: 1.000(2731)[0m | [32mExpert 56: 1.000(2776)[0m | 
[32mExpert 61: 1.000(2794)[0m | [33mExpert  3: 0.000(2689)[0m | [33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | 
[33mExpert  6: 0.000(2788)[0m | [33mExpert  7: 0.000(2803)[0m | [33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | 
[33mExpert 10: 0.000(2626)[0m | [33mExpert 11: 0.000(2629)[0m | [33mExpert 12: 0.000(2632)[0m | [33mExpert 14: 0.000(2638)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2794, 2689, 2722, 2755, 2788, 2803, 2806, 2809, 2626, 2629, 2632, 2638]
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2788[0m â†’ GPU 0
Prefetching [1;36mTensor 2803[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 14, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[2]:1.0 | [5]:2.0 | [14]:2.0 | [49]:1.0 | [61]:2.0 | [31]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:2.0 | [7]:2.0 | [22]:1.0 | [24]:1.0 | [44]:2.0 | [32]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[16]:2.0 | [27]:1.0 | [34]:1.0 | [37]:2.0 | [56]:2.0 | [60]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[7]:1.0 | [18]:2.0 | [21]:2.0 | [31]:1.0 | [57]:4.0 | [61]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[2]:2.0 | [14]:1.0 | [23]:3.0 | [29]:1.0 | [44]:2.0 | [40]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[5]:2.0 | [6]:1.0 | [23]:2.0 | [40]:1.0 | [45]:3.0 | [49]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 5,  6, 23, 40, 45, 49]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 49: 5.000(2990)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 55: 3.000(3011)[0m | [32mExpert 59: 3.000(3023)[0m | [32mExpert 10: 2.000(2864)[0m | [32mExpert 19: 2.000(2891)[0m | 
[32mExpert 50: 2.000(2996)[0m | [32mExpert 58: 2.000(3020)[0m | [32mExpert  6: 1.000(3026)[0m | [32mExpert  7: 1.000(3041)[0m | 
[32mExpert  8: 1.000(3044)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 26: 1.000(2915)[0m | [32mExpert 31: 1.000(2933)[0m | 
[32mExpert 40: 1.000(2963)[0m | [32mExpert 47: 1.000(2984)[0m | [32mExpert 52: 1.000(3002)[0m | [32mExpert 63: 1.000(3038)[0m | 
[33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | 
[33mExpert  5: 0.000(2993)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 11: 0.000(2867)[0m | [33mExpert 12: 0.000(2870)[0m | 
[33mExpert 13: 0.000(2873)[0m | [33mExpert 14: 0.000(2876)[0m | [33mExpert 18: 0.000(2888)[0m | [33mExpert 20: 0.000(2897)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2861, 2894, 2927, 2960, 2993, 3047, 2867, 2870, 2873, 2876, 2888, 2897]
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2927[0m â†’ GPU 0
Prefetching [1;36mTensor 2960[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2873[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  2,  3,  4,  5,  9, 11, 12, 13, 14, 18, 20 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:3.0 | [22]:2.0 | [35]:1.0 | [48]:1.0 | [61]:1.0 | [36]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[6]:2.0 | [18]:1.0 | [31]:1.0 | [47]:1.0 | [49]:3.0 | [32]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[17]:2.0 | [25]:1.0 | [52]:2.0 | [56]:1.0 | [61]:1.0 | [43]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[5]:2.0 | [6]:1.0 | [9]:2.0 | [19]:1.0 | [37]:2.0 | [33]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[10]:1.0 | [27]:1.0 | [29]:1.0 | [38]:1.0 | [48]:1.0 | [35]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[4]:3.0 | [12]:1.0 | [32]:1.0 | [39]:1.0 | [50]:1.0 | [2]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 4, 12, 32, 39, 50,  2]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 5.000(4103)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 27: 3.000(4136)[0m | [32mExpert 30: 3.000(4148)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert  2: 2.000(4112)[0m | [32mExpert 43: 2.000(4190)[0m | 
[32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert 62: 2.000(4253)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 13: 1.000(4091)[0m | EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4085
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
[32mExpert 19: 1.000(4109)[0m | 
[32mExpert 21: 1.000(4118)[0m | [32mExpert 37: 1.000(4169)[0m | [32mExpert 51: 1.000(4217)[0m | [32mExpert 61: 1.000(4250)[0m | 
[32mExpert 63: 1.000(4256)[0m | [33mExpert  1: 0.000(4079)[0m | [33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | 
[33mExpert  5: 0.000(4211)[0m | [33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | [33mExpert  8: 0.000(4262)[0m | 
[33mExpert 10: 0.000(4082)[0m | [33mExpert 11: 0.000(4085)[0m | [33mExpert 12: 0.000(4088)[0m | [33mExpert 15: 0.000(4097)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4256, 4079, 4145, 4178, 4211, 4244, 4259, 4262, 4082, 4085, 4088, 4097]
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4085[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  3,  4,  5,  6,  7,  8, 10, 11, 12, 15, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:1.0 | [7]:1.0 | [16]:1.0 | [22]:2.0 | [49]:1.0 | [55]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[6]:3.0 | [29]:3.0 | [30]:1.0 | [36]:1.0 | [46]:2.0 | [10]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[1]:1.0 | [17]:6.0 | [30]:4.0 | [57]:1.0 | [61]:2.0 | [10]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[2]:3.0 | [6]:2.0 | [10]:1.0 | [33]:4.0 | [42]:2.0 | [0]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:2.0 | [3]:2.0 | [14]:2.0 | [45]:3.0 | [56]:2.0 | [48]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[6]:1.0 | [8]:2.0 | [10]:6.0 | [52]:5.0 | [53]:2.0 | [34]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 6,  8, 10, 52, 53, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[16]:2.0 | [48]:2.0 | [50]:1.0 | [52]:1.0 | [63]:5.0 | [34]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[11]:1.0 | [28]:1.0 | [41]:2.0 | [57]:2.0 | [63]:2.0 | [32]:2.0 | 
---------------------------------------
return iEAM
æœºå™¨EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2788
[1m[33mEnqueueTask: [0m[32mTask: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2803
[1m[33mEnqueueTask: [0m[32mTask: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2927
[1m[33mEnqueueTask: [0m[32mTask: node: ID[916,30000001f] (16MB) STATE(0) TENSOR[2926,2927,2925,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2960
[1m[33mEnqueueTask: [0m[32mTask: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[916,30000001f] (16MB) STATE(0) TENSOR[2926,2927,2925,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:2.0 | [17]:3.0 | [30]:1.0 | [39]:1.0 | [59]:2.0 | [33]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[2]:2.0 | [20]:1.0 | [27]:3.0 | [36]:1.0 | [45]:2.0 | [43]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[21]:3.0 | [29]:1.0 | [32]:1.0 | [36]:1.0 | [43]:1.0 | [20]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[0]:2.0 | [28]:1.0 | [32]:2.0 | [48]:1.0 | [62]:1.0 | [36]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[2]:1.0 | [34]:2.0 | [40]:4.0 | [59]:3.0 | [61]:2.0 | [13]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[3]:1.0 | [28]:3.0 | [29]:1.0 | [30]:1.0 | [38]:2.0 | [57]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 3, 28, 29, 30, 38, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.000(2743)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 17: 4.000(2647)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 16: 2.000(2644)[0m | [32mExpert 19: 2.000(2653)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | 
[32mExpert 56: 2.000(2776)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert 13: 1.000(2635)[0m | 
[32mExpert 27: 1.000(2680)[0m | [32mExpert 28: 1.000(2683)[0m | [32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | 
[32mExpert 34: 1.000(2704)[0m | [32mExpert 42: 1.000(2731)[0m | [32mExpert 60: 1.000(2791)[0m | [32mExpert 61: 1.000(2794)[0m | 
[33mExpert  3: 0.000(2689)[0m | [33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | [33mExpert  6: 0.000(2788)[0m | 
[33mExpert  7: 0.000(2803)[0m | [33mExpert  8: 0.000(2806)[0m | [33mExpert  9: 0.000(2809)[0m | [33mExpert 10: 0.000(2626)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2731, 2791, 2794, 2689, 2722, 2755, 2788, 2803, 2806, 2809, 2626]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2788[0m â†’ GPU 0
Prefetching [1;36mTensor 2803[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4,  5,  6,  7,  8,  9, 10, 34, 42, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[7]:1.0 | [11]:1.0 | [31]:2.0 | [49]:2.0 | [53]:1.0 | [2]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:3.0 | [22]:2.0 | [24]:2.0 | [44]:3.0 | [51]:1.0 | [26]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[11]:1.0 | [27]:2.0 | [51]:1.0 | [56]:3.0 | [60]:2.0 | [63]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E60 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:1.0 | [14]:1.0 | [21]:3.0 | [35]:1.0 | [49]:1.0 | [34]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[13]:1.0 | [14]:2.0 | [29]:2.0 | [30]:2.0 | [33]:1.0 | [3]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[5]:3.0 | [6]:2.0 | [22]:1.0 | [45]:4.0 | [63]:1.0 | [52]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 5,  6, 22, 45, 63, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 49: 5.000(2990)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 55: 3.000(3011)[0m | [32mExpert 59: 3.000(3023)[0m | [32mExpert 10: 2.000(2864)[0m | [32mExpert 17: 2.000(2885)[0m | 
[32mExpert 19: 2.000(2891)[0m | [32mExpert 50: 2.000(2996)[0m | [32mExpert 52: 2.000(3002)[0m | [32mExpert 58: 2.000(3020)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  7: 1.000(3041)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 25: 1.000(2912)[0m | 
[32mExpert 26: 1.000(2915)[0m | [32mExpert 31: 1.000(2933)[0m | [32mExpert 40: 1.000(2963)[0m | [32mExpert 43: 1.000(2972)[0m | 
[32mExpert 47: 1.000(2984)[0m | [32mExpert 56: 1.000(3014)[0m | [32mExpert 61: 1.000(3032)[0m | [32mExpert 63: 1.000(3038)[0m | 
[33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | 
[33mExpert  5: 0.000(2993)[0m | [33mExpert  9: 0.000(3047)[0m | [33mExpert 11: 0.000(2867)[0m | [33mExpert 12: 0.000(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2984, 3014, 3032, 3038, 2861, 2894, 2927, 2960, 2993, 3047, 2867, 2870]
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2927[0m â†’ GPU 0
Prefetching [1;36mTensor 2960[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  2,  3,  4,  5,  9, 11, 12, 47, 56, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[12]:2.0 | [24]:1.0 | [36]:3.0 | [61]:2.0 | [63]:1.0 | [26]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[31]:2.0 | [37]:1.0 | [42]:1.0 | [55]:1.0 | [59]:1.0 | [56]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[12]:1.0 | [19]:3.0 | [25]:2.0 | [43]:2.0 | [62]:1.0 | [49]:6.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:3.0 | [6]:2.0 | [19]:2.0 | [25]:1.0 | [45]:1.0 | [30]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[5]:3.0 | [27]:2.0 | [48]:2.0 | [50]:1.0 | [58]:1.0 | [45]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[8]:3.0 | [11]:1.0 | [14]:1.0 | [49]:1.0 | [60]:1.0 | [4]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 8, 11, 14, 49, 60,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 6.000(4103)[0m | EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4085
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1314,b0000002b] (16MB) STATE(0) TENSOR[4084,4085,4083,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
[32mExpert 14: 4.000(4094)[0m | [32mExpert 30: 4.000(4148)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert  2: 2.000(4112)[0m | [32mExpert 43: 2.000(4190)[0m | 
[32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert 61: 2.000(4250)[0m | 
[32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  1: 1.000(4079)[0m | [32mExpert  9: 1.000(4265)[0m | 
[32mExpert 10: 1.000(4082)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 19: 1.000(4109)[0m | [32mExpert 21: 1.000(4118)[0m | 
[32mExpert 37: 1.000(4169)[0m | [32mExpert 51: 1.000(4217)[0m | [32mExpert 57: 1.000(4235)[0m | [32mExpert 63: 1.000(4256)[0m | 
[33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | [33mExpert  6: 0.000(4244)[0m | 
[33mExpert  7: 0.000(4259)[0m | [33mExpert  8: 0.000(4262)[0m | [33mExpert 11: 0.000(4085)[0m | [33mExpert 12: 0.000(4088)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4169, 4217, 4235, 4256, 4145, 4178, 4211, 4244, 4259, 4262, 4085, 4088]
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4085[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  3,  4,  5,  6,  7,  8, 11, 12, 37, 51, 57, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[23]:1.0 | [29]:2.0 | [44]:1.0 | [49]:2.0 | [59]:1.0 | [34]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[3]:1.0 | [19]:2.0 | [24]:1.0 | [53]:3.0 | [62]:1.0 | [21]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[19]:2.0 | [29]:1.0 | [32]:1.0 | [38]:1.0 | [43]:3.0 | [10]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[20]:1.0 | [26]:4.0 | [39]:6.0 | [42]:3.0 | [46]:2.0 | [33]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[14]:3.0 | [19]:1.0 | [45]:4.0 | [48]:2.0 | [62]:2.0 | [61]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[4]:1.0 | [21]:3.0 | [29]:1.0 | [45]:1.0 | [52]:6.0 | [49]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 4, 21, 29, 45, 52, 49]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[4]:1.0 | [50]:2.0 | [54]:5.0 | [55]:1.0 | [63]:6.0 | [61]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[2]:1.0 | [20]:3.0 | [25]:1.0 | [48]:2.0 | [63]:3.0 | [11]:2.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2788
[1m[33mEnqueueTask: [0m[32mTask: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2803
[1m[33mEnqueueTask: [0m[32mTask: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2927
[1m[33mEnqueueTask: [0m[32mTask: node: ID[916,30000001f] (16MB) STATE(0) TENSOR[2926,2927,2925,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2960
[1m[33mEnqueueTask: [0m[32mTask: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[916,30000001f] (16MB) STATE(0) TENSOR[2926,2927,2925,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[13]:4.0 | [26]:2.0 | [46]:3.0 | [50]:3.0 | [63]:1.0 | [12]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[11]:2.0 | [15]:1.0 | [35]:4.0 | [36]:2.0 | [58]:4.0 | [2]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[17]:3.0 | [27]:2.0 | [38]:2.0 | [51]:1.0 | [62]:2.0 | [29]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[0]:3.0 | [10]:4.0 | [15]:1.0 | [40]:2.0 | [47]:3.0 | [45]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[5]:2.0 | [25]:1.0 | [40]:5.0 | [59]:4.0 | [63]:1.0 | [33]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[6]:4.0 | [27]:2.0 | [45]:1.0 | [51]:3.0 | [59]:1.0 | [42]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 6, 27, 45, 51, 59, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.000(2743)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 17: 4.000(2647)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert 56: 3.000(2776)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 16: 2.000(2644)[0m | 
[32mExpert 19: 2.000(2653)[0m | [32mExpert 27: 2.000(2680)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 37: 2.000(2713)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert  0: 1.000(2620)[0m | 
[32mExpert  2: 1.000(2656)[0m | [32mExpert 11: 1.000(2629)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 28: 1.000(2683)[0m | 
[32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 34: 1.000(2704)[0m | [32mExpert 42: 1.000(2731)[0m | 
[32mExpert 51: 1.000(2761)[0m | [32mExpert 61: 1.000(2794)[0m | [32mExpert 63: 1.000(2800)[0m | [33mExpert  3: 0.000(2689)[0m | 
[33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | [33mExpert  6: 0.000(2788)[0m | [33mExpert  7: 0.000(2803)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2692, 2701, 2704, 2731, 2761, 2794, 2800, 2689, 2722, 2755, 2788, 2803]
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2788[0m â†’ GPU 0
Prefetching [1;36mTensor 2803[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4,  5,  6,  7, 30, 33, 34, 42, 51, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[2]:3.0 | [5]:3.0 | [22]:2.0 | [61]:3.0 | [63]:1.0 | [46]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[7]:3.0 | [26]:4.0 | [28]:2.0 | [32]:4.0 | [47]:1.0 | [52]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[16]:3.0 | [28]:2.0 | [56]:4.0 | [57]:1.0 | [59]:1.0 | [34]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[5]:2.0 | [21]:4.0 | [25]:2.0 | [42]:1.0 | [57]:5.0 | [13]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[17]:2.0 | [23]:4.0 | [40]:3.0 | [41]:1.0 | [44]:3.0 | [10]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[3]:2.0 | [4]:4.0 | [5]:4.0 | [37]:3.0 | [45]:5.0 | [23]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 3,  4,  5, 37, 45, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 6.000(2990)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 19: 3.000(2891)[0m | [32mExpert 55: 3.000(3011)[0m | [32mExpert 59: 3.000(3023)[0m | [32mExpert 10: 2.000(2864)[0m | 
[32mExpert 17: 2.000(2885)[0m | [32mExpert 25: 2.000(2912)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 50: 2.000(2996)[0m | 
[32mExpert 52: 2.000(3002)[0m | [32mExpert 58: 2.000(3020)[0m | [32mExpert  6: 1.000(3026)[0m | [32mExpert  7: 1.000(3041)[0m | 
[32mExpert  8: 1.000(3044)[0m | [32mExpert 12: 1.000(2870)[0m | [32mExpert 26: 1.000(2915)[0m | [32mExpert 31: 1.000(2933)[0m | 
[32mExpert 40: 1.000(2963)[0m | [32mExpert 47: 1.000(2984)[0m | [32mExpert 56: 1.000(3014)[0m | [32mExpert 61: 1.000(3032)[0m | 
[32mExpert 62: 1.000(3035)[0m | [32mExpert 63: 1.000(3038)[0m | [33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | 
[33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | [33mExpert  5: 0.000(2993)[0m | [33mExpert  9: 0.000(3047)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2963, 2984, 3014, 3032, 3035, 3038, 2861, 2894, 2927, 2960, 2993, 3047]
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2927[0m â†’ GPU 0
Prefetching [1;36mTensor 2960[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  2,  3,  4,  5,  9, 40, 47, 56, 61, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:4.0 | [10]:1.0 | [24]:2.0 | [47]:3.0 | [58]:2.0 | [54]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[7]:3.0 | [13]:2.0 | [23]:2.0 | [49]:4.0 | [51]:1.0 | [27]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[10]:3.0 | [37]:1.0 | [40]:2.0 | [53]:1.0 | [58]:3.0 | [26]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E40 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:4.0 | [8]:3.0 | [21]:3.0 | [30]:2.0 | [49]:1.0 | [37]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[3]:3.0 | [5]:4.0 | [13]:2.0 | [23]:2.0 | [35]:3.0 | [45]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[2]:2.0 | [13]:3.0 | [22]:3.0 | [24]:1.0 | [52]:3.0 | [36]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 2, 13, 22, 24, 52, 36]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 6.000(4103)[0m | EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
[32mExpert 14: 4.000(4094)[0m | [32mExpert 30: 4.000(4148)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 43: 3.000(4190)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert  2: 2.000(4112)[0m | 
[32mExpert 10: 2.000(4082)[0m | [32mExpert 19: 2.000(4109)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 55: 2.000(4229)[0m | [32mExpert 61: 2.000(4250)[0m | [32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | 
[32mExpert  1: 1.000(4079)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 21: 1.000(4118)[0m | 
[32mExpert 29: 1.000(4142)[0m | [32mExpert 32: 1.000(4154)[0m | [32mExpert 37: 1.000(4169)[0m | [32mExpert 38: 1.000(4172)[0m | 
[32mExpert 51: 1.000(4217)[0m | [32mExpert 57: 1.000(4235)[0m | [32mExpert 63: 1.000(4256)[0m | [33mExpert  3: 0.000(4145)[0m | 
[33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | [33mExpert  6: 0.000(4244)[0m | [33mExpert  7: 0.000(4259)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4142, 4154, 4169, 4172, 4217, 4235, 4256, 4145, 4178, 4211, 4244, 4259]
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  3,  4,  5,  6,  7, 29, 32, 37, 38, 51, 57, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[3]:3.0 | [29]:3.0 | [31]:3.0 | [44]:2.0 | [53]:4.0 | [42]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[6]:4.0 | [41]:2.0 | [43]:4.0 | [53]:4.0 | [60]:3.0 | [38]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[2]:3.0 | [10]:3.0 | [19]:3.0 | [30]:5.0 | [43]:4.0 | [50]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[2]:4.0 | [4]:3.0 | [5]:2.0 | [33]:6.0 | [44]:3.0 | [3]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:3.0 | [8]:1.0 | [19]:2.0 | [35]:3.0 | [62]:3.0 | [27]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[8]:3.0 | [10]:7.0 | [33]:3.0 | [52]:7.0 | [56]:1.0 | [53]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 8, 10, 33, 52, 56, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:2.0 | [25]:3.0 | [38]:2.0 | [54]:6.0 | [62]:3.0 | [41]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[8]:3.0 | [20]:4.0 | [41]:3.0 | [45]:2.0 | [49]:3.0 | [11]:3.0 | 
---------------------------------------
return iEAM
5å°æ—¶EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2927
[1m[33mEnqueueTask: [0m[32mTask: node: ID[916,30000001f] (16MB) STATE(0) TENSOR[2926,2927,2925,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2960
[1m[33mEnqueueTask: [0m[32mTask: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[916,30000001f] (16MB) STATE(0) TENSOR[2926,2927,2925,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[15]:2.0 | [18]:2.0 | [19]:2.0 | [33]:3.0 | [59]:3.0 | [39]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[1]:2.0 | [25]:1.0 | [29]:3.0 | [38]:6.0 | [58]:5.0 | [2]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[8]:1.0 | [12]:2.0 | [26]:2.0 | [27]:3.0 | [38]:3.0 | [10]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[0]:4.0 | [5]:1.0 | [19]:1.0 | [40]:3.0 | [58]:1.0 | [55]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[4]:1.0 | [14]:2.0 | [26]:1.0 | [40]:6.0 | [59]:5.0 | [33]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[25]:1.0 | [28]:4.0 | [51]:4.0 | [57]:2.0 | [59]:2.0 | [31]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[25, 28, 51, 57, 59, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.000(2743)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 17: 4.000(2647)[0m | [32mExpert 56: 4.000(2776)[0m | 
[32mExpert 16: 3.000(2644)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert  1: 2.000(2623)[0m | 
[32mExpert 19: 2.000(2653)[0m | [32mExpert 27: 2.000(2680)[0m | [32mExpert 28: 2.000(2683)[0m | [32mExpert 34: 2.000(2704)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | 
[32mExpert 60: 2.000(2791)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert 11: 1.000(2629)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 42: 1.000(2731)[0m | 
[32mExpert 51: 1.000(2761)[0m | [32mExpert 57: 1.000(2779)[0m | [32mExpert 59: 1.000(2785)[0m | [32mExpert 61: 1.000(2794)[0m | 
[32mExpert 63: 1.000(2800)[0m | [33mExpert  3: 0.000(2689)[0m | [33mExpert  4: 0.000(2722)[0m | [33mExpert  5: 0.000(2755)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2635, 2692, 2701, 2731, 2761, 2779, 2785, 2794, 2800, 2689, 2722, 2755]
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4,  5, 13, 30, 33, 42, 51, 57, 59, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:4.0 | [22]:3.0 | [60]:2.0 | [61]:4.0 | [63]:2.0 | [2]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:4.0 | [7]:4.0 | [28]:3.0 | [32]:5.0 | [44]:4.0 | [37]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[5]:1.0 | [11]:2.0 | [28]:3.0 | [34]:3.0 | [56]:5.0 | [57]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E57 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[5]:3.0 | [21]:5.0 | [43]:1.0 | [45]:1.0 | [57]:6.0 | [33]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[14]:3.0 | [23]:5.0 | [33]:2.0 | [41]:2.0 | [44]:4.0 | [58]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[3]:3.0 | [6]:3.0 | [16]:1.0 | [22]:2.0 | [32]:1.0 | [45]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 3,  6, 16, 22, 32, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 6.000(2990)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 10: 3.000(2864)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 55: 3.000(3011)[0m | [32mExpert 58: 3.000(3020)[0m | 
[32mExpert 59: 3.000(3023)[0m | [32mExpert 17: 2.000(2885)[0m | [32mExpert 25: 2.000(2912)[0m | [32mExpert 26: 2.000(2915)[0m | 
[32mExpert 40: 2.000(2963)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 50: 2.000(2996)[0m | [32mExpert 52: 2.000(3002)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  7: 1.000(3041)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 12: 1.000(2870)[0m | 
[32mExpert 31: 1.000(2933)[0m | [32mExpert 37: 1.000(2951)[0m | [32mExpert 47: 1.000(2984)[0m | [32mExpert 53: 1.000(3005)[0m | 
[32mExpert 56: 1.000(3014)[0m | [32mExpert 61: 1.000(3032)[0m | [32mExpert 62: 1.000(3035)[0m | [32mExpert 63: 1.000(3038)[0m | 
[33mExpert  1: 0.000(2861)[0m | [33mExpert  2: 0.000(2894)[0m | [33mExpert  3: 0.000(2927)[0m | [33mExpert  4: 0.000(2960)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2933, 2951, 2984, 3005, 3014, 3032, 3035, 3038, 2861, 2894, 2927, 2960]
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2927[0m â†’ GPU 0
Prefetching [1;36mTensor 2960[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  2,  3,  4, 31, 37, 47, 53, 56, 61, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:5.0 | [30]:4.0 | [47]:4.0 | [59]:1.0 | [61]:3.0 | [39]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[41]:1.0 | [49]:5.0 | [51]:2.0 | [52]:1.0 | [59]:2.0 | [16]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[35]:1.0 | [37]:2.0 | [39]:1.0 | [48]:1.0 | [62]:2.0 | [27]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[2]:1.0 | [19]:3.0 | [21]:4.0 | [30]:3.0 | [45]:2.0 | [5]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[5]:5.0 | [9]:1.0 | [13]:3.0 | [23]:3.0EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
 | [48]:3.0 | [0]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[2]:3.0 | [4]:5.0 | [14]:2.0 | [41]:1.0 | [50]:2.0 | [58]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 2,  4, 14, 41, 50, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 6.000(4103)[0m | [32mExpert 30: 5.000(4148)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 43: 4.000(4190)[0m | 
[32mExpert  2: 3.000(4112)[0m | [32mExpert 10: 3.000(4082)[0m | [32mExpert 19: 3.000(4109)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 55: 2.000(4229)[0m | [32mExpert 61: 2.000(4250)[0m | [32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | 
[32mExpert  1: 1.000(4079)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 21: 1.000(4118)[0m | 
[32mExpert 29: 1.000(4142)[0m | [32mExpert 32: 1.000(4154)[0m | [32mExpert 37: 1.000(4169)[0m | [32mExpert 38: 1.000(4172)[0m | 
[32mExpert 50: 1.000(4214)[0m | [32mExpert 51: 1.000(4217)[0m | [32mExpert 57: 1.000(4235)[0m | [32mExpert 63: 1.000(4256)[0m | 
[33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | [33mExpert  6: 0.000(4244)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4142, 4154, 4169, 4172, 4214, 4217, 4235, 4256, 4145, 4178, 4211, 4244]
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  3,  4,  5,  6, 29, 32, 37, 38, 50, 51, 57, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[12]:1.0 | [22]:3.0 | [44]:3.0 | [46]:1.0 | [52]:2.0 | [23]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[3]:2.0 | [29]:4.0 | [34]:1.0 | [41]:3.0 | [53]:5.0 | [36]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[10]:4.0 | [17]:7.0 | [30]:6.0 | [50]:2.0 | [56]:1.0 | [9]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[2]:5.0 | [3]:3.0 | [5]:3.0 | [26]:5.0 | [33]:7.0 | [15]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[19]:3.0 | [27]:2.0 | [45]:5.0 | [59]:2.0 | [62]:4.0 | [14]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[4]:2.0 | [21]:4.0 | [29]:2.0 | [34]:3.0 | [57]:3.0 | [32]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 4, 21, 29, 34, 57, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:3.0 | [14]:1.0 | [29]:2.0 | [41]:2.0 | [55]:2.0 | [54]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[2]:2.0 | [25]:2.0 | [27]:2.0 | [43]:1.0 | [52]:1.0 | [32]:3.0 | 
---------------------------------------
return iEAM
ç”Ÿäº§EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2945
[1m[33mEnqueueTask: [0m[32mTask: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[10]:1.0 | [21]:1.0 | [33]:4.0 | [40]:2.0 | [59]:4.0 | [17]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[9]:1.0 | [16]:2.0 | [25]:2.0 | [39]:1.0 | [55]:1.0 | [28]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[26]:3.0 | [34]:1.0 | [50]:2.0 | [59]:1.0 | [61]:1.0 | [25]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[20]:1.0 | [31]:1.0 | [43]:1.0 | [50]:1.0 | [61]:1.0 | [58]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[4]:2.0 | [7]:1.0 | [14]:3.0 | [22]:1.0 | [59]:6.0 | [33]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[7]:1.0 | [14]:1.0 | [30]:2.0 | [44]:1.0 | [61]:1.0 | [38]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 7, 14, 30, 44, 61, 38]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.000(2743)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 56: 5.000(2776)[0m | [32mExpert 17: 4.000(2647)[0m | 
[32mExpert 16: 3.000(2644)[0m | [32mExpert 28: 3.000(2683)[0m | [32mExpert 34: 3.000(2704)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 11: 2.000(2629)[0m | [32mExpert 19: 2.000(2653)[0m | 
[32mExpert 27: 2.000(2680)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 38: 2.000(2716)[0m | 
[32mExpert 48: 2.000(2749)[0m | [32mExpert 57: 2.000(2779)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert  0: 1.000(2620)[0m | 
[32mExpert  2: 1.000(2656)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 30: 1.000(2692)[0m | 
[32mExpert 33: 1.000(2701)[0m | [32mExpert 42: 1.000(2731)[0m | [32mExpert 51: 1.000(2761)[0m | [32mExpert 59: 1.000(2785)[0m | 
[32mExpert 61: 1.000(2794)[0m | [32mExpert 63: 1.000(2800)[0m | [33mExpert  3: 0.000(2689)[0m | [33mExpert  4: 0.000(2722)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2656, 2755, 2635, 2692, 2701, 2731, 2761, 2785, 2794, 2800, 2689, 2722]
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  3,  4,  5, 13, 30, 33, 42, 51, 59, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:1.0 | [1]:1.0 | [2]:5.0 | [35]:1.0 | [53]:2.0 | [48]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:5.0 | [7]:5.0 | [24]:3.0 | [29]:1.0 | [37]:2.0 | [26]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[11]:3.0 | [27]:3.0 | [36]:1.0 | [51]:2.0 | [56]:6.0 | [57]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[21]:6.0 | [35]:2.0 | [49]:2.0 | [52]:1.0 | [56]:1.0 | [8]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[14]:4.0 | [15]:1.0 | [21]:1.0 | [29]:3.0 | [41]:3.0 | [30]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[0]:1.0 | [1]:1.0 | [6]:4.0 | [16]:2.0 | [44]:1.0 | [45]:7.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 0,  1,  6, 16, 44, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 6.000(2990)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 10: 3.000(2864)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 55: 3.000(3011)[0m | [32mExpert 58: 3.000(3020)[0m | 
[32mExpert 59: 3.000(3023)[0m | [32mExpert 17: 2.000(2885)[0m | [32mExpert 25: 2.000(2912)[0m | [32mExpert 26: 2.000(2915)[0m | 
[32mExpert 37: 2.000(2951)[0m | [32mExpert 40: 2.000(2963)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 50: 2.000(2996)[0m | 
[32mExpert 52: 2.000(3002)[0m | [32mExpert 62: 2.000(3035)[0m | [32mExpert  6: 1.000(3026)[0m | [32mExpert  7: 1.000(3041)[0m | 
[32mExpert  8: 1.000(3044)[0m | [32mExpert 12: 1.000(2870)[0m | [32mExpert 27: 1.000(2918)[0m | [32mExpert 31: 1.000(2933)[0m | 
[32mExpert 35: 1.000(2945)[0m | [32mExpert 39: 1.000(2957)[0m | [32mExpert 47: 1.000(2984)[0m | [32mExpert 48: 1.000(2987)[0m | 
[32mExpert 53: 1.000(3005)[0m | [32mExpert 56: 1.000(3014)[0m | [32mExpert 61: 1.000(3032)[0m | [32mExpert 63: 1.000(3038)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3044, 2870, 2918, 2933, 2945, 2957, 2984, 2987, 3005, 3014, 3032, 3038]
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2945[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8, 12, 27, 31, 35, 39, 47, 48, 53, 56, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[13]:1.0 | [22]:3.0 | [38]:1.0 | [39]:3.0 | [47]:5.0 | [4]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[16]:2.0 | [35]:1.0 | [38]:1.0 | [45]:1.0 | [54]:1.0 | [24]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[14]:1.0 | [19]:4.0 | [37]:3.0 | [40]:3.0 | [53]:2.0 | [47]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:6.0 | [13]:1.0 | [23]:1.0 | [37]:4.0 | [47]:1.0 | [36]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[11]:1.0 | [21]:1.0 | [39]:1.0 | [50]:2.0 | [54]:1.0 | [38]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[5]:1.0 | [32]:2.0 | [33]:1.0 | [47]:1.0 | [50]:3.0 | [7]:1.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 4118
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1324,150000002b] (16MB) STATE(0) TENSOR[4117,4118,4116,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Begin prefetch18 topk= tensor([[ 5, 32, 33, 47, 50,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 7.000(4103)[0m | [32mExpert 30: 6.000(4148)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert 14: 4.000(4094)[0m | 
[32mExpert 43: 4.000(4190)[0m | [32mExpert  2: 3.000(4112)[0m | [32mExpert 19: 3.000(4109)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 46: 2.000(4199)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert 61: 2.000(4250)[0m | 
[32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  1: 1.000(4079)[0m | [32mExpert 13: 1.000(4091)[0m | 
[32mExpert 21: 1.000(4118)[0m | [32mExpert 29: 1.000(4142)[0m | [32mExpert 32: 1.000(4154)[0m | [32mExpert 37: 1.000(4169)[0m | 
[32mExpert 38: 1.000(4172)[0m | [32mExpert 51: 1.000(4217)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 57: 1.000(4235)[0m | 
[32mExpert 63: 1.000(4256)[0m | [33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | [33mExpert  5: 0.000(4211)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4118, 4142, 4154, 4169, 4172, 4217, 4232, 4235, 4256, 4145, 4178, 4211]
Prefetching [1;36mTensor 4118[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  3,  4,  5, 21, 29, 32, 37, 38, 51, 56, 57, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:1.0 | [18]:1.0 | [27]:1.0 | [58]:2.0 | [59]:2.0 | [31]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[12]:1.0 | [13]:1.0 | [19]:3.0 | [36]:3.0 | [61]:1.0 | [14]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[2]:4.0 | [21]:2.0 | [47]:1.0 | [56]:2.0 | [57]:2.0 | [17]:8.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E56 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E57 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[26]:6.0 | [28]:1.0 | [33]:8.0 | [46]:3.0 | [49]:1.0 | [17]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:4.0 | [3]:3.0 | [14]:5.0 | [45]:6.0 | [47]:4.0 | [21]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[4]:3.0 | [5]:2.0 | [8]:4.0 | [10]:8.0 | [30]:1.0 | [34]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 4,  5,  8, 10, 30, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[5]:1.0 | [14]:2.0 | [38]:3.0 | [41]:3.0 | [63]:7.0 | [22]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[6]:2.0 | [11]:4.0 | [20]:5.0 | [41]:4.0 | [60]:1.0 | [57]:3.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2945
[1m[33mEnqueueTask: [0m[32mTask: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[9]:2.0 | [12]:3.0 | [13]:5.0 | [47]:2.0 | [49]:1.0 | [54]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[3]:2.0 | [17]:2.0 | [22]:2.0 | [54]:1.0 | [58]:6.0 | [36]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[12]:3.0 | [27]:4.0 | [35]:1.0 | [49]:1.0 | [62]:3.0 | [15]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[10]:5.0 | [15]:2.0 | [40]:4.0 | [47]:4.0 | [61]:2.0 | [36]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[14]:4.0 | [25]:2.0 | [29]:3.0 | [59]:7.0 | [63]:2.0 | [4]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[6]:5.0 | [8]:1.0 | [28]:5.0 | [51]:5.0 | [59]:3.0 | [45]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 6,  8, 28, 51, 59, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.000(2743)[0m | [32mExpert 56: 6.000(2776)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 17: 4.000(2647)[0m | 
[32mExpert 11: 3.000(2629)[0m | [32mExpert 16: 3.000(2644)[0m | [32mExpert 27: 3.000(2680)[0m | [32mExpert 28: 3.000(2683)[0m | 
[32mExpert 34: 3.000(2704)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert 57: 3.000(2779)[0m | 
[32mExpert  1: 2.000(2623)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 37: 2.000(2713)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert 51: 2.000(2761)[0m | [32mExpert 60: 2.000(2791)[0m | 
[32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 13: 1.000(2635)[0m | 
[32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 36: 1.000(2710)[0m | [32mExpert 42: 1.000(2731)[0m | 
[32mExpert 59: 1.000(2785)[0m | [32mExpert 61: 1.000(2794)[0m | [32mExpert 63: 1.000(2800)[0m | [33mExpert  3: 0.000(2689)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2620, 2656, 2755, 2635, 2692, 2701, 2710, 2731, 2785, 2794, 2800, 2689]
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3,  5, 13, 30, 33, 36, 42, 59, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:2.0 | [2]:6.0 | [14]:3.0 | [48]:2.0 | [61]:5.0 | [45]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[7]:6.0 | [14]:1.0 | [28]:4.0 | [32]:6.0 | [40]:2.0 | [30]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[3]:1.0 | [16]:4.0 | [24]:1.0 | [56]:7.0 | [57]:4.0 | [17]:5.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E3 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[5]:4.0 | [18]:3.0 | [25]:3.0 | [31]:2.0 | [42]:2.0 | [19]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[23]:6.0 | [40]:4.0 | [41]:4.0 | [44]:5.0 | [59]:1.0 | [31]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[4]:5.0 | [13]:1.0 | [19]:1.0 | [37]:4.0 | [49]:2.0 | [34]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 4, 13, 19, 37, 49, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 6.000(2990)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 19: 4.000(2891)[0m | 
[32mExpert 10: 3.000(2864)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 40: 3.000(2963)[0m | 
[32mExpert 55: 3.000(3011)[0m | [32mExpert 58: 3.000(3020)[0m | [32mExpert 59: 3.000(3023)[0m | [32mExpert 17: 2.000(2885)[0m | 
[32mExpert 25: 2.000(2912)[0m | [32mExpert 26: 2.000(2915)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 47: 2.000(2984)[0m | 
[32mExpert 50: 2.000(2996)[0m | [32mExpert 52: 2.000(3002)[0m | [32mExpert 53: 2.000(3005)[0m | [32mExpert 62: 2.000(3035)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  7: 1.000(3041)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 12: 1.000(2870)[0m | 
[32mExpert 14: 1.000(2876)[0m | [32mExpert 27: 1.000(2918)[0m | [32mExpert 31: 1.000(2933)[0m | [32mExpert 35: 1.000(2945)[0m | 
[32mExpert 39: 1.000(2957)[0m | [32mExpert 48: 1.000(2987)[0m | [32mExpert 56: 1.000(3014)[0m | [32mExpert 61: 1.000(3032)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3026, 3041, 3044, 2870, 2876, 2918, 2933, 2945, 2957, 2987, 3014, 3032]
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2945[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  6,  7,  8, 12, 14, 27, 31, 35, 39, 48, 56, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:6.0 | [20]:1.0 | [28]:1.0 | [52]:1.0 | [56]:1.0 | [54]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[10]:1.0 | [13]:3.0 | [32]:3.0 | [44]:1.0 | [49]:6.0 | [17]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[10]:4.0 | [40]:4.0 | [53]:3.0 | [56]:2.0 | [58]:4.0 | [46]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E56 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[0]:1.0 | [8]:4.0 | [29]:1.0 | [51]:1.0 | [60]:2.0 | [12]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[3]:4.0 | [35]:4.0 | [38]:3.0 | [45]:3.0 | [49]:1.0 | [12]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[13]:4.0 | [22]:4.0 | [23]:2.0 | [32]:3.0 | [37]:2.0 | [38]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[13, 22, 23, 32, 37, 38]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 8.000(4103)[0m | EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
[32mExpert 30: 6.000(4148)[0m | [32mExpert  2: 4.000(4112)[0m | [32mExpert 10: 4.000(4082)[0m | 
[32mExpert 14: 4.000(4094)[0m | [32mExpert 43: 4.000(4190)[0m | [32mExpert 19: 3.000(4109)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 21: 2.000(4118)[0m | 
[32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert 56: 2.000(4232)[0m | [32mExpert 57: 2.000(4235)[0m | [32mExpert 61: 2.000(4250)[0m | [32mExpert 62: 2.000(4253)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  1: 1.000(4079)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 29: 1.000(4142)[0m | 
[32mExpert 32: 1.000(4154)[0m | [32mExpert 37: 1.000(4169)[0m | [32mExpert 38: 1.000(4172)[0m | [32mExpert 47: 1.000(4202)[0m | 
[32mExpert 51: 1.000(4217)[0m | [32mExpert 63: 1.000(4256)[0m | [33mExpert  3: 0.000(4145)[0m | [33mExpert  4: 0.000(4178)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4076, 4079, 4091, 4142, 4154, 4169, 4172, 4202, 4217, 4256, 4145, 4178]
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  3,  4, 13, 29, 32, 37, 38, 47, 51, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[3]:4.0 | [16]:2.0 | [31]:5.0 | [35]:3.0 | [45]:1.0 | [43]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[6]:5.0 | [36]:4.0 | [41]:4.0 | [43]:5.0 | [60]:4.0 | [46]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[2]:5.0 | [10]:5.0 | [19]:4.0 | [43]:5.0 | [61]:3.0 | [58]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[3]:4.0 | [5]:4.0 | [6]:3.0 | [11]:4.0 | [44]:4.0 | [48]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[12]:2.0 | [19]:4.0 | [20]:2.0 | [22]:4.0 | [42]:1.0 | [40]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[17]:1.0 | [19]:2.0 | [33]:4.0 | [34]:5.0 | [50]:4.0 | [45]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[17, 19, 33, 34, 50, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[23]:1.0 | [34]:3.0 | [44]:1.0 | [62]:4.0 | [63]:8.0 | [25]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[26]:3.0 | [29]:2.0 | [59]:3.0 | [62]:2.0 | [63]:4.0 | [34]:5.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2945
[1m[33mEnqueueTask: [0m[32mTask: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2981
[1m[33mEnqueueTask: [0m[32mTask: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[13]:6.0 | [26]:3.0 | [40]:3.0 | [47]:3.0 | [58]:1.0 | [28]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[21]:1.0 | [36]:4.0 | [43]:2.0 | [50]:1.0 | [58]:7.0 | [17]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[12]:4.0 | [17]:4.0 | [27]:5.0 | [38]:4.0 | [62]:4.0 | [35]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[1]:1.0 | [10]:6.0 | [12]:1.0 | [40]:5.0 | [47]:5.0 | [36]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[4]:4.0 | [25]:3.0 | [29]:4.0 | [40]:7.0 | [59]:8.0 | [57]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[27]:3.0 | [42]:2.0 | [45]:3.0 | [51]:6.0 | [59]:4.0 | [6]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[27, 42, 45, 51, 59,  6]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 7.000(2776)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 17: 5.000(2647)[0m | [32mExpert 41: 5.000(2728)[0m | 
[32mExpert 16: 4.000(2644)[0m | [32mExpert 57: 4.000(2779)[0m | [32mExpert 11: 3.000(2629)[0m | [32mExpert 27: 3.000(2680)[0m | 
[32mExpert 28: 3.000(2683)[0m | [32mExpert 34: 3.000(2704)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 53: 3.000(2767)[0m | 
[32mExpert  1: 2.000(2623)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 37: 2.000(2713)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert 51: 2.000(2761)[0m | [32mExpert 60: 2.000(2791)[0m | 
[32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert  3: 1.000(2689)[0m | [32mExpert  5: 1.000(2755)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 24: 1.000(2671)[0m | [32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | 
[32mExpert 36: 1.000(2710)[0m | [32mExpert 42: 1.000(2731)[0m | [32mExpert 59: 1.000(2785)[0m | [32mExpert 61: 1.000(2794)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2620, 2656, 2689, 2755, 2635, 2671, 2692, 2701, 2710, 2731, 2785, 2794]
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3,  5, 13, 24, 30, 33, 36, 42, 59, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:2.0 | [5]:5.0 | [14]:4.0 | [24]:1.0 | [62]:1.0 | [34]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[7]:7.0 | [28]:5.0 | [30]:2.0 | [32]:7.0 | [47]:2.0 | [14]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[3]:2.0 | [16]:5.0 | [24]:2.0 | [56]:8.0 | [59]:2.0 | [57]:5.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E3 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E24 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E59 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[5]:5.0 | [18]:4.0 | [21]:7.0 | [25]:4.0 | [42]:3.0 | [9]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[17]:3.0 | [23]:7.0 | [40]:5.0 | [44]:6.0 | [59]:2.0 | [61]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[19]:2.0 | [27]:1.0 | [37]:5.0 | [51]:1.0 | [55]:1.0 | [26]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[19, 27, 37, 51, 55, 26]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 6.000(2990)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 10: 4.000(2864)[0m | 
[32mExpert 19: 4.000(2891)[0m | [32mExpert 40: 4.000(2963)[0m | [32mExpert 58: 4.000(3020)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 37: 3.000(2951)[0m | [32mExpert 53: 3.000(3005)[0m | [32mExpert 55: 3.000(3011)[0m | [32mExpert 59: 3.000(3023)[0m | 
[32mExpert 17: 2.000(2885)[0m | [32mExpert 25: 2.000(2912)[0m | [32mExpert 26: 2.000(2915)[0m | [32mExpert 43: 2.000(2972)[0m | 
[32mExpert 47: 2.000(2984)[0m | [32mExpert 50: 2.000(2996)[0m | [32mExpert 52: 2.000(3002)[0m | [32mExpert 56: 2.000(3014)[0m | 
[32mExpert 62: 2.000(3035)[0m | [32mExpert  6: 1.000(3026)[0m | [32mExpert  7: 1.000(3041)[0m | [32mExpert  8: 1.000(3044)[0m | 
[32mExpert 12: 1.000(2870)[0m | [32mExpert 14: 1.000(2876)[0m | [32mExpert 27: 1.000(2918)[0m | [32mExpert 31: 1.000(2933)[0m | 
[32mExpert 35: 1.000(2945)[0m | [32mExpert 39: 1.000(2957)[0m | [32mExpert 46: 1.000(2981)[0m | [32mExpert 48: 1.000(2987)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3035, 3026, 3041, 3044, 2870, 2876, 2918, 2933, 2945, 2957, 2981, 2987]
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2945[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2981[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  6,  7,  8, 12, 14, 27, 31, 35, 39, 46, 48, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:7.0 | [20]:2.0 | [28]:2.0 | [42]:1.0 | [56]:2.0 | [36]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[3]:1.0 | [10]:2.0 | [32]:4.0 | [44]:2.0 | [47]:2.0 | [48]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[7]:2.0 | [10]:5.0 | [53]:4.0 | [56]:3.0 | [58]:5.0 | [28]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E7 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[8]:5.0 | [47]:2.0 | [49]:2.0 | [51]:2.0 | [63]:2.0 | [5]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[12]:2.0 | [14]:1.0 | [23]:4.0 | EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
[45]:4.0 | [49]:2.0 | [38]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[12]:2.0 | [36]:3.0 | [39]:2.0 | [41]:2.0 | [58]:2.0 | [37]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[12, 36, 39, 41, 58, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 8.000(4103)[0m | [32mExpert 30: 6.000(4148)[0m | [32mExpert  2: 5.000(4112)[0m | [32mExpert 10: 5.000(4082)[0m | 
[32mExpert 43: 5.000(4190)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 19: 4.000(4109)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert 61: 3.000(4250)[0m | [32mExpert  9: 2.000(4265)[0m | 
[32mExpert 21: 2.000(4118)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | 
[32mExpert 55: 2.000(4229)[0m | [32mExpert 56: 2.000(4232)[0m | [32mExpert 57: 2.000(4235)[0m | [32mExpert 62: 2.000(4253)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  1: 1.000(4079)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 29: 1.000(4142)[0m | 
[32mExpert 32: 1.000(4154)[0m | [32mExpert 37: 1.000(4169)[0m | [32mExpert 38: 1.000(4172)[0m | [32mExpert 47: 1.000(4202)[0m | 
[32mExpert 51: 1.000(4217)[0m | [32mExpert 58: 1.000(4238)[0m | [32mExpert 63: 1.000(4256)[0m | [33mExpert  3: 0.000(4145)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4076, 4079, 4091, 4142, 4154, 4169, 4172, 4202, 4217, 4238, 4256, 4145]
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  3, 13, 29, 32, 37, 38, 47, 51, 58, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[3]:5.0 | [16]:3.0 | [17]:1.0 | [31]:6.0 | [45]:2.0 | [40]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[6]:6.0 | [10]:2.0 | [11]:1.0 | [43]:6.0 | [46]:4.0 | [34]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[2]:6.0 | [4]:1.0 | [19]:5.0 | [31]:1.0 | [57]:3.0 | [49]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[7]:1.0 | [11]:5.0 | [25]:1.0 | [27]:1.0 | [49]:2.0 | [47]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[9]:1.0 | [12]:3.0 | [19]:5.0 | [32]:1.0 | [42]:2.0 | [40]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[19]:3.0 | [33]:5.0 | [34]:6.0 | [50]:5.0 | [63]:1.0 | [42]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[19, 33, 34, 50, 63, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:4.0 | [26]:1.0 | [34]:4.0 | [52]:2.0 | [63]:9.0 | [49]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[4]:1.0 | [11]:5.0 | [42]:2.0 | [45]:3.0 | [63]:5.0 | [57]:4.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2945
[1m[33mEnqueueTask: [0m[32mTask: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2981
[1m[33mEnqueueTask: [0m[32mTask: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[13]:7.0 | [16]:1.0 | [26]:4.0 | [40]:4.0 | [47]:4.0 | [35]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[10]:2.0 | [20]:2.0 | [21]:2.0 | [22]:3.0 | [28]:2.0 | [6]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[17]:5.0 | [34]:2.0 | [38]:5.0 | [40]:1.0 | [49]:2.0 | [10]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[10]:7.0 | [14]:1.0 | [40]:6.0 | [46]:1.0 | [47]:6.0 | [32]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[25]:4.0 | [28]:1.0 | [29]:5.0 | [40]:8.0 | [59]:9.0 | [57]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[1]:2.0 | [13]:1.0 | [25]:2.0 | [51]:7.0 | [59]:5.0 | [48]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 1, 13, 25, 51, 59, 48]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 8.000(2776)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 16: 5.000(2644)[0m | [32mExpert 17: 5.000(2647)[0m | 
[32mExpert 41: 5.000(2728)[0m | [32mExpert 57: 5.000(2779)[0m | [32mExpert 11: 3.000(2629)[0m | [32mExpert 27: 3.000(2680)[0m | 
[32mExpert 28: 3.000(2683)[0m | [32mExpert 34: 3.000(2704)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 53: 3.000(2767)[0m | 
[32mExpert  1: 2.000(2623)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | 
[32mExpert 51: 2.000(2761)[0m | [32mExpert 59: 2.000(2785)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert  0: 1.000(2620)[0m | 
[32mExpert  2: 1.000(2656)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 30: 1.000(2692)[0m | 
[32mExpert 33: 1.000(2701)[0m | [32mExpert 36: 1.000(2710)[0m | [32mExpert 42: 1.000(2731)[0m | [32mExpert 61: 1.000(2794)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2761, 2785, 2791, 2620, 2656, 2755, 2635, 2692, 2701, 2710, 2731, 2794]
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  5, 13, 30, 33, 36, 42, 51, 59, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[2]:7.0 | [5]:6.0 | [13]:2.0 | [14]:5.0 | [24]:2.0 | [59]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:6.0 | [7]:8.0 | [32]:8.0 | [44]:5.0 | [47]:3.0 | [37]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[10]:1.0 | [16]:6.0 | [28]:4.0 | [34]:4.0 | [56]:9.0 | [37]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[21]:8.0 | [33]:3.0 | [43]:2.0 | [46]:1.0 | [57]:7.0 | [18]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[14]:5.0 | [23]:8.0 | [40]:6.0 | [44]:7.0 | [59]:3.0 | [58]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[5]:5.0 | [20]:1.0 | [27]:2.0 | [50]:1.0 | [56]:2.0 | [33]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 5, 20, 27, 50, 56, 33]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 6.000(2990)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 10: 5.000(2864)[0m | [32mExpert 16: 5.000(2882)[0m | 
[32mExpert 58: 5.000(3020)[0m | [32mExpert 19: 4.000(2891)[0m | [32mExpert 40: 4.000(2963)[0m | [32mExpert 53: 4.000(3005)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 55: 3.000(3011)[0m | [32mExpert 56: 3.000(3014)[0m | 
[32mExpert 59: 3.000(3023)[0m | [32mExpert  7: 2.000(3041)[0m | [32mExpert 17: 2.000(2885)[0m | [32mExpert 25: 2.000(2912)[0m | 
[32mExpert 26: 2.000(2915)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 47: 2.000(2984)[0m | [32mExpert 50: 2.000(2996)[0m | 
[32mExpert 52: 2.000(3002)[0m | [32mExpert 62: 2.000(3035)[0m | [32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | 
[32mExpert 12: 1.000(2870)[0m | [32mExpert 14: 1.000(2876)[0m | [32mExpert 27: 1.000(2918)[0m | [32mExpert 28: 1.000(2921)[0m | 
[32mExpert 31: 1.000(2933)[0m | [32mExpert 35: 1.000(2945)[0m | [32mExpert 39: 1.000(2957)[0m | [32mExpert 46: 1.000(2981)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 3035, 3026, 3044, 2870, 2876, 2918, 2921, 2933, 2945, 2957, 2981]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2945[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2981[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  6,  8, 12, 14, 27, 28, 31, 35, 39, 46, 52, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[14]:2.0 | [36]:5.0 | [42]:2.0 | [47]:6.0 | [48]:2.0 | [5]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[6]:3.0 | [46]:2.0 | [48]:2.0 | [49]:7.0 | [51]:3.0 | [26]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[10]:6.0 | [24]:1.0 | [53]:5.0 | [56]:4.0 | [58]:6.0 | [28]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E28 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:8.0 | [8]:6.0 | [9]:3.0 | [40]:2.0 | [49]:3.0 | [63]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[3]:5.0 | [13]:4.0 | [23]:5.0 | [29]:2.0 | [38]:5.0 | [48]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[4]:6.0 | [12]:3.0 | [32]:4.0 | [38]:2.0 | [52]:4.0 | [58]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 4, 12, 32, 38, 52, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 8.000(4103)[0m | [32mExpert  2: 6.000(4112)[0m | [32mExpert 30: 6.000(4148)[0m | [32mExpert 10: 5.000(4082)[0m | 
[32mExpert 19: 5.000(4109)[0m | [32mExpert 43: 5.000(4190)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 27: 3.000(4136)[0m | 
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
[32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert 57: 3.000(4235)[0m | [32mExpert 61: 3.000(4250)[0m | 
[32mExpert  9: 2.000(4265)[0m | [32mExpert 21: 2.000(4118)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert 56: 2.000(4232)[0m | [32mExpert 62: 2.000(4253)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  1: 1.000(4079)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert 13: 1.000(4091)[0m | 
[32mExpert 29: 1.000(4142)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 32: 1.000(4154)[0m | [32mExpert 37: 1.000(4169)[0m | 
[32mExpert 38: 1.000(4172)[0m | [32mExpert 47: 1.000(4202)[0m | [32mExpert 49: 1.000(4208)[0m | [32mExpert 51: 1.000(4217)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4076, 4079, 4178, 4091, 4142, 4151, 4154, 4169, 4172, 4202, 4208, 4217]
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  4, 13, 29, 31, 32, 37, 38, 47, 49, 51 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[3]:6.0 | [12]:2.0 | [16]:4.0 | [31]:7.0 | [58]:3.0 | [6]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[6]:7.0 | [29]:5.0 | [35]:1.0 | [36]:5.0 | [45]:1.0 | [43]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[1]:2.0 | [2]:7.0 | [19]:6.0 | [43]:6.0 | [58]:2.0 | [57]:4.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[2]:6.0 | [3]:5.0 | [4]:4.0 | [25]:2.0 | [33]:9.0 | [10]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:5.0 | [3]:4.0 | [20]:3.0 | [35]:4.0 | [56]:3.0 | [12]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[6]:2.0 | [8]:5.0 | [10]:9.0 | [33]:6.0 | [53]:4.0 | [52]:8.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 6,  8, 10, 33, 53, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:4.0 | [14]:3.0 | [25]:5.0 | [54]:8.0 | [62]:5.0 | [38]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[8]:4.0 | [20]:6.0 | [41]:5.0 | [45]:4.0 | [49]:4.0 | [57]:5.0 | 
---------------------------------------
return iEAM
180ä¸ªEnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2945
[1m[33mEnqueueTask: [0m[32mTask: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[948,230000001f] (16MB) STATE(0) TENSOR[2944,2945,2943,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[15]:3.0 | [17]:5.0 | [20]:2.0 | [45]:1.0 | [62]:1.0 | [24]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[1]:3.0 | [10]:3.0 | [17]:4.0 | [29]:4.0 | [38]:7.0 | [25]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[6]:2.0 | [12]:5.0 | [26]:4.0 | [34]:3.0 | [38]:6.0 | [33]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[4]:2.0 | [14]:2.0 | [47]:7.0 | [54]:1.0 | [61]:3.0 | [27]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[5]:3.0 | [25]:5.0 | [32]:1.0 | [40]:9.0 | [59]:10.0 | [29]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[1]:3.0 | [8]:2.0 | [28]:6.0 | [36]:2.0 | [51]:8.0 | [25]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 1,  8, 28, 36, 51, 25]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 9.000(2776)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 17: 5.000(2647)[0m | 
[32mExpert 41: 5.000(2728)[0m | [32mExpert 57: 5.000(2779)[0m | [32mExpert 28: 4.000(2683)[0m | [32mExpert 34: 4.000(2704)[0m | 
[32mExpert 11: 3.000(2629)[0m | [32mExpert 27: 3.000(2680)[0m | [32mExpert 37: 3.000(2713)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | 
[32mExpert 24: 2.000(2671)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | 
[32mExpert 51: 2.000(2761)[0m | [32mExpert 59: 2.000(2785)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert  0: 1.000(2620)[0m | 
[32mExpert  2: 1.000(2656)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 10: 1.000(2626)[0m | [32mExpert 13: 1.000(2635)[0m | 
[32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 36: 1.000(2710)[0m | [32mExpert 42: 1.000(2731)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2761, 2785, 2791, 2620, 2656, 2755, 2626, 2635, 2692, 2701, 2710, 2731]
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  5, 10, 13, 30, 33, 36, 42, 51, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[2]:8.0 | [14]:6.0 | [24]:3.0 | [53]:3.0 | [59]:2.0 | [35]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:7.0 | [7]:9.0 | [22]:3.0 | [37]:4.0 | [44]:6.0 | [36]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[11]:4.0 | [34]:5.0 | [37]:4.0 | [56]:10.0 | [62]:1.0 | [28]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[21]:9.0 | [31]:3.0 | [38]:1.0 | [43]:3.0 | [61]:2.0 | [33]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[14]:6.0 | [29]:4.0 | [41]:5.0 | [44]:8.0 | [62]:1.0 | [33]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[6]:5.0 | [16]:3.0 | [37]:6.0 | [50]:2.0 | [51]:2.0 | [57]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 6, 16, 37, 50, 51, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(2864)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert 58: 6.000(3020)[0m | [32mExpert  0: 5.000(2858)[0m | 
[32mExpert 16: 5.000(2882)[0m | [32mExpert 53: 5.000(3005)[0m | [32mExpert 19: 4.000(2891)[0m | [32mExpert 40: 4.000(2963)[0m | 
[32mExpert 56: 4.000(3014)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 55: 3.000(3011)[0m | 
[32mExpert 59: 3.000(3023)[0m | [32mExpert  7: 2.000(3041)[0m | [32mExpert 17: 2.000(2885)[0m | [32mExpert 25: 2.000(2912)[0m | 
[32mExpert 26: 2.000(2915)[0m | [32mExpert 28: 2.000(2921)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 47: 2.000(2984)[0m | 
[32mExpert 50: 2.000(2996)[0m | [32mExpert 52: 2.000(3002)[0m | [32mExpert 62: 2.000(3035)[0m | [32mExpert  6: 1.000(3026)[0m | 
[32mExpert  8: 1.000(3044)[0m | [32mExpert 12: 1.000(2870)[0m | [32mExpert 14: 1.000(2876)[0m | [32mExpert 24: 1.000(2909)[0m | 
[32mExpert 27: 1.000(2918)[0m | [32mExpert 31: 1.000(2933)[0m | [32mExpert 35: 1.000(2945)[0m | [32mExpert 39: 1.000(2957)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 3002, 3035, 3026, 3044, 2870, 2876, 2909, 2918, 2933, 2945, 2957]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2945[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  6,  8, 12, 14, 24, 27, 31, 35, 39, 50, 52, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:2.0 | [20]:3.0 | [22]:4.0 | [47]:7.0 | [59]:2.0 | [5]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[6]:4.0 | [44]:3.0 | [49]:8.0 | [51]:4.0 | [54]:2.0 | [32]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[5]:1.0 | [33]:1.0 | [53]:6.0 | [56]:5.0 | [63]:2.0 | [17]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[5]:9.0 | [8]:7.0 | [29]:2.0 | [52]:1.0 | [60]:3.0 | [6]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[15]:3.0 | [23]:6.0 | [38]:6.0 | [39]:2.0 | [48]:5.0 | [12]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[4]:7.0 | [12]:4.0 | [37]:4.0 | [39]:3.0 | [50]:4.0 | [58]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 4, 12, 37, 39, 50, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 8.000(4103)[0m | [32mExpert  2: 7.000(4112)[0m | [32mExpert 19: 6.000(4109)[0m | [32mExpert 30: 6.000(4148)[0m | 
[32mExpert 43: 6.000(4190)[0m | [32mExpert 10: 5.000(4082)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 57: 4.000(4235)[0m | 
[32mExpert 27: 3.000(4136)[0m | [32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert 61: 3.000(4250)[0m | 
[32mExpert  1: 2.000(4079)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 21: 2.000(4118)[0m | EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
[32mExpert 46: 2.000(4199)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert 56: 2.000(4232)[0m | 
[32mExpert 58: 2.000(4238)[0m | [32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | 
[32mExpert 13: 1.000(4091)[0m | [32mExpert 29: 1.000(4142)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 32: 1.000(4154)[0m | 
[32mExpert 37: 1.000(4169)[0m | [32mExpert 38: 1.000(4172)[0m | [32mExpert 47: 1.000(4202)[0m | [32mExpert 49: 1.000(4208)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4238, 4253, 4076, 4178, 4091, 4142, 4151, 4154, 4169, 4172, 4202, 4208]
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 29, 31, 32, 37, 38, 47, 49, 58, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:3.0 | [13]:2.0 | [16]:5.0 | [44]:4.0 | [58]:4.0 | [2]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[13]:2.0 | [30]:2.0 | [35]:2.0 | [36]:6.0 | [43]:8.0 | [59]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[1]:3.0 | [17]:9.0 | [21]:3.0 | [57]:5.0 | [61]:4.0 | [58]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[3]:6.0 | [5]:5.0 | [10]:3.0 | [25]:3.0 | [33]:10.0 | [42]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:6.0 | [3]:5.0 | [12]:5.0 | [14]:6.0 | [56]:4.0 | [45]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[6]:3.0 | [8]:6.0 | [30]:2.0 | [53]:5.0 | [60]:2.0 | [10]:10.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 6,  8, 30, 53, 60, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[14]:4.0 | [35]:1.0 | [38]:5.0 | [48]:3.0 | [51]:1.0 | [16]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[2]:3.0 | [32]:4.0 | [41]:6.0 | [49]:5.0 | [57]:6.0 | [11]:6.0 | 
---------------------------------------
return iEAM
é›¶ä»¶EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:1.0 | [33]:5.0 | [41]:1.0 | [59]:5.0 | [61]:1.0 | [1]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[20]:3.0 | [29]:5.0 | [30]:1.0 | [43]:3.0 | [45]:3.0 | [38]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[20]:2.0 | [34]:4.0 | [36]:2.0 | [43]:2.0 | [59]:2.0 | [33]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[7]:1.0 | [24]:1.0 | [32]:4.0 | [55]:2.0 | [62]:2.0 | [50]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[5]:4.0 | [13]:2.0 | [34]:3.0 | [59]:11.0 | [61]:3.0 | [2]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[3]:2.0 | [28]:7.0 | [29]:2.0 | [38]:4.0 | [51]:9.0 | [20]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 3, 28, 29, 38, 51, 20]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 10.000(2776)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 17: 5.000(2647)[0m | 
[32mExpert 28: 5.000(2683)[0m | [32mExpert 34: 5.000(2704)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 57: 5.000(2779)[0m | 
[32mExpert 11: 4.000(2629)[0m | [32mExpert 37: 4.000(2713)[0m | [32mExpert 27: 3.000(2680)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | 
[32mExpert 24: 2.000(2671)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | 
[32mExpert 51: 2.000(2761)[0m | [32mExpert 59: 2.000(2785)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert  0: 1.000(2620)[0m | 
[32mExpert  2: 1.000(2656)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 10: 1.000(2626)[0m | [32mExpert 13: 1.000(2635)[0m | 
[32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 36: 1.000(2710)[0m | [32mExpert 42: 1.000(2731)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2761, 2785, 2791, 2620, 2656, 2755, 2626, 2635, 2692, 2701, 2710, 2731]
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  5, 10, 13, 30, 33, 36, 42, 51, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:3.0 | [7]:2.0 | [31]:3.0 | [49]:3.0 | [53]:4.0 | [59]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:8.0 | [7]:10.0 | [13]:1.0 | [24]:4.0 | [44]:7.0 | [36]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[12]:1.0 | [34]:6.0 | [51]:3.0 | [56]:11.0 | [60]:3.0 | [11]:5.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E60 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:2.0 | [16]:1.0 | [35]:3.0 | [49]:3.0 | [58]:1.0 | [21]:10.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[13]:2.0 | [14]:7.0 | [29]:5.0 | [40]:7.0 | [52]:1.0 | [33]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[5]:6.0 | [16]:4.0 | [33]:2.0 | [62]:1.0 | [63]:2.0 | [31]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 5, 16, 33, 62, 63, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(2864)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert 53: 6.000(3005)[0m | [32mExpert 58: 6.000(3020)[0m | 
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 56: 5.000(3014)[0m | [32mExpert 19: 4.000(2891)[0m | 
[32mExpert 40: 4.000(2963)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 17: 3.000(2885)[0m | [32mExpert 37: 3.000(2951)[0m | 
[32mExpert 55: 3.000(3011)[0m | [32mExpert 59: 3.000(3023)[0m | [32mExpert  7: 2.000(3041)[0m | [32mExpert 25: 2.000(2912)[0m | 
[32mExpert 26: 2.000(2915)[0m | [32mExpert 28: 2.000(2921)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 47: 2.000(2984)[0m | 
[32mExpert 50: 2.000(2996)[0m | [32mExpert 52: 2.000(3002)[0m | [32mExpert 62: 2.000(3035)[0m | [32mExpert 63: 2.000(3038)[0m | 
[32mExpert  5: 1.000(2993)[0m | [32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 12: 1.000(2870)[0m | 
[32mExpert 14: 1.000(2876)[0m | [32mExpert 24: 1.000(2909)[0m | [32mExpert 27: 1.000(2918)[0m | [32mExpert 31: 1.000(2933)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 3002, 3035, 3038, 2993, 3026, 3044, 2870, 2876, 2909, 2918, 2933]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6,  8, 12, 14, 24, 27, 31, 50, 52, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[24]:3.0 | [35]:2.0 | [36]:6.0 | [62]:1.0 | [63]:2.0 | [59]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[47]:3.0 | [48]:3.0 | [52]:2.0 | [55]:2.0 | [59]:3.0 | [37]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[25]:3.0 | [27]:2.0 | [36]:1.0 | [43]:3.0 | [48]:2.0 | [11]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:10.0 | [6]:4.0 | [19]:4.0 | [26]:1.0 | [60]:4.0 | [56]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[7]:1.0 | [27]:3.0 | [46]:1.0 | [48]:6.0 | [58]:2.0 | [50]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[8]:4.0 | [14]:3.0 | [47]:2.0 | [49]:2.0 | [54]:1.0 | [10]:1.0 | 
---------------------------------------
return iEAMEnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

Begin prefetch18 topk= tensor([[ 8, 14, 47, 49, 54, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 9.000(4103)[0m | [32mExpert  2: 7.000(4112)[0m | [32mExpert 19: 6.000(4109)[0m | [32mExpert 30: 6.000(4148)[0m | 
[32mExpert 43: 6.000(4190)[0m | [32mExpert 10: 5.000(4082)[0m | [32mExpert 57: 5.000(4235)[0m | [32mExpert 14: 4.000(4094)[0m | 
[32mExpert 61: 4.000(4250)[0m | [32mExpert  1: 3.000(4079)[0m | [32mExpert 21: 3.000(4118)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  9: 2.000(4265)[0m | 
[32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert 56: 2.000(4232)[0m | [32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | 
[32mExpert 13: 1.000(4091)[0m | [32mExpert 29: 1.000(4142)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 32: 1.000(4154)[0m | 
[32mExpert 37: 1.000(4169)[0m | [32mExpert 38: 1.000(4172)[0m | [32mExpert 47: 1.000(4202)[0m | [32mExpert 49: 1.000(4208)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4232, 4253, 4076, 4178, 4091, 4142, 4151, 4154, 4169, 4172, 4202, 4208]
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 29, 31, 32, 37, 38, 47, 49, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:1.0 | [12]:3.0 | [44]:5.0 | [53]:5.0 | [57]:1.0 | [2]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[4]:1.0 | [21]:2.0 | [41]:5.0 | [55]:2.0 | [62]:2.0 | [53]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[9]:3.0 | [10]:6.0 | [23]:1.0 | [30]:7.0 | [56]:3.0 | [51]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E56 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[5]:6.0 | [8]:1.0 | [33]:11.0 | [42]:5.0 | [51]:1.0 | [49]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[14]:7.0 | [28]:1.0 | [45]:8.0 | [46]:1.0 | [62]:5.0 | [27]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[5]:3.0 | [8]:7.0 | [9]:1.0 | [30]:3.0 | [45]:3.0 | [53]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 5,  8,  9, 30, 45, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[17]:1.0 | [20]:1.0 | [31]:1.0 | [54]:9.0 | [55]:3.0 | [14]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[11]:7.0 | [25]:3.0 | [27]:3.0 | [41]:7.0 | [43]:2.0 | [32]:5.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:2.0 | [12]:4.0 | [18]:3.0 | [51]:1.0 | [54]:2.0 | [43]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[0]:1.0 | [8]:3.0 | [11]:3.0 | [41]:1.0 | [46]:1.0 | [15]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[1]:1.0 | [22]:4.0 | [24]:1.0 | [40]:2.0 | [55]:2.0 | [31]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[16]:1.0 | [22]:3.0 | [29]:3.0 | [39]:1.0 | [52]:1.0 | [5]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[12]:3.0 | [14]:5.0 | [27]:1.0 | [43]:1.0 | [53]:1.0 | [47]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[11]:3.0 | [12]:1.0 | [16]:3.0 | [18]:1.0 | [54]:1.0 | [42]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[11, 12, 16, 18, 54, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 11.000(2776)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 34: 6.000(2704)[0m | [32mExpert 46: 6.000(2743)[0m | 
[32mExpert 11: 5.000(2629)[0m | [32mExpert 17: 5.000(2647)[0m | [32mExpert 28: 5.000(2683)[0m | [32mExpert 41: 5.000(2728)[0m | 
[32mExpert 57: 5.000(2779)[0m | [32mExpert 37: 4.000(2713)[0m | [32mExpert 27: 3.000(2680)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 51: 3.000(2761)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert 60: 3.000(2791)[0m | [32mExpert  1: 2.000(2623)[0m | 
[32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert 59: 2.000(2785)[0m | [32mExpert  0: 1.000(2620)[0m | 
[32mExpert  2: 1.000(2656)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 10: 1.000(2626)[0m | [32mExpert 12: 1.000(2632)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 36: 1.000(2710)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2716, 2749, 2785, 2620, 2656, 2755, 2626, 2632, 2635, 2692, 2701, 2710]
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  5, 10, 12, 13, 30, 33, 36, 38, 48, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:4.0 | [19]:1.0 | [21]:1.0 | [42]:5.0 | [60]:3.0 | [26]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[3]:1.0 | [10]:2.0 | [12]:1.0 | [20]:1.0 | [26]:6.0 | [17]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[1]:3.0 | [5]:2.0 | [48]:3.0 | [52]:1.0 | [58]:1.0 | [15]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[11]:1.0 | [29]:1.0 | [30]:7.0 | [33]:5.0 | [53]:3.0 | [44]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[0]:1.0 | [5]:1.0 | [35]:3.0 | [53]:3.0 | [57]:1.0 | [8]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[6]:6.0 | [7]:3.0 | [45]:8.0 | [54]:1.0 | [58]:3.0 | [42]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 6,  7, 45, 54, 58, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(2864)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert 53: 6.000(3005)[0m | [32mExpert 58: 6.000(3020)[0m | 
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 56: 5.000(3014)[0m | [32mExpert 19: 4.000(2891)[0m | 
[32mExpert 40: 4.000(2963)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 17: 3.000(2885)[0m | [32mExpert 25: 3.000(2912)[0m | 
[32mExpert 37: 3.000(2951)[0m | [32mExpert 43: 3.000(2972)[0m | [32mExpert 55: 3.000(3011)[0m | [32mExpert 59: 3.000(3023)[0m | 
[32mExpert  7: 2.000(3041)[0m | [32mExpert 26: 2.000(2915)[0m | [32mExpert 27: 2.000(2918)[0m | [32mExpert 28: 2.000(2921)[0m | 
[32mExpert 47: 2.000(2984)[0m | [32mExpert 48: 2.000(2987)[0m | [32mExpert 50: 2.000(2996)[0m | [32mExpert 52: 2.000(3002)[0m | 
[32mExpert 62: 2.000(3035)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert  5: 1.000(2993)[0m | [32mExpert  6: 1.000(3026)[0m | 
[32mExpert  8: 1.000(3044)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 12: 1.000(2870)[0m | [32mExpert 14: 1.000(2876)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2984, 2987, 2996, 3002, 3035, 3038, 2993, 3026, 3044, 2867, 2870, 2876]
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6,  8, 11, 12, 14, 47, 48, 50, 52, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[4]:2.0 | [30]:5.0 | [31]:1.0 | [39]:4.0 | [40]:4.0 | [25]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[4]:1.0 | [25]:5.0 | [30]:5.0 | [36]:2.0 | [59]:4.0 | [15]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[7]:3.0 | [13]:1.0 | [30]:1.0 | [33]:2.0 | [59]:4.0 | [19]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[38]:1.0 | [46]:1.0 | [48]:2.0 | [50]:3.0 | [58]:2.0 | [9]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[25]:7.0 | [42]:1.0 | [52]:5.0 | [55]:5.0 | [59]:1.0 | [6]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[3]:1.0 | [4]:8.0 | [28]:3.0 | [51]:4.0 | [57]:2.0 | [32]:5.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 3,  4, 28, 51, 57, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 9.000(4103)[0m | EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
[32mExpert  2: 7.000(4112)[0m | [32mExpert 30: 7.000(4148)[0m | [32mExpert 10: 6.000(4082)[0m | 
[32mExpert 19: 6.000(4109)[0m | [32mExpert 43: 6.000(4190)[0m | [32mExpert 57: 5.000(4235)[0m | [32mExpert 14: 4.000(4094)[0m | 
[32mExpert 61: 4.000(4250)[0m | [32mExpert  1: 3.000(4079)[0m | [32mExpert  9: 3.000(4265)[0m | [32mExpert 21: 3.000(4118)[0m | 
[32mExpert 27: 3.000(4136)[0m | [32mExpert 35: 3.000(4163)[0m | [32mExpert 54: 3.000(4226)[0m | [32mExpert 56: 3.000(4232)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | 
[32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert 62: 2.000(4253)[0m | [32mExpert  0: 1.000(4076)[0m | 
[32mExpert  4: 1.000(4178)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 23: 1.000(4124)[0m | [32mExpert 29: 1.000(4142)[0m | 
[32mExpert 31: 1.000(4151)[0m | [32mExpert 32: 1.000(4154)[0m | [32mExpert 37: 1.000(4169)[0m | [32mExpert 38: 1.000(4172)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4217, 4229, 4253, 4076, 4178, 4091, 4124, 4142, 4151, 4154, 4169, 4172]
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 23, 29, 31, 32, 37, 38, 51, 55, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[19]:1.0 | [35]:4.0 | [39]:1.0 | [44]:6.0 | [46]:2.0 | [53]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[0]:1.0 | [5]:1.0 | [30]:3.0 | [40]:1.0 | [42]:4.0 | [41]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[9]:4.0 | [14]:5.0 | [35]:4.0 | [37]:2.0 | [62]:3.0 | [54]:4.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[19]:1.0 | [24]:1.0 | [26]:7.0 | [39]:7.0 | [40]:4.0 | [52]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[6]:3.0 | [7]:6.0 | [38]:3.0 | [60]:2.0 | [63]:2.0 | [11]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[14]:1.0 | [21]:5.0 | [28]:6.0 | [37]:4.0 | [57]:4.0 | [24]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[14, 21, 28, 37, 57, 24]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[15]:1.0 | [29]:3.0 | [42]:1.0 | [57]:4.0 | [63]:10.0 | [2]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[22]:1.0 | [30]:5.0 | [36]:5.0 | [48]:3.0 | [54]:2.0 | [1]:4.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[13]:8.0 | [19]:3.0 | [26]:5.0 | [30]:2.0 | [52]:3.0 | [46]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[35]:5.0 | [44]:1.0 | [58]:8.0 | [59]:1.0 | [61]:2.0 | [13]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[15]:2.0 | [27]:6.0 | [38]:7.0 | [51]:2.0 | [62]:5.0 | [31]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[10]:8.0 | [15]:3.0 | [16]:2.0 | [40]:7.0 | [44]:1.0 | [59]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[5]:5.0 | [24]:1.0 | [25]:6.0 | [29]:7.0 | [59]:12.0 | [42]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[6]:7.0 | [27]:4.0 | [32]:1.0 | [51]:10.0 | [59]:6.0 | [21]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 6, 27, 32, 51, 59, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 11.000(2776)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 34: 6.000(2704)[0m | [32mExpert 46: 6.000(2743)[0m | 
[32mExpert 11: 5.000(2629)[0m | [32mExpert 17: 5.000(2647)[0m | [32mExpert 28: 5.000(2683)[0m | [32mExpert 41: 5.000(2728)[0m | 
[32mExpert 57: 5.000(2779)[0m | [32mExpert 37: 4.000(2713)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 27: 3.000(2680)[0m | 
[32mExpert 45: 3.000(2740)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert 51: 3.000(2761)[0m | [32mExpert 53: 3.000(2767)[0m | 
[32mExpert 60: 3.000(2791)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert  5: 2.000(2755)[0m | [32mExpert 19: 2.000(2653)[0m | 
[32mExpert 24: 2.000(2671)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert 59: 2.000(2785)[0m | 
[32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert 10: 1.000(2626)[0m | [32mExpert 12: 1.000(2632)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 15: 1.000(2641)[0m | [32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2671, 2707, 2716, 2785, 2620, 2656, 2626, 2632, 2635, 2641, 2692, 2701]
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2, 10, 12, 13, 15, 24, 30, 33, 35, 38, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:7.0 | [14]:7.0 | [22]:4.0 | [55]:2.0 | [61]:6.0 | [60]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[7]:11.0 | [28]:6.0 | [32]:9.0 | [44]:8.0 | [48]:1.0 | [1]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[10]:2.0 | [16]:7.0 | [17]:6.0 | [56]:12.0 | [59]:3.0 | [28]:6.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E59 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[3]:1.0 | [21]:11.0 | [33]:6.0 | [46]:2.0 | [57]:8.0 | [42]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[2]:3.0 | [18]:1.0 | [23]:9.0 | [44]:9.0 | [58]:3.0 | [14]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[23]:4.0 | [27]:3.0 | [37]:7.0 | [45]:9.0 | [49]:3.0 | [4]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[23, 27, 37, 45, 49,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(2864)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert 53: 6.000(3005)[0m | [32mExpert 58: 6.000(3020)[0m | 
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 19: 5.000(2891)[0m | [32mExpert 56: 5.000(3014)[0m | 
[32mExpert 40: 4.000(2963)[0m | [32mExpert 59: 4.000(3023)[0m | [32mExpert  7: 3.000(3041)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 17: 3.000(2885)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 43: 3.000(2972)[0m | 
[32mExpert 55: 3.000(3011)[0m | [32mExpert 26: 2.000(2915)[0m | [32mExpert 27: 2.000(2918)[0m | [32mExpert 28: 2.000(2921)[0m | 
[32mExpert 33: 2.000(2939)[0m | [32mExpert 47: 2.000(2984)[0m | [32mExpert 48: 2.000(2987)[0m | [32mExpert 50: 2.000(2996)[0m | 
[32mExpert 52: 2.000(3002)[0m | [32mExpert 62: 2.000(3035)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert  5: 1.000(2993)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 12: 1.000(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2984, 2987, 2996, 3002, 3035, 3038, 2993, 3026, 3044, 2867, 2870]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6,  8, 11, 12, 33, 47, 48, 50, 52, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:10.0 | [14]:3.0 | [36]:7.0 | [45]:2.0 | [48]:3.0 | [10]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[19]:1.0 | [46]:3.0 | [47]:4.0 | [49]:9.0 | [51]:5.0 | [24]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[10]:7.0 | [17]:4.0 | [26]:3.0 | [52]:3.0 | [58]:7.0 | [50]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[8]:8.0 | [21]:5.0 | [37]:5.0 | [53]:1.0 | [60]:5.0 | [40]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[3]:6.0 | [5]:6.0 | EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
[9]:2.0 | [13]:5.0 | [23]:7.0 | [17]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[4]:9.0 | [13]:5.0 | [22]:5.0 | [36]:4.0 | [52]:5.0 | [32]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 4, 13, 22, 36, 52, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 9.000(4103)[0m | [32mExpert  2: 7.000(4112)[0m | [32mExpert 30: 7.000(4148)[0m | [32mExpert 10: 6.000(4082)[0m | 
[32mExpert 19: 6.000(4109)[0m | [32mExpert 43: 6.000(4190)[0m | [32mExpert 14: 5.000(4094)[0m | [32mExpert 57: 5.000(4235)[0m | 
[32mExpert  9: 4.000(4265)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 4.000(4250)[0m | 
[32mExpert  1: 3.000(4079)[0m | [32mExpert 21: 3.000(4118)[0m | [32mExpert 27: 3.000(4136)[0m | [32mExpert 56: 3.000(4232)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 23: 1.000(4124)[0m | 
[32mExpert 29: 1.000(4142)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 32: 1.000(4154)[0m | [32mExpert 38: 1.000(4172)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4205, 4214, 4217, 4229, 4076, 4178, 4091, 4124, 4142, 4151, 4154, 4172]
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 23, 29, 31, 32, 38, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[3]:7.0 | [29]:4.0 | [31]:8.0 | [35]:5.0 | [58]:5.0 | [6]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[6]:8.0 | [29]:6.0 | [34]:3.0 | [41]:7.0 | [53]:7.0 | [60]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[1]:4.0 | [2]:8.0 | [10]:7.0 | [19]:7.0 | [43]:7.0 | [30]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[2]:7.0 | [4]:5.0 | [32]:1.0 | [33]:12.0 | [44]:5.0 | [5]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:7.0 | [20]:4.0 | [45]:9.0 | [56]:5.0 | [60]:3.0 | [59]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[8]:8.0 | [10]:11.0 | [33]:7.0 | [52]:9.0 | [53]:7.0 | [45]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 8, 10, 33, 52, 53, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[25]:6.0 | [38]:6.0 | [52]:3.0 | [54]:10.0 | [62]:6.0 | [6]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[8]:5.0 | [20]:7.0 | [41]:8.0 | [45]:5.0 | [49]:6.0 | [59]:4.0 | 
---------------------------------------
return iEAM
ï¼Œ7å°EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:3.0 | [15]:4.0 | [17]:6.0 | [19]:4.0 | [33]:6.0 | [18]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[1]:4.0 | [17]:5.0 | [29]:6.0 | [38]:9.0 | [44]:2.0 | [45]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[6]:3.0 | [10]:5.0 | [12]:6.0 | [26]:5.0 | [56]:1.0 | [11]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[4]:3.0 | [10]:9.0 | [11]:2.0 | [32]:5.0 | [47]:8.0 | [0]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[20]:2.0 | [24]:2.0 | [40]:10.0 | [59]:13.0 | [61]:4.0 | [29]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[28]:8.0 | [36]:3.0 | [51]:11.0 | [57]:3.0 | [59]:7.0 | [21]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[28, 36, 51, 57, 59, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 12.000(2776)[0m | [32mExpert 16: 7.000(2644)[0m | [32mExpert 17: 6.000(2647)[0m | [32mExpert 28: 6.000(2683)[0m | 
[32mExpert 34: 6.000(2704)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 11: 5.000(2629)[0m | [32mExpert 41: 5.000(2728)[0m | 
[32mExpert 57: 5.000(2779)[0m | [32mExpert 37: 4.000(2713)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 27: 3.000(2680)[0m | 
[32mExpert 45: 3.000(2740)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert 51: 3.000(2761)[0m | [32mExpert 53: 3.000(2767)[0m | 
[32mExpert 59: 3.000(2785)[0m | [32mExpert 60: 3.000(2791)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert  5: 2.000(2755)[0m | 
[32mExpert 10: 2.000(2626)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert 12: 1.000(2632)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 15: 1.000(2641)[0m | [32mExpert 30: 1.000(2692)[0m | [32mExpert 33: 1.000(2701)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2626, 2653, 2671, 2707, 2716, 2620, 2656, 2632, 2635, 2641, 2692, 2701]
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2, 10, 12, 13, 15, 19, 24, 30, 33, 35, 38 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:4.0 | [5]:8.0 | [14]:8.0 | [23]:1.0 | [24]:4.0 | [2]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[7]:12.0 | [22]:4.0 | [24]:5.0 | [32]:10.0 | [44]:9.0 | [4]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[16]:8.0 | [34]:7.0 | [37]:5.0 | [56]:13.0 | [60]:4.0 | [30]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[5]:6.0 | [14]:2.0 | [18]:6.0 | [21]:12.0 | [57]:9.0 | [61]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[14]:9.0 | [17]:4.0 | [23]:10.0 | [27]:2.0 | [40]:8.0 | [29]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[5]:7.0 | [6]:7.0 | [23]:5.0 | [33]:3.0 | [49]:4.0 | [63]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 5,  6, 23, 33, 49, 63]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 7.000(2864)[0m | [32mExpert 58: 7.000(3020)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert 53: 6.000(3005)[0m | 
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 19: 5.000(2891)[0m | [32mExpert 56: 5.000(3014)[0m | 
[32mExpert 17: 4.000(2885)[0m | [32mExpert 40: 4.000(2963)[0m | [32mExpert 59: 4.000(3023)[0m | [32mExpert  7: 3.000(3041)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 37: 3.000(2951)[0m | 
[32mExpert 43: 3.000(2972)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert 52: 3.000(3002)[0m | [32mExpert 55: 3.000(3011)[0m | 
[32mExpert 27: 2.000(2918)[0m | [32mExpert 28: 2.000(2921)[0m | [32mExpert 33: 2.000(2939)[0m | [32mExpert 47: 2.000(2984)[0m | 
[32mExpert 48: 2.000(2987)[0m | [32mExpert 62: 2.000(3035)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert  5: 1.000(2993)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 12: 1.000(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2918, 2921, 2939, 2984, 2987, 3035, 3038, 2993, 3026, 3044, 2867, 2870]
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6,  8, 11, 12, 27, 28, 33, 47, 48, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:3.0 | [5]:11.0 | [14]:4.0 | [43]:1.0 | [48]:4.0 | [35]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[31]:3.0 | [47]:5.0 | [49]:10.0 | [51]:6.0 | [59]:5.0 | [27]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[17]:5.0 | [25]:4.0 | [37]:4.0 | [55]:4.0 | [63]:3.0 | [5]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E63 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:5.0 | [19]:5.0 | [33]:3.0 | [45]:3.0 | [60]:6.0 | [5]:11.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[0]:3.0 | [9]:3.0 | [27]:4.0 | [30]:1.0 | [48]:7.0 | [45]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[2]:4.0 | [10]:2.0 | [32]:7.0 | [39]:4.0 | [50]:5.0 | [4]:10.0 | 
---------------------------------------
return iEAMEnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13

Begin prefetch18 topk= tensor([[ 2, 10, 32, 39, 50,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 9.000(4103)[0m | [32mExpert  2: 8.000(4112)[0m | [32mExpert 30: 8.000(4148)[0m | [32mExpert 10: 7.000(4082)[0m | 
[32mExpert 19: 7.000(4109)[0m | [32mExpert 43: 7.000(4190)[0m | [32mExpert 14: 5.000(4094)[0m | [32mExpert 57: 5.000(4235)[0m | 
[32mExpert  1: 4.000(4079)[0m | [32mExpert  9: 4.000(4265)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | 
[32mExpert 61: 4.000(4250)[0m | [32mExpert 21: 3.000(4118)[0m | [32mExpert 27: 3.000(4136)[0m | [32mExpert 56: 3.000(4232)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 23: 1.000(4124)[0m | 
[32mExpert 29: 1.000(4142)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 32: 1.000(4154)[0m | [32mExpert 38: 1.000(4172)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4205, 4214, 4217, 4229, 4076, 4178, 4091, 4124, 4142, 4151, 4154, 4172]
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 23, 29, 31, 32, 38, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:4.0 | [9]:2.0 | [16]:6.0 | [49]:3.0 | [55]:2.0 | [22]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[5]:2.0 | [30]:4.0 | [36]:7.0 | [41]:8.0 | [53]:8.0 | [29]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[1]:5.0 | [17]:10.0 | [19]:8.0 | [30]:9.0 | [57]:6.0 | [10]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[5]:8.0 | [6]:4.0 | [10]:4.0 | [33]:13.0 | [42]:6.0 | [12]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:8.0 | [3]:6.0 | [14]:8.0 | [45]:10.0 | [56]:6.0 | [59]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[8]:9.0 | [10]:12.0 | [34]:7.0 | [47]:1.0 | [53]:8.0 | [48]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 8, 10, 34, 47, 53, 48]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[14]:6.0 | [34]:5.0 | [46]:1.0 | [50]:3.0 | [63]:11.0 | [24]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[6]:3.0 | [32]:6.0 | [41]:9.0 | [57]:7.0 | [63]:6.0 | [27]:4.0 | 
---------------------------------------
return iEAM
æœºå™¨EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:4.0 | [30]:3.0 | [39]:3.0 | [59]:6.0 | [61]:2.0 | [3]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[2]:5.0 | [20]:4.0 | [28]:3.0 | [36]:5.0 | [45]:5.0 | [43]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[21]:4.0 | [32]:2.0 | [34]:5.0 | [36]:3.0 | [43]:3.0 | [29]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[0]:6.0 | [15]:4.0 | [28]:2.0 | [32]:6.0 | [62]:3.0 | [2]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[20]:3.0 | [34]:4.0 | [40]:11.0 | [59]:14.0 | [61]:5.0 | [16]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[3]:3.0 | [28]:9.0 | [38]:5.0 | [48]:2.0 | [63]:1.0 | [21]:5.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 3, 28, 38, 48, 63, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 13.000(2776)[0m | [32mExpert 16: 8.000(2644)[0m | [32mExpert 34: 7.000(2704)[0m | [32mExpert 17: 6.000(2647)[0m | 
[32mExpert 28: 6.000(2683)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 11: 5.000(2629)[0m | [32mExpert 37: 5.000(2713)[0m | 
[32mExpert 41: 5.000(2728)[0m | [32mExpert 57: 5.000(2779)[0m | [32mExpert 60: 4.000(2791)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 27: 3.000(2680)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert 51: 3.000(2761)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert 59: 3.000(2785)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert  5: 2.000(2755)[0m | 
[32mExpert 10: 2.000(2626)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 30: 2.000(2692)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 
[32mExpert 12: 1.000(2632)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 15: 1.000(2641)[0m | [32mExpert 33: 1.000(2701)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2626, 2653, 2671, 2692, 2707, 2716, 2620, 2656, 2632, 2635, 2641, 2701]
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2, 10, 12, 13, 15, 19, 24, 30, 33, 35, 38 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[2]:10.0 | [7]:3.0 | [11]:2.0 | [31]:4.0 | [49]:4.0 | [27]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:10.0 | [7]:13.0 | [22]:5.0 | [24]:6.0 | [44]:10.0 | [26]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[11]:6.0 | [34]:8.0 | [51]:4.0 | [56]:14.0 | [60]:5.0 | [30]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[14]:3.0 | [18]:7.0 | [21]:13.0 | [34]:2.0 | [35]:4.0 | [3]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[13]:3.0 | [14]:10.0 | [27]:3.0 | [29]:7.0 | [53]:4.0 | [5]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[5]:8.0 | [6]:8.0 | [45]:10.0 | [54]:2.0 | [63]:4.0 | [8]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 5,  6, 45, 54, 63,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 7.000(2864)[0m | [32mExpert 58: 7.000(3020)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert 53: 6.000(3005)[0m | 
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 17: 5.000(2885)[0m | [32mExpert 19: 5.000(2891)[0m | 
[32mExpert 56: 5.000(3014)[0m | [32mExpert 25: 4.000(2912)[0m | [32mExpert 37: 4.000(2951)[0m | [32mExpert 40: 4.000(2963)[0m | 
[32mExpert 55: 4.000(3011)[0m | [32mExpert 59: 4.000(3023)[0m | [32mExpert  7: 3.000(3041)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 43: 3.000(2972)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert 52: 3.000(3002)[0m | 
[32mExpert 63: 3.000(3038)[0m | [32mExpert  5: 2.000(2993)[0m | [32mExpert 27: 2.000(2918)[0m | [32mExpert 28: 2.000(2921)[0m | 
[32mExpert 33: 2.000(2939)[0m | [32mExpert 47: 2.000(2984)[0m | [32mExpert 48: 2.000(2987)[0m | [32mExpert 62: 2.000(3035)[0m | 
[32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 12: 1.000(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3038, 2993, 2918, 2921, 2939, 2984, 2987, 3035, 3026, 3044, 2867, 2870]
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6,  8, 11, 12, 27, 28, 33, 47, 48, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:12.0 | [24]:4.0 | [36]:8.0 | [48]:5.0 | [63]:3.0 | [10]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[37]:3.0 | [42]:2.0 | [55]:3.0 | [56]:2.0 | [59]:6.0 | [31]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[12]:2.0 | [19]:6.0 | [25]:5.0 | [36]:2.0 | [43]:4.0 | [37]:5.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:6.0 | [14]:1.0 | [21]:6.0 | [45]:4.0 | [46]:2.0 | [5]:12.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[24]:2.0 | [25]:8.0 | [46]:2.0 | [48]:8.0 | [58]:3.0 | [27]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[11]:2.0 | [14]:4.0 | [49]:3.0 | [50]:6.0 | [60]:2.0 | [44]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[11, 14, 49, 50, 60, 44]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
[32mExpert 17: 10.000(4103)[0m | [32mExpert 30: 9.000(4148)[0m | [32mExpert  2: 8.000(4112)[0m | [32mExpert 10: 8.000(4082)[0m | 
[32mExpert 19: 8.000(4109)[0m | [32mExpert 43: 7.000(4190)[0m | [32mExpert 57: 6.000(4235)[0m | [32mExpert  1: 5.000(4079)[0m | 
[32mExpert 14: 5.000(4094)[0m | [32mExpert  9: 4.000(4265)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | 
[32mExpert 61: 4.000(4250)[0m | [32mExpert 21: 3.000(4118)[0m | [32mExpert 27: 3.000(4136)[0m | [32mExpert 56: 3.000(4232)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 23: 1.000(4124)[0m | 
[32mExpert 29: 1.000(4142)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 32: 1.000(4154)[0m | [32mExpert 38: 1.000(4172)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4205, 4214, 4217, 4229, 4076, 4178, 4091, 4124, 4142, 4151, 4154, 4172]
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 23, 29, 31, 32, 38, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[23]:3.0 | [29]:5.0 | [34]:2.0 | [44]:7.0 | [46]:3.0 | [8]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[3]:3.0 | [5]:3.0 | [19]:4.0 | [24]:2.0 | [54]:1.0 | [41]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[19]:9.0 | [23]:2.0 | [29]:2.0 | [32]:2.0 | [43]:8.0 | [56]:4.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E29 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[26]:8.0 | [39]:8.0 | [42]:7.0 | [46]:4.0 | [49]:4.0 | [33]:14.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[1]:1.0 | [22]:5.0 | [48]:3.0 | [61]:3.0 | [62]:6.0 | [60]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[20]:1.0 | [21]:6.0 | [35]:1.0 | [45]:5.0 | [52]:10.0 | [56]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[20, 21, 35, 45, 52, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[14]:7.0 | [31]:2.0 | [47]:2.0 | [50]:4.0 | [63]:12.0 | [54]:11.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[2]:4.0 | [25]:4.0 | [27]:5.0 | [32]:7.0 | [63]:7.0 | [11]:8.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[13]:9.0 | [26]:6.0 | [46]:5.0 | [50]:4.0 | [58]:2.0 | [44]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[15]:3.0 | [20]:5.0 | [35]:6.0 | [36]:6.0 | [58]:9.0 | [62]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[17]:6.0 | [27]:7.0 | [38]:8.0 | [51]:3.0 | [62]:6.0 | [60]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[1]:2.0 | [10]:10.0 | [36]:4.0 | [40]:8.0 | [58]:3.0 | [45]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[5]:6.0 | [25]:7.0 | [40]:12.0 | [59]:15.0 | [63]:3.0 | [33]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[6]:8.0 | [27]:5.0 | [45]:4.0 | [51]:12.0 | [59]:8.0 | [28]:10.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 6, 27, 45, 51, 59, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 14.000(2776)[0m | [32mExpert 16: 8.000(2644)[0m | [32mExpert 34: 8.000(2704)[0m | [32mExpert 11: 6.000(2629)[0m | 
[32mExpert 17: 6.000(2647)[0m | [32mExpert 28: 6.000(2683)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 37: 5.000(2713)[0m | 
[32mExpert 41: 5.000(2728)[0m | [32mExpert 57: 5.000(2779)[0m | [32mExpert 60: 5.000(2791)[0m | [32mExpert 51: 4.000(2761)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 27: 3.000(2680)[0m | [32mExpert 30: 3.000(2692)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert 59: 3.000(2785)[0m | [32mExpert  3: 2.000(2689)[0m | 
[32mExpert  5: 2.000(2755)[0m | [32mExpert 10: 2.000(2626)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 
[32mExpert 12: 1.000(2632)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 15: 1.000(2641)[0m | [32mExpert 33: 1.000(2701)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2755, 2626, 2653, 2671, 2707, 2716, 2620, 2656, 2632, 2635, 2641, 2701]
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  5, 10, 12, 13, 15, 19, 24, 33, 35, 38 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:9.0 | [22]:5.0 | [24]:5.0 | [61]:7.0 | [63]:3.0 | [34]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[7]:14.0 | [28]:7.0 | [32]:11.0 | [47]:4.0 | [48]:2.0 | [39]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[16]:9.0 | [28]:7.0 | [34]:9.0 | [56]:15.0 | [59]:4.0 | [10]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[21]:14.0 | [25]:5.0 | [43]:4.0 | [46]:3.0 | [57]:10.0 | [5]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[14]:11.0 | [17]:5.0 | [23]:11.0 | [44]:10.0 | [58]:4.0 | [2]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[5]:9.0 | [6]:9.0 | [23]:6.0 | [37]:8.0 | [45]:11.0 | [62]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 5,  6, 23, 37, 45, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 7.000(2864)[0m | [32mExpert 58: 7.000(3020)[0m | [32mExpert 19: 6.000(2891)[0m | [32mExpert 49: 6.000(2990)[0m | 
[32mExpert 53: 6.000(3005)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 17: 5.000(2885)[0m | 
[32mExpert 25: 5.000(2912)[0m | [32mExpert 37: 5.000(2951)[0m | [32mExpert 56: 5.000(3014)[0m | [32mExpert 40: 4.000(2963)[0m | 
[32mExpert 43: 4.000(2972)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 59: 4.000(3023)[0m | [32mExpert  7: 3.000(3041)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert 52: 3.000(3002)[0m | 
[32mExpert 63: 3.000(3038)[0m | [32mExpert  5: 2.000(2993)[0m | [32mExpert 12: 2.000(2870)[0m | [32mExpert 27: 2.000(2918)[0m | 
[32mExpert 28: 2.000(2921)[0m | [32mExpert 33: 2.000(2939)[0m | [32mExpert 36: 2.000(2948)[0m | [32mExpert 47: 2.000(2984)[0m | 
[32mExpert 48: 2.000(2987)[0m | [32mExpert 62: 2.000(3035)[0m | [32mExpert  6: 1.000(3026)[0m | [32mExpert  8: 1.000(3044)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3038, 2993, 2870, 2918, 2921, 2939, 2948, 2984, 2987, 3035, 3026, 3044]
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6,  8, 12, 27, 28, 33, 36, 47, 48, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:13.0 | [14]:5.0 | [47]:8.0 | [48]:6.0 | [56]:3.0 | [22]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[7]:4.0 | [27]:4.0 | [41]:2.0 | [47]:6.0 | [49]:11.0 | [59]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[10]:8.0 | [24]:2.0 | [37]:6.0 | [40]:5.0 | [58]:8.0 | [47]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[8]:9.0 | [21]:7.0 | [37]:6.0 | [49]:4.0 | [60]:7.0 | [53]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[3]:7.0 | [5]:7.0 | [13]:6.0 | [23]:8.0 | [48]:9.0 | [45]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[2]:5.0 | [22]:6.0 | [36]:5.0 | [52]:6.0 | [58]:5.0 | [50]:7.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 2, 22, 36, 52, 58, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
[32mExpert 17: 10.000(4103)[0m | [32mExpert 19: 9.000(4109)[0m | [32mExpert 30: 9.000(4148)[0m | [32mExpert  2: 8.000(4112)[0m | 
[32mExpert 10: 8.000(4082)[0m | [32mExpert 43: 8.000(4190)[0m | [32mExpert 57: 6.000(4235)[0m | [32mExpert  1: 5.000(4079)[0m | 
[32mExpert 14: 5.000(4094)[0m | [32mExpert  9: 4.000(4265)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | 
[32mExpert 56: 4.000(4232)[0m | [32mExpert 61: 4.000(4250)[0m | [32mExpert 21: 3.000(4118)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 23: 2.000(4124)[0m | [32mExpert 29: 2.000(4142)[0m | 
[32mExpert 32: 2.000(4154)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert  0: 1.000(4076)[0m | 
[32mExpert  4: 1.000(4178)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 38: 1.000(4172)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4154, 4169, 4199, 4205, 4214, 4217, 4229, 4076, 4178, 4091, 4151, 4172]
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 31, 32, 37, 38, 46, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[3]:8.0 | [29]:6.0 | [31]:9.0 | [44]:8.0 | [53]:7.0 | [2]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[5]:4.0 | [6]:9.0 | [29]:8.0 | [41]:10.0 | [53]:9.0 | [46]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[2]:9.0 | [19]:10.0 | [30]:10.0 | [43]:9.0 | [56]:5.0 | [10]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[2]:8.0 | [4]:6.0 | [5]:9.0 | [33]:15.0 | [44]:6.0 | [3]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:9.0 | [8]:2.0 | [19]:6.0 | [35]:5.0 | [62]:7.0 | [60]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[8]:10.0 | [10]:13.0 | [33]:8.0 | [48]:3.0 | [56]:3.0 | [52]:11.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 8, 10, 33, 48, 56, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[14]:8.0 | [25]:7.0 | [38]:7.0 | [62]:7.0 | [63]:13.0 | [41]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[8]:6.0 | [20]:8.0 | [45]:6.0 | [49]:7.0 | [59]:5.0 | [11]:9.0 | 
---------------------------------------
return iEAM
8å°æ—¶EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[15]:5.0 | [18]:5.0 | [19]:5.0 | [33]:7.0 | [59]:7.0 | [39]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[1]:5.0 | [25]:4.0 | [29]:7.0 | [38]:10.0 | [58]:10.0 | [49]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[8]:2.0 | [12]:7.0 | [26]:6.0 | [27]:8.0 | [38]:9.0 | [34]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[0]:7.0 | [5]:3.0 | [19]:2.0 | [40]:9.0 | [58]:4.0 | [55]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[4]:5.0 | [26]:2.0 | [33]:5.0 | [40]:13.0 | [59]:16.0 | [25]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[25]:4.0 | [28]:11.0 | [51]:13.0 | [57]:4.0 | [59]:9.0 | [31]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[25, 28, 51, 57, 59, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 15.000(2776)[0m | [32mExpert 16: 9.000(2644)[0m | [32mExpert 34: 9.000(2704)[0m | [32mExpert 28: 7.000(2683)[0m | 
[32mExpert 11: 6.000(2629)[0m | [32mExpert 17: 6.000(2647)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 37: 5.000(2713)[0m | 
[32mExpert 41: 5.000(2728)[0m | [32mExpert 57: 5.000(2779)[0m | [32mExpert 60: 5.000(2791)[0m | [32mExpert 51: 4.000(2761)[0m | 
[32mExpert 59: 4.000(2785)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 10: 3.000(2626)[0m | [32mExpert 27: 3.000(2680)[0m | 
[32mExpert 30: 3.000(2692)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert 53: 3.000(2767)[0m | 
[32mExpert  3: 2.000(2689)[0m | [32mExpert  5: 2.000(2755)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 
[32mExpert 12: 1.000(2632)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 15: 1.000(2641)[0m | [32mExpert 33: 1.000(2701)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2689, 2755, 2653, 2671, 2707, 2716, 2620, 2656, 2632, 2635, 2641, 2701]
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3,  5, 12, 13, 15, 19, 24, 33, 35, 38 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[22]:6.0 | [24]:6.0 | [60]:5.0 | [61]:8.0 | [63]:4.0 | [2]:11.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:11.0 | [7]:15.0 | [32]:12.0 | [44]:11.0 | [48]:3.0 | [24]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[5]:3.0 | [11]:7.0 | [28]:8.0 | [34]:10.0 | [56]:16.0 | [57]:6.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[5]:8.0 | [21]:15.0 | [43]:5.0 | [45]:2.0 | [57]:11.0 | [16]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[14]:12.0 | [23]:12.0 | [41]:6.0 | [44]:11.0 | [52]:2.0 | [30]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[3]:4.0 | [6]:10.0 | [8]:2.0 | [16]:5.0 | [22]:3.0 | [35]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 3,  6,  8, 16, 22, 35]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 8.000(2864)[0m | [32mExpert 58: 8.000(3020)[0m | [32mExpert 19: 6.000(2891)[0m | [32mExpert 37: 6.000(2951)[0m | 
[32mExpert 49: 6.000(2990)[0m | [32mExpert 53: 6.000(3005)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | 
[32mExpert 17: 5.000(2885)[0m | [32mExpert 25: 5.000(2912)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert 56: 5.000(3014)[0m | 
[32mExpert 43: 4.000(2972)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 59: 4.000(3023)[0m | [32mExpert  7: 3.000(3041)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 47: 3.000(2984)[0m | [32mExpert 50: 3.000(2996)[0m | 
[32mExpert 52: 3.000(3002)[0m | [32mExpert 63: 3.000(3038)[0m | [32mExpert  5: 2.000(2993)[0m | [32mExpert 12: 2.000(2870)[0m | 
[32mExpert 24: 2.000(2909)[0m | [32mExpert 27: 2.000(2918)[0m | [32mExpert 28: 2.000(2921)[0m | [32mExpert 33: 2.000(2939)[0m | 
[32mExpert 36: 2.000(2948)[0m | [32mExpert 48: 2.000(2987)[0m | [32mExpert 62: 2.000(3035)[0m | [32mExpert  6: 1.000(3026)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 3038, 2993, 2870, 2909, 2918, 2921, 2939, 2948, 2987, 3035, 3026]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6, 12, 24, 27, 28, 33, 36, 48, 52, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:14.0 | [30]:6.0 | [39]:5.0 | [61]:4.0 | [63]:4.0 | [47]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[23]:3.0 | [26]:3.0 | [41]:3.0 | [52]:3.0 | [59]:8.0 | [16]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[12]:3.0 | [14]:2.0 | [37]:7.0 | [39]:2.0 | [62]:3.0 | [51]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:13.0 | [19]:6.0 | [21]:8.0 | [45]:5.0 | [50]:4.0 | [37]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[5]:8.0 | [9]:4.0 | [25]:9.0 | [46]:3.0 | [48]:10.0 | [8]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[12]:5.0 | [14]:5.0 | [41]:3.0 | [44]:2.0 | [60]:3.0 | [16]:1.0 | EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4172
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1341,260000002b] (16MB) STATE(0) TENSOR[4171,4172,4170,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[12, 14, 41, 44, 60, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 10.000(4103)[0m | [32mExpert 19: 10.000(4109)[0m | [32mExpert 30: 10.000(4148)[0m | [32mExpert  2: 9.000(4112)[0m | 
[32mExpert 10: 9.000(4082)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 57: 6.000(4235)[0m | [32mExpert  1: 5.000(4079)[0m | 
[32mExpert 14: 5.000(4094)[0m | [32mExpert 56: 5.000(4232)[0m | [32mExpert  9: 4.000(4265)[0m | [32mExpert 35: 4.000(4163)[0m | 
[32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 4.000(4250)[0m | [32mExpert 21: 3.000(4118)[0m | [32mExpert 27: 3.000(4136)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 23: 2.000(4124)[0m | [32mExpert 29: 2.000(4142)[0m | 
[32mExpert 32: 2.000(4154)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert  0: 1.000(4076)[0m | 
[32mExpert  4: 1.000(4178)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 38: 1.000(4172)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4154, 4169, 4199, 4205, 4214, 4217, 4229, 4076, 4178, 4091, 4151, 4172]
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4172[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 31, 32, 37, 38, 46, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[22]:5.0 | [29]:7.0 | [36]:2.0 | [44]:9.0 | [46]:4.0 | [19]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[3]:4.0 | [5]:5.0 | [24]:3.0 | [34]:4.0 | [54]:2.0 | [51]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[17]:11.0 | [19]:11.0 | [23]:3.0 | [24]:1.0 | [26]:1.0 | [21]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[2]:9.0 | [19]:2.0 | [20]:2.0 | [26]:9.0 | [42]:8.0 | [5]:10.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[1]:2.0 | [11]:2.0 | [27]:4.0 | [45]:11.0 | [62]:8.0 | [29]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[4]:4.0 | [20]:2.0 | [21]:7.0 | [45]:6.0 | [52]:12.0 | [57]:5.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 4, 20, 21, 45, 52, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:1.0 | [14]:9.0 | [47]:3.0 | [61]:2.0 | [63]:14.0 | [54]:12.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[2]:5.0 | [21]:2.0 | [25]:5.0 | [27]:6.0 | [63]:8.0 | [32]:8.0 | 
---------------------------------------
return iEAM
å¯EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[12]:5.0 | [25]:2.0 | [42]:2.0 | [62]:2.0 | [63]:2.0 | [43]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[5]:1.0 | [15]:4.0 | [16]:3.0 | [25]:5.0 | [34]:2.0 | [47]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[6]:4.0 | [16]:2.0 | [26]:7.0 | [30]:1.0 | [52]:1.0 | [34]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[8]:1.0 | [23]:1.0 | [38]:3.0 | [44]:2.0 | [57]:1.0 | [2]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[14]:6.0 | [26]:3.0 | [51]:1.0 | [52]:2.0 | [62]:1.0 | [33]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[0]:2.0 | [10]:1.0 | [52]:2.0 | [54]:2.0 | [61]:2.0 | [22]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 0, 10, 52, 54, 61, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 16.000(2776)[0m | [32mExpert 34: 10.000(2704)[0m | [32mExpert 16: 9.000(2644)[0m | [32mExpert 28: 8.000(2683)[0m | 
[32mExpert 11: 7.000(2629)[0m | [32mExpert 17: 6.000(2647)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 57: 6.000(2779)[0m | 
[32mExpert 37: 5.000(2713)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 60: 5.000(2791)[0m | [32mExpert 51: 4.000(2761)[0m | 
[32mExpert 59: 4.000(2785)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert  5: 3.000(2755)[0m | [32mExpert 10: 3.000(2626)[0m | 
[32mExpert 27: 3.000(2680)[0m | [32mExpert 30: 3.000(2692)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 48: 3.000(2749)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 
[32mExpert 12: 1.000(2632)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 15: 1.000(2641)[0m | [32mExpert 33: 1.000(2701)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2767, 2689, 2653, 2671, 2707, 2716, 2620, 2656, 2632, 2635, 2641, 2701]
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 12, 13, 15, 19, 24, 33, 35, 38, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[24]:7.0 | [30]:2.0 | [45]:2.0 | [48]:3.0 | [51]:1.0 | [35]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[17]:4.0 | [19]:1.0 | [26]:8.0 | [40]:3.0 | [60]:1.0 | [4]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[5]:4.0 | [17]:7.0 | [30]:4.0 | [52]:2.0 | [57]:7.0 | [25]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[4]:2.0 | [5]:9.0 | [33]:7.0 | [48]:1.0 | [62]:1.0 | [47]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[6]:1.0 | [22]:2.0 | [41]:7.0 | [57]:2.0 | [59]:4.0 | [61]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[6]:11.0 | [17]:1.0 | [51]:3.0 | [57]:3.0 | [59]:2.0 | [16]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 6, 17, 51, 57, 59, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 8.000(2864)[0m | [32mExpert 58: 8.000(3020)[0m | [32mExpert 37: 7.000(2951)[0m | [32mExpert 19: 6.000(2891)[0m | 
[32mExpert 49: 6.000(2990)[0m | [32mExpert 53: 6.000(3005)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | 
[32mExpert 17: 5.000(2885)[0m | [32mExpert 25: 5.000(2912)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert 56: 5.000(3014)[0m | 
[32mExpert 43: 4.000(2972)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 59: 4.000(3023)[0m | [32mExpert  7: 3.000(3041)[0m | 
[32mExpert 12: 3.000(2870)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 47: 3.000(2984)[0m | 
[32mExpert 50: 3.000(2996)[0m | [32mExpert 52: 3.000(3002)[0m | [32mExpert 62: 3.000(3035)[0m | [32mExpert 63: 3.000(3038)[0m | 
[32mExpert  5: 2.000(2993)[0m | [32mExpert 14: 2.000(2876)[0m | [32mExpert 24: 2.000(2909)[0m | [32mExpert 27: 2.000(2918)[0m | 
[32mExpert 28: 2.000(2921)[0m | [32mExpert 33: 2.000(2939)[0m | [32mExpert 36: 2.000(2948)[0m | [32mExpert 39: 2.000(2957)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 3002, 3035, 3038, 2993, 2876, 2909, 2918, 2921, 2939, 2948, 2957]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 14, 24, 27, 28, 33, 36, 39, 50, 52, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[4]:3.0 | [5]:15.0 | [28]:3.0 | [34]:2.0 | [43]:2.0 | [27]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[24]:3.0 | [27]:5.0 | [47]:7.0 | [54]:3.0 | [59]:9.0 | [19]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[31]:2.0 | [38]:1.0 | [45]:1.0 | [62]:4.0 | [63]:4.0 | [7]:4.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E63 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[0]:2.0 | [3]:1.0 | [30]:4.0 | [37]:8.0 | [62]:2.0 | [47]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[5]:9.0 | [9]:5.0 | [33]:1.0 | [38]:7.0 | [44]:2.0 | [8]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[2]:6.0 | [31]:2.0 | [32]:8.0 | [45]:1.0 | [50]:8.0 | [30]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 2, 31, 32, 45, 50, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 11.000(4103)[0m | EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
[32mExpert 19: 11.000(4109)[0m | [32mExpert 30: 10.000(4148)[0m | [32mExpert  2: 9.000(4112)[0m | 
[32mExpert 10: 9.000(4082)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 57: 6.000(4235)[0m | [32mExpert  1: 5.000(4079)[0m | 
[32mExpert 14: 5.000(4094)[0m | [32mExpert 56: 5.000(4232)[0m | [32mExpert  9: 4.000(4265)[0m | [32mExpert 21: 4.000(4118)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 4.000(4250)[0m | [32mExpert 23: 3.000(4124)[0m | 
[32mExpert 27: 3.000(4136)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 29: 2.000(4142)[0m | 
[32mExpert 32: 2.000(4154)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert  0: 1.000(4076)[0m | 
[32mExpert  4: 1.000(4178)[0m | [32mExpert 13: 1.000(4091)[0m | [32mExpert 24: 1.000(4127)[0m | [32mExpert 26: 1.000(4133)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4154, 4169, 4199, 4205, 4214, 4217, 4229, 4076, 4178, 4091, 4127, 4133]
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 13, 24, 26, 32, 37, 46, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:5.0 | [19]:3.0 | [28]:2.0 | [36]:3.0 | [53]:8.0 | [35]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[5]:6.0 | [34]:5.0 | [41]:11.0 | [58]:1.0 | [63]:1.0 | [31]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[7]:1.0 | [15]:1.0 | [19]:12.0 | [24]:2.0 | [30]:11.0 | [10]:10.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E24 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[15]:2.0 | [26]:10.0 | [33]:16.0 | [52]:2.0 | [56]:1.0 | [5]:11.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[1]:3.0 | [8]:3.0 | [21]:2.0 | [37]:1.0 | [59]:5.0 | [62]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[4]:5.0 | [21]:8.0 | [24]:2.0 | [29]:3.0 | [57]:6.0 | [20]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 4, 21, 24, 29, 57, 20]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[0]:1.0 | [8]:1.0 | [15]:2.0 | [47]:4.0 | [56]:1.0 | [30]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[2]:6.0 | [4]:2.0 | [21]:3.0 | [22]:2.0 | [52]:2.0 | [33]:1.0 | 
---------------------------------------
return iEAM
ç”Ÿäº§EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2641
[1m[33mEnqueueTask: [0m[32mTask: node: ID[538,f00000013] (16MB) STATE(0) TENSOR[2640,2641,2639,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[10]:2.0 | [17]:7.0 | [21]:2.0 | [33]:8.0 | [59]:8.0 | [40]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[9]:2.0 | [16]:4.0 | [24]:2.0 | [32]:1.0 | [39]:2.0 | [56]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[25]:2.0 | [26]:8.0 | [34]:8.0 | [59]:3.0 | [61]:2.0 | [2]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[20]:2.0 | [31]:2.0 | [43]:2.0 | [50]:3.0 | [61]:4.0 | [44]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[7]:2.0 | [14]:7.0 | [22]:2.0 | [45]:1.0 | [51]:2.0 | [59]:17.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[7]:2.0 | [30]:3.0 | [44]:2.0 | [52]:3.0 | [61]:3.0 | [42]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 7, 30, 44, 52, 61, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 16.000(2776)[0m | [32mExpert 34: 10.000(2704)[0m | [32mExpert 16: 9.000(2644)[0m | [32mExpert 28: 8.000(2683)[0m | 
[32mExpert 11: 7.000(2629)[0m | [32mExpert 17: 7.000(2647)[0m | [32mExpert 57: 7.000(2779)[0m | [32mExpert 46: 6.000(2743)[0m | 
[32mExpert 37: 5.000(2713)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 60: 5.000(2791)[0m | [32mExpert  5: 4.000(2755)[0m | 
[32mExpert 30: 4.000(2692)[0m | [32mExpert 51: 4.000(2761)[0m | [32mExpert 59: 4.000(2785)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 10: 3.000(2626)[0m | [32mExpert 27: 3.000(2680)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 48: 3.000(2749)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 38: 2.000(2716)[0m | [32mExpert 52: 2.000(2764)[0m | [32mExpert  0: 1.000(2620)[0m | 
[32mExpert  2: 1.000(2656)[0m | [32mExpert 12: 1.000(2632)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 15: 1.000(2641)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2767, 2689, 2653, 2671, 2707, 2716, 2764, 2620, 2656, 2632, 2635, 2641]
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2641[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 12, 13, 15, 19, 24, 35, 38, 52, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:3.0 | [1]:5.0 | [2]:12.0 | [35]:4.0 | [48]:4.0 | [51]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:12.0 | [7]:16.0 | [19]:2.0 | [24]:8.0 | [37]:5.0 | [29]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[17]:8.0 | [36]:2.0 | [38]:3.0 | [52]:3.0 | [56]:17.0 | [59]:5.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E38 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[3]:3.0 | [6]:1.0 | [21]:16.0 | [33]:8.0 | [52]:2.0 | [12]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[5]:3.0 | [12]:1.0 | [21]:2.0 | [53]:5.0 | [57]:3.0 | [14]:13.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[1]:2.0 | [5]:10.0 | [6]:12.0 | [20]:2.0 | [54]:3.0 | [45]:12.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 1,  5,  6, 20, 54, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 8.000(2864)[0m | [32mExpert 58: 8.000(3020)[0m | [32mExpert 37: 7.000(2951)[0m | [32mExpert 19: 6.000(2891)[0m | 
[32mExpert 49: 6.000(2990)[0m | [32mExpert 53: 6.000(3005)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | 
[32mExpert 17: 5.000(2885)[0m | [32mExpert 25: 5.000(2912)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert 56: 5.000(3014)[0m | 
[32mExpert  7: 4.000(3041)[0m | [32mExpert 43: 4.000(2972)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 59: 4.000(3023)[0m | 
[32mExpert 62: 4.000(3035)[0m | [32mExpert 63: 4.000(3038)[0m | [32mExpert 12: 3.000(2870)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 47: 3.000(2984)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert 52: 3.000(3002)[0m | 
[32mExpert  5: 2.000(2993)[0m | [32mExpert 14: 2.000(2876)[0m | [32mExpert 24: 2.000(2909)[0m | [32mExpert 27: 2.000(2918)[0m | 
[32mExpert 28: 2.000(2921)[0m | [32mExpert 31: 2.000(2933)[0m | [32mExpert 33: 2.000(2939)[0m | [32mExpert 36: 2.000(2948)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2915, 2984, 2996, 3002, 2993, 2876, 2909, 2918, 2921, 2933, 2939, 2948]
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 14, 24, 26, 27, 28, 31, 33, 36, 47, 50, 52 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[7]:1.0 | [13]:2.0 | [30]:7.0 | [38]:2.0 | [39]:6.0 | [63]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[16]:4.0 | [35]:2.0 | [45]:2.0 | [51]:7.0 | [59]:10.0 | [54]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[1]:1.0 | [38]:2.0 | [52]:4.0 | [53]:7.0 | [59]:5.0 | [25]:6.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:14.0 | [23]:2.0 | [30]:5.0 | [47]:4.0 | [60]:8.0 | [37]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[11]:2.0 | [21]:2.0 | [25]:10.0 | [39]:3.0 | [54]:2.0 | [43]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[8]:5.0 | [33]:2.0 | [47]:3.0 | [50]:9.0 | [54]:2.0 | [7]:2.0 | 
---------------------------------------
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
return iEAM
Begin prefetch18 topk= tensor([[ 8, 33, 47, 50, 54,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 19: 12.000(4109)[0m | [32mExpert 17: 11.000(4103)[0m | [32mExpert 30: 11.000(4148)[0m | [32mExpert 10: 10.000(4082)[0m | 
[32mExpert  2: 9.000(4112)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 57: 6.000(4235)[0m | [32mExpert  1: 5.000(4079)[0m | 
[32mExpert 14: 5.000(4094)[0m | [32mExpert 56: 5.000(4232)[0m | [32mExpert  9: 4.000(4265)[0m | [32mExpert 21: 4.000(4118)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 4.000(4250)[0m | [32mExpert 23: 3.000(4124)[0m | 
[32mExpert 27: 3.000(4136)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 24: 2.000(4127)[0m | 
[32mExpert 29: 2.000(4142)[0m | [32mExpert 32: 2.000(4154)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert  7: 1.000(4259)[0m | [32mExpert 13: 1.000(4091)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4142, 4154, 4169, 4199, 4205, 4214, 4217, 4229, 4076, 4178, 4259, 4091]
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4,  7, 13, 29, 32, 37, 46, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[18]:2.0 | [22]:6.0 | [34]:3.0 | [53]:9.0 | [59]:3.0 | [31]:10.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[5]:7.0 | [12]:2.0 | [14]:2.0 | [33]:1.0 | [36]:8.0 | [53]:10.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[19]:13.0 | [21]:5.0 | [56]:6.0 | [57]:7.0 | [59]:1.0 | [17]:12.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[18]:1.0 | [26]:11.0 | [33]:17.0 | [46]:5.0 | [55]:2.0 | [44]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[3]:7.0 | [9]:2.0 | [21]:3.0 | [35]:6.0 | [62]:10.0 | [0]:10.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[4]:6.0 | [20]:4.0 | [21]:9.0 | [24]:3.0 | [54]:1.0 | [61]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 4, 20, 21, 24, 54, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[22]:2.0 | [38]:8.0 | [47]:5.0 | [51]:2.0 | [54]:13.0 | [5]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[6]:4.0 | [11]:10.0 | [20]:9.0 | [57]:8.0 | [60]:2.0 | [42]:3.0 | 
---------------------------------------
return iEAM
å¤šå°‘EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:3.0 | [5]:1.0 | [9]:3.0 | [44]:2.0 | [63]:3.0 | [17]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[3]:3.0 | [12]:1.0 | [17]:6.0 | [25]:6.0 | [58]:11.0 | [5]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[4]:2.0 | [12]:8.0 | [26]:9.0 | [33]:4.0 | [53]:1.0 | [6]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[7]:2.0 | [8]:2.0 | [44]:4.0 | [47]:9.0 | [61]:5.0 | [54]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[14]:8.0 | [51]:3.0 | [55]:1.0 | [59]:18.0 | [62]:2.0 | [57]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[8]:3.0 | [25]:5.0 | [30]:4.0 | [40]:1.0 | [52]:4.0 | [48]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 8, 25, 30, 40, 52, 48]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 17.000(2776)[0m | [32mExpert 34: 10.000(2704)[0m | [32mExpert 16: 9.000(2644)[0m | [32mExpert 17: 8.000(2647)[0m | 
[32mExpert 28: 8.000(2683)[0m | [32mExpert 11: 7.000(2629)[0m | [32mExpert 57: 7.000(2779)[0m | [32mExpert 46: 6.000(2743)[0m | 
[32mExpert 37: 5.000(2713)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 59: 5.000(2785)[0m | [32mExpert 60: 5.000(2791)[0m | 
[32mExpert  5: 4.000(2755)[0m | [32mExpert 30: 4.000(2692)[0m | [32mExpert 51: 4.000(2761)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 10: 3.000(2626)[0m | [32mExpert 27: 3.000(2680)[0m | [32mExpert 38: 3.000(2716)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert 52: 3.000(2764)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert  3: 2.000(2689)[0m | 
[32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 36: 2.000(2710)[0m | 
[32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert 12: 1.000(2632)[0m | [32mExpert 13: 1.000(2635)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2749, 2764, 2767, 2689, 2653, 2671, 2707, 2710, 2620, 2656, 2632, 2635]
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 12, 13, 19, 24, 35, 36, 48, 52, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[2]:13.0 | [14]:9.0 | [33]:1.0 | [35]:5.0 | [45]:3.0 | [36]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:13.0 | [7]:17.0 | [17]:5.0 | [19]:3.0 | [37]:6.0 | [22]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[11]:8.0 | [28]:9.0 | [34]:11.0 | [37]:6.0 | [56]:18.0 | [27]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[4]:3.0 | [21]:17.0 | [28]:1.0 | [31]:4.0 | [33]:9.0 | [38]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[14]:14.0 | [30]:5.0 | [41]:8.0 | [56]:1.0 | [57]:4.0 | [59]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[6]:13.0 | [20]:3.0 | [37]:9.0 | [57]:4.0 | [62]:3.0 | [53]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 6, 20, 37, 57, 62, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 8.000(2864)[0m | [32mExpert 58: 8.000(3020)[0m | [32mExpert 37: 7.000(2951)[0m | [32mExpert 53: 7.000(3005)[0m | 
[32mExpert 19: 6.000(2891)[0m | [32mExpert 25: 6.000(2912)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert  0: 5.000(2858)[0m | 
[32mExpert 16: 5.000(2882)[0m | [32mExpert 17: 5.000(2885)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert 56: 5.000(3014)[0m | 
[32mExpert 59: 5.000(3023)[0m | [32mExpert  7: 4.000(3041)[0m | [32mExpert 43: 4.000(2972)[0m | [32mExpert 52: 4.000(3002)[0m | 
[32mExpert 55: 4.000(3011)[0m | [32mExpert 62: 4.000(3035)[0m | [32mExpert 63: 4.000(3038)[0m | [32mExpert 12: 3.000(2870)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 47: 3.000(2984)[0m | [32mExpert 50: 3.000(2996)[0m | 
[32mExpert  5: 2.000(2993)[0m | [32mExpert 14: 2.000(2876)[0m | [32mExpert 24: 2.000(2909)[0m | [32mExpert 27: 2.000(2918)[0m | 
[32mExpert 28: 2.000(2921)[0m | [32mExpert 31: 2.000(2933)[0m | [32mExpert 33: 2.000(2939)[0m | [32mExpert 36: 2.000(2948)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2879, 2915, 2984, 2996, 2993, 2876, 2909, 2918, 2921, 2933, 2939, 2948]
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 14, 15, 24, 26, 27, 28, 31, 33, 36, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[0]:1.0 | [5]:16.0 | [22]:6.0 | [48]:7.0 | [63]:6.0 | [14]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[6]:5.0 | [32]:6.0 | [49]:12.0 | [51]:8.0 | [52]:4.0 | [47]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[10]:9.0 | [38]:3.0 | [46]:2.0 | [52]:5.0 | [63]:5.0 | [14]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E14 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[3]:2.0 | [8]:10.0 | [21]:9.0 | [40]:4.0 | [47]:5.0 | [60]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[9]:6.0 | [35]:5.0 | [37]:1.0 | [38]:8.0 | [39]:4.0 | [29]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[13]:6.0 | [19]:1.0 | [47]:4.0 | [52]:7.0 | [58]:6.0 | [2]:7.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[13, 19, 47, 52, 58,  2]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 19: 13.000(4109)[0m | [32mExpert 17: 12.000(4103)[0m | [32mExpert 30: 11.000(4148)[0m | [32mExpert 10: 10.000(4082)[0m | 
[32mExpert  2: 9.000(4112)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 57: 7.000(4235)[0m | EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
[32mExpert 56: 6.000(4232)[0m | 
[32mExpert  1: 5.000(4079)[0m | [32mExpert 14: 5.000(4094)[0m | [32mExpert 21: 5.000(4118)[0m | [32mExpert  9: 4.000(4265)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 4.000(4250)[0m | [32mExpert 23: 3.000(4124)[0m | 
[32mExpert 27: 3.000(4136)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 24: 2.000(4127)[0m | 
[32mExpert 29: 2.000(4142)[0m | [32mExpert 32: 2.000(4154)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert  7: 1.000(4259)[0m | [32mExpert 13: 1.000(4091)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4142, 4154, 4169, 4199, 4205, 4214, 4217, 4229, 4076, 4178, 4259, 4091]
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4,  7, 13, 29, 32, 37, 46, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:6.0 | [6]:6.0 | [16]:7.0 | [22]:7.0 | [31]:11.0 | [42]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[5]:8.0 | [6]:10.0 | [13]:3.0 | [36]:9.0 | [43]:9.0 | [45]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[2]:10.0 | [17]:13.0 | [21]:6.0 | [56]:7.0 | [61]:5.0 | [1]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[2]:10.0 | [4]:7.0 | [33]:18.0 | [42]:9.0 | [44]:8.0 | [3]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[0]:11.0 | [21]:4.0 | [26]:1.0 | [35]:7.0 | [56]:7.0 | [12]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[8]:11.0 | [10]:14.0 | [20]:5.0 | [26]:1.0 | [30]:4.0 | [33]:9.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 8, 10, 20, 26, 30, 33]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[11]:1.0 | [25]:8.0 | [38]:9.0 | [48]:4.0 | [62]:8.0 | [52]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[8]:7.0 | [44]:2.0 | [45]:7.0 | [49]:8.0 | [61]:1.0 | [57]:9.0 | 
---------------------------------------
return iEAM
é›¶ä»¶EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:2.0 | [33]:9.0 | [41]:2.0 | [59]:9.0 | [61]:3.0 | [15]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[1]:6.0 | [20]:6.0 | [29]:8.0 | [38]:11.0 | [45]:6.0 | [30]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[20]:3.0 | [33]:5.0 | [34]:9.0 | [43]:4.0 | [59]:4.0 | [36]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[2]:3.0 | [7]:3.0 | [32]:7.0 | [55]:4.0 | [62]:4.0 | [24]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[5]:7.0 | [34]:5.0 | [47]:2.0 | [57]:4.0 | [59]:19.0 | [55]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[3]:4.0 | [28]:12.0 | [29]:3.0 | [47]:1.0 | [48]:4.0 | [27]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 3, 28, 29, 47, 48, 27]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 18.000(2776)[0m | [32mExpert 34: 11.000(2704)[0m | [32mExpert 16: 9.000(2644)[0m | [32mExpert 28: 9.000(2683)[0m | 
[32mExpert 11: 8.000(2629)[0m | [32mExpert 17: 8.000(2647)[0m | [32mExpert 57: 7.000(2779)[0m | [32mExpert 37: 6.000(2713)[0m | 
[32mExpert 46: 6.000(2743)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 59: 5.000(2785)[0m | [32mExpert 60: 5.000(2791)[0m | 
[32mExpert  5: 4.000(2755)[0m | [32mExpert 27: 4.000(2680)[0m | [32mExpert 30: 4.000(2692)[0m | [32mExpert 51: 4.000(2761)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 10: 3.000(2626)[0m | [32mExpert 38: 3.000(2716)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert 52: 3.000(2764)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert  3: 2.000(2689)[0m | 
[32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 36: 2.000(2710)[0m | 
[32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert 12: 1.000(2632)[0m | [32mExpert 13: 1.000(2635)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2749, 2764, 2767, 2689, 2653, 2671, 2707, 2710, 2620, 2656, 2632, 2635]
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 12, 13, 19, 24, 35, 36, 48, 52, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[2]:14.0 | [7]:4.0 | [35]:6.0 | [45]:4.0 | [49]:5.0 | [34]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[1]:14.0 | [7]:18.0 | [17]:6.0 | [24]:9.0 | [37]:7.0 | [44]:12.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[11]:9.0 | [12]:2.0 | [34]:12.0 | [51]:5.0 | [56]:19.0 | [31]:1.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[21]:18.0 | [33]:10.0 | [34]:3.0 | [47]:2.0 | [58]:2.0 | [49]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[13]:4.0 | [16]:3.0 | [29]:8.0 | [40]:9.0 | [57]:5.0 | [14]:15.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[5]:11.0 | [16]:7.0 | [31]:2.0 | [62]:4.0 | [63]:5.0 | [33]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 5, 16, 31, 62, 63, 33]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 9.000(2864)[0m | [32mExpert 58: 8.000(3020)[0m | [32mExpert 37: 7.000(2951)[0m | [32mExpert 53: 7.000(3005)[0m | 
[32mExpert 19: 6.000(2891)[0m | [32mExpert 25: 6.000(2912)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert  0: 5.000(2858)[0m | 
[32mExpert 16: 5.000(2882)[0m | [32mExpert 17: 5.000(2885)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert 52: 5.000(3002)[0m | 
[32mExpert 56: 5.000(3014)[0m | [32mExpert 59: 5.000(3023)[0m | [32mExpert 63: 5.000(3038)[0m | [32mExpert  7: 4.000(3041)[0m | 
[32mExpert 43: 4.000(2972)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 62: 4.000(3035)[0m | [32mExpert 12: 3.000(2870)[0m | 
[32mExpert 14: 3.000(2876)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 38: 3.000(2954)[0m | 
[32mExpert 47: 3.000(2984)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert  5: 2.000(2993)[0m | [32mExpert 24: 2.000(2909)[0m | 
[32mExpert 27: 2.000(2918)[0m | [32mExpert 28: 2.000(2921)[0m | [32mExpert 31: 2.000(2933)[0m | [32mExpert 33: 2.000(2939)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2876, 2879, 2915, 2954, 2984, 2996, 2993, 2909, 2918, 2921, 2933, 2939]
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 14, 15, 24, 26, 27, 28, 31, 33, 38, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:17.0 | [24]:5.0 | [35]:4.0 | [36]:9.0 | [63]:7.0 | [45]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[47]:9.0 | [48]:4.0 | [52]:5.0 | [55]:4.0 | [59]:11.0 | [31]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[25]:7.0 | [27]:3.0 | [36]:3.0 | [38]:4.0 | [43]:5.0 | [63]:6.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E38 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:7.0 | [30]:6.0 | [56]:2.0 | [60]:10.0 | [63]:4.0 | [5]:15.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[7]:2.0 | [27]:6.0 | [48]:11.0 | [58]:4.0 | [61]:1.0 | [24]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[2]:8.0 | [5]:2.0 | [10]:3.0 | [35]:1.0 | [47]:5.0 | [49]:4.0 | EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20

---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 2,  5, 10, 35, 47, 49]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 13.000(4103)[0m | [32mExpert 19: 13.000(4109)[0m | [32mExpert 30: 11.000(4148)[0m | [32mExpert  2: 10.000(4112)[0m | 
[32mExpert 10: 10.000(4082)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 56: 7.000(4232)[0m | [32mExpert 57: 7.000(4235)[0m | 
[32mExpert  1: 6.000(4079)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 14: 5.000(4094)[0m | [32mExpert 61: 5.000(4250)[0m | 
[32mExpert  9: 4.000(4265)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 23: 3.000(4124)[0m | 
[32mExpert 27: 3.000(4136)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 24: 2.000(4127)[0m | 
[32mExpert 29: 2.000(4142)[0m | [32mExpert 32: 2.000(4154)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | 
[32mExpert 48: 2.000(4205)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert  7: 1.000(4259)[0m | [32mExpert 13: 1.000(4091)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4142, 4154, 4169, 4199, 4205, 4214, 4217, 4229, 4076, 4178, 4259, 4091]
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4,  7, 13, 29, 32, 37, 46, 48, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:7.0 | [6]:7.0 | [9]:3.0 | [44]:10.0 | [53]:10.0 | [23]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[4]:2.0 | [5]:9.0 | [31]:3.0 | [41]:12.0 | [53]:11.0 | [55]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[22]:1.0 | [26]:2.0 | [30]:12.0 | [47]:2.0 | [51]:3.0 | [56]:8.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:2.0 | [33]:19.0 | [47]:2.0 | [51]:2.0 | [56]:2.0 | [49]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[28]:2.0 | [36]:1.0 | [45]:12.0 | [46]:2.0 | [47]:5.0 | [62]:11.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[8]:12.0 | [20]:6.0 | [24]:4.0 | [36]:1.0 | [45]:7.0 | [9]:2.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[ 8, 20, 24, 36, 45,  9]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[17]:2.0 | [20]:2.0 | [47]:6.0 | [53]:1.0 | [54]:14.0 | [5]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[11]:11.0 | [16]:1.0 | [29]:3.0 | [43]:3.0 | [56]:5.0 | [58]:1.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:3.0 | [25]:3.0 | [55]:1.0 | [60]:1.0 | [62]:3.0 | [12]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[0]:2.0 | [8]:4.0 | [19]:1.0 | [46]:2.0 | [47]:2.0 | [10]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[22]:5.0 | [45]:1.0 | [48]:4.0 | [55]:3.0 | [60]:3.0 | [40]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[3]:3.0 | [22]:4.0 | [29]:4.0 | [39]:2.0 | [52]:2.0 | [14]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[8]:1.0 | [12]:4.0 | [14]:9.0 | [42]:6.0 | [43]:2.0 | [41]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[11]:4.0 | [12]:2.0 | [16]:4.0 | [18]:2.0 | [56]:6.0 | [33]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[11, 12, 16, 18, 56, 33]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 19.000(2776)[0m | [32mExpert 34: 12.000(2704)[0m | [32mExpert 11: 9.000(2629)[0m | [32mExpert 16: 9.000(2644)[0m | 
[32mExpert 28: 9.000(2683)[0m | [32mExpert 17: 8.000(2647)[0m | [32mExpert 57: 7.000(2779)[0m | [32mExpert 37: 6.000(2713)[0m | 
[32mExpert 46: 6.000(2743)[0m | [32mExpert 41: 5.000(2728)[0m | [32mExpert 51: 5.000(2761)[0m | [32mExpert 59: 5.000(2785)[0m | 
[32mExpert 60: 5.000(2791)[0m | [32mExpert  5: 4.000(2755)[0m | [32mExpert 27: 4.000(2680)[0m | [32mExpert 30: 4.000(2692)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 10: 3.000(2626)[0m | [32mExpert 38: 3.000(2716)[0m | [32mExpert 45: 3.000(2740)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert 52: 3.000(2764)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert  3: 2.000(2689)[0m | 
[32mExpert 12: 2.000(2632)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 36: 2.000(2710)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | [32mExpert 13: 1.000(2635)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2749, 2764, 2767, 2689, 2632, 2653, 2671, 2707, 2710, 2620, 2656, 2635]
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 12, 13, 19, 24, 35, 36, 48, 52, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:4.0 | [8]:5.0 | [19]:2.0 | [21]:2.0 | [42]:6.0 | [41]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[3]:2.0 | [6]:5.0 | [10]:3.0 | [17]:7.0 | [45]:4.0 | [46]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[1]:4.0 | [35]:3.0 | [41]:6.0 | [48]:4.0 | [58]:2.0 | [12]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[29]:2.0 | [30]:8.0 | [53]:4.0 | [55]:5.0 | [60]:3.0 | [17]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[8]:4.0 | [28]:6.0 | [35]:4.0 | [47]:5.0 | [57]:6.0 | [30]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[7]:4.0 | [29]:6.0 | [42]:7.0 | [43]:2.0 | [56]:3.0 | [58]:4.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 7, 29, 42, 43, 56, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 9.000(2864)[0m | [32mExpert 58: 8.000(3020)[0m | [32mExpert 25: 7.000(2912)[0m | [32mExpert 37: 7.000(2951)[0m | 
[32mExpert 53: 7.000(3005)[0m | [32mExpert 19: 6.000(2891)[0m | [32mExpert 49: 6.000(2990)[0m | [32mExpert 63: 6.000(3038)[0m | 
[32mExpert  0: 5.000(2858)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 17: 5.000(2885)[0m | [32mExpert 40: 5.000(2963)[0m | 
[32mExpert 43: 5.000(2972)[0m | [32mExpert 52: 5.000(3002)[0m | [32mExpert 56: 5.000(3014)[0m | [32mExpert 59: 5.000(3023)[0m | 
[32mExpert  7: 4.000(3041)[0m | [32mExpert 38: 4.000(2954)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 62: 4.000(3035)[0m | 
[32mExpert 12: 3.000(2870)[0m | [32mExpert 14: 3.000(2876)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | 
[32mExpert 27: 3.000(2918)[0m | [32mExpert 36: 3.000(2948)[0m | [32mExpert 47: 3.000(2984)[0m | [32mExpert 50: 3.000(2996)[0m | 
[32mExpert  5: 2.000(2993)[0m | [32mExpert 24: 2.000(2909)[0m | [32mExpert 28: 2.000(2921)[0m | [32mExpert 31: 2.000(2933)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2870, 2876, 2879, 2915, 2918, 2948, 2984, 2996, 2993, 2909, 2921, 2933]
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 12, 14, 15, 24, 26, 27, 28, 31, 36, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[21]:3.0 | [31]:2.0 | [33]:4.0 | [40]:5.0 | [43]:3.0 | [29]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[4]:2.0 | [25]:6.0 | [30]:6.0 | [48]:5.0 | [50]:5.0 | [33]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[16]:6.0 | [38]:5.0 | [46]:3.0 | [49]:7.0 | [59]:6.0 | [4]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[9]:5.0 | [17]:4.0 | [24]:6.0 | [38]:2.0 | [41]:6.0 | [60]:11.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[10]:2.0 | [25]:11.0 | [38]:9.0 | [40]:6.0 | [55]:6.0 | [52]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[3]:2.0 | [46]:6.0 | [47]:6.0 | [51]:5.0 | [57]:3.0 | [4]:11.0 | 
---------------------------------------
return iEAM
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Begin prefetch18 topk= tensor([[ 3, 46, 47, 51, 57,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 13.000(4103)[0m | [32mExpert 19: 13.000(4109)[0m | [32mExpert 30: 12.000(4148)[0m | [32mExpert  2: 10.000(4112)[0m | 
[32mExpert 10: 10.000(4082)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 56: 8.000(4232)[0m | [32mExpert 57: 7.000(4235)[0m | 
[32mExpert  1: 6.000(4079)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 14: 5.000(4094)[0m | [32mExpert 61: 5.000(4250)[0m | 
[32mExpert  9: 4.000(4265)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 23: 3.000(4124)[0m | 
[32mExpert 27: 3.000(4136)[0m | [32mExpert 51: 3.000(4217)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert 62: 3.000(4253)[0m | 
[32mExpert 24: 2.000(4127)[0m | [32mExpert 26: 2.000(4133)[0m | [32mExpert 29: 2.000(4142)[0m | [32mExpert 32: 2.000(4154)[0m | 
[32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 47: 2.000(4202)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4127, 4133, 4142, 4154, 4169, 4199, 4202, 4205, 4214, 4229, 4076, 4178]
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 24, 26, 29, 32, 37, 46, 47, 48, 50, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:1.0 | [9]:4.0 | [47]:5.0 | [53]:11.0 | [60]:5.0 | [2]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[15]:6.0 | [22]:5.0 | [40]:2.0 | [44]:3.0 | [50]:6.0 | [10]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[14]:6.0 | [30]:13.0 | [35]:5.0 | [51]:4.0 | [62]:4.0 | [61]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[8]:3.0 | [21]:6.0 | [24]:2.0 | [26]:12.0 | [33]:20.0 | [57]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[6]:4.0 | [7]:7.0 | [38]:4.0 | [46]:3.0 | [60]:6.0 | [59]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[24]:5.0 | [28]:7.0 | [37]:5.0 | [50]:6.0 | [61]:5.0 | [45]:8.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[24, 28, 37, 50, 61, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:5.0 | [12]:5.0 | [54]:15.0 | [57]:5.0 | [63]:15.0 | [42]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[1]:5.0 | [30]:6.0 | [36]:6.0 | [54]:3.0 | [56]:6.0 | [48]:4.0 | 
---------------------------------------
return iEAM
ï¼Ÿ
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2740
[1m[33mEnqueueTask: [0m[32mTask: node: ID[568,2d00000013] (16MB) STATE(0) TENSOR[2739,2740,2738,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2981
[1m[33mEnqueueTask: [0m[32mTask: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:5.0 | [8]:1.0 | [31]:3.0 | [50]:5.0 | [57]:4.0 | [12]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[8]:5.0 | [13]:2.0 | [36]:7.0 | [59]:2.0 | [62]:4.0 | [63]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[21]:5.0 | [22]:6.0 | [46]:4.0 | [48]:5.0 | [60]:4.0 | [18]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[3]:4.0 | [13]:4.0 | [18]:5.0 | [34]:6.0 | [60]:5.0 | [22]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[18]:4.0 | [39]:6.0 | [41]:7.0 | [42]:7.0 | [50]:6.0 | [12]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[16]:5.0 | [37]:4.0 | [46]:6.0 | [50]:6.0 | [56]:7.0 | [11]:5.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[16, 37, 46, 50, 56, 11]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 19.000(2776)[0m | [32mExpert 34: 12.000(2704)[0m | [32mExpert 11: 9.000(2629)[0m | [32mExpert 16: 9.000(2644)[0m | 
[32mExpert 28: 9.000(2683)[0m | [32mExpert 17: 8.000(2647)[0m | [32mExpert 57: 7.000(2779)[0m | [32mExpert 37: 6.000(2713)[0m | 
[32mExpert 41: 6.000(2728)[0m | [32mExpert 46: 6.000(2743)[0m | [32mExpert 51: 5.000(2761)[0m | [32mExpert 59: 5.000(2785)[0m | 
[32mExpert 60: 5.000(2791)[0m | [32mExpert  1: 4.000(2623)[0m | [32mExpert  5: 4.000(2755)[0m | [32mExpert 27: 4.000(2680)[0m | 
[32mExpert 30: 4.000(2692)[0m | [32mExpert 48: 4.000(2749)[0m | [32mExpert 10: 3.000(2626)[0m | [32mExpert 12: 3.000(2632)[0m | 
[32mExpert 35: 3.000(2707)[0m | [32mExpert 38: 3.000(2716)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 52: 3.000(2764)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 36: 2.000(2710)[0m | [32mExpert 58: 2.000(2782)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2716, 2740, 2764, 2767, 2689, 2653, 2671, 2710, 2782, 2620, 2656]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2740[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 19, 24, 35, 36, 38, 45, 52, 53, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:6.0 | [26]:6.0 | [41]:7.0 | [42]:7.0 | [50]:7.0 | [38]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[6]:6.0 | [8]:6.0 | [45]:5.0 | [46]:6.0 | [55]:3.0 | [10]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[1]:5.0 | [41]:7.0 | [45]:4.0 | [46]:7.0 | [48]:5.0 | [35]:4.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E45 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[17]:4.0 | [30]:9.0 | [53]:5.0 | [55]:6.0 | [60]:4.0 | [41]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[8]:5.0 | [28]:7.0 | [35]:5.0 | [43]:6.0 | [47]:6.0 | [16]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[7]:5.0 | [29]:7.0 | [38]:3.0 | [42]:8.0 | [46]:5.0 | [43]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 7, 29, 38, 42, 46, 43]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 9.000(2864)[0m | [32mExpert 58: 8.000(3020)[0m | [32mExpert 25: 7.000(2912)[0m | [32mExpert 37: 7.000(2951)[0m | 
[32mExpert 49: 7.000(2990)[0m | [32mExpert 53: 7.000(3005)[0m | [32mExpert 16: 6.000(2882)[0m | [32mExpert 19: 6.000(2891)[0m | 
[32mExpert 59: 6.000(3023)[0m | [32mExpert 63: 6.000(3038)[0m | [32mExpert  0: 5.000(2858)[0m | [32mExpert 17: 5.000(2885)[0m | 
[32mExpert 38: 5.000(2954)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert 43: 5.000(2972)[0m | [32mExpert 52: 5.000(3002)[0m | 
[32mExpert 56: 5.000(3014)[0m | [32mExpert  7: 4.000(3041)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 62: 4.000(3035)[0m | 
[32mExpert 12: 3.000(2870)[0m | [32mExpert 14: 3.000(2876)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | 
[32mExpert 27: 3.000(2918)[0m | [32mExpert 36: 3.000(2948)[0m | [32mExpert 46: 3.000(2981)[0m | [32mExpert 47: 3.000(2984)[0m | 
[32mExpert 50: 3.000(2996)[0m | [32mExpert  5: 2.000(2993)[0m | [32mExpert 24: 2.000(2909)[0m | [32mExpert 28: 2.000(2921)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2870, 2876, 2879, 2915, 2918, 2948, 2981, 2984, 2996, 2993, 2909, 2921]
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
Prefetching [1;36mTensor 2981[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 12, 14, 15, 24, 26, 27, 28, 36, 46, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[18]:2.0 | [21]:4.0 | [29]:6.0 | [33]:5.0 | [44]:6.0 | [40]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[9]:4.0 | [28]:7.0 | [30]:7.0 | [33]:7.0 | [50]:6.0 | [15]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[0]:6.0 | [6]:2.0 | [16]:7.0 | [38]:6.0 | [49]:8.0 | [33]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[15]:4.0 | [16]:4.0 | [17]:5.0 | [24]:7.0 | [41]:7.0 | [43]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[25]:12.0 | [26]:2.0 | [40]:7.0 | [52]:7.0 | [62]:4.0 | [55]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[18]:5.0 | [30]:5.0 | [46]:7.0 | [53]:5.0 | [59]:2.0 | [40]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[18, 30, 46, 53, 59, 40]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 13.000(4103)[0m | EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
[32mExpert 19: 13.000(4109)[0m | [32mExpert 30: 13.000(4148)[0m | [32mExpert  2: 10.000(4112)[0m | 
[32mExpert 10: 10.000(4082)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 56: 8.000(4232)[0m | [32mExpert 57: 7.000(4235)[0m | 
[32mExpert  1: 6.000(4079)[0m | [32mExpert 14: 6.000(4094)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 61: 6.000(4250)[0m | 
[32mExpert 35: 5.000(4163)[0m | [32mExpert  9: 4.000(4265)[0m | [32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | 
[32mExpert 62: 4.000(4253)[0m | [32mExpert 23: 3.000(4124)[0m | [32mExpert 27: 3.000(4136)[0m | [32mExpert 58: 3.000(4238)[0m | 
[32mExpert 24: 2.000(4127)[0m | [32mExpert 26: 2.000(4133)[0m | [32mExpert 29: 2.000(4142)[0m | [32mExpert 32: 2.000(4154)[0m | 
[32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 47: 2.000(4202)[0m | [32mExpert 48: 2.000(4205)[0m | 
[32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4127, 4133, 4142, 4154, 4169, 4199, 4202, 4205, 4214, 4229, 4076, 4178]
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 24, 26, 29, 32, 37, 46, 47, 48, 50, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:6.0 | [24]:4.0 | [41]:6.0 | [47]:6.0 | [60]:6.0 | [19]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[15]:7.0 | [22]:6.0 | [25]:4.0 | [43]:10.0 | [50]:7.0 | [44]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[14]:7.0 | [27]:4.0 | [35]:6.0 | [48]:3.0 | [62]:5.0 | [17]:14.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[11]:6.0 | [21]:7.0 | [40]:5.0 | [55]:3.0 | [60]:5.0 | [33]:21.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[7]:8.0 | [22]:6.0 | [23]:5.0 | [40]:4.0 | [41]:1.0 | [57]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[28]:8.0 | [37]:6.0 | [50]:7.0 | [58]:2.0 | [61]:6.0 | [22]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[28, 37, 50, 58, 61, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:6.0 | [10]:6.0 | [12]:6.0 | [40]:1.0 | [57]:6.0 | [44]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[26]:4.0 | [30]:7.0 | [34]:6.0 | [44]:3.0 | [56]:7.0 | [36]:7.0 | 
---------------------------------------
return iEAM

EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2981
[1m[33mEnqueueTask: [0m[32mTask: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:6.0 | [31]:4.0 | [50]:6.0 | [54]:3.0 | [57]:5.0 | [7]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[8]:6.0 | [27]:4.0 | [36]:8.0 | [62]:5.0 | [63]:6.0 | [37]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[0]:5.0 | [21]:6.0 | [46]:5.0 | [48]:6.0 | [60]:5.0 | [22]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[3]:5.0 | [13]:5.0 | [18]:6.0 | [34]:7.0 | [60]:6.0 | [22]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[18]:5.0 | [39]:7.0 | [41]:8.0 | [42]:8.0 | [50]:7.0 | [12]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[16]:6.0 | [37]:5.0 | [46]:7.0 | [50]:7.0 | [56]:8.0 | [35]:3.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[16, 37, 46, 50, 56, 35]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 19.000(2776)[0m | [32mExpert 34: 12.000(2704)[0m | [32mExpert 11: 9.000(2629)[0m | [32mExpert 16: 9.000(2644)[0m | 
[32mExpert 28: 9.000(2683)[0m | [32mExpert 17: 8.000(2647)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert 46: 7.000(2743)[0m | 
[32mExpert 57: 7.000(2779)[0m | [32mExpert 37: 6.000(2713)[0m | [32mExpert  1: 5.000(2623)[0m | [32mExpert 48: 5.000(2749)[0m | 
[32mExpert 51: 5.000(2761)[0m | [32mExpert 59: 5.000(2785)[0m | [32mExpert 60: 5.000(2791)[0m | [32mExpert  5: 4.000(2755)[0m | 
[32mExpert 27: 4.000(2680)[0m | [32mExpert 30: 4.000(2692)[0m | [32mExpert 35: 4.000(2707)[0m | [32mExpert 45: 4.000(2740)[0m | 
[32mExpert 10: 3.000(2626)[0m | [32mExpert 12: 3.000(2632)[0m | [32mExpert 38: 3.000(2716)[0m | [32mExpert 52: 3.000(2764)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 36: 2.000(2710)[0m | [32mExpert 58: 2.000(2782)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2626, 2632, 2716, 2764, 2767, 2689, 2653, 2671, 2710, 2782, 2620, 2656]
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 10, 12, 19, 24, 36, 38, 52, 53, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:7.0 | [26]:7.0 | [38]:5.0 | [41]:8.0 | [42]:8.0 | [50]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[6]:7.0 | [8]:7.0 | [45]:6.0 | [46]:7.0 | [55]:4.0 | [25]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[1]:6.0 | [35]:5.0 | [41]:8.0 | [46]:8.0 | [48]:6.0 | [38]:4.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E38 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[17]:5.0 | [30]:10.0 | [41]:8.0 | [55]:7.0 | [60]:5.0 | [53]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[8]:6.0 | [28]:8.0 | [43]:7.0 | [47]:7.0 | [54]:5.0 | [35]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[7]:6.0 | [29]:8.0 | [41]:5.0 | [42]:9.0 | [46]:6.0 | [58]:5.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 7, 29, 41, 42, 46, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 9.000(2864)[0m | [32mExpert 49: 8.000(2990)[0m | [32mExpert 58: 8.000(3020)[0m | [32mExpert 16: 7.000(2882)[0m | 
[32mExpert 25: 7.000(2912)[0m | [32mExpert 37: 7.000(2951)[0m | [32mExpert 53: 7.000(3005)[0m | [32mExpert  0: 6.000(2858)[0m | 
[32mExpert 19: 6.000(2891)[0m | [32mExpert 38: 6.000(2954)[0m | [32mExpert 59: 6.000(3023)[0m | [32mExpert 63: 6.000(3038)[0m | 
[32mExpert 17: 5.000(2885)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert 43: 5.000(2972)[0m | [32mExpert 52: 5.000(3002)[0m | 
[32mExpert 56: 5.000(3014)[0m | [32mExpert  7: 4.000(3041)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 62: 4.000(3035)[0m | 
[32mExpert 12: 3.000(2870)[0m | [32mExpert 14: 3.000(2876)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | 
[32mExpert 27: 3.000(2918)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 36: 3.000(2948)[0m | [32mExpert 46: 3.000(2981)[0m | 
[32mExpert 47: 3.000(2984)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert  5: 2.000(2993)[0m | [32mExpert  6: 2.000(3026)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2870, 2876, 2879, 2915, 2918, 2939, 2948, 2981, 2984, 2996, 2993, 3026]
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
Prefetching [1;36mTensor 2981[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6, 12, 14, 15, 26, 27, 33, 36, 46, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[29]:7.0 | [33]:6.0 | [40]:7.0 | [41]:5.0 | [44]:7.0 | [49]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[25]:7.0 | [28]:8.0 | [30]:8.0 | [33]:8.0 | [50]:7.0 | [9]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[0]:7.0 | [6]:3.0 | [16]:8.0 | [49]:9.0 | [59]:7.0 | [8]:2.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[10]:2.0 | [15]:5.0 | [17]:6.0 | [24]:8.0 | [41]:8.0 | [42]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[6]:3.0 | [25]:13.0 | [40]:8.0 | [52]:8.0 | [55]:8.0 | [57]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[18]:6.0 | [46]:8.0 | [51]:6.0 | [53]:6.0 | [57]:4.0 | [17]:1.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[18, 46, 51, 53, 57, 17]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 14.000(4103)[0m | EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
[32mExpert 19: 13.000(4109)[0m | [32mExpert 30: 13.000(4148)[0m | [32mExpert  2: 10.000(4112)[0m | 
[32mExpert 10: 10.000(4082)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 56: 8.000(4232)[0m | [32mExpert 14: 7.000(4094)[0m | 
[32mExpert 57: 7.000(4235)[0m | [32mExpert  1: 6.000(4079)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 35: 6.000(4163)[0m | 
[32mExpert 61: 6.000(4250)[0m | [32mExpert 62: 5.000(4253)[0m | [32mExpert  9: 4.000(4265)[0m | [32mExpert 27: 4.000(4136)[0m | 
[32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 23: 3.000(4124)[0m | [32mExpert 48: 3.000(4205)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert 24: 2.000(4127)[0m | [32mExpert 26: 2.000(4133)[0m | [32mExpert 29: 2.000(4142)[0m | 
[32mExpert 32: 2.000(4154)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 47: 2.000(4202)[0m | 
[32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  4: 1.000(4178)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4238, 4127, 4133, 4142, 4154, 4169, 4199, 4202, 4214, 4229, 4076, 4178]
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  4, 24, 26, 29, 32, 37, 46, 47, 50, 55, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:2.0 | [9]:5.0 | [14]:7.0 | [41]:7.0 | [47]:7.0 | [60]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[15]:8.0 | [22]:7.0 | [25]:5.0 | [29]:9.0 | [50]:8.0 | [40]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[14]:8.0 | [27]:5.0 | [35]:7.0 | [48]:4.0 | [62]:6.0 | [13]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 22 MLP ==
[0m
[21]:8.0 | [26]:13.0 | [39]:9.0 | [40]:6.0 | [60]:6.0 | [37]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[6]:5.0 | [7]:9.0 | [23]:6.0 | [38]:5.0 | [57]:4.0 | [63]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[28]:9.0 | [36]:2.0 | [37]:7.0 | [50]:8.0 | [61]:7.0 | [57]:7.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[28, 36, 37, 50, 61, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:7.0 | [10]:7.0 | [12]:7.0 | [40]:2.0 | [57]:7.0 | [21]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[26]:5.0 | [30]:8.0 | [34]:7.0 | [48]:5.0 | [56]:8.0 | [44]:4.0 | 
---------------------------------------
return iEAM
é¦–å…ˆEnqueuePrefetch: 2740
[1m[33mEnqueueTask: [0m[32mTask: node: ID[568,2d00000013] (16MB) STATE(0) TENSOR[2739,2740,2738,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2981
[1m[33mEnqueueTask: [0m[32mTask: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[5]:2.0 | [17]:9.0 | [20]:3.0 | [42]:3.0 | [43]:4.0 | [25]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 2 MLP ==
[0m
[14]:5.0 | [38]:12.0 | [42]:5.0 | [57]:3.0 | [61]:3.0 | [7]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 3 MLP ==
[0m
[0]:6.0 | [7]:5.0 | [42]:6.0 | [44]:2.0 | [58]:2.0 | [16]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 4 MLP ==
[0m
[6]:1.0 | [19]:3.0 | [25]:2.0 | [38]:4.0 | [41]:2.0 | [5]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 5 MLP ==
[0m
[35]:2.0 | [36]:3.0 | [38]:6.0 | [41]:9.0 | [50]:8.0 | [18]:6.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 6 MLP ==
[0m
[5]:2.0 | [9]:1.0 | [19]:5.0 | [24]:1.0 | [43]:1.0 | [46]:8.0 | 
---------------------------------------
return iEAM
Begin prefetch6 topk= tensor([[ 5,  9, 19, 24, 43, 46]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 19.000(2776)[0m | [32mExpert 34: 12.000(2704)[0m | [32mExpert 11: 9.000(2629)[0m | [32mExpert 16: 9.000(2644)[0m | 
[32mExpert 28: 9.000(2683)[0m | [32mExpert 17: 8.000(2647)[0m | [32mExpert 41: 8.000(2728)[0m | [32mExpert 46: 8.000(2743)[0m | 
[32mExpert 57: 7.000(2779)[0m | [32mExpert  1: 6.000(2623)[0m | [32mExpert 37: 6.000(2713)[0m | [32mExpert 48: 6.000(2749)[0m | 
[32mExpert 35: 5.000(2707)[0m | [32mExpert 51: 5.000(2761)[0m | [32mExpert 59: 5.000(2785)[0m | [32mExpert 60: 5.000(2791)[0m | 
[32mExpert  5: 4.000(2755)[0m | [32mExpert 27: 4.000(2680)[0m | [32mExpert 30: 4.000(2692)[0m | [32mExpert 38: 4.000(2716)[0m | 
[32mExpert 45: 4.000(2740)[0m | [32mExpert 10: 3.000(2626)[0m | [32mExpert 12: 3.000(2632)[0m | [32mExpert 52: 3.000(2764)[0m | 
[32mExpert 53: 3.000(2767)[0m | [32mExpert  3: 2.000(2689)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 36: 2.000(2710)[0m | [32mExpert 58: 2.000(2782)[0m | [32mExpert  0: 1.000(2620)[0m | [32mExpert  2: 1.000(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2740, 2626, 2632, 2764, 2767, 2689, 2653, 2671, 2710, 2782, 2620, 2656]
Prefetching [1;36mTensor 2740[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 10, 12, 19, 24, 36, 45, 52, 53, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[10]:1.0 | [25]:2.0 | [26]:8.0 | [30]:3.0 | [61]:9.0 | [50]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 8 MLP ==
[0m
[18]:3.0 | [27]:2.0 | [45]:7.0 | [46]:8.0 | [49]:5.0 | [52]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 9 MLP ==
[0m
[1]:7.0 | [5]:5.0 | [38]:5.0 | [41]:9.0 | [46]:9.0 | [57]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 10 MLP ==
[0m
[30]:11.0 | [37]:1.0 | [50]:3.0 | [57]:12.0 | [63]:2.0 | [0]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 11 MLP ==
[0m
[25]:1.0 | [28]:9.0 | [30]:7.0 | [46]:2.0 | [54]:6.0 | [63]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 12 MLP ==
[0m
[3]:5.0 | [15]:1.0 | [30]:2.0 | [42]:10.0 | [58]:6.0 | [41]:6.0 | 
---------------------------------------
return iEAM
Begin prefetch12 topk= tensor([[ 3, 15, 30, 42, 58, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 9.000(2864)[0m | [32mExpert 49: 9.000(2990)[0m | [32mExpert 16: 8.000(2882)[0m | [32mExpert 58: 8.000(3020)[0m | 
[32mExpert  0: 7.000(2858)[0m | [32mExpert 25: 7.000(2912)[0m | [32mExpert 37: 7.000(2951)[0m | [32mExpert 53: 7.000(3005)[0m | 
[32mExpert 59: 7.000(3023)[0m | [32mExpert 19: 6.000(2891)[0m | [32mExpert 38: 6.000(2954)[0m | [32mExpert 63: 6.000(3038)[0m | 
[32mExpert 17: 5.000(2885)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert 43: 5.000(2972)[0m | [32mExpert 52: 5.000(3002)[0m | 
[32mExpert 56: 5.000(3014)[0m | [32mExpert  7: 4.000(3041)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 62: 4.000(3035)[0m | 
[32mExpert  6: 3.000(3026)[0m | [32mExpert 12: 3.000(2870)[0m | [32mExpert 14: 3.000(2876)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 27: 3.000(2918)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 36: 3.000(2948)[0m | 
[32mExpert 46: 3.000(2981)[0m | [32mExpert 47: 3.000(2984)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert  5: 2.000(2993)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3026, 2870, 2876, 2879, 2915, 2918, 2939, 2948, 2981, 2984, 2996, 2993]
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
Prefetching [1;36mTensor 2981[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6, 12, 14, 15, 26, 27, 33, 36, 46, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[19]:1.0 | [40]:8.0 | [41]:6.0 | [49]:2.0 | [57]:1.0 | [39]:7.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 14 MLP ==
[0m
[12]:1.0 | [30]:9.0 | [41]:4.0 | [50]:8.0 | [60]:2.0 | [21]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 15 MLP ==
[0m
[4]:2.0 | [8]:3.0 | [13]:2.0 | [45]:2.0 | [59]:8.0 | [62]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 16 MLP ==
[0m
[7]:2.0 | [8]:11.0 | [39]:1.0 | [42]:5.0 | [48]:3.0 | [53]:3.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 17 MLP ==
[0m
[6]:4.0 | [8]:3.0 | [35]:6.0 | [44]:3.0 | [56]:3.0 | [52]:9.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 18 MLP ==
[0m
[9]:1.0 | [25]:2.0 | [29]:1.0 | [45]:2.0 | [53]:7.0 | [32]:9.0 | 
---------------------------------------
return iEAM
Begin prefetch18 topk= tensor([[ 9, 25, 29, 45, 53, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 14.000(4103)[0m | [32mExpert 19: 13.000(4109)[0m | [32mExpert 30: 13.000(4148)[0m | [32mExpert  2: 10.000(4112)[0m | 
[32mExpert 10: 10.000(4082)[0m | [32mExpert 43: 9.000(4190)[0m | [32mExpert 14: 8.000(4094)[0m | [32mExpert 56: 8.000(4232)[0m | 
[32mExpert 35: 7.000(4163)[0m | [32mExpert 57: 7.000(4235)[0m | [32mExpert  1: 6.000(4079)[0m | [32mExpert 21: 6.000(4118)[0m | 
[32mExpert 61: 6.000(4250)[0m | [32mExpert 62: 6.000(4253)[0m | EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
[32mExpert 27: 5.000(4136)[0m | [32mExpert  9: 4.000(4265)[0m | 
[32mExpert 48: 4.000(4205)[0m | [32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 23: 3.000(4124)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert 13: 2.000(4091)[0m | [32mExpert 24: 2.000(4127)[0m | [32mExpert 26: 2.000(4133)[0m | 
[32mExpert 29: 2.000(4142)[0m | [32mExpert 32: 2.000(4154)[0m | [32mExpert 37: 2.000(4169)[0m | [32mExpert 46: 2.000(4199)[0m | 
[32mExpert 47: 2.000(4202)[0m | [32mExpert 50: 2.000(4214)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert  0: 1.000(4076)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4238, 4091, 4127, 4133, 4142, 4154, 4169, 4199, 4202, 4214, 4229, 4076]
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0, 13, 24, 26, 29, 32, 37, 46, 47, 50, 55, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:9.0 | [9]:6.0 | [50]:1.0 | [52]:3.0 | [63]:1.0 | [19]:5.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 20 MLP ==
[0m
[15]:9.0 | [26]:1.0 | [31]:4.0 | [40]:4.0 | [50]:9.0 | [9]:2.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 21 MLP ==
[0m
[0]:2.0 | [9]:5.0 | [14]:9.0 | [35]:8.0 | [37]:3.0 | [50]:3.0 | 
---------------------------------------
return iEAM
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[15]:3.0 | [20]:3.0 | [26]:14.0 | [40]:7.0 | [52]:3.0 | [36]:1.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 23 MLP ==
[0m
[7]:10.0 | [33]:2.0 | [59]:7.0 | [60]:7.0 | [62]:12.0 | [46]:4.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 24 MLP ==
[0m
[19]:4.0 | [28]:10.0 | [36]:3.0 | [45]:9.0 | [51]:1.0 | [50]:9.0 | 
---------------------------------------
return iEAM
Begin prefetch24 topk= tensor([[19, 28, 36, 45, 51, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:8.0 | [18]:3.0 | [21]:3.0 | [54]:16.0 | [55]:4.0 | [57]:8.0 | 
---------------------------------------
return iEAM

[1;36m== Layer 26 MLP ==
[0m
[21]:4.0 | [22]:3.0 | [25]:6.0 | [36]:8.0 | [52]:3.0 | [12]:2.0 | 
---------------------------------------
return EAMC[0]
ï¼Œ
EnqueuePrefetch: 2740
[1m[33mEnqueueTask: [0m[32mTask: node: ID[568,2d00000013] (16MB) STATE(0) TENSOR[2739,2740,2738,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefilling time: 3.584599733352661 seconds
Decoding time: 9.59267783164978 seconds
Decoding iterations: 32
Decoding time per iteration: 0.29977118223905563 seconds
Input tokens: 168
input:  è¯·ç”¨Pythonå®ç°ä»¥ä¸‹éœ€æ±‚ï¼š
1. ç¼–å†™ä¸€ä¸ªæ”¯æŒLRUç¼“å­˜æœºåˆ¶çš„è£…é¥°å™¨ç±»ï¼ŒåŒ…å«get/putæ–¹æ³•
2. ç”¨PyTorchæ„å»ºä¸€ä¸ª3å±‚MoEæ¨¡å‹ï¼š
   - ä¸“å®¶æ•°=4ï¼Œé—¨æ§ç½‘ç»œä¸ºç®€å•çº¿æ€§å±‚
   - æ¯ä¸“å®¶ä¸ºå«Dropoutçš„å…¨è¿æ¥ç½‘ç»œ
   - æ”¯æŒåŠ¨æ€ä¸“å®¶æ¿€æ´»æ•°ï¼ˆtop_k=2ï¼‰
3. ä¿®å¤ä»¥ä¸‹ä»£ç çš„BUGï¼ˆæç¤ºï¼šæ¶‰åŠå¼‚æ­¥åç¨‹ï¼‰ï¼š
   async def fetch_data():
       results = []
       for url in urls:
           data = await session.get(url)  # æŠ¥é”™ä½ç½®
           results.append(data.json())
       return results
è¦æ±‚ï¼šä»£ç éœ€å¯ç›´æ¥è¿è¡Œï¼Œå…³é”®å¤„æ·»åŠ æ³¨é‡Šã€‚
inputs ...
torch.Size([1, 178])
outputs_text ...

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:1.0 | [26]:1.0 | [56]:1.0 | [57]:1.0 | [60]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[3]:1.0 | [35]:1.0 | [38]:1.0 | [62]:1.0 | [63]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[4]:1.0 | [9]:1.0 | [11]:1.0 | [25]:1.0 | [54]:1.0 | [12]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[11]:1.0 | [21]:1.0 | [31]:1.0 | [33]:1.0 | [49]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[19]:1.0 | [20]:1.0 | [47]:1.0 | [49]:1.0 | [52]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[13]:1.0 | [21]:1.0 | [22]:1.0 | [42]:1.0 | [47]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[13, 21, 22, 42, 47, 32],
        [19, 37, 39, 46, 56, 26],
        [ 0,  7, 19, 26, 44,  4],
        ...,
        [ 2, 14, 26, 53, 60, 38],
        [ 2,  4, 14, 31, 60, 44],
        [11, 12, 16, 18, 50, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 3.800(2776)[0m | [32mExpert 34: 2.400(2704)[0m | [32mExpert 11: 1.800(2629)[0m | [32mExpert 16: 1.800(2644)[0m | 
[32mExpert 28: 1.800(2683)[0m | [32mExpert 41: 1.800(2728)[0m | [32mExpert 46: 1.800(2743)[0m | [32mExpert 17: 1.600(2647)[0m | 
[32mExpert 57: 1.600(2779)[0m | [32mExpert  1: 1.400(2623)[0m | [32mExpert 37: 1.200(2713)[0m | [32mExpert 48: 1.200(2749)[0m | 
[32mExpert  5: 1.000(2755)[0m | [32mExpert 35: 1.000(2707)[0m | [32mExpert 38: 1.000(2716)[0m | [32mExpert 51: 1.000(2761)[0m | 
[32mExpert 59: 1.000(2785)[0m | [32mExpert 60: 1.000(2791)[0m | [32mExpert 27: 0.800(2680)[0m | [32mExpert 30: 0.800(2692)[0m | 
[32mExpert 45: 0.800(2740)[0m | [32mExpert 10: 0.600(2626)[0m | [32mExpert 12: 0.600(2632)[0m | [32mExpert 52: 0.600(2764)[0m | 
[32mExpert 53: 0.600(2767)[0m | [33mExpert  3: 0.400(2689)[0m | [33mExpert 19: 0.400(2653)[0m | [33mExpert 24: 0.400(2671)[0m | 
[33mExpert 36: 0.400(2710)[0m | [33mExpert 58: 0.400(2782)[0m | [33mExpert  0: 0.200(2620)[0m | [33mExpert  2: 0.200(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2740, 2626, 2632, 2764, 2767, 2689, 2653, 2671, 2710, 2782, 2620, 2656]
Prefetching [1;36mTensor 2740[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  3, 10, 12, 19, 24, 36, 45, 52, 53, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[28]:1.0 | [43]:1.0 | [44]:1.0 | [58]:1.0 | [62]:1.0 | [18]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[2]:1.0 | [11]:1.0 | [30]:1.0 | [39]:1.0 | [54]:1.0 | [47]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[12]:1.0 | [13]:1.0 | [22]:1.0 | [27]:1.0 | [31]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E2 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E3 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E24 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E36 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E45 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[2]:1.0 | [9]:1.0 | [13]:1.0 | [42]:1.0 | [47]:1.0 | [31]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[10]:1.0 | [11]:1.0 | [17]:1.0 | [18]:1.0 | [27]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[4]:1.0 | [30]:1.0 | [37]:1.0 | [50]:1.0 | [59]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2876
[1m[33mEnqueueTask: [0m[32mTask: node: ID[927,e0000001f] (16MB) STATE(0) TENSOR[2875,2876,2874,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2948
[1m[33mEnqueueTask: [0m[32mTask: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2981
[1m[33mEnqueueTask: [0m[32mTask: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[949,240000001f] (16MB) STATE(0) TENSOR[2947,2948,2946,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
tensor([[ 4, 30, 37, 50, 59,  3],
        [12, 17, 29, 47, 59, 41],
        [12, 30, 44, 47, 57, 41],
        ...,
        [ 0, 33, 44, 57, 59, 30],
        [ 0, 18, 30, 32, 44, 52],
        [30, 38, 43, 44, 47,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 1.800(2864)[0m | [32mExpert 49: 1.800(2990)[0m | [32mExpert 16: 1.600(2882)[0m | [32mExpert 58: 1.600(3020)[0m | 
[32mExpert 59: 1.600(3023)[0m | [32mExpert  0: 1.400(2858)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | 
[32mExpert 53: 1.400(3005)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 38: 1.200(2954)[0m | [32mExpert 63: 1.200(3038)[0m | 
[32mExpert 17: 1.000(2885)[0m | [32mExpert 40: 1.000(2963)[0m | [32mExpert 43: 1.000(2972)[0m | [32mExpert 52: 1.000(3002)[0m | 
[32mExpert 56: 1.000(3014)[0m | [32mExpert 62: 1.000(3035)[0m | [32mExpert  7: 0.800(3041)[0m | [32mExpert 55: 0.800(3011)[0m | 
[32mExpert  6: 0.600(3026)[0m | [32mExpert  8: 0.600(3044)[0m | [32mExpert 12: 0.600(2870)[0m | [32mExpert 14: 0.600(2876)[0m | 
[32mExpert 15: 0.600(2879)[0m | [32mExpert 26: 0.600(2915)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 33: 0.600(2939)[0m | 
[32mExpert 36: 0.600(2948)[0m | [32mExpert 46: 0.600(2981)[0m | [32mExpert 47: 0.600(2984)[0m | [32mExpert 50: 0.600(2996)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3026, 3044, 2870, 2876, 2879, 2915, 2918, 2939, 2948, 2981, 2984, 2996]
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2876[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2948[0m â†’ GPU 0
Prefetching [1;36mTensor 2981[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  6,  8, 12, 14, 15, 26, 27, 33, 36, 46, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:1.0 | [24]:1.0 | [34]:1.0 | [36]:1.0 | [47]:1.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[5]:1.0 | [7]:1.0 | [23]:1.0 | [27]:1.0 | [51]:1.0 | [24]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[5]:1.0 | [14]:1.0 | [48]:1.0 | [52]:1.0 | [55]:1.0 | [36]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E14 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E15 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E36 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E46 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:1.0 | [13]:1.0 | [26]:1.0 | [33]:1.0 | [63]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[0]:1.0 | [11]:1.0 | [18]:1.0 | [26]:1.0 | [43]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[2]:1.0 | [5]:1.0 | [39]:1.0 | [56]:1.0 | [61]:1.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 2,  5, 39, 56, 61, 49],
        [ 1, 18, 31, 35, 53, 21],
        [ 1, 18, 31, 33, 37,  9],
        ...,
        [ 1, 33, 55, 58, 59,  5],
        [ 1,  7, 14, 35, 55,  5],
        [35, 46, 51, 57, 59, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 2.800(4103)[0m | [32mExpert 19: 2.600(4109)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert  2: 2.000(4112)[0m | 
[32mExpert 10: 2.000(4082)[0m | [32mExpert 14: 1.800(4094)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 35: 1.600(4163)[0m | 
[32mExpert 56: 1.600(4232)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert  1: 1.200(4079)[0m | [32mExpert 21: 1.200(4118)[0m | 
[32mExpert 61: 1.200(4250)[0m | [32mExpert 62: 1.200(4253)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 27: 1.000(4136)[0m | 
[32mExpert 48: 0.800(4205)[0m | [32mExpert 51: 0.800(4217)[0m | [32mExpert 54: 0.800(4226)[0m | [32mExpert 23: 0.600(4124)[0m | 
[32mExpert 37: 0.600(4169)[0m | [32mExpert 50: 0.600(4214)[0m | [32mExpert 58: 0.600(4238)[0m | [33mExpert  0: 0.400(4076)[0m | 
[33mExpert 13: 0.400(4091)[0m | [33mExpert 24: 0.400(4127)[0m | [33mExpert 26: 0.400(4133)[0m | [33mExpert 29: 0.400(4142)[0m | 
[33mExpert 32: 0.400(4154)[0m | [33mExpert 46: 0.400(4199)[0m | [33mExpert 47: 0.400(4202)[0m | [33mExpert 55: 0.400(4229)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4169, 4214, 4238, 4076, 4091, 4127, 4133, 4142, 4154, 4199, 4202, 4229]
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0, 13, 24, 26, 29, 32, 37, 46, 47, 50, 55, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:1.0 | [6]:1.0 | [23]:1.0 | [44]:1.0 | [54]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[1]:1.0 | [20]:1.0 | [26]:1.0 | [36]:1.0 | [38]:1.0 | [57]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[16]:1.0 | [19]:1.0 | [21]:1.0 | [53]:1.0 | [54]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E24 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E29 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E46 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:1.0 | [3]:1.0 | [5]:1.0 | [8]:1.0 | [55]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[0]:1.0 | [3]:1.0 | [5]:1.0 | [45]:1.0 | [47]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[10]:1.0 | [24]:1.0 | [47]:1.0 | [62]:1.0 | [63]:1.0 | [5]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[10, 24, 47, 62, 63,  5],
        [ 0, 24, 28, 36, 42, 62],
        [16, 24, 28, 36, 40, 25],
        ...,
        [ 6, 23, 26, 33, 35,  5],
        [ 3,  4, 18, 31, 49, 12],
        [16, 28, 37, 50, 61, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:1.0 | [11]:1.0 | [38]:1.0 | [39]:1.0 | [45]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[9]:1.0 | [34]:1.0 | [54]:1.0 | [56]:1.0 | [57]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]
write out information.

EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2740
[1m[33mEnqueueTask: [0m[32mTask: node: ID[568,2d00000013] (16MB) STATE(0) TENSOR[2739,2740,2738,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2981
[1m[33mEnqueueTask: [0m[32mTask: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:1.0 | [11]:1.0 | [31]:1.0 | [50]:1.0 | [57]:2.0 | [47]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[8]:1.0 | [50]:1.0 | [59]:1.0 | [62]:2.0 | [63]:2.0 | [43]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:1.0 | [21]:1.0 | [22]:1.0 | [46]:1.0 | [48]:1.0 | [18]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[3]:1.0 | [18]:1.0 | [22]:1.0 | [34]:1.0 | [60]:1.0 | [25]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[12]:1.0 | [18]:1.0 | [39]:1.0 | [42]:1.0 | [50]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[11]:1.0 | [37]:1.0 | [46]:1.0 | [50]:1.0 | [56]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[11, 37, 46, 50, 56, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 3.800(2776)[0m | [32mExpert 34: 2.400(2704)[0m | [32mExpert 11: 1.800(2629)[0m | [32mExpert 16: 1.800(2644)[0m | 
[32mExpert 28: 1.800(2683)[0m | [32mExpert 41: 1.800(2728)[0m | [32mExpert 46: 1.800(2743)[0m | [32mExpert 27: 1.600(2680)[0m | 
[32mExpert 17: 1.600(2647)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert  1: 1.400(2623)[0m | 
[32mExpert 37: 1.200(2713)[0m | [32mExpert 48: 1.200(2749)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 31: 1.000(2695)[0m | 
[32mExpert  5: 1.000(2755)[0m | [32mExpert 35: 1.000(2707)[0m | [32mExpert 38: 1.000(2716)[0m | [32mExpert 51: 1.000(2761)[0m | 
[32mExpert 59: 1.000(2785)[0m | [32mExpert 60: 1.000(2791)[0m | [32mExpert 22: 0.800(2665)[0m | [32mExpert 44: 0.800(2737)[0m | 
[32mExpert 30: 0.800(2692)[0m | [32mExpert 45: 0.800(2740)[0m | [32mExpert 10: 0.600(2626)[0m | [32mExpert 52: 0.600(2764)[0m | 
[32mExpert 53: 0.600(2767)[0m | [33mExpert  3: 0.400(2689)[0m | [33mExpert 19: 0.400(2653)[0m | [33mExpert 24: 0.400(2671)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2785, 2791, 2665, 2737, 2692, 2740, 2626, 2764, 2767, 2689, 2653, 2671]
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2740[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3, 10, 19, 22, 24, 30, 44, 45, 52, 53, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:1.0 | [8]:1.0 | [38]:1.0 | [41]:1.0 | [42]:1.0 | [50]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[6]:1.0 | [8]:1.0 | [33]:1.0 | [45]:1.0 | [55]:1.0 | [10]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[1]:1.0 | [35]:1.0 | [41]:1.0 | [45]:1.0 | [48]:1.0 | [46]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E45 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[17]:1.0 | [41]:1.0 | [44]:1.0 | [55]:1.0 | [60]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[8]:1.0 | [35]:1.0 | [43]:1.0 | [47]:1.0 | [54]:2.0 | [28]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[7]:1.0 | [29]:1.0 | [38]:1.0 | [43]:1.0 | [46]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 7, 29, 38, 43, 46, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 52: 1.800(3002)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 49: 1.800(2990)[0m | [32mExpert 55: 1.600(3011)[0m | 
[32mExpert 16: 1.600(2882)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert 14: 1.400(2876)[0m | 
[32mExpert 36: 1.400(2948)[0m | [32mExpert  0: 1.400(2858)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | 
[32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 48: 1.200(2987)[0m | [32mExpert 19: 1.200(2891)[0m | 
[32mExpert 38: 1.200(2954)[0m | [32mExpert 63: 1.200(3038)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 40: 1.000(2963)[0m | 
[32mExpert 43: 1.000(2972)[0m | [32mExpert 56: 1.000(3014)[0m | [32mExpert 62: 1.000(3035)[0m | [32mExpert  7: 0.800(3041)[0m | 
[32mExpert  6: 0.600(3026)[0m | [32mExpert  8: 0.600(3044)[0m | [32mExpert 12: 0.600(2870)[0m | [32mExpert 15: 0.600(2879)[0m | 
[32mExpert 26: 0.600(2915)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 33: 0.600(2939)[0m | [32mExpert 46: 0.600(2981)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2972, 3014, 3035, 3041, 3026, 3044, 2870, 2879, 2915, 2918, 2939, 2981]
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2981[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  6,  7,  8, 12, 15, 26, 27, 33, 43, 46, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:1.0 | [21]:1.0 | [29]:1.0 | [33]:1.0 | [44]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[9]:1.0 | [15]:1.0 | [25]:1.0 | [30]:1.0 | [33]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[0]:1.0 | [16]:1.0 | [49]:1.0 | [50]:1.0 | [63]:1.0 | [38]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[10]:1.0 | [15]:1.0 | [16]:1.0 | [17]:1.0 | [41]:1.0 | [33]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[18]:2.0 | [25]:1.0 | [26]:2.0 | [40]:1.0 | [62]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[17]:1.0 | [18]:1.0 | [30]:1.0 | [46]:1.0 | [59]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[17, 18, 30, 46, 59,  3]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 19: 3.400(4109)[0m | [32mExpert 17: 2.800(4103)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert 21: 2.000(4118)[0m | 
[32mExpert  2: 2.000(4112)[0m | [32mExpert 10: 2.000(4082)[0m | EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
[32mExpert 14: 1.800(4094)[0m | [32mExpert 43: 1.800(4190)[0m | 
[32mExpert 54: 1.600(4226)[0m | [32mExpert 35: 1.600(4163)[0m | [32mExpert 56: 1.600(4232)[0m | [32mExpert 57: 1.400(4235)[0m | 
[32mExpert  1: 1.200(4079)[0m | [32mExpert 61: 1.200(4250)[0m | [32mExpert 62: 1.200(4253)[0m | [32mExpert  9: 1.000(4265)[0m | 
[32mExpert 27: 1.000(4136)[0m | [32mExpert 16: 0.800(4100)[0m | [32mExpert 28: 0.800(4139)[0m | [32mExpert 53: 0.800(4223)[0m | 
[32mExpert 48: 0.800(4205)[0m | [32mExpert 51: 0.800(4217)[0m | [32mExpert 23: 0.600(4124)[0m | [32mExpert 37: 0.600(4169)[0m | 
[32mExpert 50: 0.600(4214)[0m | [32mExpert 58: 0.600(4238)[0m | [33mExpert  0: 0.400(4076)[0m | [33mExpert 13: 0.400(4091)[0m | 
[33mExpert 24: 0.400(4127)[0m | [33mExpert 26: 0.400(4133)[0m | [33mExpert 29: 0.400(4142)[0m | [33mExpert 32: 0.400(4154)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4205, 4217, 4124, 4169, 4214, 4238, 4076, 4091, 4127, 4133, 4142, 4154]
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0, 13, 23, 24, 26, 29, 32, 37, 48, 50, 51, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:1.0 | [19]:1.0 | [24]:1.0 | [41]:1.0 | [53]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[15]:1.0 | [22]:1.0 | [25]:1.0 | [44]:1.0 | [50]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[14]:1.0 | [27]:1.0 | [37]:1.0 | [54]:2.0 | [62]:1.0 | [17]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[11]:2.0 | [21]:1.0 | [24]:1.0 | [57]:1.0 | [60]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[6]:1.0 | [7]:1.0 | [23]:1.0 | [26]:1.0 | [40]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[22]:1.0 | [37]:1.0 | [50]:1.0 | [52]:1.0 | [61]:1.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[22, 37, 50, 52, 61, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [12]:1.0 | [57]:1.0 | [63]:1.0 | [21]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[26]:1.0 | [30]:1.0 | [34]:2.0 | [54]:2.0 | [56]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]

EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[11]:2.0 | [31]:2.0 | [47]:2.0 | [50]:2.0 | [57]:3.0 | [12]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[8]:2.0 | [27]:1.0 | [31]:1.0 | [62]:3.0 | [63]:3.0 | [38]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:2.0 | [21]:2.0 | [46]:2.0 | [48]:2.0 | [55]:1.0 | [22]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[3]:2.0 | [18]:2.0 | [22]:2.0 | [34]:2.0 | [60]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[12]:2.0 | [18]:2.0 | [38]:1.0 | [39]:2.0 | [50]:2.0 | [42]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[11]:2.0 | [16]:2.0 | [37]:2.0 | [46]:2.0 | [56]:2.0 | [50]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[11, 16, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 3.800(2776)[0m | [32mExpert 41: 2.600(2728)[0m | [32mExpert 46: 2.600(2743)[0m | [32mExpert 34: 2.400(2704)[0m | 
[32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.000(2749)[0m | [32mExpert 35: 1.800(2707)[0m | [32mExpert 11: 1.800(2629)[0m | 
[32mExpert 16: 1.800(2644)[0m | [32mExpert 28: 1.800(2683)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 45: 1.600(2740)[0m | 
[32mExpert 17: 1.600(2647)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert 37: 1.200(2713)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | 
[32mExpert 51: 1.000(2761)[0m | [32mExpert 59: 1.000(2785)[0m | [32mExpert 60: 1.000(2791)[0m | [32mExpert 22: 0.800(2665)[0m | 
[32mExpert 44: 0.800(2737)[0m | [32mExpert 30: 0.800(2692)[0m | [32mExpert 10: 0.600(2626)[0m | [32mExpert 52: 0.600(2764)[0m | 
[32mExpert 53: 0.600(2767)[0m | [33mExpert  3: 0.400(2689)[0m | [33mExpert 19: 0.400(2653)[0m | [33mExpert 24: 0.400(2671)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2761, 2785, 2791, 2665, 2737, 2692, 2626, 2764, 2767, 2689, 2653, 2671]
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3, 10, 19, 22, 24, 30, 44, 51, 52, 53, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:2.0 | [8]:2.0 | [38]:2.0 | [41]:2.0 | [42]:2.0 | [26]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[6]:2.0 | [8]:2.0 | [33]:2.0 | [45]:2.0 | [55]:2.0 | [46]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[1]:2.0 | [35]:2.0 | [41]:2.0 | [45]:2.0 | [46]:2.0 | [48]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 10 MLP ==
[0m
[17]:2.0 | [41]:2.0 | [55]:2.0 | [59]:1.0 | [60]:2.0 | [44]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[8]:2.0 | [28]:2.0 | [43]:2.0 | [47]:2.0 | [54]:3.0 | [35]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[7]:2.0 | [29]:2.0 | [38]:2.0 | [42]:1.0 | [46]:2.0 | [43]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 7, 29, 38, 42, 46, 43]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 2.600(2990)[0m | [32mExpert 16: 2.400(2882)[0m | [32mExpert  0: 2.200(2858)[0m | [32mExpert 38: 2.000(2954)[0m | 
[32mExpert 63: 2.000(3038)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 55: 1.600(3011)[0m | 
[32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert 14: 1.400(2876)[0m | [32mExpert 36: 1.400(2948)[0m | 
[32mExpert 50: 1.400(2996)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | [32mExpert 53: 1.400(3005)[0m | 
[32mExpert  5: 1.200(2993)[0m | [32mExpert 48: 1.200(2987)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 17: 1.000(2885)[0m | 
[32mExpert 40: 1.000(2963)[0m | [32mExpert 43: 1.000(2972)[0m | [32mExpert 56: 1.000(3014)[0m | [32mExpert 62: 1.000(3035)[0m | 
[32mExpert  7: 0.800(3041)[0m | [32mExpert  6: 0.600(3026)[0m | [32mExpert  8: 0.600(3044)[0m | [32mExpert 12: 0.600(2870)[0m | 
[32mExpert 15: 0.600(2879)[0m | [32mExpert 26: 0.600(2915)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 33: 0.600(2939)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2963, 2972, 3014, 3035, 3041, 3026, 3044, 2870, 2879, 2915, 2918, 2939]
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  6,  7,  8, 12, 15, 26, 27, 33, 40, 43, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:1.0 | [21]:2.0 | [29]:2.0 | [33]:2.0 | [44]:2.0 | [1]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[9]:2.0 | [25]:2.0 | [28]:2.0 | [30]:2.0 | [33]:2.0 | [15]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[0]:2.0 | [8]:1.0 | [16]:2.0 | [49]:2.0 | [50]:2.0 | [55]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[10]:2.0 | [15]:2.0 | [17]:2.0 | [24]:1.0 | [41]:2.0 | [42]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[25]:2.0 | [28]:1.0 | [40]:2.0 | [52]:1.0 | [55]:1.0 | [18]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[18]:2.0 | [23]:1.0 | [46]:2.0 | [51]:1.0 | [53]:1.0 | [57]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[18, 23, 46, 51, 53, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 3.600(4103)[0m | [32mExpert 19: 3.400(4109)[0m | [32mExpert 14: 2.600(4094)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 54: 2.400(4226)[0m | [32mExpert 21: 2.000(4118)[0m | EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
[32mExpert 62: 2.000(4253)[0m | [32mExpert  2: 2.000(4112)[0m | 
[32mExpert 10: 2.000(4082)[0m | [32mExpert 27: 1.800(4136)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 35: 1.600(4163)[0m | 
[32mExpert 56: 1.600(4232)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert  1: 1.200(4079)[0m | 
[32mExpert 61: 1.200(4250)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 16: 0.800(4100)[0m | [32mExpert 28: 0.800(4139)[0m | 
[32mExpert 53: 0.800(4223)[0m | [32mExpert 48: 0.800(4205)[0m | [32mExpert 51: 0.800(4217)[0m | [32mExpert 23: 0.600(4124)[0m | 
[32mExpert 50: 0.600(4214)[0m | [32mExpert 58: 0.600(4238)[0m | [33mExpert  0: 0.400(4076)[0m | [33mExpert 13: 0.400(4091)[0m | 
[33mExpert 24: 0.400(4127)[0m | [33mExpert 26: 0.400(4133)[0m | [33mExpert 29: 0.400(4142)[0m | [33mExpert 32: 0.400(4154)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4223, 4205, 4217, 4124, 4214, 4238, 4076, 4091, 4127, 4133, 4142, 4154]
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0, 13, 23, 24, 26, 29, 32, 48, 50, 51, 53, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:2.0 | [41]:2.0 | [47]:1.0 | [53]:2.0 | [60]:1.0 | [30]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[7]:1.0 | [15]:2.0 | [22]:2.0 | [25]:2.0 | [50]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[14]:2.0 | [27]:2.0 | [48]:1.0 | [54]:3.0 | [62]:2.0 | [6]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:2.0 | [40]:1.0 | [55]:2.0 | [57]:2.0 | [60]:2.0 | [48]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[6]:2.0 | [7]:2.0 | [23]:2.0 | [40]:2.0 | [57]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[22]:2.0 | [28]:1.0 | [37]:2.0 | [50]:2.0 | [61]:2.0 | [16]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[22, 28, 37, 50, 61, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:2.0 | [10]:2.0 | [12]:2.0 | [21]:2.0 | [57]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[26]:2.0 | [30]:2.0 | [34]:3.0 | [36]:1.0 | [48]:2.0 | [56]:3.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[26]:2.0 | [55]:1.0 | [56]:2.0 | [60]:2.0 | [62]:1.0 | [25]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[35]:2.0 | [38]:3.0 | [42]:1.0 | [51]:1.0 | [63]:4.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:3.0 | [5]:1.0 | [7]:1.0 | [45]:1.0 | [48]:3.0 | [15]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[18]:3.0 | [34]:3.0 | [38]:1.0 | [59]:1.0 | [63]:1.0 | [60]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[15]:1.0 | [18]:3.0 | [38]:2.0 | [39]:3.0 | [50]:3.0 | [42]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[6]:1.0 | [19]:1.0 | [37]:3.0 | [46]:3.0 | [56]:3.0 | [50]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 6, 19, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 56: 3.800(2776)[0m | [32mExpert 41: 3.400(2728)[0m | [32mExpert 46: 3.400(2743)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 48: 2.800(2749)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert 45: 2.400(2740)[0m | [32mExpert 34: 2.400(2704)[0m | 
[32mExpert 11: 1.800(2629)[0m | [32mExpert 16: 1.800(2644)[0m | [32mExpert 28: 1.800(2683)[0m | [32mExpert 27: 1.600(2680)[0m | 
[32mExpert 17: 1.600(2647)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert 37: 1.200(2713)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | 
[32mExpert 51: 1.000(2761)[0m | [32mExpert 59: 1.000(2785)[0m | [32mExpert 60: 1.000(2791)[0m | [32mExpert 22: 0.800(2665)[0m | 
[32mExpert 44: 0.800(2737)[0m | [32mExpert 30: 0.800(2692)[0m | [32mExpert 10: 0.600(2626)[0m | [32mExpert 52: 0.600(2764)[0m | 
[32mExpert 53: 0.600(2767)[0m | [33mExpert  3: 0.400(2689)[0m | [33mExpert 19: 0.400(2653)[0m | [33mExpert 24: 0.400(2671)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2761, 2785, 2791, 2665, 2737, 2692, 2626, 2764, 2767, 2689, 2653, 2671]
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3, 10, 19, 22, 24, 30, 44, 51, 52, 53, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:3.0 | [16]:1.0 | [38]:3.0 | [41]:3.0 | [50]:2.0 | [8]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[6]:3.0 | [8]:3.0 | [33]:3.0 | [46]:2.0 | [49]:1.0 | [45]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[41]:3.0 | [45]:3.0 | [46]:3.0 | [53]:1.0 | [55]:1.0 | [17]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:2.0 | [41]:3.0 | [44]:3.0 | [50]:1.0 | [59]:2.0 | [55]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[16]:1.0 | [20]:1.0 | [28]:3.0 | [34]:1.0 | [43]:3.0 | [47]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[12]:1.0 | [29]:3.0 | [38]:3.0 | [43]:3.0 | [47]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[12, 29, 38, 43, 47, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 3.400(2990)[0m | [32mExpert 16: 3.200(2882)[0m | [32mExpert  0: 3.000(2858)[0m | [32mExpert 55: 2.400(3011)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 38: 2.000(2954)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 52: 1.800(3002)[0m | 
[32mExpert 10: 1.800(2864)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | 
[32mExpert 14: 1.400(2876)[0m | [32mExpert 36: 1.400(2948)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | 
[32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 48: 1.200(2987)[0m | [32mExpert 19: 1.200(2891)[0m | 
[32mExpert 17: 1.000(2885)[0m | [32mExpert 40: 1.000(2963)[0m | [32mExpert 43: 1.000(2972)[0m | [32mExpert 56: 1.000(3014)[0m | 
[32mExpert 62: 1.000(3035)[0m | [32mExpert  7: 0.800(3041)[0m | [32mExpert  6: 0.600(3026)[0m | [32mExpert 12: 0.600(2870)[0m | 
[32mExpert 15: 0.600(2879)[0m | [32mExpert 26: 0.600(2915)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 33: 0.600(2939)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2885, 2963, 2972, 3014, 3035, 3041, 3026, 2870, 2879, 2915, 2918, 2939]
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  6,  7, 12, 15, 17, 26, 27, 33, 40, 43, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:2.0 | [10]:1.0 | [17]:1.0 | [23]:1.0 | [29]:3.0 | [1]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[9]:3.0 | [27]:2.0 | [28]:3.0 | [47]:1.0 | [51]:2.0 | [3]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[0]:3.0 | [4]:1.0 | [6]:1.0 | [16]:3.0 | [23]:1.0 | [55]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:2.0 | [10]:3.0 | [17]:3.0 | [26]:2.0 | [41]:3.0 | [16]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[1]:1.0 | [2]:1.0 | [10]:1.0 | [40]:3.0 | [45]:1.0 | [62]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[18]:3.0 | [35]:1.0 | [37]:1.0 | [46]:3.0 | [59]:2.0 | [30]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[18, 35, 37, 46, 59, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
[90mTop 20 Experts:[0m
[32mExpert 17: 3.600(4103)[0m | [32mExpert 14: 3.400(4094)[0m | [32mExpert 19: 3.400(4109)[0m | [32mExpert 54: 3.200(4226)[0m | 
[32mExpert 62: 2.800(4253)[0m | [32mExpert 27: 2.600(4136)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert 21: 2.000(4118)[0m | 
[32mExpert  2: 2.000(4112)[0m | [32mExpert 10: 2.000(4082)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 35: 1.600(4163)[0m | [32mExpert 56: 1.600(4232)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 57: 1.400(4235)[0m | 
[32mExpert  1: 1.200(4079)[0m | [32mExpert 61: 1.200(4250)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | 
[32mExpert 16: 0.800(4100)[0m | [32mExpert 28: 0.800(4139)[0m | [32mExpert 53: 0.800(4223)[0m | [32mExpert 51: 0.800(4217)[0m | 
[32mExpert 23: 0.600(4124)[0m | [32mExpert 50: 0.600(4214)[0m | [32mExpert 58: 0.600(4238)[0m | [33mExpert  0: 0.400(4076)[0m | 
[33mExpert 13: 0.400(4091)[0m | [33mExpert 24: 0.400(4127)[0m | [33mExpert 26: 0.400(4133)[0m | [33mExpert 29: 0.400(4142)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4100, 4139, 4223, 4217, 4124, 4214, 4238, 4076, 4091, 4127, 4133, 4142]
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0, 13, 16, 23, 24, 26, 28, 29, 50, 51, 53, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:1.0 | [16]:1.0 | [24]:2.0 | [53]:3.0 | [58]:1.0 | [23]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[7]:2.0 | [15]:3.0 | [44]:2.0 | [50]:3.0 | [55]:1.0 | [56]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[1]:1.0 | [42]:1.0 | [54]:4.0 | [59]:1.0 | [62]:3.0 | [51]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:2.0 | [11]:3.0 | [48]:3.0 | [60]:3.0 | [63]:1.0 | [21]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[11]:2.0 | [23]:3.0 | [38]:1.0 | [40]:3.0 | [57]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[19]:1.0 | [22]:3.0 | [24]:2.0 | [50]:3.0 | [61]:3.0 | [37]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[19, 22, 24, 50, 61, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:3.0 | [10]:3.0 | [12]:3.0 | [57]:3.0 | [63]:2.0 | [26]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[30]:3.0 | [34]:4.0 | [36]:2.0 | [56]:4.0 | [63]:1.0 | [48]:3.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2764
[1m[33mEnqueueTask: [0m[32mTask: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[575,3400000013] (16MB) STATE(0) TENSOR[2763,2764,2762,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:1.0 | [20]:1.0 | [26]:3.0 | [30]:1.0 | [56]:3.0 | [11]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[12]:1.0 | [21]:1.0 | [42]:2.0 | [51]:2.0 | [57]:1.0 | [14]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:4.0 | [3]:1.0 | [17]:1.0 | [29]:1.0 | [34]:1.0 | [42]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[6]:1.0 | [9]:1.0 | [24]:1.0 | [25]:2.0 | [46]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[13]:1.0 | [15]:2.0 | [35]:1.0 | [38]:3.0 | [42]:4.0 | [41]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[4]:1.0 | [19]:2.0 | [29]:1.0 | [41]:1.0 | [46]:4.0 | [32]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 4, 19, 29, 41, 46, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 4.200(2728)[0m | [32mExpert 46: 4.200(2743)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 45: 3.200(2740)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 48: 2.800(2749)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert 17: 2.400(2647)[0m | 
[32mExpert 34: 2.400(2704)[0m | [32mExpert 11: 1.800(2629)[0m | [32mExpert 16: 1.800(2644)[0m | [32mExpert 28: 1.800(2683)[0m | 
[32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert 53: 1.400(2767)[0m | 
[32mExpert 37: 1.200(2713)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert  5: 1.000(2755)[0m | 
[32mExpert 38: 1.000(2716)[0m | [32mExpert 51: 1.000(2761)[0m | [32mExpert 59: 1.000(2785)[0m | [32mExpert 60: 1.000(2791)[0m | 
[32mExpert 22: 0.800(2665)[0m | [32mExpert 44: 0.800(2737)[0m | [32mExpert 55: 0.800(2773)[0m | [32mExpert 30: 0.800(2692)[0m | 
[32mExpert 10: 0.600(2626)[0m | [32mExpert 52: 0.600(2764)[0m | [33mExpert  3: 0.400(2689)[0m | [33mExpert 19: 0.400(2653)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2716, 2761, 2785, 2791, 2665, 2737, 2773, 2692, 2626, 2764, 2689, 2653]
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2764[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3, 10, 19, 22, 30, 38, 44, 51, 52, 55, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:4.0 | [10]:1.0 | [39]:1.0 | [47]:1.0 | [50]:3.0 | [34]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[13]:1.0 | [30]:2.0 | [39]:2.0 | [52]:1.0 | [54]:2.0 | [16]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[4]:1.0 | [7]:1.0 | [23]:1.0 | [34]:1.0 | [55]:2.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:1.0 | [16]:1.0 | [20]:1.0 | [42]:2.0 | [49]:1.0 | [33]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[15]:1.0 | [16]:2.0 | [27]:2.0 | [29]:1.0 | [33]:1.0 | [43]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[8]:1.0 | [16]:2.0 | [23]:1.0 | [31]:1.0 | [62]:1.0 | [28]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 8, 16, 23, 31, 62, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.000(2882)[0m | [32mExpert  0: 3.800(2858)[0m | [32mExpert 49: 3.400(2990)[0m | [32mExpert 55: 3.200(3011)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 38: 2.000(2954)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 52: 1.800(3002)[0m | 
[32mExpert 10: 1.800(2864)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  6: 1.400(3026)[0m | 
[32mExpert  8: 1.400(3044)[0m | [32mExpert 14: 1.400(2876)[0m | [32mExpert 36: 1.400(2948)[0m | [32mExpert 25: 1.400(2912)[0m | 
[32mExpert 37: 1.400(2951)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert  4: 1.200(2960)[0m | [32mExpert  5: 1.200(2993)[0m | 
[32mExpert 48: 1.200(2987)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 40: 1.000(2963)[0m | 
[32mExpert 43: 1.000(2972)[0m | [32mExpert 56: 1.000(3014)[0m | [32mExpert 62: 1.000(3035)[0m | [32mExpert 23: 0.800(2906)[0m | 
[32mExpert  7: 0.800(3041)[0m | [32mExpert 12: 0.600(2870)[0m | [32mExpert 15: 0.600(2879)[0m | [32mExpert 26: 0.600(2915)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2987, 2891, 2885, 2963, 2972, 3014, 3035, 2906, 3041, 2870, 2879, 2915]
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7, 12, 15, 17, 19, 23, 26, 40, 43, 48, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:1.0 | [6]:3.0 | [16]:1.0 | [24]:2.0 | [26]:1.0 | [36]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[5]:2.0 | [23]:2.0 | [51]:3.0 | [55]:1.0 | [59]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[4]:2.0 | [14]:2.0 | [24]:1.0 | [36]:2.0 | [40]:1.0 | [26]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E40 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:1.0 | [18]:1.0 | [20]:1.0 | [51]:1.0 | [61]:1.0 | [22]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[1]:2.0 | [3]:1.0 | [10]:2.0 | [24]:1.0 | [32]:1.0 | [45]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[13]:1.0 | [14]:1.0 | [35]:2.0 | [47]:1.0 | [49]:2.0 | [2]:2.0 | EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[13, 14, 35, 47, 49,  2]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.600(4253)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 14: 3.400(4094)[0m | 
[32mExpert 19: 3.400(4109)[0m | [32mExpert 27: 2.600(4136)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert  1: 2.000(4079)[0m | 
[32mExpert 21: 2.000(4118)[0m | [32mExpert  2: 2.000(4112)[0m | [32mExpert 10: 2.000(4082)[0m | [32mExpert 43: 1.800(4190)[0m | 
[32mExpert 48: 1.600(4205)[0m | [32mExpert 51: 1.600(4217)[0m | [32mExpert 35: 1.600(4163)[0m | [32mExpert 56: 1.600(4232)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert 61: 1.200(4250)[0m | [32mExpert 59: 1.000(4241)[0m | 
[32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | [32mExpert 16: 0.800(4100)[0m | [32mExpert 28: 0.800(4139)[0m | 
[32mExpert 42: 0.800(4187)[0m | [32mExpert 53: 0.800(4223)[0m | [32mExpert 23: 0.600(4124)[0m | [32mExpert 50: 0.600(4214)[0m | 
[32mExpert 58: 0.600(4238)[0m | [33mExpert  0: 0.400(4076)[0m | [33mExpert 13: 0.400(4091)[0m | [33mExpert 24: 0.400(4127)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4265, 4244, 4100, 4139, 4187, 4223, 4124, 4214, 4238, 4076, 4091, 4127]
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  6,  9, 13, 16, 23, 24, 28, 42, 50, 53, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[12]:1.0 | [24]:3.0 | [35]:1.0 | [39]:1.0 | [42]:1.0 | [38]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[30]:1.0 | [44]:3.0 | [55]:2.0 | [60]:1.0 | [61]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[4]:1.0 | [18]:1.0 | [49]:1.0 | [51]:2.0 | [58]:1.0 | [10]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:3.0 | [27]:1.0 | [30]:1.0 | [49]:1.0 | [63]:2.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[13]:1.0 | [33]:1.0 | [39]:1.0 | [47]:2.0 | [58]:1.0 | [63]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[7]:1.0 | [15]:1.0 | [24]:3.0 | [29]:1.0 | [31]:1.0 | [34]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 7, 15, 24, 29, 31, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[13]:1.0 | [15]:1.0 | [21]:3.0 | [32]:1.0 | [46]:1.0 | [33]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[17]:1.0 | [38]:1.0 | [42]:1.0 | [43]:1.0 | [56]:5.0 | [18]:1.0 | 
---------------------------------------
return EAMC[0]
```python
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2803
[1m[33mEnqueueTask: [0m[32mTask: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[31]:3.0 | [46]:1.0 | [50]:3.0 | [56]:4.0 | [57]:4.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[11]:1.0 | [46]:1.0 | [51]:3.0 | [62]:4.0 | [63]:5.0 | [47]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:5.0 | [5]:2.0 | [22]:3.0 | [46]:3.0 | [48]:4.0 | [21]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[3]:3.0 | [18]:4.0 | [34]:4.0 | [59]:2.0 | [60]:4.0 | [13]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[15]:3.0 | [38]:4.0 | [39]:4.0 | [41]:2.0 | [50]:4.0 | [18]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[6]:2.0 | [19]:3.0 | [35]:1.0 | [46]:5.0 | [56]:4.0 | [37]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 6, 19, 35, 46, 56, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 4.200(2728)[0m | [32mExpert 46: 4.200(2743)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 45: 3.200(2740)[0m | 
[32mExpert 34: 3.200(2704)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 48: 2.800(2749)[0m | [32mExpert 35: 2.600(2707)[0m | 
[32mExpert 17: 2.400(2647)[0m | [32mExpert 11: 1.800(2629)[0m | [32mExpert 16: 1.800(2644)[0m | [32mExpert 28: 1.800(2683)[0m | 
[32mExpert 55: 1.600(2773)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | 
[32mExpert 53: 1.400(2767)[0m | [32mExpert 37: 1.200(2713)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 31: 1.000(2695)[0m | 
[32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | [32mExpert 51: 1.000(2761)[0m | [32mExpert 59: 1.000(2785)[0m | 
[32mExpert 60: 1.000(2791)[0m | [32mExpert  4: 0.800(2722)[0m | [32mExpert  7: 0.800(2803)[0m | [32mExpert 14: 0.800(2638)[0m | 
[32mExpert 22: 0.800(2665)[0m | [32mExpert 23: 0.800(2668)[0m | [32mExpert 44: 0.800(2737)[0m | [32mExpert 30: 0.800(2692)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2755, 2716, 2761, 2785, 2791, 2722, 2803, 2638, 2665, 2668, 2737, 2692]
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2803[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  7, 14, 22, 23, 30, 38, 44, 51, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:4.0 | [16]:2.0 | [17]:1.0 | [41]:4.0 | [50]:4.0 | [38]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[6]:4.0 | [8]:4.0 | [18]:1.0 | [45]:4.0 | [46]:3.0 | [33]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[19]:1.0 | [41]:4.0 | [45]:4.0 | [46]:4.0 | [53]:2.0 | [1]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 10 MLP ==
[0m
[30]:3.0 | [41]:4.0 | [44]:4.0 | [50]:2.0 | [51]:1.0 | [55]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[28]:4.0 | [34]:2.0 | [43]:5.0 | [47]:4.0 | [63]:1.0 | [20]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[12]:2.0 | [16]:3.0 | [29]:4.0 | [41]:1.0 | [58]:1.0 | [42]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[12, 16, 29, 41, 58, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.000(2882)[0m | [32mExpert  0: 3.800(2858)[0m | [32mExpert 49: 3.400(2990)[0m | [32mExpert 55: 3.200(3011)[0m | 
[32mExpert 14: 2.200(2876)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert  4: 2.000(2960)[0m | 
[32mExpert 38: 2.000(2954)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 40: 1.800(2963)[0m | [32mExpert 52: 1.800(3002)[0m | 
[32mExpert 10: 1.800(2864)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  6: 1.400(3026)[0m | 
[32mExpert  8: 1.400(3044)[0m | [32mExpert 26: 1.400(2915)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | 
[32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 48: 1.200(2987)[0m | 
[32mExpert 19: 1.200(2891)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 43: 1.000(2972)[0m | [32mExpert 56: 1.000(3014)[0m | 
[32mExpert 62: 1.000(3035)[0m | [32mExpert 23: 0.800(2906)[0m | [32mExpert  7: 0.800(3041)[0m | [32mExpert 12: 0.600(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3005, 2993, 2909, 2987, 2891, 2885, 2972, 3014, 3035, 2906, 3041, 2870]
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  7, 12, 17, 19, 23, 24, 43, 48, 53, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[23]:2.0 | [29]:4.0 | [30]:1.0 | [33]:3.0 | [37]:1.0 | [44]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[9]:4.0 | [28]:4.0 | [33]:3.0 | [43]:1.0 | [50]:1.0 | [25]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[0]:4.0 | [15]:1.0 | [16]:4.0 | [29]:1.0 | [49]:3.0 | [6]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[15]:3.0 | [16]:3.0 | [41]:4.0 | [44]:1.0 | [59]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:2.0 | [25]:3.0 | [26]:3.0 | [40]:4.0 | [62]:3.0 | [18]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[17]:2.0 | [18]:4.0 | [21]:1.0 | [30]:3.0 | [46]:4.0 | [53]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[17, 18, 21, 30, 46, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.600(4253)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 14: 3.400(4094)[0m | 
[32mExpert 19: 3.400(4109)[0m | [32mExpert 10: 2.800(4082)[0m | [32mExpert 27: 2.600(4136)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 51: 2.400(4217)[0m | [32mExpert  1: 2.000(4079)[0m | [32mExpert 21: 2.000(4118)[0m | [32mExpert  2: 2.000(4112)[0m | 
[32mExpert 43: 1.800(4190)[0m | EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
[32mExpert 48: 1.600(4205)[0m | [32mExpert 35: 1.600(4163)[0m | [32mExpert 56: 1.600(4232)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 58: 1.400(4238)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert 61: 1.200(4250)[0m | 
[32mExpert  4: 1.000(4178)[0m | [32mExpert 49: 1.000(4208)[0m | [32mExpert 59: 1.000(4241)[0m | [32mExpert  9: 1.000(4265)[0m | 
[32mExpert  6: 0.800(4244)[0m | [32mExpert 16: 0.800(4100)[0m | [32mExpert 18: 0.800(4106)[0m | [32mExpert 28: 0.800(4139)[0m | 
[32mExpert 42: 0.800(4187)[0m | [32mExpert 53: 0.800(4223)[0m | [32mExpert 23: 0.600(4124)[0m | [32mExpert 50: 0.600(4214)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4178, 4208, 4241, 4265, 4244, 4100, 4106, 4139, 4187, 4223, 4124, 4214]
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  6,  9, 16, 18, 23, 28, 42, 49, 50, 53, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[19]:2.0 | [24]:4.0 | [32]:1.0 | [41]:3.0 | [43]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[16]:1.0 | [27]:1.0 | [33]:1.0 | [50]:4.0 | [53]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[19]:2.0 | [27]:3.0 | [39]:1.0 | [42]:2.0 | [55]:1.0 | [59]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E59 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:4.0 | [33]:1.0 | [48]:4.0 | [55]:3.0 | [60]:4.0 | [6]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[0]:2.0 | [7]:3.0 | [23]:4.0 | [25]:1.0 | [57]:3.0 | [6]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:2.0 | [22]:4.0 | [28]:2.0 | [37]:4.0 | [50]:4.0 | [42]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 22, 28, 37, 50, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:2.0 | [2]:4.0 | [10]:4.0 | [12]:4.0 | [44]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[9]:2.0 | [26]:3.0 | [30]:4.0 | [34]:5.0 | [63]:2.0 | [51]:1.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2803
[1m[33mEnqueueTask: [0m[32mTask: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[5]:1.0 | [8]:2.0 | [23]:1.0 | [42]:1.0 | [56]:5.0 | [32]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[35]:3.0 | [38]:4.0 | [42]:3.0 | [57]:2.0 | [61]:1.0 | [63]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:6.0 | [4]:2.0 | [7]:2.0 | [54]:2.0 | [58]:1.0 | [56]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[6]:2.0 | [29]:2.0 | [34]:5.0 | [38]:2.0 | [44]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[36]:1.0 | [38]:5.0 | [41]:3.0 | [42]:5.0 | [55]:1.0 | [5]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[6]:3.0 | [19]:4.0 | [32]:3.0 | [46]:6.0 | [55]:1.0 | [4]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 6, 19, 32, 46, 55,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.000(2728)[0m | [32mExpert 46: 5.000(2743)[0m | [32mExpert 45: 4.000(2740)[0m | [32mExpert  1: 3.800(2623)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 34: 3.200(2704)[0m | [32mExpert 48: 2.800(2749)[0m | [32mExpert 35: 2.600(2707)[0m | 
[32mExpert 17: 2.400(2647)[0m | [32mExpert 53: 2.200(2767)[0m | [32mExpert 11: 1.800(2629)[0m | [32mExpert 16: 1.800(2644)[0m | 
[32mExpert 28: 1.800(2683)[0m | [32mExpert 55: 1.600(2773)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | 
[32mExpert 12: 1.400(2632)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 37: 1.200(2713)[0m | [32mExpert 13: 1.000(2635)[0m | 
[32mExpert 31: 1.000(2695)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | [32mExpert 51: 1.000(2761)[0m | 
[32mExpert 59: 1.000(2785)[0m | [32mExpert 60: 1.000(2791)[0m | [32mExpert  4: 0.800(2722)[0m | [32mExpert  7: 0.800(2803)[0m | 
[32mExpert 14: 0.800(2638)[0m | [32mExpert 22: 0.800(2665)[0m | [32mExpert 23: 0.800(2668)[0m | [32mExpert 44: 0.800(2737)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2695, 2755, 2716, 2761, 2785, 2791, 2722, 2803, 2638, 2665, 2668, 2737]
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2803[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  7, 14, 22, 23, 31, 38, 44, 51, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[4]:1.0 | [10]:2.0 | [39]:2.0 | [50]:5.0 | [54]:1.0 | [16]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[8]:5.0 | [33]:5.0 | [34]:1.0 | [35]:1.0 | [39]:3.0 | [54]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[33]:1.0 | [45]:5.0 | [50]:1.0 | [53]:3.0 | [55]:3.0 | [21]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 10 MLP ==
[0m
[39]:1.0 | [41]:5.0 | [44]:5.0 | [47]:2.0 | [50]:3.0 | [59]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[20]:3.0 | [34]:3.0 | [43]:6.0 | [53]:1.0 | [63]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[12]:3.0 | [29]:5.0 | [30]:2.0 | [47]:2.0 | [58]:2.0 | [50]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[12, 29, 30, 47, 58, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.800(2882)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert 55: 3.200(3011)[0m | 
[32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert  4: 2.000(2960)[0m | [32mExpert 38: 2.000(2954)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 40: 1.800(2963)[0m | 
[32mExpert 52: 1.800(3002)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | 
[32mExpert  8: 1.400(3044)[0m | [32mExpert 15: 1.400(2879)[0m | [32mExpert 26: 1.400(2915)[0m | [32mExpert 25: 1.400(2912)[0m | 
[32mExpert 37: 1.400(2951)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 24: 1.200(2909)[0m | 
[32mExpert 48: 1.200(2987)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 43: 1.000(2972)[0m | 
[32mExpert 56: 1.000(3014)[0m | [32mExpert 62: 1.000(3035)[0m | [32mExpert 23: 0.800(2906)[0m | [32mExpert 29: 0.800(2924)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2951, 3005, 2993, 2909, 2987, 2891, 2885, 2972, 3014, 3035, 2906, 2924]
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 17, 19, 23, 24, 29, 37, 43, 48, 53, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[20]:1.0 | [23]:3.0 | [37]:2.0 | [42]:1.0 | [54]:1.0 | [30]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[43]:2.0 | [48]:1.0 | [57]:1.0 | [60]:1.0 | [63]:1.0 | [27]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[15]:2.0 | [18]:1.0 | [33]:1.0 | [34]:1.0 | [61]:1.0 | [38]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[3]:1.0 | [10]:4.0 | [30]:2.0 | [47]:1.0 | [52]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:3.0 | [15]:1.0 | [20]:1.0 | [38]:1.0 | [39]:1.0 | [61]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[14]:2.0 | [18]:5.0 | [21]:2.0 | [34]:1.0 | [61]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[14, 18, 21, 34, 61,  9]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 19: 4.200(4109)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.600(4253)[0m | [32mExpert 17: 3.600(4103)[0m | 
[32mExpert 27: 3.400(4136)[0m | [32mExpert 14: 3.400(4094)[0m | [32mExpert 10: 2.800(4082)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 51: 2.400(4217)[0m | [32mExpert  1: 2.000(4079)[0m | [32mExpert 21: 2.000(4118)[0m | [32mExpert  2: 2.000(4112)[0m | 
[32mExpert 59: 1.800(4241)[0m | EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
[32mExpert 43: 1.800(4190)[0m | [32mExpert 42: 1.600(4187)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 35: 1.600(4163)[0m | [32mExpert 56: 1.600(4232)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 58: 1.400(4238)[0m | 
[32mExpert 57: 1.400(4235)[0m | [32mExpert 55: 1.200(4229)[0m | [32mExpert 61: 1.200(4250)[0m | [32mExpert  4: 1.000(4178)[0m | 
[32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | [32mExpert 16: 0.800(4100)[0m | 
[32mExpert 18: 0.800(4106)[0m | [32mExpert 28: 0.800(4139)[0m | [32mExpert 39: 0.800(4175)[0m | [32mExpert 53: 0.800(4223)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4235, 4229, 4250, 4178, 4208, 4265, 4244, 4100, 4106, 4139, 4175, 4223]
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  6,  9, 16, 18, 28, 39, 49, 53, 55, 57, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:1.0 | [18]:1.0 | [21]:1.0 | [32]:2.0 | [60]:2.0 | [43]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[7]:3.0 | [32]:2.0 | [33]:2.0 | [40]:2.0 | [50]:5.0 | [53]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[35]:1.0 | [42]:3.0 | [55]:2.0 | [59]:3.0 | [61]:1.0 | [10]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:2.0 | [6]:2.0 | [44]:1.0 | [50]:1.0 | [62]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[9]:2.0 | [17]:1.0 | [25]:2.0 | [50]:1.0 | [60]:2.0 | [59]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:3.0 | [25]:1.0 | [28]:3.0 | [50]:5.0 | [60]:1.0 | [36]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 25, 28, 50, 60, 36]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[5]:1.0 | [10]:5.0 | [18]:1.0 | [23]:1.0 | [41]:1.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[12]:1.0 | [28]:1.0 | [32]:1.0 | [50]:1.0 | [51]:2.0 | [52]:1.0 | 
---------------------------------------
return EAMC[0]
import EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2803
[1m[33mEnqueueTask: [0m[32mTask: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[530,700000013] (16MB) STATE(0) TENSOR[2802,2803,2801,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3035
[1m[33mEnqueueTask: [0m[32mTask: node: ID[975,3e0000001f] (16MB) STATE(0) TENSOR[3034,3035,3033,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[24]:1.0 | [33]:1.0 | [56]:6.0 | [62]:2.0 | [63]:1.0 | [32]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[12]:2.0 | [33]:1.0 | [35]:4.0 | [51]:4.0 | [57]:3.0 | [53]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:7.0 | [29]:2.0 | [53]:1.0 | [54]:3.0 | [63]:1.0 | [52]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[6]:3.0 | [24]:2.0 | [46]:2.0 | [48]:1.0 | [54]:1.0 | [2]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[29]:1.0 | [35]:2.0 | [38]:6.0 | [44]:1.0 | [54]:2.0 | [13]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[4]:3.0 | [9]:1.0 | [20]:1.0 | [41]:2.0 | [57]:1.0 | [15]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 4,  9, 20, 41, 57, 15]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.000(2728)[0m | [32mExpert 46: 5.000(2743)[0m | [32mExpert 45: 4.800(2740)[0m | [32mExpert  1: 3.800(2623)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 34: 3.200(2704)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert 48: 2.800(2749)[0m | 
[32mExpert 35: 2.600(2707)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 11: 1.800(2629)[0m | 
[32mExpert 16: 1.800(2644)[0m | [32mExpert 28: 1.800(2683)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | 
[32mExpert 12: 1.400(2632)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 37: 1.200(2713)[0m | [32mExpert 13: 1.000(2635)[0m | 
[32mExpert 31: 1.000(2695)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | 
[32mExpert 51: 1.000(2761)[0m | [32mExpert 59: 1.000(2785)[0m | [32mExpert 60: 1.000(2791)[0m | [32mExpert  4: 0.800(2722)[0m | 
[32mExpert  7: 0.800(2803)[0m | [32mExpert 14: 0.800(2638)[0m | [32mExpert 21: 0.800(2662)[0m | [32mExpert 22: 0.800(2665)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2695, 2701, 2755, 2716, 2761, 2785, 2791, 2722, 2803, 2638, 2662, 2665]
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2803[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  7, 14, 21, 22, 31, 33, 38, 51, 59, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:1.0 | [11]:1.0 | [39]:3.0 | [47]:2.0 | [57]:1.0 | [46]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[1]:1.0 | [11]:2.0 | [13]:2.0 | [39]:4.0 | [53]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[7]:2.0 | [9]:1.0 | [16]:1.0 | [26]:1.0 | [34]:2.0 | [63]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E7 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[8]:1.0 | [10]:2.0 | [16]:2.0 | [25]:1.0 | [49]:2.0 | [32]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[2]:1.0 | [22]:1.0 | [42]:1.0 | [58]:1.0 | [59]:1.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[1]:1.0 | [22]:1.0 | [32]:1.0 | [33]:1.0 | [62]:2.0 | [31]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 1, 22, 32, 33, 62, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.800(2882)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert 55: 3.200(3011)[0m | 
[32mExpert 38: 2.800(2954)[0m | [32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 15: 2.200(2879)[0m | 
[32mExpert 36: 2.200(2948)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert  4: 2.000(2960)[0m | [32mExpert 63: 2.000(3038)[0m | 
[32mExpert 40: 1.800(2963)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 58: 1.600(3020)[0m | 
[32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | [32mExpert 26: 1.400(2915)[0m | [32mExpert 33: 1.400(2939)[0m | 
[32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | 
[32mExpert 24: 1.200(2909)[0m | [32mExpert 48: 1.200(2987)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 61: 1.000(3032)[0m | 
[32mExpert 17: 1.000(2885)[0m | [32mExpert 43: 1.000(2972)[0m | [32mExpert 56: 1.000(3014)[0m | [32mExpert 62: 1.000(3035)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2951, 3005, 2993, 2909, 2987, 2891, 3032, 2885, 2972, 3014, 3035]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3035[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 17, 19, 24, 25, 37, 43, 48, 53, 56, 61, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[22]:1.0 | [23]:4.0 | [36]:3.0 | [48]:1.0 | [63]:1.0 | [26]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[20]:1.0 | [48]:2.0 | [55]:2.0 | [58]:1.0 | [60]:2.0 | [59]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[11]:1.0 | [18]:2.0 | [40]:2.0 | [48]:2.0 | [57]:1.0 | [36]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:1.0 | [20]:2.0 | [26]:3.0 | [47]:2.0 | [54]:1.0 | [30]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[24]:2.0 | [29]:1.0 | [30]:1.0 | [45]:3.0 | [51]:1.0 | [2]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[14]:3.0 | [19]:1.0 | [35]:3.0 | [47]:2.0 | [58]:1.0 | [49]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[14, 19, 35, 47, 58, 49]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
[90mTop 20 Experts:[0m
[32mExpert 19: 4.200(4109)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.600(4253)[0m | [32mExpert 10: 3.600(4082)[0m | 
[32mExpert 17: 3.600(4103)[0m | [32mExpert 27: 3.400(4136)[0m | [32mExpert 14: 3.400(4094)[0m | [32mExpert 59: 2.600(4241)[0m | 
[32mExpert 30: 2.600(4148)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 51: 2.400(4217)[0m | [32mExpert 35: 2.400(4163)[0m | 
[32mExpert 55: 2.000(4229)[0m | [32mExpert  1: 2.000(4079)[0m | [32mExpert 21: 2.000(4118)[0m | [32mExpert 61: 2.000(4250)[0m | 
[32mExpert  2: 2.000(4112)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 48: 1.600(4205)[0m | [32mExpert 56: 1.600(4232)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 58: 1.400(4238)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert  4: 1.000(4178)[0m | 
[32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | [32mExpert 16: 0.800(4100)[0m | 
[32mExpert 18: 0.800(4106)[0m | [32mExpert 28: 0.800(4139)[0m | [32mExpert 39: 0.800(4175)[0m | [32mExpert 53: 0.800(4223)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4169, 4238, 4235, 4178, 4208, 4265, 4244, 4100, 4106, 4139, 4175, 4223]
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  6,  9, 16, 18, 28, 37, 39, 49, 53, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:2.0 | [6]:2.0 | [11]:1.0 | [12]:2.0 | [39]:2.0 | [56]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[7]:4.0 | [13]:1.0 | [16]:2.0 | [33]:3.0 | [60]:2.0 | [27]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[2]:1.0 | [10]:3.0 | [41]:1.0 | [56]:1.0 | [59]:4.0 | [21]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[3]:2.0 | [6]:3.0 | [17]:1.0 | [43]:1.0 | [49]:2.0 | [8]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[3]:2.0 | [9]:3.0 | [13]:2.0 | [47]:3.0 | [52]:1.0 | [45]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[8]:1.0 | [10]:2.0 | [32]:1.0 | [53]:1.0 | [54]:1.0 | [16]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 8, 10, 32, 53, 54, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:1.0 | [23]:2.0 | [32]:2.0 | [38]:2.0 | [52]:1.0 | [55]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[11]:1.0 | [17]:2.0 | [25]:1.0 | [57]:2.0 | [59]:1.0 | [53]:1.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[6]:1.0 | [20]:2.0 | [29]:1.0 | [33]:2.0 | [59]:1.0 | [50]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[2]:1.0 | [33]:2.0 | [40]:1.0 | [43]:2.0 | [57]:4.0 | [4]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:8.0 | [3]:2.0 | [29]:3.0 | [36]:1.0 | [54]:4.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[6]:4.0 | [24]:3.0 | [40]:1.0 | [46]:3.0 | [48]:2.0 | [1]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[4]:1.0 | [8]:1.0 | [13]:3.0 | [46]:1.0 | [52]:2.0 | [55]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[4]:4.0 | [9]:2.0 | [29]:2.0 | [32]:4.0 | [41]:3.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 4,  9, 29, 32, 41, 48]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.000(2728)[0m | [32mExpert 46: 5.000(2743)[0m | [32mExpert 45: 4.800(2740)[0m | [32mExpert 34: 4.000(2704)[0m | 
[32mExpert  1: 3.800(2623)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert 48: 2.800(2749)[0m | 
[32mExpert 16: 2.600(2644)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 17: 2.400(2647)[0m | 
[32mExpert 11: 1.800(2629)[0m | [32mExpert 28: 1.800(2683)[0m | [32mExpert  7: 1.600(2803)[0m | [32mExpert 27: 1.600(2680)[0m | 
[32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 37: 1.200(2713)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 63: 1.000(2800)[0m | 
[32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | [32mExpert 51: 1.000(2761)[0m | [32mExpert 59: 1.000(2785)[0m | 
[32mExpert 60: 1.000(2791)[0m | [32mExpert  4: 0.800(2722)[0m | [32mExpert  9: 0.800(2809)[0m | [32mExpert 14: 0.800(2638)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2635, 2695, 2701, 2800, 2755, 2716, 2761, 2785, 2791, 2722, 2809, 2638]
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  9, 13, 14, 31, 33, 38, 51, 59, 60, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:2.0 | [27]:1.0 | [28]:2.0 | [39]:4.0 | [47]:3.0 | [24]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[1]:2.0 | [11]:3.0 | [13]:3.0 | [30]:3.0 | [52]:2.0 | [44]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[7]:3.0 | [9]:2.0 | [26]:2.0 | [31]:2.0 | [34]:3.0 | [11]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[8]:2.0 | [10]:3.0 | [16]:3.0 | [35]:1.0 | [42]:3.0 | [25]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[16]:3.0 | [22]:2.0 | [52]:1.0 | [58]:2.0 | [59]:2.0 | [61]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[23]:2.0 | [31]:3.0 | [32]:2.0 | [33]:2.0 | [62]:3.0 | [8]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[23, 31, 32, 33, 62,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.800(2882)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert 55: 3.200(3011)[0m | 
[32mExpert 36: 3.000(2948)[0m | [32mExpert 38: 2.800(2954)[0m | [32mExpert 40: 2.600(2963)[0m | [32mExpert  6: 2.200(3026)[0m | 
[32mExpert 14: 2.200(2876)[0m | [32mExpert 15: 2.200(2879)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert  4: 2.000(2960)[0m | 
[32mExpert 48: 2.000(2987)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 10: 1.800(2864)[0m | 
[32mExpert 18: 1.600(2888)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | 
[32mExpert 26: 1.400(2915)[0m | [32mExpert 33: 1.400(2939)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | 
[32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 19: 1.200(2891)[0m | 
[32mExpert 11: 1.000(2867)[0m | [32mExpert 61: 1.000(3032)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 43: 1.000(2972)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2915, 2939, 2912, 2951, 3005, 2993, 2909, 2891, 2867, 3032, 2885, 2972]
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5, 11, 17, 19, 24, 25, 26, 33, 37, 43, 53, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[10]:2.0 | [15]:1.0 | [24]:3.0 | [36]:4.0 | [63]:2.0 | [5]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[19]:1.0 | [38]:1.0 | [46]:1.0 | [55]:3.0 | [59]:3.0 | [52]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[11]:2.0 | [25]:1.0 | [36]:4.0 | [37]:1.0 | [48]:3.0 | [40]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E11 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E37 â•‘[0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:2.0 | [18]:2.0 | [25]:1.0 | [40]:1.0 | [53]:1.0 | [6]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[24]:3.0 | [28]:2.0 | [30]:2.0 | [45]:4.0 | [50]:1.0 | [10]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[7]:1.0 | [14]:4.0 | [35]:4.0 | [47]:3.0 | [49]:4.0 | [58]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 7, 14, 35, 47, 49, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 4.400(4082)[0m | [32mExpert 19: 4.200(4109)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.600(4253)[0m | 
[32mExpert 17: 3.600(4103)[0m | [32mExpert 27: 3.400(4136)[0m | [32mExpert 59: 3.400(4241)[0m | [32mExpert 14: 3.400(4094)[0m | 
[32mExpert  2: 2.800(4112)[0m | [32mExpert 21: 2.800(4118)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert 42: 2.400(4187)[0m | 
[32mExpert 51: 2.400(4217)[0m | [32mExpert 35: 2.400(4163)[0m | [32mExpert 56: 2.400(4232)[0m | [32mExpert 55: 2.000(4229)[0m | 
[32mExpert  1: 2.000(4079)[0m | [32mExpert 61: 2.000(4250)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 58: 1.400(4238)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert  4: 1.000(4178)[0m | 
[32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | [32mExpert 16: 0.800(4100)[0m | 
[32mExpert 18: 0.800(4106)[0m | [32mExpert 28: 0.800(4139)[0m | [32mExpert 39: 0.800(4175)[0m | [32mExpert 41: 0.800(4184)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4169, 4238, 4235, 4178, 4208, 4265, 4244, 4100, 4106, 4139, 4175, 4184]
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  6,  9, 16, 18, 28, 37, 39, 41, 49, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[12]:3.0 | [39]:3.0 | [42]:2.0 | [44]:2.0 | [57]:1.0 | [20]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[21]:1.0 | [30]:2.0 | [44]:4.0 | [55]:3.0 | [57]:2.0 | [52]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[13]:1.0 | [21]:3.0 | [51]:3.0 | [52]:1.0 | [58]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:5.0 | [9]:1.0 | [20]:1.0 | [43]:2.0 | [58]:2.0 | [30]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [13]:3.0 | [46]:1.0 | [52]:2.0 | [11]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[17]:1.0 | [18]:1.0 | [41]:1.0 | [44]:1.0 | [62]:2.0 | [34]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[17, 18, 41, 44, 62, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[17]:1.0 | [21]:4.0 | [46]:2.0 | [49]:1.0 | [55]:2.0 | [34]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[5]:1.0 | [25]:2.0 | [38]:2.0 | [43]:2.0 | [56]:6.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]
asyncio
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2785
[1m[33mEnqueueTask: [0m[32mTask: node: ID[582,3b00000013] (16MB) STATE(0) TENSOR[2784,2785,2783,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[31]:4.0 | [34]:1.0 | [46]:2.0 | [50]:5.0 | [57]:5.0 | [47]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[2]:2.0 | [15]:1.0 | [47]:2.0 | [51]:5.0 | [62]:5.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:9.0 | [21]:4.0 | [48]:5.0 | [54]:5.0 | [55]:2.0 | [5]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[3]:4.0 | [22]:3.0 | [34]:6.0 | [39]:1.0 | [60]:5.0 | [16]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[12]:3.0 | [17]:1.0 | [18]:5.0 | [43]:2.0 | [47]:2.0 | [2]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[16]:3.0 | [17]:1.0 | [32]:5.0 | [39]:1.0 | [46]:7.0 | [1]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[16, 17, 32, 39, 46,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.000(2728)[0m | [32mExpert 46: 5.000(2743)[0m | [32mExpert 34: 4.800(2704)[0m | [32mExpert 45: 4.800(2740)[0m | 
[32mExpert  1: 3.800(2623)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert 48: 2.800(2749)[0m | 
[32mExpert 11: 2.600(2629)[0m | [32mExpert 16: 2.600(2644)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert  7: 2.400(2803)[0m | 
[32mExpert 55: 2.400(2773)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 28: 1.800(2683)[0m | 
[32mExpert  9: 1.600(2809)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | 
[32mExpert 12: 1.400(2632)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 37: 1.200(2713)[0m | [32mExpert 13: 1.000(2635)[0m | 
[32mExpert 33: 1.000(2701)[0m | [32mExpert 63: 1.000(2800)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | 
[32mExpert 51: 1.000(2761)[0m | [32mExpert 59: 1.000(2785)[0m | [32mExpert 60: 1.000(2791)[0m | [32mExpert  4: 0.800(2722)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2632, 2653, 2713, 2635, 2701, 2800, 2755, 2716, 2761, 2785, 2791, 2722]
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2785[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5, 12, 13, 19, 33, 37, 38, 51, 59, 60, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:5.0 | [17]:2.0 | [26]:2.0 | [41]:5.0 | [42]:3.0 | [39]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[3]:1.0 | [12]:1.0 | [20]:1.0 | [33]:6.0 | [45]:5.0 | [4]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[1]:4.0 | [3]:1.0 | [41]:5.0 | [45]:6.0 | [50]:2.0 | [44]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 10 MLP ==
[0m
[9]:2.0 | [19]:1.0 | [44]:6.0 | [55]:5.0 | [59]:4.0 | [27]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[17]:2.0 | [34]:4.0 | [43]:7.0 | [47]:5.0 | [60]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[7]:3.0 | [13]:1.0 | [16]:4.0 | [29]:6.0 | [48]:1.0 | [58]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 7, 13, 16, 29, 48, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.800(2882)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert 36: 3.800(2948)[0m | 
[32mExpert 40: 3.400(2963)[0m | [32mExpert 55: 3.200(3011)[0m | [32mExpert 48: 2.800(2987)[0m | [32mExpert 38: 2.800(2954)[0m | 
[32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 15: 2.200(2879)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert  4: 2.000(2960)[0m | [32mExpert 63: 2.000(3038)[0m | 
[32mExpert 11: 1.800(2867)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 18: 1.600(2888)[0m | 
[32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | [32mExpert 26: 1.400(2915)[0m | 
[32mExpert 33: 1.400(2939)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 24: 1.200(2909)[0m | 
[32mExpert 19: 1.200(2891)[0m | [32mExpert 61: 1.000(3032)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 43: 1.000(2972)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3020, 3023, 3044, 2915, 2939, 3005, 2993, 2909, 2891, 3032, 2885, 2972]
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 17, 19, 24, 26, 33, 43, 53, 58, 59, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[17]:2.0 | [20]:2.0 | [21]:3.0 | [23]:5.0 | [29]:5.0 | [1]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[10]:1.0 | [28]:5.0 | [33]:4.0 | [36]:1.0 | [63]:2.0 | [57]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[16]:5.0 | [29]:2.0 | [30]:1.0 | [49]:4.0 | [61]:2.0 | [33]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:3.0 | [16]:4.0 | [33]:3.0 | [41]:5.0 | [44]:2.0 | [37]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:5.0 | [23]:1.0 | [29]:2.0 | [40]:5.0 | [62]:4.0 | [1]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[17]:3.0 | [37]:2.0 | [46]:5.0 | [56]:2.0 | [59]:3.0 | [21]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[17, 37, 46, 56, 59, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
[90mTop 20 Experts:[0m
[32mExpert 10: 4.400(4082)[0m | [32mExpert 19: 4.200(4109)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 21: 3.600(4118)[0m | 
[32mExpert 62: 3.600(4253)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 27: 3.400(4136)[0m | [32mExpert 59: 3.400(4241)[0m | 
[32mExpert 14: 3.400(4094)[0m | [32mExpert 51: 3.200(4217)[0m | [32mExpert  2: 2.800(4112)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 42: 2.400(4187)[0m | [32mExpert 35: 2.400(4163)[0m | [32mExpert 56: 2.400(4232)[0m | [32mExpert 58: 2.200(4238)[0m | 
[32mExpert 55: 2.000(4229)[0m | [32mExpert  1: 2.000(4079)[0m | [32mExpert 61: 2.000(4250)[0m | [32mExpert 43: 1.800(4190)[0m | 
[32mExpert 48: 1.600(4205)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert 13: 1.200(4091)[0m | 
[32mExpert  4: 1.000(4178)[0m | [32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | 
[32mExpert 16: 0.800(4100)[0m | [32mExpert 18: 0.800(4106)[0m | [32mExpert 28: 0.800(4139)[0m | [32mExpert 39: 0.800(4175)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4205, 4169, 4235, 4091, 4178, 4208, 4265, 4244, 4100, 4106, 4139, 4175]
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  6,  9, 13, 16, 18, 28, 37, 39, 48, 49, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[19]:3.0 | [37]:1.0 | [43]:3.0 | [45]:1.0 | [55]:1.0 | [41]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[10]:1.0 | [33]:4.0 | [38]:2.0 | [50]:6.0 | [53]:3.0 | [56]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[13]:2.0 | [19]:3.0 | [27]:4.0 | [31]:1.0 | [52]:2.0 | [14]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[20]:2.0 | [21]:5.0 | [24]:2.0 | [48]:5.0 | [60]:5.0 | [33]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[6]:4.0 | [23]:5.0 | [25]:3.0 | [40]:4.0 | [58]:2.0 | [7]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[19]:2.0 | [37]:5.0 | [42]:2.0 | [50]:6.0 | [62]:3.0 | [38]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[19, 37, 42, 50, 62, 38]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:5.0 | [10]:6.0 | [12]:5.0 | [44]:2.0 | [63]:3.0 | [46]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[5]:2.0 | [9]:3.0 | [30]:5.0 | [54]:3.0 | [63]:3.0 | [34]:6.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[5]:2.0 | [8]:3.0 | [23]:2.0 | [42]:2.0 | [56]:7.0 | [43]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[35]:5.0 | [38]:5.0 | [42]:4.0 | [44]:1.0 | [57]:5.0 | [61]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:10.0 | [4]:3.0 | [16]:1.0 | [51]:1.0 | [54]:6.0 | [56]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[6]:5.0 | [16]:2.0 | [29]:3.0 | [30]:2.0 | [44]:2.0 | [17]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[17]:2.0 | [24]:1.0 | [36]:2.0 | [38]:7.0 | [41]:4.0 | [23]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[19]:5.0 | [34]:1.0 | [39]:2.0 | [46]:8.0 | [58]:1.0 | [47]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[19, 34, 39, 46, 58, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.800(2728)[0m | [32mExpert 45: 5.600(2740)[0m | [32mExpert 46: 5.000(2743)[0m | [32mExpert 34: 4.800(2704)[0m | 
[32mExpert  1: 4.600(2623)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 53: 3.000(2767)[0m | [32mExpert 48: 2.800(2749)[0m | 
[32mExpert 11: 2.600(2629)[0m | [32mExpert 16: 2.600(2644)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert  7: 2.400(2803)[0m | 
[32mExpert 55: 2.400(2773)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 28: 1.800(2683)[0m | 
[32mExpert  9: 1.600(2809)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 44: 1.600(2737)[0m | [32mExpert 50: 1.600(2758)[0m | 
[32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert  3: 1.200(2689)[0m | 
[32mExpert 19: 1.200(2653)[0m | [32mExpert 37: 1.200(2713)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 33: 1.000(2701)[0m | 
[32mExpert 63: 1.000(2800)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | [32mExpert 51: 1.000(2761)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2680, 2779, 2632, 2689, 2653, 2713, 2635, 2701, 2800, 2755, 2716, 2761]
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  5, 12, 13, 19, 27, 33, 37, 38, 51, 57, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[4]:2.0 | [32]:1.0 | [50]:6.0 | [54]:2.0 | [55]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[0]:1.0 | [12]:2.0 | [34]:2.0 | [35]:2.0 | [42]:1.0 | [33]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[8]:1.0 | [33]:2.0 | [45]:7.0 | [50]:3.0 | [53]:4.0 | [24]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[3]:1.0 | [39]:2.0 | [41]:6.0 | [44]:7.0 | [51]:2.0 | [47]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[7]:1.0 | [10]:2.0 | [20]:4.0 | [34]:5.0 | [43]:8.0 | [51]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[9]:1.0 | [12]:4.0 | [57]:1.0 | [58]:4.0 | [61]:1.0 | [30]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 9, 12, 57, 58, 61, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 5.600(2882)[0m | [32mExpert 49: 5.000(2990)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 36: 3.800(2948)[0m | 
[32mExpert 40: 3.400(2963)[0m | [32mExpert 55: 3.200(3011)[0m | [32mExpert 48: 2.800(2987)[0m | [32mExpert 38: 2.800(2954)[0m | 
[32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 15: 2.200(2879)[0m | [32mExpert 33: 2.200(2939)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert  4: 2.000(2960)[0m | 
[32mExpert 63: 2.000(3038)[0m | [32mExpert 11: 1.800(2867)[0m | [32mExpert 61: 1.800(3032)[0m | [32mExpert 52: 1.800(3002)[0m | 
[32mExpert 10: 1.800(2864)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert 29: 1.600(2924)[0m | [32mExpert 58: 1.600(3020)[0m | 
[32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | [32mExpert 26: 1.400(2915)[0m | [32mExpert 53: 1.400(3005)[0m | 
[32mExpert  5: 1.200(2993)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 30: 1.000(2930)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2864, 2888, 2924, 3020, 3023, 3044, 2915, 3005, 2993, 2909, 2891, 2930]
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 10, 18, 19, 24, 26, 29, 30, 53, 58, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[20]:3.0 | [23]:6.0 | [34]:2.0 | [37]:3.0 | [43]:1.0 | [45]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[43]:3.0 | [48]:3.0 | [57]:3.0 | [60]:3.0 | [63]:3.0 | [36]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[15]:3.0 | [18]:3.0 | [33]:3.0 | [34]:2.0 | [61]:3.0 | [2]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E18 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[3]:2.0 | [10]:5.0 | [43]:2.0 | [46]:1.0 | [52]:2.0 | [30]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:6.0 | [11]:2.0 | [15]:2.0 | [20]:2.0 | [39]:2.0 | [38]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[18]:6.0 | [21]:4.0 | [34]:2.0 | [41]:1.0 | [63]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[18, 21, 34, 41, 63,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[90mTop 20 Experts:[0m
[32mExpert 19: 5.000(4109)[0m | [32mExpert 10: 4.400(4082)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 27: 4.200(4136)[0m | 
[32mExpert 54: 4.000(4226)[0m | [32mExpert 21: 3.600(4118)[0m | [32mExpert 62: 3.600(4253)[0m | [32mExpert 17: 3.600(4103)[0m | 
[32mExpert 59: 3.400(4241)[0m | [32mExpert 51: 3.200(4217)[0m | [32mExpert  2: 2.800(4112)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 42: 2.400(4187)[0m | [32mExpert 35: 2.400(4163)[0m | [32mExpert 56: 2.400(4232)[0m | [32mExpert 58: 2.200(4238)[0m | 
[32mExpert 13: 2.000(4091)[0m | [32mExpert 55: 2.000(4229)[0m | [32mExpert  1: 2.000(4079)[0m | [32mExpert 61: 2.000(4250)[0m | 
[32mExpert 43: 1.800(4190)[0m | [32mExpert 52: 1.600(4220)[0m | [32mExpert 48: 1.600(4205)[0m | [32mExpert 37: 1.400(4169)[0m | 
[32mExpert 57: 1.400(4235)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 49: 1.000(4208)[0m | 
[32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | [32mExpert 16: 0.800(4100)[0m | [32mExpert 18: 0.800(4106)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4190, 4220, 4205, 4169, 4235, 4178, 4151, 4208, 4265, 4244, 4100, 4106]
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  6,  9, 16, 18, 31, 37, 43, 48, 49, 52, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:2.0 | [18]:2.0 | [32]:3.0 | [36]:1.0 | [60]:3.0 | [37]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[7]:5.0 | [32]:3.0 | [33]:5.0 | [40]:3.0 | [50]:7.0 | [28]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[35]:2.0 | [44]:1.0 | [50]:1.0 | [55]:3.0 | [61]:2.0 | [1]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[6]:4.0 | [28]:2.0 | [44]:2.0 | [50]:2.0 | [62]:2.0 | [25]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[9]:4.0 | [17]:2.0 | [25]:4.0 | [50]:2.0 | [60]:3.0 | [47]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:5.0 | [25]:2.0 | [28]:4.0 | [50]:7.0 | [60]:2.0 | [27]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 25, 28, 50, 60, 27]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:7.0 | [18]:2.0 | [23]:3.0 | [41]:2.0 | [58]:2.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[12]:2.0 | [32]:2.0 | [50]:2.0 | [51]:3.0 | [52]:2.0 | [28]:2.0 | 
---------------------------------------
return EAMC[0]
import EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[6]:2.0 | [21]:1.0 | [26]:4.0 | [50]:6.0 | [56]:8.0 | [8]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[12]:3.0 | [33]:3.0 | [35]:6.0 | [51]:6.0 | [55]:1.0 | [57]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[3]:3.0 | [6]:1.0 | [14]:1.0 | [49]:2.0 | [54]:7.0 | [12]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[2]:2.0 | [10]:1.0 | [21]:2.0 | [47]:1.0 | [48]:3.0 | [46]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[35]:3.0 | [38]:8.0 | [42]:6.0 | [44]:2.0 | [54]:3.0 | [32]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[8]:1.0 | [13]:2.0 | [41]:4.0 | [48]:2.0 | [59]:1.0 | [45]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 8, 13, 41, 48, 59, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 6.400(2740)[0m | [32mExpert 41: 5.800(2728)[0m | [32mExpert 46: 5.000(2743)[0m | [32mExpert 34: 4.800(2704)[0m | 
[32mExpert  1: 4.600(2623)[0m | [32mExpert 53: 3.800(2767)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 2.800(2749)[0m | 
[32mExpert 11: 2.600(2629)[0m | [32mExpert 16: 2.600(2644)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert  7: 2.400(2803)[0m | 
[32mExpert 50: 2.400(2758)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 31: 1.800(2695)[0m | 
[32mExpert 33: 1.800(2701)[0m | [32mExpert 28: 1.800(2683)[0m | [32mExpert  9: 1.600(2809)[0m | [32mExpert 26: 1.600(2677)[0m | 
[32mExpert 44: 1.600(2737)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | 
[32mExpert  3: 1.200(2689)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 24: 1.200(2671)[0m | [32mExpert 37: 1.200(2713)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 63: 1.000(2800)[0m | [32mExpert  5: 1.000(2755)[0m | [32mExpert 38: 1.000(2716)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2737, 2680, 2779, 2632, 2689, 2653, 2671, 2713, 2635, 2800, 2755, 2716]
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  5, 12, 13, 19, 24, 27, 37, 38, 44, 57, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[3]:2.0 | [11]:3.0 | [39]:6.0 | [46]:2.0 | [47]:4.0 | [28]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[11]:4.0 | [13]:4.0 | [28]:1.0 | [51]:1.0 | [52]:3.0 | [44]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[16]:2.0 | [24]:2.0 | [34]:4.0 | [37]:1.0 | [62]:1.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E24 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:4.0 | [25]:3.0 | [38]:1.0 | [41]:7.0 | [61]:1.0 | [31]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[10]:3.0 | [34]:6.0 | [49]:2.0 | [58]:3.0 | [59]:3.0 | [2]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[12]:5.0 | [37]:2.0 | [51]:1.0 | [61]:2.0 | [62]:4.0 | [23]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[12, 37, 51, 61, 62, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 5.600(2882)[0m | [32mExpert 49: 5.000(2990)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 36: 3.800(2948)[0m | 
[32mExpert 40: 3.400(2963)[0m | [32mExpert 55: 3.200(3011)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 33: 3.000(2939)[0m | 
[32mExpert 48: 2.800(2987)[0m | [32mExpert 38: 2.800(2954)[0m | [32mExpert 61: 2.600(3032)[0m | [32mExpert 18: 2.400(2888)[0m | 
[32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | 
[32mExpert 37: 2.200(2951)[0m | [32mExpert  4: 2.000(2960)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 11: 1.800(2867)[0m | 
[32mExpert 52: 1.800(3002)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 29: 1.600(2924)[0m | [32mExpert 34: 1.600(2942)[0m | 
[32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | [32mExpert 26: 1.400(2915)[0m | 
[32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 19: 1.200(2891)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 2864, 2924, 2942, 3020, 3023, 3044, 2915, 3005, 2993, 2909, 2891]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 10, 19, 24, 26, 29, 34, 52, 53, 58, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[23]:7.0 | [26]:3.0 | [37]:4.0 | [45]:2.0 | [48]:2.0 | [58]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[0]:1.0 | [19]:2.0 | [32]:1.0 | [54]:1.0 | [63]:4.0 | [44]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[18]:4.0 | [20]:1.0 | [40]:4.0 | [48]:4.0 | [61]:4.0 | [17]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[6]:3.0 | [20]:3.0 | [32]:2.0 | [37]:2.0 | [53]:2.0 | [54]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:7.0 | [15]:3.0 | [23]:2.0 | [24]:4.0 | [28]:3.0 | [9]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[2]:3.0 | [50]:1.0 | [56]:3.0 | [58]:3.0 | [63]:2.0 | [34]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 2, 50, 56, 58, 63, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
[90mTop 20 Experts:[0m
[32mExpert 19: 5.000(4109)[0m | [32mExpert 10: 4.400(4082)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 27: 4.200(4136)[0m | 
[32mExpert 54: 4.000(4226)[0m | [32mExpert 21: 3.600(4118)[0m | [32mExpert 62: 3.600(4253)[0m | [32mExpert 17: 3.600(4103)[0m | 
[32mExpert 59: 3.400(4241)[0m | [32mExpert 51: 3.200(4217)[0m | [32mExpert 35: 3.200(4163)[0m | [32mExpert 55: 2.800(4229)[0m | 
[32mExpert  1: 2.800(4079)[0m | [32mExpert  2: 2.800(4112)[0m | [32mExpert 61: 2.800(4250)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 42: 2.400(4187)[0m | [32mExpert 56: 2.400(4232)[0m | [32mExpert 58: 2.200(4238)[0m | [32mExpert 13: 2.000(4091)[0m | 
[32mExpert 43: 1.800(4190)[0m | [32mExpert 52: 1.600(4220)[0m | [32mExpert 48: 1.600(4205)[0m | [32mExpert 37: 1.400(4169)[0m | 
[32mExpert 50: 1.400(4214)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert 31: 1.000(4151)[0m | 
[32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | [32mExpert 16: 0.800(4100)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4190, 4220, 4205, 4169, 4214, 4235, 4178, 4151, 4208, 4265, 4244, 4100]
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  6,  9, 16, 31, 37, 43, 48, 49, 50, 52, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:3.0 | [7]:1.0 | [12]:4.0 | [22]:1.0 | [58]:2.0 | [5]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[13]:2.0 | [18]:1.0 | [36]:2.0 | [45]:1.0 | [60]:3.0 | [16]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[2]:2.0 | [10]:4.0 | [21]:4.0 | [41]:2.0 | [59]:5.0 | [56]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[3]:3.0 | [6]:5.0 | [11]:4.0 | [17]:2.0 | [49]:3.0 | [0]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[3]:3.0 | [9]:5.0 | [45]:3.0 | [47]:5.0 | [54]:1.0 | [0]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[8]:2.0 | [10]:3.0 | [32]:2.0 | [33]:1.0 | [54]:2.0 | [53]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 8, 10, 32, 33, 54, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:2.0 | [16]:1.0 | [38]:3.0 | [48]:2.0 | [62]:1.0 | [52]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[11]:2.0 | [17]:3.0 | [49]:1.0 | [57]:3.0 | [59]:2.0 | [62]:1.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[6]:3.0 | [33]:3.0 | [36]:1.0 | [47]:4.0 | [59]:2.0 | [26]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[18]:1.0 | [21]:2.0 | [29]:1.0 | [33]:4.0 | [43]:3.0 | [10]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[3]:4.0 | [10]:1.0 | [17]:2.0 | [29]:4.0 | [42]:2.0 | [36]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[2]:3.0 | [14]:2.0 | [35]:1.0 | [46]:5.0 | [48]:4.0 | [1]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[13]:4.0 | [20]:2.0 | [35]:4.0 | [44]:3.0 | [55]:3.0 | [42]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[4]:5.0 | [32]:6.0 | [41]:5.0 | [48]:3.0 | [59]:2.0 | [9]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 4, 32, 41, 48, 59,  9]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 6.400(2740)[0m | [32mExpert 41: 5.800(2728)[0m | [32mExpert 34: 5.600(2704)[0m | [32mExpert 46: 5.000(2743)[0m | 
[32mExpert  1: 4.600(2623)[0m | [32mExpert 53: 3.800(2767)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 16: 3.400(2644)[0m | 
[32mExpert 48: 2.800(2749)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert  7: 2.400(2803)[0m | 
[32mExpert 50: 2.400(2758)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 37: 2.000(2713)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 28: 1.800(2683)[0m | 
[32mExpert  9: 1.600(2809)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 44: 1.600(2737)[0m | [32mExpert 27: 1.600(2680)[0m | 
[32mExpert 57: 1.600(2779)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert  3: 1.200(2689)[0m | [32mExpert 19: 1.200(2653)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 62: 1.000(2797)[0m | [32mExpert 63: 1.000(2800)[0m | [32mExpert  5: 1.000(2755)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2809, 2677, 2737, 2680, 2779, 2632, 2689, 2653, 2635, 2797, 2800, 2755]
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  5,  9, 12, 13, 19, 26, 27, 44, 57, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:4.0 | [24]:2.0 | [39]:7.0 | [46]:3.0 | [47]:5.0 | [27]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[11]:5.0 | [13]:5.0 | [39]:5.0 | [48]:1.0 | [52]:4.0 | [44]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[7]:4.0 | [10]:1.0 | [16]:3.0 | [26]:3.0 | [34]:5.0 | [4]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:5.0 | [16]:4.0 | [25]:4.0 | [49]:3.0 | [61]:2.0 | [42]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[34]:7.0 | [42]:2.0 | [49]:3.0 | [58]:4.0 | [59]:4.0 | [27]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[23]:4.0 | [31]:4.0 | [33]:3.0 | [61]:3.0 | [62]:5.0 | [9]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[23, 31, 33, 61, 62,  9]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 5.600(2882)[0m | [32mExpert 49: 5.000(2990)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 40: 4.200(2963)[0m | 
[32mExpert 36: 3.800(2948)[0m | [32mExpert 48: 3.600(2987)[0m | [32mExpert 61: 3.400(3032)[0m | [32mExpert 18: 3.200(2888)[0m | 
[32mExpert 55: 3.200(3011)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 38: 2.800(2954)[0m | 
[32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | 
[32mExpert 37: 2.200(2951)[0m | [32mExpert  4: 2.000(2960)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 11: 1.800(2867)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 29: 1.600(2924)[0m | 
[32mExpert 34: 1.600(2942)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | 
[32mExpert 26: 1.400(2915)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 24: 1.200(2909)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2885, 3002, 2864, 2924, 2942, 3020, 3023, 3044, 2915, 3005, 2993, 2909]
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 10, 17, 24, 26, 29, 34, 52, 53, 58, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[15]:2.0 | [26]:4.0 | [37]:5.0 | [45]:3.0 | [48]:3.0 | [36]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[0]:2.0 | [19]:3.0 | [46]:2.0 | [55]:4.0 | [57]:4.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[18]:5.0 | [26]:2.0 | [36]:5.0 | [40]:5.0 | [52]:2.0 | [49]:5.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:4.0 | [20]:4.0 | [32]:3.0 | [40]:2.0 | [53]:3.0 | [54]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:8.0 | [10]:4.0 | [24]:5.0 | [28]:4.0 | [38]:3.0 | [45]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[2]:4.0 | [14]:5.0 | [32]:1.0 | [58]:4.0 | [63]:3.0 | [49]:5.0 | EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 2, 14, 32, 58, 63, 49]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 5.200(4082)[0m | [32mExpert 19: 5.000(4109)[0m | [32mExpert 21: 4.400(4118)[0m | [32mExpert 14: 4.200(4094)[0m | 
[32mExpert 27: 4.200(4136)[0m | [32mExpert 59: 4.200(4241)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.600(4253)[0m | 
[32mExpert  2: 3.600(4112)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 51: 3.200(4217)[0m | [32mExpert 35: 3.200(4163)[0m | 
[32mExpert 56: 3.200(4232)[0m | [32mExpert 55: 2.800(4229)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 61: 2.800(4250)[0m | 
[32mExpert 30: 2.600(4148)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 58: 2.200(4238)[0m | [32mExpert 13: 2.000(4091)[0m | 
[32mExpert 43: 1.800(4190)[0m | [32mExpert 41: 1.600(4184)[0m | [32mExpert 52: 1.600(4220)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert  4: 1.000(4178)[0m | 
[32mExpert 31: 1.000(4151)[0m | [32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert  6: 0.800(4244)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4190, 4184, 4220, 4205, 4169, 4214, 4235, 4178, 4151, 4208, 4265, 4244]
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  6,  9, 31, 37, 41, 43, 48, 49, 50, 52, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:2.0 | [6]:4.0 | [12]:5.0 | [42]:3.0 | [58]:3.0 | [22]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[10]:2.0 | [16]:4.0 | [33]:6.0 | [36]:3.0 | [60]:4.0 | [11]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[3]:1.0 | [10]:5.0 | [21]:5.0 | [41]:3.0 | [59]:6.0 | [12]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:4.0 | [3]:4.0 | [6]:6.0 | [7]:1.0 | [58]:3.0 | [50]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[3]:4.0 | [9]:6.0 | [16]:2.0 | [50]:3.0 | [52]:3.0 | [13]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[8]:3.0 | [16]:6.0 | [50]:8.0 | [53]:3.0 | [54]:3.0 | [10]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 8, 16, 50, 53, 54, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:3.0 | [23]:4.0 | [38]:4.0 | [48]:3.0 | [55]:3.0 | [21]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[11]:3.0 | [17]:4.0 | [25]:3.0 | [57]:4.0 | [59]:3.0 | [63]:4.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:2.0 | [11]:4.0 | [21]:2.0 | [33]:4.0 | [44]:1.0 | [49]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[10]:2.0 | [11]:2.0 | [12]:4.0 | [21]:3.0 | [58]:1.0 | [6]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[3]:5.0 | [17]:3.0 | [27]:1.0 | [29]:5.0 | [36]:3.0 | [54]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[14]:3.0 | [35]:2.0 | [40]:2.0 | [46]:6.0 | [48]:5.0 | [2]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[2]:2.0 | [13]:5.0 | [20]:3.0 | [34]:1.0 | [46]:2.0 | [55]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[4]:6.0 | [29]:3.0 | [32]:7.0 | [41]:6.0 | [63]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 4, 29, 32, 41, 63,  3]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 6.400(2740)[0m | [32mExpert 34: 6.400(2704)[0m | [32mExpert 41: 5.800(2728)[0m | [32mExpert 46: 5.000(2743)[0m | 
[32mExpert  1: 4.600(2623)[0m | [32mExpert 16: 4.200(2644)[0m | [32mExpert 53: 3.800(2767)[0m | [32mExpert 56: 3.800(2776)[0m | 
[32mExpert  7: 3.200(2803)[0m | [32mExpert 48: 2.800(2749)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert 35: 2.600(2707)[0m | 
[32mExpert 26: 2.400(2677)[0m | [32mExpert 50: 2.400(2758)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 17: 2.400(2647)[0m | 
[32mExpert 24: 2.000(2671)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | 
[32mExpert 28: 1.800(2683)[0m | [32mExpert  4: 1.600(2722)[0m | [32mExpert  9: 1.600(2809)[0m | [32mExpert 44: 1.600(2737)[0m | 
[32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 10: 1.400(2626)[0m | [32mExpert 12: 1.400(2632)[0m | 
[32mExpert  3: 1.200(2689)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 62: 1.000(2797)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2683, 2722, 2809, 2737, 2680, 2779, 2626, 2632, 2689, 2653, 2635, 2797]
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4,  9, 10, 12, 13, 19, 27, 28, 44, 57, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:5.0 | [24]:3.0 | [27]:3.0 | [39]:8.0 | [47]:6.0 | [57]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[1]:3.0 | [11]:6.0 | [13]:6.0 | [48]:2.0 | [52]:5.0 | [30]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[7]:5.0 | [9]:3.0 | [26]:4.0 | [34]:6.0 | [55]:4.0 | [51]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[8]:3.0 | [10]:6.0 | [16]:5.0 | [35]:2.0 | [49]:4.0 | [20]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[16]:4.0 | [42]:3.0 | [52]:2.0 | [58]:5.0 | [59]:5.0 | [15]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[23]:5.0 | [31]:5.0 | [32]:3.0 | [33]:4.0 | [62]:6.0 | [22]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[23, 31, 32, 33, 62, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 5.800(2990)[0m | [32mExpert 16: 5.600(2882)[0m | [32mExpert 40: 5.000(2963)[0m | [32mExpert  0: 4.600(2858)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 18: 4.000(2888)[0m | [32mExpert 48: 3.600(2987)[0m | [32mExpert 61: 3.400(3032)[0m | 
[32mExpert 55: 3.200(3011)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 38: 2.800(2954)[0m | 
[32mExpert 52: 2.600(3002)[0m | [32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 26: 2.200(2915)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert  4: 2.000(2960)[0m | 
[32mExpert 63: 2.000(3038)[0m | [32mExpert 11: 1.800(2867)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | 
[32mExpert 29: 1.600(2924)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | 
[32mExpert  8: 1.400(3044)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | [32mExpert 24: 1.200(2909)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3038, 2867, 2885, 2864, 2924, 2942, 3020, 3023, 3044, 3005, 2993, 2909]
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 10, 11, 17, 24, 29, 34, 53, 58, 59, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[24]:4.0 | [26]:5.0 | [36]:6.0 | [48]:4.0 | [63]:3.0 | [61]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[19]:4.0 | [45]:1.0 | [46]:3.0 | [52]:2.0 | [55]:5.0 | [20]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[11]:3.0 | [26]:3.0 | [36]:6.0 | [40]:6.0 | [48]:5.0 | [47]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E11 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:3.0 | [6]:5.0 | [20]:5.0 | [40]:3.0 | [53]:4.0 | [18]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:9.0 | [3]:2.0 | [23]:3.0 | [24]:6.0 | [30]:3.0 | [10]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[14]:6.0 | [36]:1.0 | [47]:4.0 | [49]:6.0 | [52]:1.0 | [2]:5.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[14, 36, 47, 49, 52,  2]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4145
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1306,30000002b] (16MB) STATE(0) TENSOR[4144,4145,4143,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(4082)[0m | [32mExpert 21: 5.200(4118)[0m | [32mExpert 59: 5.000(4241)[0m | [32mExpert 19: 5.000(4109)[0m | 
[32mExpert 14: 4.200(4094)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.600(4253)[0m | 
[32mExpert  2: 3.600(4112)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 51: 3.200(4217)[0m | [32mExpert 35: 3.200(4163)[0m | 
[32mExpert 56: 3.200(4232)[0m | [32mExpert 55: 2.800(4229)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 61: 2.800(4250)[0m | 
[32mExpert 30: 2.600(4148)[0m | [32mExpert 41: 2.400(4184)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 58: 2.200(4238)[0m | 
[32mExpert 13: 2.000(4091)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 52: 1.600(4220)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert  4: 1.000(4178)[0m | 
[32mExpert 31: 1.000(4151)[0m | [32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert  3: 0.800(4145)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4091, 4190, 4220, 4205, 4169, 4214, 4235, 4178, 4151, 4208, 4265, 4145]
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4145[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  3,  4,  9, 13, 31, 37, 43, 48, 49, 50, 52, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:5.0 | [12]:6.0 | [24]:5.0 | [42]:4.0 | [57]:2.0 | [20]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[3]:1.0 | [21]:2.0 | [35]:1.0 | [44]:5.0 | [60]:5.0 | [52]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[2]:3.0 | [13]:3.0 | [26]:1.0 | [51]:4.0 | [52]:3.0 | [40]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:6.0 | [9]:2.0 | [43]:3.0 | [47]:1.0 | [58]:4.0 | [30]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[2]:2.0 | [10]:2.0 | [13]:5.0 | [20]:1.0 | [58]:3.0 | [63]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[1]:1.0 | [17]:2.0 | [19]:3.0 | [38]:2.0 | [47]:2.0 | [62]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 1, 17, 19, 38, 47, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[17]:2.0 | [20]:1.0 | [25]:1.0 | [46]:4.0 | [55]:4.0 | [15]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[25]:4.0 | [38]:3.0 | [43]:3.0 | [56]:7.0 | [59]:4.0 | [17]:5.0 | 
---------------------------------------
return EAMC[0]
aiohttp
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
EnqueuePrefetch: 2960
[1m[33mEnqueueTask: [0m[32mTask: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[917,40000001f] (16MB) STATE(0) TENSOR[2959,2960,2958,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[31]:5.0 | [46]:3.0 | [47]:5.0 | [50]:7.0 | [57]:6.0 | [34]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[15]:2.0 | [20]:1.0 | [36]:1.0 | [47]:3.0 | [62]:6.0 | [55]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:11.0 | [10]:2.0 | [21]:5.0 | [48]:6.0 | [54]:9.0 | [55]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[3]:5.0 | [13]:2.0 | [51]:1.0 | [60]:6.0 | [63]:2.0 | [22]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[17]:3.0 | [18]:6.0 | [47]:3.0 | [53]:1.0 | [56]:1.0 | [20]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[1]:2.0 | [16]:4.0 | [23]:1.0 | [35]:2.0 | [47]:3.0 | [11]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 1, 16, 23, 35, 47, 11]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 34: 7.200(2704)[0m | [32mExpert 45: 6.400(2740)[0m | [32mExpert 41: 5.800(2728)[0m | [32mExpert 46: 5.000(2743)[0m | 
[32mExpert  1: 4.600(2623)[0m | [32mExpert 16: 4.200(2644)[0m | [32mExpert  7: 4.000(2803)[0m | [32mExpert 53: 3.800(2767)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert 55: 3.200(2773)[0m | [32mExpert 48: 2.800(2749)[0m | 
[32mExpert 11: 2.600(2629)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert  9: 2.400(2809)[0m | [32mExpert 50: 2.400(2758)[0m | 
[32mExpert 17: 2.400(2647)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 31: 1.800(2695)[0m | 
[32mExpert 33: 1.800(2701)[0m | [32mExpert 51: 1.800(2761)[0m | [32mExpert 28: 1.800(2683)[0m | [32mExpert  4: 1.600(2722)[0m | 
[32mExpert 44: 1.600(2737)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 10: 1.400(2626)[0m | 
[32mExpert 12: 1.400(2632)[0m | [32mExpert  3: 1.200(2689)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 13: 1.000(2635)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2761, 2683, 2722, 2737, 2680, 2779, 2626, 2632, 2689, 2653, 2635]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4, 10, 12, 13, 19, 27, 28, 33, 44, 51, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:6.0 | [17]:3.0 | [21]:1.0 | [41]:6.0 | [42]:4.0 | [24]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[3]:2.0 | [10]:2.0 | [12]:3.0 | [20]:2.0 | [33]:8.0 | [45]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[1]:5.0 | [44]:3.0 | [45]:8.0 | [53]:5.0 | [55]:5.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[9]:3.0 | [27]:2.0 | [42]:5.0 | [44]:8.0 | [55]:6.0 | [60]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[16]:5.0 | [17]:3.0 | [43]:9.0 | [47]:6.0 | [60]:2.0 | [40]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[7]:4.0 | [16]:5.0 | [29]:7.0 | [48]:2.0 | [56]:1.0 | [31]:6.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 7, 16, 29, 48, 56, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 40: 5.800(2963)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 16: 5.600(2882)[0m | [32mExpert 36: 5.400(2948)[0m | 
[32mExpert  0: 4.600(2858)[0m | [32mExpert 48: 4.400(2987)[0m | [32mExpert 18: 4.000(2888)[0m | [32mExpert 61: 3.400(3032)[0m | 
[32mExpert 55: 3.200(3011)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | 
[32mExpert 38: 2.800(2954)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.600(3002)[0m | [32mExpert  6: 2.200(3026)[0m | 
[32mExpert 14: 2.200(2876)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert 37: 2.200(2951)[0m | 
[32mExpert  4: 2.000(2960)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | 
[32mExpert 29: 1.600(2924)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | 
[32mExpert  8: 1.400(3044)[0m | [32mExpert 47: 1.400(2984)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert  5: 1.200(2993)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2960, 3038, 2885, 2864, 2924, 2942, 3020, 3023, 3044, 2984, 3005, 2993]
Prefetching [1;36mTensor 2960[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  4,  5,  8, 10, 17, 29, 34, 47, 53, 58, 59, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:5.0 | [5]:3.0 | [10]:3.0 | [21]:4.0 | [35]:1.0 | [31]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[4]:1.0 | [9]:5.0 | [10]:2.0 | [28]:6.0 | [33]:5.0 | [0]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[4]:3.0 | [16]:6.0 | [30]:2.0 | [40]:7.0 | [49]:6.0 | [31]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E4 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[16]:5.0 | [18]:4.0 | [33]:4.0 | [37]:3.0 | [53]:5.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:10.0 | [28]:5.0 | [40]:6.0 | [44]:1.0 | [62]:5.0 | [55]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[2]:6.0 | [23]:2.0 | [28]:1.0 | [46]:6.0 | [56]:4.0 | [37]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 2, 23, 28, 46, 56, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(4082)[0m | [32mExpert 21: 5.200(4118)[0m | [32mExpert 59: 5.000(4241)[0m | [32mExpert 19: 5.000(4109)[0m | 
[32mExpert  2: 4.400(4112)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 51: 4.000(4217)[0m | 
[32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.600(4253)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 35: 3.200(4163)[0m | 
[32mExpert 56: 3.200(4232)[0m | [32mExpert 13: 2.800(4091)[0m | [32mExpert 55: 2.800(4229)[0m | [32mExpert  1: 2.800(4079)[0m | 
[32mExpert 61: 2.800(4250)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert 41: 2.400(4184)[0m | [32mExpert 42: 2.400(4187)[0m | 
[32mExpert 52: 2.400(4220)[0m | [32mExpert 58: 2.200(4238)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert 26: 1.200(4133)[0m | 
[32mExpert  4: 1.000(4178)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4220, 4238, 4190, 4205, 4169, 4214, 4235, 4133, 4178, 4151, 4208, 4265]
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  9, 26, 31, 37, 43, 48, 49, 50, 52, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:6.0 | [19]:4.0 | [35]:2.0 | [55]:2.0 | [60]:4.0 | [40]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[22]:3.0 | [33]:7.0 | [41]:2.0 | [50]:8.0 | [53]:4.0 | [10]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[13]:4.0 | [21]:6.0 | [27]:5.0 | [52]:4.0 | [58]:3.0 | [62]:4.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:6.0 | [24]:3.0 | [33]:3.0 | [48]:6.0 | [60]:6.0 | [20]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[6]:5.0 | [23]:6.0 | [40]:5.0 | [45]:4.0 | [58]:4.0 | [7]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:7.0 | [22]:5.0 | [37]:6.0 | [50]:9.0 | [52]:2.0 | [34]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 22, 37, 50, 52, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:6.0 | [10]:8.0 | [12]:6.0 | [44]:3.0 | [63]:4.0 | [46]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[30]:6.0 | [34]:7.0 | [54]:4.0 | [56]:8.0 | [63]:5.0 | [48]:4.0 | 
---------------------------------------
return EAMC[0]

EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[31]:6.0 | [38]:1.0 | [46]:4.0 | [47]:6.0 | [50]:8.0 | [3]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[27]:2.0 | [31]:2.0 | [36]:2.0 | [62]:7.0 | [63]:7.0 | [20]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:12.0 | [5]:4.0 | [21]:6.0 | [48]:7.0 | [55]:4.0 | [46]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[3]:6.0 | [18]:5.0 | [22]:5.0 | [34]:7.0 | [60]:7.0 | [13]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[12]:4.0 | [18]:7.0 | [38]:9.0 | [39]:5.0 | [50]:5.0 | [29]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[11]:4.0 | [16]:5.0 | [46]:9.0 | [50]:4.0 | [56]:5.0 | [37]:5.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[11, 16, 46, 50, 56, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 34: 7.200(2704)[0m | [32mExpert 45: 7.200(2740)[0m | [32mExpert 41: 5.800(2728)[0m | [32mExpert  1: 5.400(2623)[0m | 
[32mExpert 46: 5.000(2743)[0m | [32mExpert 53: 4.600(2767)[0m | [32mExpert 16: 4.200(2644)[0m | [32mExpert  7: 4.000(2803)[0m | 
[32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert 48: 2.800(2749)[0m | 
[32mExpert 11: 2.600(2629)[0m | [32mExpert 35: 2.600(2707)[0m | [32mExpert  9: 2.400(2809)[0m | [32mExpert 44: 2.400(2737)[0m | 
[32mExpert 50: 2.400(2758)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 37: 2.000(2713)[0m | 
[32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 51: 1.800(2761)[0m | [32mExpert 28: 1.800(2683)[0m | 
[32mExpert  4: 1.600(2722)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 10: 1.400(2626)[0m | 
[32mExpert 12: 1.400(2632)[0m | [32mExpert  3: 1.200(2689)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 58: 1.200(2782)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2695, 2701, 2761, 2683, 2722, 2680, 2779, 2626, 2632, 2689, 2653, 2782]
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4, 10, 12, 19, 27, 28, 31, 33, 51, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[17]:4.0 | [26]:3.0 | [38]:5.0 | [41]:7.0 | [42]:5.0 | [6]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[6]:5.0 | [8]:6.0 | [33]:9.0 | [45]:7.0 | [55]:3.0 | [46]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[1]:6.0 | [41]:6.0 | [45]:9.0 | [46]:5.0 | [48]:3.0 | [35]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 10 MLP ==
[0m
[41]:8.0 | [44]:9.0 | [50]:4.0 | [55]:7.0 | [60]:4.0 | [30]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[20]:5.0 | [28]:5.0 | [43]:10.0 | [47]:7.0 | [51]:2.0 | [8]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[7]:5.0 | [29]:8.0 | [41]:2.0 | [47]:3.0 | [58]:5.0 | [16]:6.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 7, 29, 41, 47, 58, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 40: 6.600(2963)[0m | [32mExpert 49: 6.600(2990)[0m | [32mExpert 16: 6.400(2882)[0m | [32mExpert 36: 5.400(2948)[0m | 
[32mExpert  0: 4.600(2858)[0m | [32mExpert 48: 4.400(2987)[0m | [32mExpert 18: 4.000(2888)[0m | [32mExpert 61: 3.400(3032)[0m | 
[32mExpert 55: 3.200(3011)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | 
[32mExpert  4: 2.800(2960)[0m | [32mExpert 38: 2.800(2954)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.600(3002)[0m | 
[32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | 
[32mExpert 37: 2.200(2951)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 30: 1.800(2930)[0m | [32mExpert 17: 1.800(2885)[0m | 
[32mExpert 10: 1.800(2864)[0m | [32mExpert 29: 1.600(2924)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert 58: 1.600(3020)[0m | 
[32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | [32mExpert 47: 1.400(2984)[0m | [32mExpert 53: 1.400(3005)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2951, 3038, 2930, 2885, 2864, 2924, 2942, 3020, 3023, 3044, 2984, 3005]
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8, 10, 17, 29, 30, 34, 37, 47, 53, 58, 59, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[17]:3.0 | [23]:8.0 | [29]:6.0 | [30]:3.0 | [37]:6.0 | [33]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[9]:6.0 | [28]:7.0 | [33]:6.0 | [43]:4.0 | [45]:2.0 | [10]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[4]:4.0 | [7]:1.0 | [16]:7.0 | [29]:3.0 | [49]:7.0 | [46]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E29 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[15]:4.0 | [32]:4.0 | [41]:6.0 | [44]:3.0 | [59]:2.0 | [11]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:11.0 | [12]:1.0 | [15]:4.0 | [18]:5.0 | [40]:7.0 | [41]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[21]:5.0 | [37]:4.0 | [46]:7.0 | [53]:3.0 | [63]:4.0 | [61]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[21, 37, 46, 53, 63, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(4082)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 59: 5.000(4241)[0m | [32mExpert 19: 5.000(4109)[0m | 
[32mExpert 27: 5.000(4136)[0m | [32mExpert  2: 4.400(4112)[0m | EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
[32mExpert 62: 4.400(4253)[0m | [32mExpert 14: 4.200(4094)[0m | 
[32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 13: 3.600(4091)[0m | [32mExpert 17: 3.600(4103)[0m | 
[32mExpert 52: 3.200(4220)[0m | [32mExpert 35: 3.200(4163)[0m | [32mExpert 56: 3.200(4232)[0m | [32mExpert 58: 3.000(4238)[0m | 
[32mExpert 55: 2.800(4229)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 61: 2.800(4250)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 41: 2.400(4184)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert 26: 1.200(4133)[0m | 
[32mExpert  4: 1.000(4178)[0m | [32mExpert 31: 1.000(4151)[0m | [32mExpert 49: 1.000(4208)[0m | [32mExpert  9: 1.000(4265)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4184, 4187, 4190, 4205, 4169, 4214, 4235, 4133, 4178, 4151, 4208, 4265]
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4,  9, 26, 31, 37, 41, 42, 43, 48, 49, 50, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:3.0 | [32]:4.0 | [37]:3.0 | [41]:5.0 | [43]:4.0 | [19]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[16]:5.0 | [27]:3.0 | [32]:4.0 | [50]:9.0 | [53]:5.0 | [33]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[12]:2.0 | [27]:6.0 | [35]:3.0 | [55]:4.0 | [59]:7.0 | [44]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[6]:7.0 | [21]:7.0 | [33]:4.0 | [50]:4.0 | [60]:7.0 | [25]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[7]:6.0 | [16]:3.0 | [23]:7.0 | [25]:5.0 | [51]:1.0 | [56]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:8.0 | [22]:6.0 | [25]:3.0 | [28]:5.0 | [56]:1.0 | [37]:7.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 22, 25, 28, 56, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:9.0 | [39]:2.0 | [44]:4.0 | [51]:1.0 | [58]:3.0 | [12]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[9]:4.0 | [26]:4.0 | [30]:7.0 | [51]:4.0 | [63]:6.0 | [34]:8.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2981
[1m[33mEnqueueTask: [0m[32mTask: node: ID[959,2e0000001f] (16MB) STATE(0) TENSOR[2980,2981,2979,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[24]:2.0 | [26]:6.0 | [33]:5.0 | [56]:9.0 | [62]:3.0 | [8]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[14]:3.0 | [35]:7.0 | [42]:5.0 | [57]:7.0 | [61]:3.0 | [12]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:13.0 | [52]:2.0 | [53]:2.0 | [54]:10.0 | [63]:2.0 | [58]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[6]:6.0 | [9]:2.0 | [24]:4.0 | [25]:3.0 | [54]:2.0 | [53]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[35]:5.0 | [36]:3.0 | [38]:10.0 | [44]:4.0 | [51]:1.0 | [20]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[9]:4.0 | [15]:2.0 | [19]:6.0 | [20]:2.0 | [41]:7.0 | [21]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 9, 15, 19, 20, 41, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 8.000(2740)[0m | [32mExpert 34: 7.200(2704)[0m | [32mExpert 41: 6.600(2728)[0m | [32mExpert  1: 6.200(2623)[0m | 
[32mExpert 46: 5.800(2743)[0m | [32mExpert 53: 4.600(2767)[0m | [32mExpert 16: 4.200(2644)[0m | [32mExpert  7: 4.000(2803)[0m | 
[32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 35: 3.400(2707)[0m | 
[32mExpert 26: 3.200(2677)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert  9: 2.400(2809)[0m | [32mExpert 44: 2.400(2737)[0m | 
[32mExpert 50: 2.400(2758)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 24: 2.000(2671)[0m | [32mExpert 37: 2.000(2713)[0m | 
[32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 51: 1.800(2761)[0m | [32mExpert 28: 1.800(2683)[0m | 
[32mExpert  4: 1.600(2722)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 10: 1.400(2626)[0m | 
[32mExpert 12: 1.400(2632)[0m | [32mExpert  3: 1.200(2689)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 58: 1.200(2782)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2695, 2701, 2761, 2683, 2722, 2680, 2779, 2626, 2632, 2689, 2653, 2782]
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4, 10, 12, 19, 27, 28, 31, 33, 51, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[3]:3.0 | [11]:6.0 | [39]:9.0 | [48]:1.0 | [57]:3.0 | [4]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[33]:10.0 | [38]:1.0 | [49]:2.0 | [53]:2.0 | [62]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[7]:6.0 | [18]:1.0 | [28]:1.0 | [39]:1.0 | [53]:6.0 | [16]:4.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E28 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[32]:2.0 | [33]:2.0 | [44]:10.0 | [47]:4.0 | [48]:1.0 | [16]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[2]:3.0 | [9]:1.0 | [20]:6.0 | [45]:2.0 | [58]:6.0 | [6]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[29]:9.0 | [31]:7.0 | [32]:4.0 | [33]:5.0 | [58]:6.0 | [53]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[29, 31, 32, 33, 58, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 7.400(2990)[0m | [32mExpert 16: 7.200(2882)[0m | [32mExpert 40: 6.600(2963)[0m | [32mExpert 36: 5.400(2948)[0m | 
[32mExpert  0: 4.600(2858)[0m | [32mExpert 48: 4.400(2987)[0m | [32mExpert 18: 4.000(2888)[0m | [32mExpert  4: 3.600(2960)[0m | 
[32mExpert 61: 3.400(3032)[0m | [32mExpert 55: 3.200(3011)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | 
[32mExpert 33: 3.000(2939)[0m | [32mExpert 38: 2.800(2954)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.600(3002)[0m | 
[32mExpert 29: 2.400(2924)[0m | [32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 30: 1.800(2930)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert  7: 1.600(3041)[0m | 
[32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | [32mExpert 46: 1.400(2981)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2951, 3038, 2930, 2885, 2864, 2942, 3041, 3020, 3023, 3044, 2981]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2981[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8, 10, 17, 25, 30, 34, 37, 46, 58, 59, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[22]:2.0 | [23]:9.0 | [27]:1.0 | [30]:4.0 | [42]:2.0 | [29]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[20]:3.0 | [24]:2.0 | [28]:8.0 | [48]:4.0 | [60]:4.0 | [32]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[12]:1.0 | [28]:1.0 | [45]:1.0 | [49]:8.0 | [57]:2.0 | [36]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[13]:2.0 | [18]:5.0 | [22]:2.0 | [26]:4.0 | [62]:1.0 | [30]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[0]:2.0 | [20]:3.0 | [24]:7.0 | [30]:4.0 | [41]:3.0 | [51]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[11]:1.0 | [14]:7.0 | [21]:6.0 | [35]:5.0 | [61]:4.0 | [55]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[11, 14, 21, 35, 61, 55]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(4082)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 27: 5.800(4136)[0m | [32mExpert 59: 5.800(4241)[0m | 
[32mExpert 19: 5.000(4109)[0m | [32mExpert  2: 4.400(4112)[0m | EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
[32mExpert 62: 4.400(4253)[0m | [32mExpert 14: 4.200(4094)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 13: 3.600(4091)[0m | 
[32mExpert 55: 3.600(4229)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 56: 3.200(4232)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 61: 2.800(4250)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 41: 2.400(4184)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 12: 1.600(4088)[0m | 
[32mExpert 44: 1.600(4193)[0m | [32mExpert 48: 1.600(4205)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | 
[32mExpert 57: 1.400(4235)[0m | [32mExpert 26: 1.200(4133)[0m | [32mExpert  4: 1.000(4178)[0m | [32mExpert 31: 1.000(4151)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4184, 4187, 4190, 4088, 4193, 4205, 4169, 4214, 4235, 4133, 4178, 4151]
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4, 12, 26, 31, 37, 41, 42, 43, 44, 48, 50, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:3.0 | [5]:4.0 | [11]:2.0 | [27]:1.0 | [39]:4.0 | [43]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[13]:3.0 | [50]:10.0 | [57]:3.0 | [58]:1.0 | [61]:2.0 | [53]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[2]:4.0 | [26]:2.0 | [33]:1.0 | [49]:2.0 | [56]:3.0 | [13]:5.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:7.0 | [17]:3.0 | [29]:1.0 | [32]:1.0 | [49]:4.0 | [30]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[2]:3.0 | [33]:2.0 | [52]:4.0 | [53]:1.0 | [55]:1.0 | [47]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[15]:2.0 | [19]:4.0 | [24]:4.0 | [34]:4.0 | [41]:2.0 | [29]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[15, 19, 24, 34, 41, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[4]:1.0 | [8]:1.0 | [22]:1.0 | [32]:3.0 | [47]:1.0 | [37]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[10]:1.0 | [11]:4.0 | [17]:6.0 | [46]:1.0 | [49]:2.0 | [8]:1.0 | 
---------------------------------------
return EAMC[0]
async EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[5]:3.0 | [24]:3.0 | [29]:2.0 | [56]:10.0 | [62]:4.0 | [26]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[34]:1.0 | [35]:8.0 | [51]:7.0 | [57]:8.0 | [61]:4.0 | [6]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:14.0 | [4]:4.0 | [7]:3.0 | [52]:3.0 | [54]:11.0 | [63]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[6]:7.0 | [9]:3.0 | [23]:1.0 | [24]:5.0 | [29]:4.0 | [25]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[0]:1.0 | [38]:11.0 | [41]:5.0 | [51]:2.0 | [55]:5.0 | [60]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[9]:5.0 | [10]:1.0 | [19]:7.0 | [36]:1.0 | [52]:1.0 | [6]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 9, 10, 19, 36, 52,  6]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 8.000(2740)[0m | [32mExpert 34: 7.200(2704)[0m | [32mExpert 41: 6.600(2728)[0m | [32mExpert  1: 6.200(2623)[0m | 
[32mExpert 46: 5.800(2743)[0m | [32mExpert 53: 5.400(2767)[0m | [32mExpert 16: 5.000(2644)[0m | [32mExpert  7: 4.800(2803)[0m | 
[32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 35: 3.400(2707)[0m | 
[32mExpert 26: 3.200(2677)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert 28: 2.600(2683)[0m | [32mExpert  9: 2.400(2809)[0m | 
[32mExpert 44: 2.400(2737)[0m | [32mExpert 50: 2.400(2758)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 37: 2.000(2713)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 51: 1.800(2761)[0m | 
[32mExpert  4: 1.600(2722)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 10: 1.400(2626)[0m | 
[32mExpert 12: 1.400(2632)[0m | [32mExpert  3: 1.200(2689)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 58: 1.200(2782)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2713, 2695, 2701, 2761, 2722, 2680, 2779, 2626, 2632, 2689, 2653, 2782]
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4, 10, 12, 19, 27, 31, 33, 37, 51, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[3]:4.0 | [4]:4.0 | [17]:5.0 | [48]:2.0 | [50]:7.0 | [44]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[15]:1.0 | [24]:1.0 | [31]:1.0 | [38]:2.0 | [49]:3.0 | [46]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[42]:1.0 | [45]:10.0 | [46]:6.0 | [47]:1.0 | [53]:7.0 | [22]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 10 MLP ==
[0m
[13]:2.0 | [41]:9.0 | [44]:11.0 | [48]:2.0 | [50]:5.0 | [5]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[34]:8.0 | [43]:11.0 | [45]:3.0 | [51]:3.0 | [53]:2.0 | [20]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[41]:3.0 | [45]:1.0 | [47]:4.0 | [58]:7.0 | [61]:4.0 | [12]:6.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[41, 45, 47, 58, 61, 12]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 8.200(2990)[0m | [32mExpert 16: 7.200(2882)[0m | [32mExpert 40: 6.600(2963)[0m | [32mExpert 36: 6.200(2948)[0m | 
[32mExpert  0: 4.600(2858)[0m | [32mExpert 48: 4.400(2987)[0m | [32mExpert 18: 4.000(2888)[0m | [32mExpert  4: 3.600(2960)[0m | 
[32mExpert 61: 3.400(3032)[0m | [32mExpert 55: 3.200(3011)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 26: 3.000(2915)[0m | 
[32mExpert 33: 3.000(2939)[0m | [32mExpert 38: 2.800(2954)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.600(3002)[0m | 
[32mExpert 29: 2.400(2924)[0m | [32mExpert  6: 2.200(3026)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 30: 1.800(2930)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert 57: 1.600(3017)[0m | 
[32mExpert  7: 1.600(3041)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2951, 3038, 2930, 2885, 2864, 2942, 3017, 3041, 3020, 3023, 3044]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8, 10, 17, 25, 30, 34, 37, 57, 58, 59, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[17]:4.0 | [23]:10.0 | [34]:3.0 | [37]:7.0 | [48]:5.0 | [30]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[1]:1.0 | [12]:1.0 | [21]:1.0 | [43]:5.0 | [51]:4.0 | [32]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[6]:3.0 | [9]:1.0 | [15]:4.0 | [18]:6.0 | [61]:5.0 | [48]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[10]:6.0 | [11]:2.0 | [22]:3.0 | [24]:2.0 | [50]:1.0 | [59]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:12.0 | [4]:1.0 | [15]:5.0 | [33]:1.0 | [57]:1.0 | [12]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[9]:2.0 | [21]:7.0 | [29]:1.0 | [37]:5.0 | [53]:4.0 | [18]:7.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 9, 21, 29, 37, 53, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.000(4082)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 27: 5.800(4136)[0m | [32mExpert 59: 5.800(4241)[0m | 
[32mExpert  2: 5.200(4112)[0m | [32mExpert 19: 5.000(4109)[0m | [32mExpert 13: 4.400(4091)[0m | [32mExpert 62: 4.400(4253)[0m | 
[32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | 
[32mExpert 56: 4.000(4232)[0m | EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
[32mExpert 55: 3.600(4229)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 52: 3.200(4220)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 61: 2.800(4250)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 41: 2.400(4184)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 26: 2.000(4133)[0m | [32mExpert 49: 1.800(4208)[0m | 
[32mExpert 43: 1.800(4190)[0m | [32mExpert 12: 1.600(4088)[0m | [32mExpert 44: 1.600(4193)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert  4: 1.000(4178)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4184, 4187, 4133, 4208, 4190, 4088, 4193, 4205, 4169, 4214, 4235, 4178]
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  4, 12, 26, 37, 41, 42, 43, 44, 48, 49, 50, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[0]:1.0 | [1]:4.0 | [18]:3.0 | [32]:5.0 | [52]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[1]:2.0 | [16]:6.0 | [17]:1.0 | [32]:5.0 | [50]:11.0 | [19]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[13]:6.0 | [24]:1.0 | [44]:3.0 | [55]:5.0 | [59]:8.0 | [61]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:5.0 | [36]:1.0 | [44]:3.0 | [50]:5.0 | [63]:3.0 | [38]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[25]:6.0 | [29]:1.0 | [44]:1.0 | [50]:4.0 | [51]:2.0 | [16]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:9.0 | [25]:4.0 | [28]:6.0 | [39]:1.0 | [60]:3.0 | [56]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 25, 28, 39, 60, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:10.0 | [18]:3.0 | [35]:1.0 | [50]:1.0 | [58]:4.0 | [51]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[12]:3.0 | [15]:1.0 | [41]:1.0 | [50]:3.0 | [51]:5.0 | [32]:3.0 | 
---------------------------------------
return EAMC[0]
def EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[6]:4.0 | [24]:4.0 | [32]:3.0 | [33]:6.0 | [56]:11.0 | [8]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[9]:1.0 | [33]:5.0 | [39]:1.0 | [56]:1.0 | [57]:9.0 | [12]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[29]:6.0 | [54]:12.0 | [58]:3.0 | [61]:1.0 | [63]:4.0 | [4]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[31]:2.0 | [35]:3.0 | [43]:1.0 | [48]:6.0 | [50]:1.0 | [9]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[3]:1.0 | [7]:1.0 | [22]:1.0 | [38]:12.0 | [44]:5.0 | [46]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[4]:7.0 | [9]:6.0 | [20]:3.0 | [41]:8.0 | [44]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 4,  9, 20, 41, 44, 14]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 8.800(2740)[0m | [32mExpert 34: 7.200(2704)[0m | [32mExpert 41: 6.600(2728)[0m | [32mExpert 46: 6.600(2743)[0m | 
[32mExpert  1: 6.200(2623)[0m | [32mExpert 53: 6.200(2767)[0m | [32mExpert 16: 5.000(2644)[0m | [32mExpert  7: 4.800(2803)[0m | 
[32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 35: 3.400(2707)[0m | 
[32mExpert 26: 3.200(2677)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert 28: 2.600(2683)[0m | [32mExpert  9: 2.400(2809)[0m | 
[32mExpert 44: 2.400(2737)[0m | [32mExpert 50: 2.400(2758)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 37: 2.000(2713)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 51: 1.800(2761)[0m | 
[32mExpert  4: 1.600(2722)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | 
[32mExpert 10: 1.400(2626)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert  3: 1.200(2689)[0m | [32mExpert 19: 1.200(2653)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2713, 2695, 2701, 2761, 2722, 2665, 2680, 2779, 2626, 2632, 2689, 2653]
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4, 10, 12, 19, 22, 27, 31, 33, 37, 51, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:1.0 | [5]:2.0 | [11]:7.0 | [15]:1.0 | [47]:7.0 | [4]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[1]:4.0 | [2]:2.0 | [4]:2.0 | [11]:7.0 | [13]:7.0 | [43]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[16]:5.0 | [26]:5.0 | [36]:1.0 | [40]:1.0 | [62]:2.0 | [7]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 10 MLP ==
[0m
[10]:7.0 | [25]:5.0 | [27]:3.0 | [35]:3.0 | [56]:1.0 | [49]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[2]:4.0 | [21]:1.0 | [29]:2.0 | [45]:4.0 | [58]:7.0 | [49]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[18]:1.0 | [32]:5.0 | [33]:6.0 | [34]:1.0 | [45]:2.0 | [0]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[18, 32, 33, 34, 45,  0]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 8.200(2990)[0m | [32mExpert 16: 7.200(2882)[0m | [32mExpert 40: 6.600(2963)[0m | [32mExpert 36: 6.200(2948)[0m | 
[32mExpert 48: 5.200(2987)[0m | [32mExpert 18: 4.800(2888)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 61: 4.200(3032)[0m | 
[32mExpert 15: 3.800(2879)[0m | [32mExpert  4: 3.600(2960)[0m | [32mExpert 55: 3.200(3011)[0m | [32mExpert  6: 3.000(3026)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 38: 2.800(2954)[0m | [32mExpert 11: 2.600(2867)[0m | 
[32mExpert 52: 2.600(3002)[0m | [32mExpert 29: 2.400(2924)[0m | [32mExpert 14: 2.200(2876)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 30: 1.800(2930)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert 57: 1.600(3017)[0m | 
[32mExpert  7: 1.600(3041)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2951, 3038, 2930, 2885, 2864, 2942, 3017, 3041, 3020, 3023, 3044]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8, 10, 17, 25, 30, 34, 37, 57, 58, 59, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[10]:4.0 | [36]:7.0 | [38]:1.0 | [45]:4.0 | [63]:4.0 | [52]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[14]:2.0 | [20]:4.0 | [35]:1.0 | [38]:2.0 | [47]:2.0 | [46]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[18]:7.0 | [25]:2.0 | [32]:1.0 | [40]:8.0 | [48]:7.0 | [1]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[20]:6.0 | [23]:1.0 | [35]:1.0 | [47]:3.0 | [54]:4.0 | [61]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[22]:1.0 | [24]:8.0 | [30]:5.0 | [45]:6.0 | [54]:1.0 | [39]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[5]:2.0 | [7]:2.0 | [14]:8.0 | [47]:5.0 | [55]:2.0 | [58]:5.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 5,  7, 14, 47, 55, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 59: 6.600(4241)[0m | [32mExpert 10: 6.000(4082)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 27: 5.800(4136)[0m | 
[32mExpert 13: 5.200(4091)[0m | [32mExpert  2: 5.200(4112)[0m | EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
[32mExpert 19: 5.000(4109)[0m | [32mExpert 55: 4.400(4229)[0m | 
[32mExpert 62: 4.400(4253)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 51: 4.000(4217)[0m | 
[32mExpert 54: 4.000(4226)[0m | [32mExpert 56: 4.000(4232)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 17: 3.600(4103)[0m | 
[32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 30: 2.600(4148)[0m | 
[32mExpert 41: 2.400(4184)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 44: 2.400(4193)[0m | [32mExpert 26: 2.000(4133)[0m | 
[32mExpert 49: 1.800(4208)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 12: 1.600(4088)[0m | [32mExpert 48: 1.600(4205)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | [32mExpert 57: 1.400(4235)[0m | [32mExpert 24: 1.200(4127)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4184, 4187, 4193, 4133, 4208, 4190, 4088, 4205, 4169, 4214, 4235, 4127]
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21: 12, 24, 26, 37, 41, 42, 43, 44, 48, 49, 50, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:5.0 | [12]:7.0 | [18]:4.0 | [21]:2.0 | [56]:2.0 | [4]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[13]:4.0 | [20]:2.0 | [36]:4.0 | [41]:3.0 | [57]:4.0 | [60]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[10]:6.0 | [26]:3.0 | [41]:4.0 | [56]:4.0 | [57]:1.0 | [12]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E57 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[3]:5.0 | [17]:4.0 | [24]:4.0 | [28]:3.0 | [47]:2.0 | [29]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[3]:5.0 | [14]:1.0 | [17]:3.0 | [32]:1.0 | [36]:1.0 | [21]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[12]:1.0 | [19]:5.0 | [45]:1.0 | [47]:3.0 | [54]:4.0 | [34]:5.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[12, 19, 45, 47, 54, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[5]:2.0 | [6]:4.0 | [22]:2.0 | [31]:1.0 | [47]:2.0 | [54]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[5]:3.0 | [6]:1.0 | [11]:5.0 | [17]:7.0 | [60]:1.0 | [57]:5.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3023
[1m[33mEnqueueTask: [0m[32mTask: node: ID[972,3b0000001f] (16MB) STATE(0) TENSOR[3022,3023,3021,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:1.0 | [26]:8.0 | [45]:1.0 | [46]:5.0 | [60]:3.0 | [13]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[3]:2.0 | [22]:1.0 | [48]:2.0 | [50]:2.0 | [52]:1.0 | [17]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[12]:3.0 | [40]:1.0 | [54]:13.0 | [61]:2.0 | [63]:5.0 | [37]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[2]:5.0 | [27]:1.0 | [42]:1.0 | [50]:2.0 | [61]:1.0 | [14]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[3]:2.0 | [22]:2.0 | [54]:4.0 | [58]:1.0 | [63]:1.0 | [7]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[7]:1.0 | [9]:7.0 | [23]:2.0 | [39]:3.0 | [44]:2.0 | [42]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 7,  9, 23, 39, 44, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 8.800(2740)[0m | [32mExpert 34: 7.200(2704)[0m | [32mExpert 41: 6.600(2728)[0m | [32mExpert 46: 6.600(2743)[0m | 
[32mExpert  1: 6.200(2623)[0m | [32mExpert 53: 6.200(2767)[0m | [32mExpert 16: 5.800(2644)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 4.000(2677)[0m | [32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | 
[32mExpert 35: 3.400(2707)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert 28: 2.600(2683)[0m | [32mExpert  9: 2.400(2809)[0m | 
[32mExpert 44: 2.400(2737)[0m | [32mExpert 50: 2.400(2758)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 24: 2.000(2671)[0m | 
[32mExpert 37: 2.000(2713)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 62: 1.800(2797)[0m | 
[32mExpert 51: 1.800(2761)[0m | [32mExpert  4: 1.600(2722)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 27: 1.600(2680)[0m | 
[32mExpert 57: 1.600(2779)[0m | [32mExpert 10: 1.400(2626)[0m | [32mExpert 12: 1.400(2632)[0m | [32mExpert  3: 1.200(2689)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2713, 2695, 2701, 2797, 2761, 2722, 2665, 2680, 2779, 2626, 2632, 2689]
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4, 10, 12, 22, 27, 31, 33, 37, 51, 57, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:3.0 | [15]:2.0 | [46]:4.0 | [48]:3.0 | [59]:1.0 | [0]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[0]:2.0 | [11]:8.0 | [26]:1.0 | [30]:5.0 | [40]:1.0 | [39]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[13]:2.0 | [16]:6.0 | [22]:3.0 | [50]:4.0 | [62]:3.0 | [24]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E22 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[2]:2.0 | [12]:1.0 | [13]:3.0 | [25]:6.0 | [56]:2.0 | [35]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[2]:5.0 | [4]:1.0 | [21]:2.0 | [45]:5.0 | [58]:8.0 | [59]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[20]:1.0 | [33]:7.0 | [34]:2.0 | [45]:3.0 | [61]:5.0 | [59]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[20, 33, 34, 45, 61, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 8.200(2990)[0m | [32mExpert 40: 7.400(2963)[0m | [32mExpert 16: 7.200(2882)[0m | [32mExpert 36: 6.200(2948)[0m | 
[32mExpert 48: 6.000(2987)[0m | [32mExpert 18: 5.600(2888)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 61: 4.200(3032)[0m | 
[32mExpert 15: 3.800(2879)[0m | [32mExpert  4: 3.600(2960)[0m | [32mExpert 55: 3.200(3011)[0m | [32mExpert  6: 3.000(3026)[0m | 
[32mExpert 25: 3.000(2912)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 38: 2.800(2954)[0m | 
[32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.600(3002)[0m | [32mExpert 29: 2.400(2924)[0m | [32mExpert 14: 2.200(2876)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert 30: 1.800(2930)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert 57: 1.600(3017)[0m | 
[32mExpert  7: 1.600(3041)[0m | [32mExpert 58: 1.600(3020)[0m | [32mExpert 59: 1.600(3023)[0m | [32mExpert  8: 1.400(3044)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2951, 3038, 2930, 2885, 2864, 2942, 3017, 3041, 3020, 3023, 3044]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3023[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8, 10, 17, 30, 34, 37, 50, 57, 58, 59, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[13]:1.0 | [23]:11.0 | [37]:8.0 | [38]:2.0 | [63]:5.0 | [10]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[0]:4.0 | [14]:3.0 | [20]:5.0 | [29]:1.0 | [35]:2.0 | [38]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[9]:2.0 | [18]:8.0 | [21]:1.0 | [25]:3.0 | [40]:9.0 | [1]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[20]:7.0 | [23]:2.0 | [30]:6.0 | [47]:4.0 | [54]:5.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:13.0 | [22]:2.0 | [30]:6.0 | [36]:1.0 | [54]:2.0 | [53]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[7]:3.0 | [14]:9.0 | [33]:1.0 | [37]:6.0 | [55]:3.0 | [58]:6.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 7, 14, 33, 37, 55, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
[90mTop 20 Experts:[0m
[32mExpert 10: 6.800(4082)[0m | [32mExpert 59: 6.600(4241)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 27: 5.800(4136)[0m | 
[32mExpert 13: 5.200(4091)[0m | [32mExpert  2: 5.200(4112)[0m | [32mExpert 19: 5.000(4109)[0m | [32mExpert 56: 4.800(4232)[0m | 
[32mExpert 55: 4.400(4229)[0m | [32mExpert 62: 4.400(4253)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | 
[32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 17: 3.600(4103)[0m | 
[32mExpert 41: 3.200(4184)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert 26: 2.800(4133)[0m | 
[32mExpert  1: 2.800(4079)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert 12: 2.400(4088)[0m | [32mExpert 42: 2.400(4187)[0m | 
[32mExpert 44: 2.400(4193)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 49: 1.800(4208)[0m | [32mExpert 43: 1.800(4190)[0m | 
[32mExpert 48: 1.600(4205)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | [32mExpert 24: 1.200(4127)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4079, 4148, 4088, 4187, 4193, 4235, 4208, 4190, 4205, 4169, 4214, 4127]
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1, 12, 24, 30, 37, 42, 43, 44, 48, 49, 50, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:5.0 | [5]:6.0 | [18]:5.0 | [32]:6.0 | [56]:3.0 | [12]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[1]:3.0 | [11]:2.0 | [13]:5.0 | [16]:7.0 | [19]:2.0 | [33]:9.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[12]:4.0 | [15]:1.0 | [19]:4.0 | [29]:1.0 | [59]:9.0 | [41]:5.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:6.0 | [17]:5.0 | [29]:3.0 | [34]:1.0 | [44]:4.0 | [28]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[14]:2.0 | [16]:5.0 | [25]:7.0 | [51]:3.0 | [58]:5.0 | [17]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:10.0 | [19]:6.0 | [40]:1.0 | [50]:10.0 | [54]:5.0 | [24]:5.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 19, 40, 50, 54, 24]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[5]:3.0 | [31]:2.0 | [44]:5.0 | [59]:1.0 | [63]:5.0 | [23]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[6]:2.0 | [7]:1.0 | [9]:5.0 | [60]:2.0 | [63]:7.0 | [40]:1.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2779
[1m[33mEnqueueTask: [0m[32mTask: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2626
[1m[33mEnqueueTask: [0m[32mTask: node: ID[533,a00000013] (16MB) STATE(0) TENSOR[2625,2626,2624,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[580,3900000013] (16MB) STATE(0) TENSOR[2778,2779,2777,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:1.0 | [7]:3.0 | [40]:1.0 | [50]:9.0 | [59]:3.0 | [49]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[3]:3.0 | [6]:3.0 | [26]:1.0 | [30]:1.0 | [33]:6.0 | [45]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[20]:1.0 | [29]:7.0 | [36]:4.0 | [37]:2.0 | [43]:1.0 | [63]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[24]:6.0 | [28]:1.0 | [35]:4.0 | [48]:7.0 | [62]:1.0 | [7]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[2]:3.0 | [4]:2.0 | [6]:1.0 | [30]:1.0 | [46]:4.0 | [34]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[3]:2.0 | [4]:8.0 | [14]:2.0 | [20]:4.0 | [29]:4.0 | [30]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 3,  4, 14, 20, 29, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 8.800(2740)[0m | [32mExpert 34: 7.200(2704)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert 41: 6.600(2728)[0m | 
[32mExpert 46: 6.600(2743)[0m | [32mExpert  1: 6.200(2623)[0m | [32mExpert 53: 6.200(2767)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 4.000(2677)[0m | [32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | 
[32mExpert 35: 3.400(2707)[0m | [32mExpert 50: 3.200(2758)[0m | [32mExpert 24: 2.800(2671)[0m | [32mExpert 62: 2.600(2797)[0m | 
[32mExpert 11: 2.600(2629)[0m | [32mExpert 28: 2.600(2683)[0m | [32mExpert  9: 2.400(2809)[0m | [32mExpert 22: 2.400(2665)[0m | 
[32mExpert 44: 2.400(2737)[0m | [32mExpert 17: 2.400(2647)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 51: 1.800(2761)[0m | [32mExpert  4: 1.600(2722)[0m | 
[32mExpert 27: 1.600(2680)[0m | [32mExpert 57: 1.600(2779)[0m | [32mExpert 10: 1.400(2626)[0m | [32mExpert 12: 1.400(2632)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2737, 2647, 2713, 2635, 2695, 2701, 2761, 2722, 2680, 2779, 2626, 2632]
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2779[0m â†’ GPU 0
Prefetching [1;36mTensor 2626[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4, 10, 12, 13, 17, 27, 31, 33, 37, 44, 51, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:4.0 | [10]:3.0 | [11]:8.0 | [47]:8.0 | [49]:1.0 | [27]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[1]:5.0 | [11]:9.0 | [24]:2.0 | [40]:2.0 | [58]:1.0 | [13]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[13]:3.0 | [23]:2.0 | [26]:6.0 | [31]:3.0 | [60]:1.0 | [63]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[16]:7.0 | [25]:7.0 | [34]:1.0 | [35]:5.0 | [49]:6.0 | [7]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[2]:6.0 | [13]:1.0 | [45]:6.0 | [53]:3.0 | [58]:9.0 | [29]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[18]:2.0 | [22]:3.0 | [32]:6.0 | [52]:1.0 | [63]:1.0 | [45]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[18, 22, 32, 52, 63, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 40: 8.200(2963)[0m | [32mExpert 49: 8.200(2990)[0m | [32mExpert 16: 7.200(2882)[0m | [32mExpert 18: 6.400(2888)[0m | 
[32mExpert 36: 6.200(2948)[0m | [32mExpert 48: 6.000(2987)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 61: 4.200(3032)[0m | 
[32mExpert 15: 3.800(2879)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert  4: 3.600(2960)[0m | [32mExpert 55: 3.200(3011)[0m | 
[32mExpert  6: 3.000(3026)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 38: 2.800(2954)[0m | 
[32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.600(3002)[0m | [32mExpert 29: 2.400(2924)[0m | [32mExpert 14: 2.200(2876)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert  1: 1.800(2861)[0m | 
[32mExpert 30: 1.800(2930)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert  9: 1.600(3047)[0m | 
[32mExpert 34: 1.600(2942)[0m | [32mExpert 57: 1.600(3017)[0m | [32mExpert  7: 1.600(3041)[0m | [32mExpert 58: 1.600(3020)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2951, 3038, 2861, 2930, 2885, 2864, 3047, 2942, 3017, 3041, 3020]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  7,  9, 10, 17, 30, 34, 37, 50, 57, 58, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[22]:3.0 | [24]:5.0 | [36]:8.0 | [55]:1.0 | [63]:6.0 | [53]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[8]:1.0 | [14]:4.0 | [38]:4.0 | [55]:6.0 | [59]:4.0 | [11]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[32]:2.0 | [40]:10.0 | [48]:8.0 | [49]:9.0 | [55]:4.0 | [14]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[13]:3.0 | [26]:5.0 | [30]:7.0 | [54]:6.0 | [61]:3.0 | [6]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[3]:3.0 | [17]:1.0 | [45]:7.0 | [50]:2.0 | [58]:1.0 | [22]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[3]:2.0 | [5]:3.0 | [36]:2.0 | [39]:2.0 | [56]:5.0 | [19]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 3,  5, 36, 39, 56, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4127
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1327,180000002b] (16MB) STATE(0) TENSOR[4126,4127,4125,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
[90mTop 20 Experts:[0m
[32mExpert 59: 7.400(4241)[0m | [32mExpert 10: 6.800(4082)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 27: 5.800(4136)[0m | 
[32mExpert 19: 5.800(4109)[0m | [32mExpert 13: 5.200(4091)[0m | [32mExpert  2: 5.200(4112)[0m | [32mExpert 56: 4.800(4232)[0m | 
[32mExpert 55: 4.400(4229)[0m | [32mExpert 62: 4.400(4253)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | 
[32mExpert 41: 4.000(4184)[0m | [32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | 
[32mExpert 17: 3.600(4103)[0m | [32mExpert 12: 3.200(4088)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | 
[32mExpert 26: 2.800(4133)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert 42: 2.400(4187)[0m | 
[32mExpert 44: 2.400(4193)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 49: 1.800(4208)[0m | [32mExpert 43: 1.800(4190)[0m | 
[32mExpert 48: 1.600(4205)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 50: 1.400(4214)[0m | [32mExpert 24: 1.200(4127)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4133, 4079, 4148, 4187, 4193, 4235, 4208, 4190, 4205, 4169, 4214, 4127]
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4127[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1, 24, 26, 30, 37, 42, 43, 44, 48, 49, 50, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:7.0 | [12]:9.0 | [13]:1.0 | [39]:5.0 | [43]:6.0 | [36]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[41]:4.0 | [56]:3.0 | [57]:5.0 | [61]:3.0 | [62]:1.0 | [38]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[6]:2.0 | [13]:7.0 | [26]:4.0 | [29]:2.0 | [41]:6.0 | [0]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:8.0 | [14]:1.0 | [24]:5.0 | [32]:2.0 | [35]:1.0 | [12]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[11]:4.0 | [14]:3.0 | [18]:1.0 | [36]:2.0 | [62]:1.0 | [32]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[19]:7.0 | [20]:1.0 | [38]:3.0 | [54]:6.0 | [62]:5.0 | [7]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[19, 20, 38, 54, 62,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[5]:4.0 | [20]:2.0 | [31]:3.0 | [47]:3.0 | [53]:1.0 | [17]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[10]:2.0 | [11]:6.0 | [14]:2.0 | [43]:4.0 | [60]:3.0 | [20]:1.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[25]:2.0 | [43]:3.0 | [55]:2.0 | [62]:5.0 | [63]:2.0 | [26]:9.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[15]:3.0 | [19]:1.0 | [25]:1.0 | [47]:4.0 | [51]:8.0 | [1]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[9]:2.0 | [13]:1.0 | [36]:5.0 | [45]:2.0 | [54]:14.0 | [5]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[13]:4.0 | [51]:2.0 | [59]:3.0 | [60]:8.0 | [63]:3.0 | [33]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[2]:4.0 | [17]:4.0 | [41]:6.0 | [53]:2.0 | [56]:2.0 | [10]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[10]:2.0 | [33]:1.0 | [35]:3.0 | [43]:1.0 | [55]:2.0 | [23]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[10, 33, 35, 43, 55, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 8.800(2740)[0m | [32mExpert 34: 7.200(2704)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert 41: 6.600(2728)[0m | 
[32mExpert 46: 6.600(2743)[0m | [32mExpert  1: 6.200(2623)[0m | [32mExpert 53: 6.200(2767)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 4.800(2677)[0m | [32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | 
[32mExpert 35: 3.400(2707)[0m | [32mExpert 50: 3.200(2758)[0m | [32mExpert 24: 2.800(2671)[0m | [32mExpert 13: 2.600(2635)[0m | 
[32mExpert 31: 2.600(2695)[0m | [32mExpert 62: 2.600(2797)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert 28: 2.600(2683)[0m | 
[32mExpert  9: 2.400(2809)[0m | [32mExpert 22: 2.400(2665)[0m | [32mExpert 44: 2.400(2737)[0m | [32mExpert 17: 2.400(2647)[0m | 
[32mExpert 37: 2.000(2713)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 51: 1.800(2761)[0m | 
[32mExpert 60: 1.800(2791)[0m | [32mExpert  4: 1.600(2722)[0m | [32mExpert 23: 1.600(2668)[0m | [32mExpert 27: 1.600(2680)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2809, 2665, 2737, 2647, 2713, 2701, 2800, 2761, 2791, 2722, 2668, 2680]
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  9, 17, 22, 23, 27, 33, 37, 44, 51, 60, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:1.0 | [6]:8.0 | [20]:1.0 | [33]:1.0 | [48]:4.0 | [8]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[6]:6.0 | [8]:7.0 | [17]:1.0 | [26]:2.0 | [38]:3.0 | [49]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[17]:2.0 | [33]:3.0 | [38]:1.0 | [45]:11.0 | [53]:8.0 | [52]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[0]:1.0 | [30]:5.0 | [37]:1.0 | [44]:12.0 | [50]:6.0 | [59]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[6]:2.0 | [15]:3.0 | [53]:4.0 | [57]:1.0 | [63]:3.0 | [16]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[16]:7.0 | [17]:1.0 | [42]:3.0 | [58]:8.0 | [60]:1.0 | [26]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[16, 17, 42, 58, 60, 26]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 40: 9.000(2963)[0m | [32mExpert 49: 9.000(2990)[0m | [32mExpert 16: 7.200(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert 61: 4.200(3032)[0m | 
[32mExpert 55: 4.000(3011)[0m | [32mExpert 15: 3.800(2879)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert  4: 3.600(2960)[0m | 
[32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | 
[32mExpert 38: 2.800(2954)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.600(3002)[0m | [32mExpert 29: 2.400(2924)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert  1: 1.800(2861)[0m | 
[32mExpert 30: 1.800(2930)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | [32mExpert  9: 1.600(3047)[0m | 
[32mExpert 32: 1.600(2936)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert 57: 1.600(3017)[0m | [32mExpert  7: 1.600(3041)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2951, 3038, 2861, 2930, 2885, 2864, 3047, 2936, 2942, 3017, 3041]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  7,  9, 10, 17, 30, 32, 34, 37, 50, 57, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[3]:1.0 | [27]:2.0 | [40]:1.0 | [43]:2.0 | [52]:2.0 | [56]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[32]:4.0 | [39]:1.0 | [50]:2.0 | [54]:2.0 | [59]:5.0 | [63]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[4]:5.0 | [8]:2.0 | [38]:3.0 | [44]:1.0 | [54]:1.0 | [22]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[3]:3.0 | [17]:4.0 | [30]:8.0 | [34]:1.0 | [38]:1.0 | [16]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[4]:2.0 | [16]:1.0 | [20]:4.0 | [28]:6.0 | [44]:2.0 | [53]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[8]:1.0 | [35]:6.0 | [47]:6.0 | [57]:2.0 | [61]:5.0 | [31]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 8, 35, 47, 57, 61, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
[90mTop 20 Experts:[0m
[32mExpert 59: 7.400(4241)[0m | [32mExpert 10: 6.800(4082)[0m | [32mExpert 13: 6.000(4091)[0m | [32mExpert 21: 6.000(4118)[0m | 
[32mExpert 27: 5.800(4136)[0m | [32mExpert 19: 5.800(4109)[0m | [32mExpert  2: 5.200(4112)[0m | [32mExpert 41: 4.800(4184)[0m | 
[32mExpert 56: 4.800(4232)[0m | [32mExpert 55: 4.400(4229)[0m | [32mExpert 62: 4.400(4253)[0m | [32mExpert 14: 4.200(4094)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 51: 4.000(4217)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 26: 3.600(4133)[0m | 
[32mExpert 61: 3.600(4250)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 12: 3.200(4088)[0m | [32mExpert 52: 3.200(4220)[0m | 
[32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 30: 2.600(4148)[0m | [32mExpert 42: 2.400(4187)[0m | 
[32mExpert 44: 2.400(4193)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | [32mExpert 49: 1.800(4208)[0m | 
[32mExpert 43: 1.800(4190)[0m | [32mExpert  6: 1.600(4244)[0m | [32mExpert 48: 1.600(4205)[0m | [32mExpert 37: 1.400(4169)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4238, 4079, 4148, 4187, 4193, 4235, 4142, 4208, 4190, 4244, 4205, 4169]
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 29, 30, 37, 42, 43, 44, 48, 49, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:1.0 | [28]:1.0 | [36]:3.0 | [50]:1.0 | [53]:4.0 | [46]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[40]:4.0 | [44]:6.0 | [49]:1.0 | [53]:7.0 | [61]:4.0 | [28]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[26]:5.0 | [30]:1.0 | [45]:2.0 | [47]:1.0 | [51]:5.0 | [2]:5.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:9.0 | [9]:3.0 | [11]:5.0 | [33]:5.0 | [44]:5.0 | [29]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[19]:1.0 | [32]:3.0 | [40]:6.0 | [53]:2.0 | [60]:4.0 | [42]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[2]:1.0 | [45]:2.0 | [51]:1.0 | [52]:3.0 | [58]:2.0 | [63]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 2, 45, 51, 52, 58, 63]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[4]:2.0 | [11]:2.0 | [12]:8.0 | [15]:3.0 | [40]:2.0 | [21]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[5]:4.0 | [7]:2.0 | [37]:1.0 | [55]:1.0 | [56]:9.0 | [17]:8.0 | 
---------------------------------------
return EAMC[0]
fetch_data():
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[20]:3.0 | [31]:7.0 | [35]:1.0 | [50]:10.0 | [57]:7.0 | [47]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[8]:3.0 | [43]:4.0 | [53]:2.0 | [59]:2.0 | [62]:8.0 | [28]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:15.0 | [5]:6.0 | [21]:7.0 | [22]:4.0 | [48]:8.0 | [46]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[2]:6.0 | [3]:7.0 | [22]:6.0 | [34]:8.0 | [60]:9.0 | [36]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[18]:8.0 | [29]:3.0 | [39]:6.0 | [41]:7.0 | [50]:6.0 | [55]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[16]:6.0 | [27]:1.0 | [35]:4.0 | [50]:5.0 | [56]:6.0 | [37]:6.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[16, 27, 35, 50, 56, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 9.600(2740)[0m | [32mExpert 34: 7.200(2704)[0m | [32mExpert 53: 7.000(2767)[0m | [32mExpert 16: 6.600(2644)[0m | 
[32mExpert 41: 6.600(2728)[0m | [32mExpert 46: 6.600(2743)[0m | [32mExpert  1: 6.200(2623)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 4.800(2677)[0m | [32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | 
[32mExpert 35: 3.400(2707)[0m | [32mExpert 50: 3.200(2758)[0m | [32mExpert 17: 3.200(2647)[0m | [32mExpert 24: 2.800(2671)[0m | 
[32mExpert 13: 2.600(2635)[0m | [32mExpert 31: 2.600(2695)[0m | [32mExpert 33: 2.600(2701)[0m | [32mExpert 62: 2.600(2797)[0m | 
[32mExpert 11: 2.600(2629)[0m | [32mExpert 28: 2.600(2683)[0m | [32mExpert  9: 2.400(2809)[0m | [32mExpert 22: 2.400(2665)[0m | 
[32mExpert 44: 2.400(2737)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 38: 1.800(2716)[0m | 
[32mExpert 51: 1.800(2761)[0m | [32mExpert 60: 1.800(2791)[0m | [32mExpert  4: 1.600(2722)[0m | [32mExpert 23: 1.600(2668)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2629, 2683, 2809, 2665, 2737, 2713, 2800, 2716, 2761, 2791, 2722, 2668]
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  9, 11, 22, 23, 28, 37, 38, 44, 51, 60, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:9.0 | [26]:4.0 | [38]:6.0 | [41]:8.0 | [42]:6.0 | [8]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[6]:7.0 | [8]:8.0 | [15]:2.0 | [45]:8.0 | [46]:6.0 | [33]:11.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[41]:7.0 | [44]:4.0 | [45]:12.0 | [46]:7.0 | [50]:5.0 | [17]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:6.0 | [41]:10.0 | [44]:13.0 | [55]:8.0 | [60]:5.0 | [5]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[28]:6.0 | [31]:1.0 | [40]:2.0 | [44]:1.0 | [47]:8.0 | [1]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[7]:6.0 | [29]:10.0 | [37]:3.0 | [42]:4.0 | [58]:9.0 | [46]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 7, 29, 37, 42, 58, 46]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 40: 9.000(2963)[0m | [32mExpert 49: 9.000(2990)[0m | [32mExpert 16: 7.200(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert  0: 4.600(2858)[0m | [32mExpert  4: 4.400(2960)[0m | 
[32mExpert 61: 4.200(3032)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 15: 3.800(2879)[0m | [32mExpert 25: 3.800(2912)[0m | 
[32mExpert 38: 3.600(2954)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | [32mExpert 26: 3.000(2915)[0m | 
[32mExpert 33: 3.000(2939)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.600(3002)[0m | [32mExpert 29: 2.400(2924)[0m | 
[32mExpert  8: 2.200(3044)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert 63: 2.000(3038)[0m | 
[32mExpert  1: 1.800(2861)[0m | [32mExpert 30: 1.800(2930)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 10: 1.800(2864)[0m | 
[32mExpert  9: 1.600(3047)[0m | [32mExpert 32: 1.600(2936)[0m | [32mExpert 34: 1.600(2942)[0m | [32mExpert 57: 1.600(3017)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3044, 2996, 2951, 3038, 2861, 2930, 2885, 2864, 3047, 2936, 2942, 3017]
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  8,  9, 10, 17, 30, 32, 34, 37, 50, 57, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[9]:1.0 | [18]:1.0 | [29]:8.0 | [43]:3.0 | [44]:4.0 | [33]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[9]:7.0 | [28]:9.0 | [33]:7.0 | [48]:5.0 | [50]:3.0 | [51]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[0]:5.0 | [16]:8.0 | [24]:2.0 | [29]:4.0 | [49]:10.0 | [10]:1.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:4.0 | [16]:7.0 | [41]:7.0 | [43]:3.0 | [48]:2.0 | [3]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[16]:2.0 | [23]:4.0 | [26]:4.0 | [40]:8.0 | [41]:4.0 | [27]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[18]:8.0 | [26]:1.0 | [28]:2.0 | [30]:4.0 | [46]:8.0 | [48]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[18, 26, 28, 30, 46, 48]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
[90mTop 20 Experts:[0m
[32mExpert 59: 7.400(4241)[0m | [32mExpert 10: 6.800(4082)[0m | [32mExpert  2: 6.000(4112)[0m | [32mExpert 13: 6.000(4091)[0m | 
[32mExpert 21: 6.000(4118)[0m | [32mExpert 27: 5.800(4136)[0m | [32mExpert 19: 5.800(4109)[0m | [32mExpert 41: 4.800(4184)[0m | 
[32mExpert 51: 4.800(4217)[0m | [32mExpert 56: 4.800(4232)[0m | [32mExpert 26: 4.400(4133)[0m | [32mExpert 55: 4.400(4229)[0m | 
[32mExpert 62: 4.400(4253)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | 
[32mExpert 61: 3.600(4250)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 30: 3.400(4148)[0m | [32mExpert 12: 3.200(4088)[0m | 
[32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 42: 2.400(4187)[0m | 
[32mExpert 44: 2.400(4193)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | [32mExpert 49: 1.800(4208)[0m | 
[32mExpert 43: 1.800(4190)[0m | [32mExpert  6: 1.600(4244)[0m | [32mExpert 45: 1.600(4196)[0m | [32mExpert 48: 1.600(4205)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4220, 4238, 4079, 4187, 4193, 4235, 4142, 4208, 4190, 4244, 4196, 4205]
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 29, 42, 43, 44, 45, 48, 49, 52, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[0]:2.0 | [19]:6.0 | [24]:6.0 | [29]:1.0 | [41]:6.0 | [37]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[15]:4.0 | [22]:4.0 | [38]:4.0 | [40]:5.0 | [50]:12.0 | [43]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[16]:2.0 | [27]:7.0 | [45]:3.0 | [53]:2.0 | [62]:5.0 | [19]:5.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E45 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[24]:6.0 | [45]:1.0 | [52]:1.0 | [60]:8.0 | [63]:4.0 | [37]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[4]:1.0 | [7]:7.0 | [8]:1.0 | [23]:8.0 | [40]:7.0 | [37]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[12]:2.0 | [22]:7.0 | [37]:8.0 | [50]:11.0 | [59]:1.0 | [41]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[12, 22, 37, 50, 59, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:7.0 | [8]:2.0 | [12]:9.0 | [40]:3.0 | [57]:4.0 | [0]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[18]:2.0 | [21]:1.0 | [30]:8.0 | [44]:1.0 | [55]:2.0 | [22]:1.0 | 
---------------------------------------
return EAMC[0]
   EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:4.0 | [13]:2.0 | [26]:10.0 | [41]:1.0 | [48]:1.0 | [0]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[27]:3.0 | [29]:2.0 | [38]:6.0 | [53]:3.0 | [63]:8.0 | [14]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[5]:7.0 | [7]:4.0 | [25]:2.0 | [46]:6.0 | [47]:1.0 | [40]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[5]:1.0 | [23]:2.0 | [41]:1.0 | [44]:3.0 | [60]:10.0 | [2]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[0]:2.0 | [4]:3.0 | [38]:13.0 | [41]:8.0 | [50]:7.0 | [29]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[10]:3.0 | [19]:8.0 | [34]:2.0 | [35]:5.0 | [43]:2.0 | [61]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[10, 19, 34, 35, 43, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 10.400(2740)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | [32mExpert 34: 7.200(2704)[0m | 
[32mExpert 53: 7.000(2767)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert  1: 6.200(2623)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 4.800(2677)[0m | [32mExpert 17: 4.000(2647)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 35: 3.400(2707)[0m | [32mExpert 44: 3.200(2737)[0m | 
[32mExpert 24: 2.800(2671)[0m | [32mExpert 13: 2.600(2635)[0m | [32mExpert 31: 2.600(2695)[0m | [32mExpert 33: 2.600(2701)[0m | 
[32mExpert 62: 2.600(2797)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert 28: 2.600(2683)[0m | [32mExpert  9: 2.400(2809)[0m | 
[32mExpert 22: 2.400(2665)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 38: 1.800(2716)[0m | 
[32mExpert 51: 1.800(2761)[0m | [32mExpert 60: 1.800(2791)[0m | [32mExpert  4: 1.600(2722)[0m | [32mExpert 23: 1.600(2668)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2797, 2629, 2683, 2809, 2665, 2713, 2800, 2716, 2761, 2791, 2722, 2668]
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  9, 11, 22, 23, 28, 37, 38, 51, 60, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[17]:6.0 | [18]:2.0 | [48]:5.0 | [58]:2.0 | [60]:1.0 | [43]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[8]:9.0 | [18]:2.0 | [27]:1.0 | [31]:2.0 | [33]:12.0 | [43]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[2]:1.0 | [5]:1.0 | [17]:4.0 | [19]:2.0 | [53]:9.0 | [38]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E38 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:7.0 | [37]:2.0 | [41]:11.0 | [44]:14.0 | [50]:7.0 | [7]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[28]:7.0 | [41]:1.0 | [45]:7.0 | [53]:5.0 | [63]:4.0 | [20]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[29]:11.0 | [34]:3.0 | [42]:5.0 | [45]:5.0 | [58]:10.0 | [41]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[29, 34, 42, 45, 58, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 9.800(2990)[0m | [32mExpert 40: 9.000(2963)[0m | [32mExpert 16: 8.000(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert  0: 5.400(2858)[0m | [32mExpert  4: 4.400(2960)[0m | 
[32mExpert 61: 4.200(3032)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 15: 3.800(2879)[0m | [32mExpert 25: 3.800(2912)[0m | 
[32mExpert 38: 3.600(2954)[0m | [32mExpert 29: 3.200(2924)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 10: 2.600(2864)[0m | 
[32mExpert 52: 2.600(3002)[0m | [32mExpert  8: 2.200(3044)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 37: 2.200(2951)[0m | 
[32mExpert 24: 2.000(2909)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert  1: 1.800(2861)[0m | [32mExpert 30: 1.800(2930)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 32: 1.600(2936)[0m | [32mExpert 34: 1.600(2942)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 3044, 2996, 2951, 2909, 3038, 2861, 2930, 2885, 3047, 2936, 2942]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  8,  9, 17, 24, 30, 32, 34, 37, 50, 52, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[17]:5.0 | [23]:12.0 | [30]:6.0 | [37]:9.0 | [52]:3.0 | [29]:9.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[28]:10.0 | [33]:8.0 | [40]:1.0 | [43]:6.0 | [51]:6.0 | [50]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[9]:3.0 | [16]:9.0 | [29]:5.0 | [49]:11.0 | [61]:6.0 | [15]:5.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[41]:8.0 | [43]:4.0 | [44]:4.0 | [48]:3.0 | [59]:4.0 | [15]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[2]:14.0 | [4]:3.0 | [12]:3.0 | [36]:2.0 | [40]:9.0 | [15]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[3]:3.0 | [18]:9.0 | [21]:8.0 | [53]:5.0 | [60]:1.0 | [9]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 3, 18, 21, 53, 60,  9]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
[90mTop 20 Experts:[0m
[32mExpert 59: 7.400(4241)[0m | [32mExpert 10: 6.800(4082)[0m | [32mExpert 27: 6.600(4136)[0m | [32mExpert 19: 6.600(4109)[0m | 
[32mExpert  2: 6.000(4112)[0m | [32mExpert 13: 6.000(4091)[0m | [32mExpert 21: 6.000(4118)[0m | [32mExpert 62: 5.200(4253)[0m | 
[32mExpert 41: 4.800(4184)[0m | [32mExpert 51: 4.800(4217)[0m | [32mExpert 56: 4.800(4232)[0m | [32mExpert 26: 4.400(4133)[0m | 
[32mExpert 55: 4.400(4229)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | 
[32mExpert 61: 3.600(4250)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 30: 3.400(4148)[0m | [32mExpert 12: 3.200(4088)[0m | 
[32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 42: 2.400(4187)[0m | 
[32mExpert 44: 2.400(4193)[0m | [32mExpert 45: 2.400(4196)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | 
[32mExpert 49: 1.800(4208)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert  6: 1.600(4244)[0m | [32mExpert 16: 1.600(4100)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4220, 4238, 4079, 4187, 4193, 4196, 4235, 4142, 4208, 4190, 4244, 4100]
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 16, 29, 42, 43, 44, 45, 49, 52, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:6.0 | [29]:2.0 | [32]:7.0 | [39]:6.0 | [43]:7.0 | [6]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[16]:8.0 | [17]:2.0 | [27]:4.0 | [33]:10.0 | [50]:13.0 | [32]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[19]:6.0 | [21]:7.0 | [27]:8.0 | [55]:6.0 | [59]:10.0 | [45]:4.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E45 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[6]:8.0 | [21]:8.0 | [25]:3.0 | [33]:6.0 | [55]:4.0 | [60]:9.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[0]:4.0 | [23]:9.0 | [25]:8.0 | [43]:1.0 | [51]:4.0 | [58]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[11]:1.0 | [16]:11.0 | [28]:7.0 | [39]:2.0 | [56]:3.0 | [46]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[11, 16, 28, 39, 56, 46]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:11.0 | [27]:1.0 | [39]:3.0 | [51]:3.0 | [58]:5.0 | [35]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[12]:4.0 | [19]:1.0 | [23]:1.0 | [47]:1.0 | [50]:4.0 | [51]:6.0 | 
---------------------------------------
return EAMC[0]
 EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[6]:5.0 | [32]:4.0 | [33]:7.0 | [39]:1.0 | [61]:1.0 | [15]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[12]:7.0 | [14]:5.0 | [35]:9.0 | [42]:6.0 | [57]:10.0 | [20]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[14]:2.0 | [20]:2.0 | [29]:8.0 | [36]:6.0 | [37]:3.0 | [43]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[7]:2.0 | [19]:1.0 | [35]:5.0 | [48]:8.0 | [55]:1.0 | [53]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[6]:2.0 | [30]:2.0 | [44]:6.0 | [46]:5.0 | [49]:2.0 | [37]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[4]:9.0 | [9]:8.0 | [14]:3.0 | [29]:5.0 | [41]:9.0 | [30]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 4,  9, 14, 29, 41, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 10.400(2740)[0m | [32mExpert 53: 7.800(2767)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | 
[32mExpert 34: 7.200(2704)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert  1: 6.200(2623)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 4.800(2677)[0m | [32mExpert 17: 4.800(2647)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 35: 3.400(2707)[0m | [32mExpert 44: 3.200(2737)[0m | 
[32mExpert 24: 2.800(2671)[0m | [32mExpert 13: 2.600(2635)[0m | [32mExpert 31: 2.600(2695)[0m | [32mExpert 33: 2.600(2701)[0m | 
[32mExpert 62: 2.600(2797)[0m | [32mExpert 11: 2.600(2629)[0m | [32mExpert 28: 2.600(2683)[0m | [32mExpert 38: 2.600(2716)[0m | 
[32mExpert  9: 2.400(2809)[0m | [32mExpert 22: 2.400(2665)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 37: 2.000(2713)[0m | 
[32mExpert 63: 1.800(2800)[0m | [32mExpert  5: 1.800(2755)[0m | [32mExpert 51: 1.800(2761)[0m | [32mExpert 60: 1.800(2791)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2797, 2629, 2683, 2716, 2809, 2665, 2653, 2713, 2800, 2755, 2761, 2791]
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5,  9, 11, 19, 22, 28, 37, 38, 51, 60, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[10]:4.0 | [13]:1.0 | [35]:1.0 | [47]:9.0 | [49]:2.0 | [5]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[1]:6.0 | [9]:1.0 | [11]:10.0 | [22]:1.0 | [57]:1.0 | [26]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[9]:4.0 | [11]:2.0 | [26]:7.0 | [43]:1.0 | [51]:2.0 | [12]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E11 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[8]:4.0 | [16]:8.0 | [34]:2.0 | [35]:6.0 | [49]:7.0 | [56]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[2]:7.0 | [13]:2.0 | [41]:2.0 | [56]:1.0 | [58]:10.0 | [49]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[1]:2.0 | [16]:8.0 | [18]:3.0 | [22]:4.0 | [36]:1.0 | [26]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 1, 16, 18, 22, 36, 26]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 10.600(2990)[0m | [32mExpert 40: 9.000(2963)[0m | [32mExpert 16: 8.800(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert  0: 5.400(2858)[0m | [32mExpert 61: 5.000(3032)[0m | 
[32mExpert 15: 4.600(2879)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 29: 4.000(2924)[0m | [32mExpert 55: 4.000(3011)[0m | 
[32mExpert 25: 3.800(2912)[0m | [32mExpert 38: 3.600(2954)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 10: 2.600(2864)[0m | 
[32mExpert 52: 2.600(3002)[0m | [32mExpert  9: 2.400(3047)[0m | [32mExpert  8: 2.200(3044)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 37: 2.200(2951)[0m | [32mExpert 24: 2.000(2909)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert  1: 1.800(2861)[0m | 
[32mExpert 30: 1.800(2930)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 32: 1.600(2936)[0m | [32mExpert 34: 1.600(2942)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 3047, 3044, 2996, 2951, 2909, 3038, 2861, 2930, 2885, 2936, 2942]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  8,  9, 17, 24, 30, 32, 34, 37, 50, 52, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[36]:9.0 | [43]:4.0 | [45]:5.0 | [47]:2.0 | [58]:3.0 | [22]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[10]:4.0 | [19]:5.0 | [20]:6.0 | [38]:5.0 | [54]:3.0 | [51]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[5]:2.0 | [11]:4.0 | [32]:3.0 | [42]:1.0 | [44]:2.0 | [40]:11.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[7]:1.0 | [26]:6.0 | [28]:1.0 | [33]:5.0 | [63]:2.0 | [13]:4.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22

[1;36m== Layer 17 MLP ==
[0m
[12]:4.0 | [22]:4.0 | [44]:3.0 | [45]:8.0 | [48]:2.0 | [50]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[2]:7.0 | [5]:4.0 | [15]:1.0 | [16]:1.0 | [19]:3.0 | [42]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 2,  5, 15, 16, 19, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 59: 8.200(4241)[0m | [32mExpert 19: 7.400(4109)[0m | [32mExpert 27: 7.400(4136)[0m | [32mExpert 10: 6.800(4082)[0m | 
[32mExpert 21: 6.800(4118)[0m | [32mExpert  2: 6.000(4112)[0m | [32mExpert 13: 6.000(4091)[0m | [32mExpert 55: 5.200(4229)[0m | 
[32mExpert 62: 5.200(4253)[0m | [32mExpert 41: 4.800(4184)[0m | [32mExpert 51: 4.800(4217)[0m | [32mExpert 56: 4.800(4232)[0m | 
[32mExpert 26: 4.400(4133)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | 
[32mExpert 61: 3.600(4250)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 30: 3.400(4148)[0m | [32mExpert 12: 3.200(4088)[0m | 
[32mExpert 45: 3.200(4196)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | 
[32mExpert 42: 2.400(4187)[0m | [32mExpert 44: 2.400(4193)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | 
[32mExpert 49: 1.800(4208)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert  6: 1.600(4244)[0m | [32mExpert 16: 1.600(4100)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4196, 4220, 4238, 4079, 4187, 4193, 4235, 4142, 4208, 4190, 4244, 4100]
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 16, 29, 42, 43, 44, 45, 49, 52, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[15]:1.0 | [16]:2.0 | [27]:2.0 | [39]:7.0 | [49]:1.0 | [35]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[24]:1.0 | [41]:5.0 | [47]:1.0 | [56]:4.0 | [61]:5.0 | [62]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[10]:7.0 | [17]:2.0 | [26]:6.0 | [41]:7.0 | [45]:5.0 | [6]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E45 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:10.0 | [24]:7.0 | [30]:5.0 | [47]:3.0 | [53]:1.0 | [35]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[8]:2.0 | [11]:5.0 | [13]:6.0 | [52]:5.0 | [58]:7.0 | [3]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[0]:1.0 | [8]:4.0 | [54]:7.0 | [62]:6.0 | [63]:3.0 | [24]:6.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 0,  8, 54, 62, 63, 24]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[3]:1.0 | [24]:1.0 | [34]:2.0 | [47]:4.0 | [53]:2.0 | [13]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[18]:3.0 | [25]:5.0 | [37]:2.0 | [40]:2.0 | [55]:3.0 | [46]:2.0 | 
---------------------------------------
return EAMC[0]
results EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[5]:4.0 | [23]:3.0 | [27]:1.0 | [29]:3.0 | [52]:1.0 | [26]:11.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[16]:1.0 | [34]:2.0 | [47]:5.0 | [56]:2.0 | [57]:11.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[1]:1.0 | [11]:2.0 | [19]:1.0 | [30]:1.0 | [56]:3.0 | [9]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[5]:2.0 | [8]:1.0 | [26]:1.0 | [44]:4.0 | [57]:1.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[0]:3.0 | [10]:2.0 | [17]:5.0 | [31]:1.0 | [60]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[10]:4.0 | [34]:3.0 | [35]:6.0 | [43]:3.0 | [55]:3.0 | [61]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[10, 34, 35, 43, 55, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 10.400(2740)[0m | [32mExpert 53: 7.800(2767)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | 
[32mExpert 34: 7.200(2704)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert  1: 6.200(2623)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 5.600(2677)[0m | [32mExpert 17: 4.800(2647)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 35: 3.400(2707)[0m | [32mExpert 11: 3.400(2629)[0m | 
[32mExpert  9: 3.200(2809)[0m | [32mExpert 44: 3.200(2737)[0m | [32mExpert 24: 2.800(2671)[0m | [32mExpert 13: 2.600(2635)[0m | 
[32mExpert 31: 2.600(2695)[0m | [32mExpert 33: 2.600(2701)[0m | [32mExpert 62: 2.600(2797)[0m | [32mExpert 28: 2.600(2683)[0m | 
[32mExpert 38: 2.600(2716)[0m | [32mExpert 51: 2.600(2761)[0m | [32mExpert 22: 2.400(2665)[0m | [32mExpert 12: 2.200(2632)[0m | 
[32mExpert 19: 2.000(2653)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert  5: 1.800(2755)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2695, 2701, 2797, 2683, 2716, 2761, 2665, 2632, 2653, 2713, 2800, 2755]
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5, 12, 19, 22, 28, 31, 33, 37, 38, 51, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:2.0 | [4]:6.0 | [20]:2.0 | [51]:1.0 | [52]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[0]:3.0 | [8]:10.0 | [26]:4.0 | [34]:3.0 | [60]:1.0 | [36]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[2]:2.0 | [24]:4.0 | [32]:1.0 | [33]:4.0 | [53]:10.0 | [13]:4.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[6]:1.0 | [23]:1.0 | [37]:3.0 | [39]:3.0 | [50]:8.0 | [9]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[11]:2.0 | [20]:9.0 | [32]:1.0 | [41]:3.0 | [63]:5.0 | [53]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[43]:4.0 | [50]:3.0 | [51]:2.0 | [57]:2.0 | [58]:11.0 | [2]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[43, 50, 51, 57, 58,  2]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 10.600(2990)[0m | [32mExpert 40: 9.800(2963)[0m | [32mExpert 16: 8.800(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert  0: 5.400(2858)[0m | [32mExpert 61: 5.000(3032)[0m | 
[32mExpert 15: 4.600(2879)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 29: 4.000(2924)[0m | [32mExpert 55: 4.000(3011)[0m | 
[32mExpert 25: 3.800(2912)[0m | [32mExpert 38: 3.600(2954)[0m | [32mExpert 11: 3.400(2867)[0m | [32mExpert  6: 3.000(3026)[0m | 
[32mExpert 14: 3.000(2876)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 33: 3.000(2939)[0m | [32mExpert 10: 2.600(2864)[0m | 
[32mExpert 52: 2.600(3002)[0m | [32mExpert  9: 2.400(3047)[0m | [32mExpert 32: 2.400(2936)[0m | [32mExpert  8: 2.200(3044)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert  5: 2.000(2993)[0m | [32mExpert 24: 2.000(2909)[0m | 
[32mExpert 63: 2.000(3038)[0m | [32mExpert  1: 1.800(2861)[0m | [32mExpert 30: 1.800(2930)[0m | [32mExpert 17: 1.800(2885)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 3047, 2936, 3044, 2996, 2951, 2993, 2909, 3038, 2861, 2930, 2885]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  5,  8,  9, 17, 24, 30, 32, 37, 50, 52, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[20]:4.0 | [23]:13.0 | [37]:10.0 | [43]:5.0 | [56]:2.0 | [13]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[6]:1.0 | [40]:2.0 | [43]:7.0 | [54]:4.0 | [62]:1.0 | [51]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[5]:3.0 | [15]:6.0 | [31]:2.0 | [44]:3.0 | [52]:3.0 | [9]:4.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[15]:6.0 | [50]:2.0 | [60]:1.0 | [61]:4.0 | [63]:3.0 | [49]:2.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23

[1;36m== Layer 17 MLP ==
[0m
[1]:4.0 | [12]:5.0 | [18]:6.0 | [20]:5.0 | [25]:4.0 | [27]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[6]:1.0 | [17]:4.0 | [18]:10.0 | [21]:9.0 | [61]:6.0 | [56]:6.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 6, 17, 18, 21, 61, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 59: 8.200(4241)[0m | [32mExpert 10: 7.600(4082)[0m | [32mExpert 19: 7.400(4109)[0m | [32mExpert 27: 7.400(4136)[0m | 
[32mExpert 21: 6.800(4118)[0m | [32mExpert  2: 6.000(4112)[0m | [32mExpert 13: 6.000(4091)[0m | [32mExpert 41: 5.600(4184)[0m | 
[32mExpert 26: 5.200(4133)[0m | [32mExpert 55: 5.200(4229)[0m | [32mExpert 62: 5.200(4253)[0m | [32mExpert 51: 4.800(4217)[0m | 
[32mExpert 56: 4.800(4232)[0m | [32mExpert 17: 4.400(4103)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | 
[32mExpert 45: 4.000(4196)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 30: 3.400(4148)[0m | 
[32mExpert 12: 3.200(4088)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | 
[32mExpert  6: 2.400(4244)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 44: 2.400(4193)[0m | [32mExpert 57: 2.200(4235)[0m | 
[32mExpert 29: 2.000(4142)[0m | [32mExpert 49: 1.800(4208)[0m | [32mExpert 43: 1.800(4190)[0m | [32mExpert 16: 1.600(4100)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4220, 4238, 4079, 4244, 4187, 4193, 4235, 4142, 4208, 4190, 4100]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 12, 16, 29, 42, 43, 44, 49, 52, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:2.0 | [9]:2.0 | [14]:3.0 | [15]:2.0 | [43]:8.0 | [3]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[8]:1.0 | [32]:7.0 | [33]:11.0 | [56]:5.0 | [61]:6.0 | [40]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[5]:1.0 | [7]:1.0 | [40]:2.0 | [48]:2.0 | [62]:6.0 | [31]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[25]:4.0 | [27]:2.0 | [30]:6.0 | [33]:7.0 | [55]:5.0 | [46]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[11]:6.0 | [20]:2.0 | [21]:2.0 | [25]:9.0 | [37]:2.0 | [60]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:12.0 | [36]:2.0 | [38]:4.0 | [48]:1.0 | [58]:3.0 | [28]:8.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 36, 38, 48, 58, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[14]:2.0 | [16]:2.0 | [18]:4.0 | [37]:2.0 | [49]:2.0 | [41]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[12]:5.0 | [27]:1.0 | [28]:3.0 | [50]:5.0 | [51]:7.0 | [52]:3.0 | 
---------------------------------------
return EAMC[0]
= EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[20]:4.0 | [24]:5.0 | [25]:3.0 | [55]:3.0 | [62]:6.0 | [26]:12.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[16]:2.0 | [19]:2.0 | [24]:1.0 | [25]:2.0 | [51]:9.0 | [37]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[5]:8.0 | [9]:4.0 | [13]:2.0 | [45]:3.0 | [49]:3.0 | [46]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[35]:6.0 | [38]:3.0 | [59]:4.0 | [60]:11.0 | [63]:4.0 | [40]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[10]:3.0 | [15]:4.0 | [17]:6.0 | [31]:2.0 | [52]:3.0 | [25]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[6]:5.0 | [8]:2.0 | [34]:4.0 | [43]:4.0 | [55]:4.0 | [35]:7.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 6,  8, 34, 43, 55, 35]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 10.400(2740)[0m | [32mExpert 53: 8.600(2767)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | 
[32mExpert 34: 7.200(2704)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert  1: 6.200(2623)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 5.600(2677)[0m | [32mExpert 17: 4.800(2647)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 24: 3.600(2671)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 13: 3.400(2635)[0m | 
[32mExpert 33: 3.400(2701)[0m | [32mExpert 35: 3.400(2707)[0m | [32mExpert 11: 3.400(2629)[0m | [32mExpert  9: 3.200(2809)[0m | 
[32mExpert 44: 3.200(2737)[0m | [32mExpert 31: 2.600(2695)[0m | [32mExpert 62: 2.600(2797)[0m | [32mExpert 28: 2.600(2683)[0m | 
[32mExpert 38: 2.600(2716)[0m | [32mExpert 51: 2.600(2761)[0m | [32mExpert 22: 2.400(2665)[0m | [32mExpert 12: 2.200(2632)[0m | 
[32mExpert 19: 2.000(2653)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert  2: 1.800(2656)[0m | [32mExpert 63: 1.800(2800)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2737, 2695, 2797, 2683, 2716, 2761, 2665, 2632, 2653, 2713, 2656, 2800]
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2, 12, 19, 22, 28, 31, 37, 38, 44, 51, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:10.0 | [13]:2.0 | [16]:4.0 | [20]:3.0 | [28]:4.0 | [14]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[1]:7.0 | [8]:11.0 | [22]:2.0 | [26]:5.0 | [59]:1.0 | [38]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[9]:5.0 | [11]:3.0 | [33]:5.0 | [39]:2.0 | [53]:11.0 | [5]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 10 MLP ==
[0m
[9]:5.0 | [25]:8.0 | [32]:3.0 | [44]:15.0 | [45]:1.0 | [0]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[11]:3.0 | [16]:7.0 | [17]:4.0 | [57]:2.0 | [61]:2.0 | [3]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[1]:3.0 | [5]:1.0 | [8]:3.0 | [16]:9.0 | [56]:2.0 | [37]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 1,  5,  8, 16, 56, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 10.600(2990)[0m | [32mExpert 40: 9.800(2963)[0m | [32mExpert 16: 8.800(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert 15: 5.400(2879)[0m | [32mExpert  0: 5.400(2858)[0m | 
[32mExpert 61: 5.000(3032)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 29: 4.000(2924)[0m | [32mExpert 55: 4.000(3011)[0m | 
[32mExpert 25: 3.800(2912)[0m | [32mExpert 38: 3.600(2954)[0m | [32mExpert 11: 3.400(2867)[0m | [32mExpert 52: 3.400(3002)[0m | 
[32mExpert  9: 3.200(3047)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | [32mExpert 26: 3.000(2915)[0m | 
[32mExpert 33: 3.000(2939)[0m | [32mExpert  5: 2.800(2993)[0m | [32mExpert 10: 2.600(2864)[0m | [32mExpert 32: 2.400(2936)[0m | 
[32mExpert 44: 2.400(2975)[0m | [32mExpert  8: 2.200(3044)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 37: 2.200(2951)[0m | 
[32mExpert 24: 2.000(2909)[0m | [32mExpert 31: 2.000(2933)[0m | [32mExpert 63: 2.000(3038)[0m | [32mExpert  1: 1.800(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2993, 2864, 2936, 2975, 3044, 2996, 2951, 2909, 2933, 3038, 2861]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  5,  8, 10, 24, 31, 32, 33, 37, 44, 50, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[8]:1.0 | [10]:6.0 | [22]:5.0 | [31]:2.0 | [38]:3.0 | [43]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[4]:2.0 | [20]:7.0 | [38]:6.0 | [39]:2.0 | [47]:3.0 | [10]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[11]:5.0 | [12]:2.0 | [27]:1.0 | [31]:3.0 | [43]:1.0 | [37]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[7]:2.0 | [17]:5.0 | [26]:7.0 | [28]:2.0 | [38]:2.0 | [13]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[18]:7.0 | [22]:5.0 | [27]:3.0 | [48]:3.0 | [50]:4.0 | [58]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[2]:8.0 | [7]:4.0 | [19]:4.0 | [57]:3.0 | [61]:7.0 | [16]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 2,  7, 19, 57, 61, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4208
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1352,310000002b] (16MB) STATE(0) TENSOR[4207,4208,4206,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
[90mTop 20 Experts:[0m
[32mExpert 59: 8.200(4241)[0m | [32mExpert 10: 7.600(4082)[0m | [32mExpert 19: 7.400(4109)[0m | [32mExpert 27: 7.400(4136)[0m | 
[32mExpert 21: 6.800(4118)[0m | [32mExpert  2: 6.000(4112)[0m | [32mExpert 13: 6.000(4091)[0m | [32mExpert 62: 6.000(4253)[0m | 
[32mExpert 41: 5.600(4184)[0m | [32mExpert 26: 5.200(4133)[0m | [32mExpert 55: 5.200(4229)[0m | [32mExpert 51: 4.800(4217)[0m | 
[32mExpert 56: 4.800(4232)[0m | [32mExpert 17: 4.400(4103)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | 
[32mExpert 45: 4.000(4196)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 30: 3.400(4148)[0m | 
[32mExpert 12: 3.200(4088)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | 
[32mExpert  6: 2.400(4244)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 44: 2.400(4193)[0m | [32mExpert 48: 2.400(4205)[0m | 
[32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | [32mExpert 31: 1.800(4151)[0m | [32mExpert 49: 1.800(4208)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4220, 4238, 4079, 4244, 4187, 4193, 4205, 4235, 4142, 4151, 4208]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4208[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 12, 29, 31, 42, 44, 48, 49, 52, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[16]:3.0 | [28]:2.0 | [39]:8.0 | [53]:5.0 | [55]:3.0 | [56]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[11]:3.0 | [31]:1.0 | [44]:7.0 | [46]:1.0 | [53]:8.0 | [62]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[32]:1.0 | [34]:1.0 | [39]:2.0 | [46]:1.0 | [51]:6.0 | [7]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[8]:11.0 | [9]:4.0 | [10]:1.0 | [45]:2.0 | [48]:7.0 | [33]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[19]:2.0 | [21]:3.0 | [45]:5.0 | [60]:6.0 | [62]:2.0 | [26]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[0]:2.0 | [24]:7.0 | [45]:3.0 | [62]:7.0 | [63]:4.0 | [47]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 0, 24, 45, 62, 63, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[12]:10.0 | [21]:7.0 | [30]:1.0 | [46]:6.0 | [60]:1.0 | [34]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[17]:9.0 | [24]:1.0 | [38]:4.0 | [46]:3.0 | [56]:10.0 | [32]:4.0 | 
---------------------------------------
return EAMC[0]
[]
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:3.0 | [31]:8.0 | [35]:2.0 | [50]:11.0 | [57]:8.0 | [47]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[8]:4.0 | [32]:1.0 | [41]:1.0 | [56]:3.0 | [62]:9.0 | [48]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[21]:8.0 | [23]:1.0 | [24]:1.0 | [41]:1.0 | [60]:1.0 | [48]:9.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[3]:8.0 | [22]:7.0 | [39]:2.0 | [49]:2.0 | [60]:12.0 | [15]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[12]:5.0 | [17]:7.0 | [31]:3.0 | [43]:3.0 | [52]:4.0 | [21]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[16]:7.0 | [17]:2.0 | [27]:2.0 | [34]:5.0 | [54]:1.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[16, 17, 27, 34, 54, 49]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 10.400(2740)[0m | [32mExpert 53: 9.400(2767)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | 
[32mExpert 34: 7.200(2704)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert  1: 6.200(2623)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 5.600(2677)[0m | [32mExpert 17: 4.800(2647)[0m | [32mExpert 11: 4.200(2629)[0m | [32mExpert 33: 4.200(2701)[0m | 
[32mExpert  9: 4.000(2809)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | [32mExpert 56: 3.800(2776)[0m | 
[32mExpert 24: 3.600(2671)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 13: 3.400(2635)[0m | [32mExpert 35: 3.400(2707)[0m | 
[32mExpert 44: 3.200(2737)[0m | [32mExpert 31: 2.600(2695)[0m | [32mExpert 62: 2.600(2797)[0m | [32mExpert  5: 2.600(2755)[0m | 
[32mExpert 28: 2.600(2683)[0m | [32mExpert 38: 2.600(2716)[0m | [32mExpert 51: 2.600(2761)[0m | [32mExpert 22: 2.400(2665)[0m | 
[32mExpert 12: 2.200(2632)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 37: 2.000(2713)[0m | [32mExpert  2: 1.800(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2737, 2695, 2797, 2755, 2683, 2716, 2761, 2665, 2632, 2653, 2713, 2656]
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  5, 12, 19, 22, 28, 31, 37, 38, 44, 51, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[17]:7.0 | [19]:1.0 | [21]:2.0 | [38]:7.0 | [42]:7.0 | [18]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[3]:3.0 | [26]:6.0 | [47]:2.0 | [55]:4.0 | [59]:2.0 | [36]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[1]:7.0 | [22]:4.0 | [32]:2.0 | [44]:5.0 | [45]:13.0 | [58]:2.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E22 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[5]:3.0 | [7]:3.0 | [9]:6.0 | [18]:1.0 | [44]:16.0 | [42]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[1]:3.0 | [17]:5.0 | [25]:1.0 | [41]:4.0 | [53]:7.0 | [60]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[7]:7.0 | [14]:1.0 | [40]:1.0 | [48]:3.0 | [56]:3.0 | [13]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 7, 14, 40, 48, 56, 13]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 10.600(2990)[0m | [32mExpert 40: 9.800(2963)[0m | [32mExpert 16: 8.800(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert 15: 5.400(2879)[0m | [32mExpert  0: 5.400(2858)[0m | 
[32mExpert 61: 5.000(3032)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 29: 4.000(2924)[0m | 
[32mExpert 55: 4.000(3011)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 38: 3.600(2954)[0m | [32mExpert 52: 3.400(3002)[0m | 
[32mExpert  9: 3.200(3047)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | [32mExpert 26: 3.000(2915)[0m | 
[32mExpert 33: 3.000(2939)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert  5: 2.800(2993)[0m | [32mExpert 31: 2.800(2933)[0m | 
[32mExpert 10: 2.600(2864)[0m | [32mExpert 32: 2.400(2936)[0m | [32mExpert 44: 2.400(2975)[0m | [32mExpert  8: 2.200(3044)[0m | 
[32mExpert 12: 2.200(2870)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 24: 2.000(2909)[0m | [32mExpert 63: 2.000(3038)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2951, 2993, 2933, 2864, 2936, 2975, 3044, 2870, 2996, 2909, 3038]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 10, 12, 24, 31, 32, 33, 37, 44, 50, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[9]:2.0 | [18]:2.0 | [22]:6.0 | [44]:5.0 | [52]:4.0 | [49]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[9]:8.0 | [10]:6.0 | [28]:11.0 | [33]:9.0 | [41]:1.0 | [57]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[0]:6.0 | [16]:10.0 | [30]:3.0 | [50]:3.0 | [54]:2.0 | [33]:4.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[16]:8.0 | [27]:1.0 | [41]:9.0 | [42]:2.0 | [43]:5.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7

[1;36m== Layer 17 MLP ==
[0m
[26]:5.0 | [40]:10.0 | [41]:5.0 | [59]:1.0 | [62]:6.0 | [27]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[3]:4.0 | [17]:5.0 | [26]:2.0 | [51]:2.0 | [60]:2.0 | [50]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 3, 17, 26, 51, 60, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 59: 8.200(4241)[0m | [32mExpert 10: 7.600(4082)[0m | [32mExpert 19: 7.400(4109)[0m | [32mExpert 27: 7.400(4136)[0m | 
[32mExpert 21: 6.800(4118)[0m | [32mExpert  2: 6.000(4112)[0m | [32mExpert 13: 6.000(4091)[0m | [32mExpert 62: 6.000(4253)[0m | 
[32mExpert 41: 5.600(4184)[0m | [32mExpert 51: 5.600(4217)[0m | [32mExpert 26: 5.200(4133)[0m | [32mExpert 55: 5.200(4229)[0m | 
[32mExpert 56: 4.800(4232)[0m | [32mExpert 17: 4.400(4103)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 35: 4.000(4163)[0m | 
[32mExpert 45: 4.000(4196)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 30: 3.400(4148)[0m | 
[32mExpert 12: 3.200(4088)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | 
[32mExpert  6: 2.400(4244)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 44: 2.400(4193)[0m | [32mExpert 48: 2.400(4205)[0m | 
[32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | [32mExpert  7: 1.800(4259)[0m | [32mExpert 31: 1.800(4151)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4220, 4238, 4079, 4244, 4187, 4193, 4205, 4235, 4142, 4259, 4151]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6,  7, 12, 29, 31, 42, 44, 48, 52, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[0]:3.0 | [19]:7.0 | [41]:7.0 | [43]:9.0 | [56]:5.0 | [23]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[0]:1.0 | [22]:5.0 | [40]:7.0 | [50]:14.0 | [53]:9.0 | [52]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[14]:4.0 | [45]:6.0 | [53]:3.0 | [60]:1.0 | [62]:7.0 | [37]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[20]:4.0 | [24]:8.0 | [37]:2.0 | [52]:2.0 | [60]:10.0 | [45]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[6]:6.0 | [33]:3.0 | [40]:8.0 | [53]:3.0 | [62]:3.0 | [7]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[37]:9.0 | [38]:5.0 | [41]:4.0 | [50]:12.0 | [59]:2.0 | [31]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[37, 38, 41, 50, 59, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:8.0 | [8]:3.0 | [12]:11.0 | [40]:4.0 | [57]:5.0 | [34]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[18]:4.0 | [21]:2.0 | [30]:9.0 | [44]:2.0 | [55]:4.0 | [54]:5.0 | 
---------------------------------------
return EAMC[0]
   EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2713
[1m[33mEnqueueTask: [0m[32mTask: node: ID[560,2500000013] (16MB) STATE(0) TENSOR[2712,2713,2711,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:5.0 | [12]:2.0 | [13]:3.0 | [26]:13.0 | [41]:2.0 | [28]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[3]:4.0 | [9]:2.0 | [27]:4.0 | [38]:7.0 | [44]:2.0 | [53]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[0]:16.0 | [7]:5.0 | [46]:8.0 | [47]:2.0 | [51]:2.0 | [11]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[16]:3.0 | [25]:5.0 | [38]:4.0 | [41]:2.0 | [60]:13.0 | [23]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[21]:2.0 | [24]:2.0 | [38]:14.0 | [50]:8.0 | [52]:5.0 | [31]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[17]:3.0 | [34]:6.0 | [39]:4.0 | [49]:2.0 | [61]:3.0 | [22]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[17, 34, 39, 49, 61, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 11.200(2740)[0m | [32mExpert 53: 9.400(2767)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | 
[32mExpert 34: 7.200(2704)[0m | [32mExpert  1: 7.000(2623)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 5.600(2677)[0m | [32mExpert 17: 4.800(2647)[0m | [32mExpert 11: 4.200(2629)[0m | [32mExpert 33: 4.200(2701)[0m | 
[32mExpert  9: 4.000(2809)[0m | [32mExpert 44: 4.000(2737)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 24: 3.600(2671)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 13: 3.400(2635)[0m | 
[32mExpert 35: 3.400(2707)[0m | [32mExpert 22: 3.200(2665)[0m | [32mExpert 31: 2.600(2695)[0m | [32mExpert 62: 2.600(2797)[0m | 
[32mExpert  5: 2.600(2755)[0m | [32mExpert 28: 2.600(2683)[0m | [32mExpert 38: 2.600(2716)[0m | [32mExpert 51: 2.600(2761)[0m | 
[32mExpert 12: 2.200(2632)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 58: 2.000(2782)[0m | [32mExpert 37: 2.000(2713)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2665, 2695, 2797, 2755, 2683, 2716, 2761, 2632, 2653, 2782, 2713]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2713[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5, 12, 19, 22, 28, 31, 35, 37, 38, 51, 58, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:3.0 | [17]:8.0 | [18]:4.0 | [21]:3.0 | [43]:3.0 | [52]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[8]:12.0 | [12]:4.0 | [26]:7.0 | [42]:2.0 | [55]:5.0 | [54]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[2]:3.0 | [8]:2.0 | [17]:5.0 | [19]:3.0 | [33]:6.0 | [44]:6.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[2]:3.0 | [9]:7.0 | [30]:8.0 | [44]:17.0 | [50]:9.0 | [7]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[7]:2.0 | [28]:8.0 | [41]:5.0 | [53]:8.0 | [63]:6.0 | [17]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[9]:3.0 | [43]:5.0 | [49]:1.0 | [56]:4.0 | [58]:12.0 | [50]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 9, 43, 49, 56, 58, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 10.600(2990)[0m | [32mExpert 40: 9.800(2963)[0m | [32mExpert 16: 9.600(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert  0: 6.200(2858)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert 15: 5.400(2879)[0m | 
[32mExpert 61: 5.000(3032)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 29: 4.000(2924)[0m | 
[32mExpert 55: 4.000(3011)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 33: 3.800(2939)[0m | [32mExpert 38: 3.600(2954)[0m | 
[32mExpert 52: 3.400(3002)[0m | [32mExpert  9: 3.200(3047)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert  5: 2.800(2993)[0m | 
[32mExpert 31: 2.800(2933)[0m | [32mExpert 30: 2.600(2930)[0m | [32mExpert 10: 2.600(2864)[0m | [32mExpert 32: 2.400(2936)[0m | 
[32mExpert 44: 2.400(2975)[0m | [32mExpert  8: 2.200(3044)[0m | [32mExpert 12: 2.200(2870)[0m | [32mExpert 24: 2.000(2909)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2915, 2951, 2996, 2993, 2933, 2930, 2864, 2936, 2975, 3044, 2870, 2909]
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 10, 12, 24, 26, 30, 31, 32, 37, 44, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[17]:6.0 | [22]:7.0 | [23]:14.0 | [30]:7.0 | [37]:11.0 | [49]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[6]:2.0 | [24]:3.0 | [32]:5.0 | [33]:10.0 | [43]:8.0 | [28]:12.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[2]:2.0 | [9]:5.0 | [16]:11.0 | [29]:6.0 | [34]:3.0 | [61]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[41]:10.0 | [44]:5.0 | [48]:4.0 | [58]:2.0 | [59]:5.0 | [3]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[12]:6.0 | [16]:3.0 | [36]:3.0 | [37]:1.0 | [62]:7.0 | [27]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[9]:4.0 | [17]:6.0 | [21]:10.0 | [31]:2.0 | [60]:3.0 | [34]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 9, 17, 21, 31, 60, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 59: 8.200(4241)[0m | [32mExpert 10: 7.600(4082)[0m | [32mExpert 19: 7.400(4109)[0m | [32mExpert 27: 7.400(4136)[0m | 
[32mExpert 21: 6.800(4118)[0m | [32mExpert 62: 6.800(4253)[0m | EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
[32mExpert  2: 6.000(4112)[0m | [32mExpert 13: 6.000(4091)[0m | 
[32mExpert 41: 5.600(4184)[0m | [32mExpert 51: 5.600(4217)[0m | [32mExpert 26: 5.200(4133)[0m | [32mExpert 55: 5.200(4229)[0m | 
[32mExpert 14: 5.000(4094)[0m | [32mExpert 45: 4.800(4196)[0m | [32mExpert 56: 4.800(4232)[0m | [32mExpert 17: 4.400(4103)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 30: 3.400(4148)[0m | 
[32mExpert 12: 3.200(4088)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | [32mExpert  1: 2.800(4079)[0m | 
[32mExpert  6: 2.400(4244)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 44: 2.400(4193)[0m | [32mExpert 53: 2.400(4223)[0m | 
[32mExpert 48: 2.400(4205)[0m | [32mExpert 37: 2.200(4169)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4220, 4238, 4079, 4244, 4187, 4193, 4223, 4205, 4169, 4235, 4142]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 12, 29, 37, 42, 44, 48, 52, 53, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:7.0 | [23]:4.0 | [25]:1.0 | [32]:8.0 | [39]:9.0 | [0]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[16]:9.0 | [17]:3.0 | [27]:5.0 | [33]:12.0 | [50]:15.0 | [32]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[27]:9.0 | [44]:4.0 | [45]:7.0 | [55]:7.0 | [59]:11.0 | [13]:8.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:7.0 | [25]:5.0 | [37]:3.0 | [50]:6.0 | [55]:6.0 | [23]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[7]:9.0 | [23]:10.0 | [25]:10.0 | [31]:1.0 | [43]:2.0 | [56]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[16]:13.0 | [28]:9.0 | [38]:6.0 | [39]:3.0 | [56]:4.0 | [60]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[16, 28, 38, 39, 56, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:12.0 | [27]:2.0 | [39]:4.0 | [51]:4.0 | [58]:6.0 | [49]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[12]:6.0 | [19]:2.0 | [47]:2.0 | [50]:6.0 | [51]:8.0 | [23]:2.0 | 
---------------------------------------
return EAMC[0]
 EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[5]:5.0 | [10]:1.0 | [24]:6.0 | [47]:9.0 | [52]:2.0 | [21]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[14]:6.0 | [34]:3.0 | [42]:7.0 | [57]:12.0 | [61]:5.0 | [9]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[4]:6.0 | [44]:1.0 | [47]:3.0 | [56]:4.0 | [59]:1.0 | [58]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[9]:5.0 | [17]:2.0 | [23]:4.0 | [30]:3.0 | [41]:3.0 | [6]:8.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[0]:4.0 | [21]:3.0 | [36]:4.0 | [38]:15.0 | [58]:2.0 | [60]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[10]:5.0 | [19]:9.0 | [34]:7.0 | [36]:2.0 | [49]:3.0 | [22]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[10, 19, 34, 36, 49, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 11.200(2740)[0m | [32mExpert 53: 9.400(2767)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | 
[32mExpert 34: 7.200(2704)[0m | [32mExpert  1: 7.000(2623)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert  7: 5.600(2803)[0m | 
[32mExpert 26: 5.600(2677)[0m | [32mExpert 17: 5.600(2647)[0m | [32mExpert 33: 5.000(2701)[0m | [32mExpert 44: 4.800(2737)[0m | 
[32mExpert 11: 4.200(2629)[0m | [32mExpert  9: 4.000(2809)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 24: 3.600(2671)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert 13: 3.400(2635)[0m | 
[32mExpert 35: 3.400(2707)[0m | [32mExpert 22: 3.200(2665)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert  2: 2.600(2656)[0m | 
[32mExpert 31: 2.600(2695)[0m | [32mExpert 62: 2.600(2797)[0m | [32mExpert  5: 2.600(2755)[0m | [32mExpert 28: 2.600(2683)[0m | 
[32mExpert 38: 2.600(2716)[0m | [32mExpert 51: 2.600(2761)[0m | [32mExpert 12: 2.200(2632)[0m | [32mExpert 58: 2.000(2782)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2665, 2653, 2656, 2695, 2797, 2755, 2683, 2716, 2761, 2632, 2782]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  5, 12, 19, 22, 28, 31, 35, 38, 51, 58, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[4]:7.0 | [20]:4.0 | [25]:1.0 | [52]:3.0 | [54]:3.0 | [36]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[8]:13.0 | [22]:3.0 | [26]:8.0 | [34]:4.0 | [50]:1.0 | [31]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[17]:6.0 | [28]:2.0 | [47]:2.0 | [53]:12.0 | [61]:1.0 | [2]:4.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E2 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E28 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[4]:1.0 | [13]:4.0 | [26]:1.0 | [50]:10.0 | [63]:1.0 | [41]:12.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[25]:2.0 | [45]:8.0 | [46]:1.0 | [53]:9.0 | [63]:7.0 | [26]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[20]:2.0 | [45]:6.0 | [50]:5.0 | [56]:5.0 | [58]:13.0 | [59]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[20, 45, 50, 56, 58, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 10.600(2990)[0m | [32mExpert 16: 10.400(2882)[0m | [32mExpert 40: 9.800(2963)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert  0: 6.200(2858)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert 61: 5.800(3032)[0m | 
[32mExpert 15: 5.400(2879)[0m | [32mExpert 29: 4.800(2924)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | 
[32mExpert  9: 4.000(3047)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 33: 3.800(2939)[0m | 
[32mExpert 38: 3.600(2954)[0m | [32mExpert 52: 3.400(3002)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert  5: 2.800(2993)[0m | 
[32mExpert 31: 2.800(2933)[0m | [32mExpert 30: 2.600(2930)[0m | [32mExpert 10: 2.600(2864)[0m | [32mExpert 32: 2.400(2936)[0m | 
[32mExpert 34: 2.400(2942)[0m | [32mExpert 44: 2.400(2975)[0m | [32mExpert  8: 2.200(3044)[0m | [32mExpert 12: 2.200(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2915, 2951, 2996, 2993, 2933, 2930, 2864, 2936, 2942, 2975, 3044, 2870]
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 10, 12, 26, 30, 31, 32, 34, 37, 44, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[12]:1.0 | [13]:3.0 | [14]:1.0 | [17]:7.0 | [35]:2.0 | [16]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[0]:5.0 | [6]:3.0 | [27]:4.0 | [43]:9.0 | [60]:5.0 | [24]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[15]:7.0 | [40]:12.0 | [46]:2.0 | [52]:4.0 | [53]:1.0 | [9]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 16 MLP ==
[0m
[8]:1.0 | [32]:5.0 | [37]:4.0 | [48]:5.0 | [59]:6.0 | [3]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[35]:1.0 | [36]:4.0 | [37]:2.0 | [38]:4.0 | [54]:3.0 | [44]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[6]:2.0 | [28]:3.0 | [31]:3.0 | [32]:2.0 | [33]:2.0 | [1]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 6, 28, 31, 32, 33,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
[90mTop 20 Experts:[0m
[32mExpert 59: 9.000(4241)[0m | [32mExpert 27: 8.200(4136)[0m | [32mExpert 10: 7.600(4082)[0m | [32mExpert 19: 7.400(4109)[0m | 
[32mExpert 13: 6.800(4091)[0m | [32mExpert 21: 6.800(4118)[0m | [32mExpert 62: 6.800(4253)[0m | [32mExpert  2: 6.000(4112)[0m | 
[32mExpert 55: 6.000(4229)[0m | [32mExpert 41: 5.600(4184)[0m | [32mExpert 45: 5.600(4196)[0m | [32mExpert 51: 5.600(4217)[0m | 
[32mExpert 26: 5.200(4133)[0m | [32mExpert 14: 5.000(4094)[0m | [32mExpert 56: 4.800(4232)[0m | [32mExpert 17: 4.400(4103)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 30: 3.400(4148)[0m | 
[32mExpert 12: 3.200(4088)[0m | [32mExpert 44: 3.200(4193)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | 
[32mExpert  1: 2.800(4079)[0m | [32mExpert  6: 2.400(4244)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 53: 2.400(4223)[0m | 
[32mExpert 48: 2.400(4205)[0m | [32mExpert 37: 2.200(4169)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4193, 4220, 4238, 4079, 4244, 4187, 4223, 4205, 4169, 4235, 4142]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 12, 29, 37, 42, 44, 48, 52, 53, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[0]:5.0 | [7]:2.0 | [18]:6.0 | [32]:9.0 | [40]:3.0 | [58]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[1]:4.0 | [14]:1.0 | [17]:4.0 | [20]:3.0 | [28]:3.0 | [56]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[4]:2.0 | [5]:2.0 | [15]:2.0 | [46]:2.0 | [63]:1.0 | [47]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[4]:1.0 | [15]:1.0 | [18]:1.0 | [31]:1.0 | [32]:3.0 | [44]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[0]:5.0 | [2]:4.0 | [20]:3.0 | [25]:11.0 | [56]:3.0 | [47]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[0]:3.0 | [16]:14.0 | [19]:8.0 | [34]:6.0 | [38]:7.0 | [12]:3.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 0, 16, 19, 34, 38, 12]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[22]:3.0 | [34]:5.0 | [37]:3.0 | [62]:2.0 | [63]:6.0 | [15]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[6]:3.0 | [12]:7.0 | [35]:1.0 | [49]:3.0 | [50]:7.0 | [8]:2.0 | 
---------------------------------------
return EAMC[0]
for EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:6.0 | [20]:5.0 | [28]:2.0 | [33]:8.0 | [39]:2.0 | [26]:14.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[3]:5.0 | [30]:2.0 | [35]:10.0 | [37]:2.0 | [53]:5.0 | [60]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[3]:6.0 | [20]:3.0 | [29]:9.0 | [36]:7.0 | [37]:4.0 | [11]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[0]:1.0 | [7]:3.0 | [35]:7.0 | [48]:9.0 | [55]:2.0 | [28]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[13]:6.0 | [30]:3.0 | [34]:3.0 | [35]:6.0 | [46]:6.0 | [44]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[3]:3.0 | [4]:10.0 | [14]:4.0 | [29]:6.0 | [63]:2.0 | [41]:10.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[ 3,  4, 14, 29, 63, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 11.200(2740)[0m | [32mExpert 53: 10.200(2767)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | 
[32mExpert 34: 7.200(2704)[0m | [32mExpert  1: 7.000(2623)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert 17: 6.400(2647)[0m | 
[32mExpert  7: 5.600(2803)[0m | [32mExpert 26: 5.600(2677)[0m | [32mExpert 33: 5.000(2701)[0m | [32mExpert 44: 4.800(2737)[0m | 
[32mExpert 11: 4.200(2629)[0m | [32mExpert  9: 4.000(2809)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 24: 3.600(2671)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert  2: 3.400(2656)[0m | 
[32mExpert 13: 3.400(2635)[0m | [32mExpert 35: 3.400(2707)[0m | [32mExpert 28: 3.400(2683)[0m | [32mExpert 22: 3.200(2665)[0m | 
[32mExpert 19: 2.800(2653)[0m | [32mExpert 31: 2.600(2695)[0m | [32mExpert 62: 2.600(2797)[0m | [32mExpert  5: 2.600(2755)[0m | 
[32mExpert 38: 2.600(2716)[0m | [32mExpert 51: 2.600(2761)[0m | [32mExpert 12: 2.200(2632)[0m | [32mExpert 58: 2.000(2782)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2635, 2707, 2683, 2665, 2653, 2695, 2797, 2755, 2716, 2761, 2632, 2782]
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5, 12, 13, 19, 22, 28, 31, 35, 38, 51, 58, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[7]:1.0 | [13]:3.0 | [47]:10.0 | [49]:3.0 | [63]:1.0 | [39]:10.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[1]:8.0 | [2]:3.0 | [4]:3.0 | [11]:11.0 | [22]:4.0 | [13]:9.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[11]:4.0 | [23]:3.0 | [26]:8.0 | [51]:3.0 | [60]:2.0 | [32]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:8.0 | [18]:2.0 | [27]:4.0 | [34]:3.0 | [49]:8.0 | [58]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[3]:2.0 | [13]:3.0 | [33]:2.0 | [58]:11.0 | [62]:1.0 | [32]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[18]:4.0 | [21]:1.0 | [23]:6.0 | [40]:2.0 | [52]:2.0 | [11]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[18, 21, 23, 40, 52, 11]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 40: 10.600(2963)[0m | [32mExpert 49: 10.600(2990)[0m | [32mExpert 16: 10.400(2882)[0m | [32mExpert 48: 6.800(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert  0: 6.200(2858)[0m | [32mExpert 15: 6.200(2879)[0m | [32mExpert 36: 6.200(2948)[0m | 
[32mExpert 61: 5.800(3032)[0m | [32mExpert  9: 4.800(3047)[0m | [32mExpert 29: 4.800(2924)[0m | [32mExpert  4: 4.400(2960)[0m | 
[32mExpert 11: 4.200(2867)[0m | [32mExpert 52: 4.200(3002)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 25: 3.800(2912)[0m | 
[32mExpert 33: 3.800(2939)[0m | [32mExpert 38: 3.600(2954)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 14: 3.000(2876)[0m | 
[32mExpert 26: 3.000(2915)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert  5: 2.800(2993)[0m | 
[32mExpert 31: 2.800(2933)[0m | [32mExpert 30: 2.600(2930)[0m | [32mExpert 10: 2.600(2864)[0m | [32mExpert 32: 2.400(2936)[0m | 
[32mExpert 34: 2.400(2942)[0m | [32mExpert 44: 2.400(2975)[0m | [32mExpert  8: 2.200(3044)[0m | [32mExpert 12: 2.200(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2915, 2951, 2996, 2993, 2933, 2930, 2864, 2936, 2942, 2975, 3044, 2870]
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  8, 10, 12, 26, 30, 31, 32, 34, 37, 44, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[15]:3.0 | [45]:6.0 | [47]:3.0 | [52]:5.0 | [55]:2.0 | [53]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[5]:3.0 | [11]:2.0 | [42]:1.0 | [44]:3.0 | [55]:7.0 | [37]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[14]:4.0 | [24]:3.0 | [32]:4.0 | [48]:9.0 | [53]:2.0 | [52]:5.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:7.0 | [19]:1.0 | [25]:2.0 | [37]:5.0 | [60]:2.0 | [28]:3.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[9]:2.0 | [10]:6.0 | [27]:6.0 | [46]:1.0 | [58]:3.0 | [45]:9.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[2]:9.0 | [10]:1.0 | [14]:10.0 | [35]:7.0 | [49]:7.0 | [44]:1.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 2, 10, 14, 35, 49, 44]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0mEnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18

[90mTop 20 Experts:[0m
[32mExpert 59: 9.000(4241)[0m | [32mExpert 27: 8.200(4136)[0m | [32mExpert 10: 7.600(4082)[0m | [32mExpert 19: 7.400(4109)[0m | 
[32mExpert 13: 6.800(4091)[0m | [32mExpert 21: 6.800(4118)[0m | [32mExpert 62: 6.800(4253)[0m | [32mExpert  2: 6.000(4112)[0m | 
[32mExpert 55: 6.000(4229)[0m | [32mExpert 41: 5.600(4184)[0m | [32mExpert 45: 5.600(4196)[0m | [32mExpert 51: 5.600(4217)[0m | 
[32mExpert 26: 5.200(4133)[0m | [32mExpert 14: 5.000(4094)[0m | [32mExpert 56: 4.800(4232)[0m | [32mExpert 17: 4.400(4103)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 30: 3.400(4148)[0m | 
[32mExpert 12: 3.200(4088)[0m | [32mExpert 44: 3.200(4193)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | 
[32mExpert  1: 2.800(4079)[0m | [32mExpert  6: 2.400(4244)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 53: 2.400(4223)[0m | 
[32mExpert 48: 2.400(4205)[0m | [32mExpert 37: 2.200(4169)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4193, 4220, 4238, 4079, 4244, 4187, 4223, 4205, 4169, 4235, 4142]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 12, 29, 37, 42, 44, 48, 52, 53, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:8.0 | [42]:5.0 | [44]:3.0 | [58]:5.0 | [63]:1.0 | [39]:10.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[1]:5.0 | [23]:1.0 | [36]:5.0 | [41]:6.0 | [47]:2.0 | [57]:6.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[10]:8.0 | [26]:7.0 | [38]:1.0 | [56]:5.0 | [60]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 22 MLP ==
[0m
[3]:6.0 | [5]:2.0 | [14]:2.0 | [20]:5.0 | [47]:4.0 | [46]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[0]:6.0 | [8]:3.0 | [11]:7.0 | [32]:4.0 | [52]:6.0 | [13]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[15]:3.0 | [29]:3.0 | [38]:8.0 | [49]:1.0 | [54]:8.0 | [62]:8.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[15, 29, 38, 49, 54, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[3]:2.0 | [33]:2.0 | [47]:5.0 | [55]:5.0 | [61]:1.0 | [0]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[17]:10.0 | [25]:6.0 | [35]:2.0 | [38]:5.0 | [40]:3.0 | [46]:4.0 | 
---------------------------------------
return EAMC[0]
url EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2683
[1m[33mEnqueueTask: [0m[32mTask: node: ID[551,1c00000013] (16MB) STATE(0) TENSOR[2682,2683,2681,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2716
[1m[33mEnqueueTask: [0m[32mTask: node: ID[561,2600000013] (16MB) STATE(0) TENSOR[2715,2716,2714,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:7.0 | [24]:7.0 | [35]:3.0 | [53]:1.0 | [56]:12.0 | [38]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 2 MLP ==
[0m
[9]:4.0 | [22]:2.0 | [34]:4.0 | [47]:6.0 | [55]:3.0 | [48]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 3 MLP ==
[0m
[1]:2.0 | [28]:1.0 | [36]:8.0 | [56]:5.0 | [59]:2.0 | [31]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 4 MLP ==
[0m
[5]:3.0 | [17]:3.0 | [20]:1.0 | [57]:2.0 | [58]:2.0 | [44]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 5 MLP ==
[0m
[10]:4.0 | [36]:5.0 | [54]:5.0 | [58]:3.0 | [60]:4.0 | [23]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 6 MLP ==
[0m
[10]:6.0 | [34]:8.0 | [40]:1.0 | [49]:4.0 | [61]:4.0 | [22]:4.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch6 topk= tensor([[10, 34, 40, 49, 61, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 11.200(2740)[0m | [32mExpert 53: 10.200(2767)[0m | [32mExpert 41: 7.400(2728)[0m | [32mExpert 46: 7.400(2743)[0m | 
[32mExpert 34: 7.200(2704)[0m | [32mExpert  1: 7.000(2623)[0m | [32mExpert 16: 6.600(2644)[0m | [32mExpert 17: 6.400(2647)[0m | 
[32mExpert 26: 6.400(2677)[0m | [32mExpert  7: 5.600(2803)[0m | [32mExpert 33: 5.000(2701)[0m | [32mExpert 11: 5.000(2629)[0m | 
[32mExpert 44: 4.800(2737)[0m | [32mExpert  9: 4.000(2809)[0m | [32mExpert 50: 4.000(2758)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 56: 3.800(2776)[0m | [32mExpert 24: 3.600(2671)[0m | [32mExpert 48: 3.600(2749)[0m | [32mExpert  2: 3.400(2656)[0m | 
[32mExpert 13: 3.400(2635)[0m | [32mExpert 35: 3.400(2707)[0m | [32mExpert 51: 3.400(2761)[0m | [32mExpert 28: 3.400(2683)[0m | 
[32mExpert 22: 3.200(2665)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert 31: 2.600(2695)[0m | [32mExpert 62: 2.600(2797)[0m | 
[32mExpert  5: 2.600(2755)[0m | [32mExpert 38: 2.600(2716)[0m | [32mExpert 60: 2.600(2791)[0m | [32mExpert 23: 2.400(2668)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2635, 2707, 2761, 2683, 2665, 2653, 2695, 2797, 2755, 2716, 2791, 2668]
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2683[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2716[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5, 13, 19, 22, 23, 28, 31, 35, 38, 51, 60, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[2]:1.0 | [4]:8.0 | [20]:5.0 | [52]:4.0 | [54]:4.0 | [43]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 8 MLP ==
[0m
[22]:5.0 | [24]:3.0 | [34]:5.0 | [41]:2.0 | [50]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 9 MLP ==
[0m
[3]:2.0 | [13]:5.0 | [32]:4.0 | [47]:3.0 | [61]:2.0 | [33]:7.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[2]:4.0 | [26]:2.0 | [39]:4.0 | [43]:1.0 | [47]:5.0 | [24]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 11 MLP ==
[0m
[20]:10.0 | [26]:2.0 | [32]:3.0 | [37]:1.0 | [63]:8.0 | [24]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 12 MLP ==
[0m
[2]:2.0 | [20]:3.0 | [50]:6.0 | [57]:3.0 | [59]:4.0 | [43]:6.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch12 topk= tensor([[ 2, 20, 50, 57, 59, 43]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 40: 10.600(2963)[0m | [32mExpert 49: 10.600(2990)[0m | [32mExpert 16: 10.400(2882)[0m | [32mExpert 48: 7.600(2987)[0m | 
[32mExpert 18: 6.400(2888)[0m | [32mExpert  0: 6.200(2858)[0m | [32mExpert 15: 6.200(2879)[0m | [32mExpert 36: 6.200(2948)[0m | 
[32mExpert 61: 5.800(3032)[0m | [32mExpert 52: 5.000(3002)[0m | [32mExpert  9: 4.800(3047)[0m | [32mExpert 29: 4.800(2924)[0m | 
[32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 55: 4.000(3011)[0m | [32mExpert 14: 3.800(2876)[0m | 
[32mExpert 25: 3.800(2912)[0m | [32mExpert 33: 3.800(2939)[0m | [32mExpert 38: 3.600(2954)[0m | [32mExpert 32: 3.200(2936)[0m | 
[32mExpert  6: 3.000(3026)[0m | [32mExpert 26: 3.000(2915)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 50: 3.000(2996)[0m | 
[32mExpert 53: 3.000(3005)[0m | [32mExpert  5: 2.800(2993)[0m | [32mExpert 24: 2.800(2909)[0m | [32mExpert 31: 2.800(2933)[0m | 
[32mExpert 30: 2.600(2930)[0m | [32mExpert 10: 2.600(2864)[0m | [32mExpert 34: 2.400(2942)[0m | [32mExpert 44: 2.400(2975)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3026, 2915, 2951, 2996, 3005, 2993, 2909, 2933, 2930, 2864, 2942, 2975]
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  5,  6, 10, 24, 26, 30, 31, 34, 37, 44, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[7]:1.0 | [13]:4.0 | [17]:8.0 | [32]:1.0 | [56]:3.0 | [11]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 14 MLP ==
[0m
[6]:4.0 | [13]:1.0 | [40]:3.0 | [43]:10.0 | [60]:6.0 | [61]:1.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 15 MLP ==
[0m
[2]:3.0 | [15]:8.0 | [20]:2.0 | [23]:2.0 | [57]:3.0 | [31]:4.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[0]:1.0 | [11]:3.0 | [35]:2.0 | [46]:2.0 | [49]:3.0 | [59]:7.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 17 MLP ==
[0m
[20]:6.0 | [29]:3.0 | [37]:3.0 | [41]:6.0 | [54]:4.0 | [43]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 18 MLP ==
[0m
[6]:3.0 | [31]:4.0 | [33]:3.0 | [34]:5.0 | [37]:7.0 | [15]:2.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch18 topk= tensor([[ 6, 31, 33, 34, 37, 15]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4205
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1351,300000002b] (16MB) STATE(0) TENSOR[4204,4205,4203,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4142
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1332,1d0000002b] (16MB) STATE(0) TENSOR[4141,4142,4140,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
[90mTop 20 Experts:[0m
[32mExpert 59: 9.000(4241)[0m | [32mExpert 10: 8.400(4082)[0m | [32mExpert 27: 8.200(4136)[0m | [32mExpert 19: 7.400(4109)[0m | 
[32mExpert 13: 6.800(4091)[0m | [32mExpert 21: 6.800(4118)[0m | [32mExpert 62: 6.800(4253)[0m | [32mExpert  2: 6.000(4112)[0m | 
[32mExpert 26: 6.000(4133)[0m | [32mExpert 55: 6.000(4229)[0m | [32mExpert 41: 5.600(4184)[0m | [32mExpert 45: 5.600(4196)[0m | 
[32mExpert 51: 5.600(4217)[0m | [32mExpert 56: 5.600(4232)[0m | [32mExpert 14: 5.000(4094)[0m | [32mExpert 17: 4.400(4103)[0m | 
[32mExpert 35: 4.000(4163)[0m | [32mExpert 54: 4.000(4226)[0m | [32mExpert 61: 3.600(4250)[0m | [32mExpert 30: 3.400(4148)[0m | 
[32mExpert 12: 3.200(4088)[0m | [32mExpert 44: 3.200(4193)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert 58: 3.000(4238)[0m | 
[32mExpert  1: 2.800(4079)[0m | [32mExpert  6: 2.400(4244)[0m | [32mExpert 42: 2.400(4187)[0m | [32mExpert 53: 2.400(4223)[0m | 
[32mExpert 48: 2.400(4205)[0m | [32mExpert 37: 2.200(4169)[0m | [32mExpert 57: 2.200(4235)[0m | [32mExpert 29: 2.000(4142)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4193, 4220, 4238, 4079, 4244, 4187, 4223, 4205, 4169, 4235, 4142]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4205[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4142[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  6, 12, 29, 37, 42, 44, 48, 52, 53, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[0]:6.0 | [18]:7.0 | [43]:10.0 | [46]:2.0 | [59]:1.0 | [45]:2.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 20 MLP ==
[0m
[8]:2.0 | [11]:4.0 | [28]:4.0 | [32]:9.0 | [46]:2.0 | [38]:5.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 21 MLP ==
[0m
[31]:3.0 | [45]:8.0 | [57]:2.0 | [60]:3.0 | [63]:2.0 | [47]:3.0 | 
---------------------------------------
return EAMC[0]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E57 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[25]:6.0 | [31]:2.0 | [33]:9.0 | [41]:1.0 | [44]:7.0 | [6]:9.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 23 MLP ==
[0m
[2]:5.0 | [25]:12.0 | [31]:2.0 | [34]:1.0 | [39]:2.0 | [56]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 24 MLP ==
[0m
[2]:2.0 | [38]:9.0 | [41]:5.0 | [42]:3.0 | [48]:2.0 | [16]:15.0 | 
---------------------------------------
return EAMC[0]
Begin prefetch24 topk= tensor([[ 2, 38, 41, 42, 48, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[14]:3.0 | [22]:4.0 | [37]:4.0 | [51]:5.0 | [56]:1.0 | [49]:4.0 | 
---------------------------------------
return EAMC[0]

[1;36m== Layer 26 MLP ==
[0m
[12]:8.0 | [13]:1.0 | [47]:3.0 | [50]:8.0 | [51]:9.0 | [41]:2.0 | 
---------------------------------------
return EAMC[1]
in urls
Prefilling time: 2.133234977722168 seconds
Decoding time: 11.566356658935547 seconds
Decoding iterations: 32
Decoding time per iteration: 0.36144864559173584 seconds
Input tokens: 178
input:  è¯·å®Œæˆä»¥ä¸‹è·¨è¯­è¨€ä»»åŠ¡ï¼š
1. å°†ä¸­æ–‡è°šè¯­'å¡ç¿å¤±é©¬ï¼Œç„‰çŸ¥éç¦'ç¿»è¯‘æˆè‹±æ–‡ã€æ³•æ–‡ã€æ—¥æ–‡ï¼Œå¹¶åˆ†åˆ«ç»™å‡ºæ–‡åŒ–èƒŒæ™¯è§£é‡Š
2. æŠŠè¥¿ç­ç‰™è¯­æ­Œè¯'Despacito'ï¼ˆåŸæ„ï¼šæ…¢æ…¢æ¥ï¼‰æœ¬åœ°åŒ–ä¸ºä¸­æ–‡å››å­—æˆè¯­é£æ ¼
3. åˆ†æå¾·è¯­å¤åˆè¯'Schadenfreude'ï¼ˆå¹¸ç¾ä¹ç¥¸ï¼‰åœ¨ä¸­æ–‡/é˜¿æ‹‰ä¼¯è¯­ä¸­çš„ç­‰æ•ˆè¡¨è¾¾
4. ä¸ºæ—¥æœ¬å®¢æˆ·æ’°å†™å•†åŠ¡é‚®ä»¶ï¼ˆæ—¥æ–‡ï¼‰ï¼Œä¸»é¢˜ï¼šAIåˆä½œé¡¹ç›®å»¶æœŸè¯·æ±‚ï¼ˆéœ€ç¬¦åˆæ•¬è¯­è§„èŒƒï¼‰
è¦æ±‚ï¼šè¯‘æ–‡éœ€ç¬¦åˆç›®æ ‡è¯­è¨€æ–‡åŒ–ä¹ æƒ¯ï¼Œé‡è¦æ¦‚å¿µé™„åŠ è¯´æ˜ã€‚
inputs ...
torch.Size([1, 148])
outputs_text ...

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:1.0 | [26]:1.0 | [56]:1.0 | [57]:1.0 | [60]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[3]:1.0 | [35]:1.0 | [38]:1.0 | [62]:1.0 | [63]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[4]:1.0 | [9]:1.0 | [11]:1.0 | [25]:1.0 | [54]:1.0 | [12]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[11]:1.0 | [21]:1.0 | [31]:1.0 | [33]:1.0 | [49]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[19]:1.0 | [20]:1.0 | [47]:1.0 | [49]:1.0 | [52]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[13]:1.0 | [21]:1.0 | [22]:1.0 | [42]:1.0 | [47]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[13, 21, 22, 42, 47, 32],
        [19, 37, 39, 46, 56, 26],
        [ 0,  4,  7, 14, 44, 19],
        [19, 24, 36, 40, 46,  8],
        [14, 25, 26, 44, 61, 57],
        [ 3, 29, 57, 60, 63, 28],
        [ 2, 14, 29, 44, 53, 33],
        [12, 16, 35, 46, 56, 18],
        [ 1, 23, 39, 42, 45, 32],
        [16, 19, 37, 46, 56, 50],
        [12, 19, 35, 46, 56, 28],
        [19, 37, 46, 50, 56,  6],
        [ 4,  7, 19, 44, 52, 14],
        [ 3, 29, 41, 57, 63,  4],
        [ 6, 26, 29, 41, 60, 14],
        [ 3, 26, 29, 33, 53,  2],
        [ 2,  3, 29, 33, 53, 63],
        [ 6, 23, 33, 35, 55, 46],
        [ 6, 26, 41, 60, 62, 49],
        [13, 17, 22, 27, 45, 15],
        [22, 45, 47, 60, 62, 42],
        [22, 27, 45, 60, 62, 13],
        [ 6, 16, 18, 22, 55, 12],
        [ 8, 22, 34, 40, 45, 52],
        [ 5, 10, 22, 45, 60,  0],
        [ 5,  8, 43, 45, 52, 59],
        [15, 45, 53, 60, 62, 31],
        [ 6, 11, 12, 16, 33, 18],
        [ 2,  4, 14, 29, 44,  7],
        [ 7, 34, 44, 49, 58,  4],
        [ 4, 29, 41, 59, 63, 57],
        [12, 18, 34, 35, 55, 56],
        [27, 29, 41, 59, 63, 57],
        [27, 29, 41, 59, 63, 57],
        [23, 28, 34, 35, 55, 39],
        [23, 27, 41, 59, 63, 29],
        [27, 29, 41, 59, 63, 57],
        [11, 12, 16, 18, 56, 35],
        [18, 24, 34, 54, 55, 61],
        [ 8,  9, 28, 44, 61, 34],
        [ 0,  7, 14, 28, 44,  4],
        [ 2,  3, 29, 53, 57, 63],
        [ 2,  5, 15, 53, 63, 43],
        [ 2,  5, 43, 44, 53, 24],
        [11, 12, 16, 46, 56, 50],
        [19, 37, 39, 46, 56,  1],
        [11, 34, 46, 50, 56, 16],
        [19, 34, 46, 50, 56, 16],
        [ 0,  7, 19, 24, 44,  4],
        [27, 41, 57, 59, 63, 13],
        [27, 29, 41, 57, 63,  4],
        [ 2,  3, 29, 33, 38, 14],
        [ 5,  6, 23, 33, 35, 36],
        [ 6, 19, 23, 41, 48, 55],
        [13, 30, 32, 48, 60, 38],
        [13, 27, 32, 47, 48, 33],
        [ 6, 12, 33, 35, 47, 16],
        [ 6, 12, 23, 33, 35, 34],
        [26, 36, 43, 57, 58, 33],
        [ 2,  5,  9, 33, 43, 35],
        [ 6, 12, 23, 35, 43, 33],
        [ 6,  8,  9, 25, 60, 31],
        [ 9, 31, 45, 53, 60, 62],
        [ 6, 11, 12, 16, 33, 18],
        [15, 26, 36, 57, 63,  3],
        [ 2,  7, 44, 49, 53, 29],
        [29, 41, 57, 59, 63, 21],
        [ 8, 26, 28, 36, 51, 32],
        [28, 32, 33, 51, 57, 38],
        [26, 28, 44, 45, 58, 49],
        [ 3, 29, 33, 47, 63,  2],
        [ 2, 25, 29, 47, 57, 48],
        [11, 12, 16, 18, 56, 46],
        [ 1, 19, 37, 42, 51, 39],
        [11, 16, 34, 50, 56,  1],
        [11, 19, 46, 50, 56, 16],
        [ 2,  7, 24, 44, 53,  4],
        [26, 27, 41, 59, 63, 13],
        [22, 27, 29, 41, 63, 32],
        [ 2, 25, 26, 47, 57, 53],
        [ 2,  3, 29, 33, 38, 57],
        [ 6, 23, 33, 35, 36, 43],
        [ 6, 13, 23, 41, 48, 42],
        [ 1, 30, 53, 60, 62, 48],
        [15, 30, 47, 53, 62, 60],
        [ 5, 15, 53, 60, 62, 31],
        [ 6, 12, 23, 33, 35, 47],
        [ 6, 12, 23, 33, 35, 47],
        [ 5,  6, 15, 26, 60, 41],
        [15, 45, 53, 60, 62, 20],
        [ 1,  9, 45, 47, 48, 13],
        [45, 53, 59, 60, 62, 15],
        [11, 12, 16, 33, 47,  6],
        [33, 43, 49, 58, 61,  7],
        [27, 29, 41, 57, 63, 20],
        [ 6, 23, 34, 39, 55, 33],
        [ 3, 27, 41, 59, 63, 57],
        [ 3, 27, 41, 47, 63, 57],
        [27, 36, 43, 47, 63, 49],
        [25, 26, 33, 34, 36, 55],
        [ 2, 25, 36, 53, 58, 60],
        [ 2, 14, 29, 33, 53, 43],
        [11, 16, 46, 50, 56, 37],
        [19, 28, 39, 42, 51, 37],
        [11, 16, 34, 50, 56, 46],
        [11, 19, 46, 50, 56, 16],
        [ 7, 10, 19, 44, 49, 24],
        [23, 27, 41, 59, 63, 21],
        [ 3, 14, 15, 21, 29, 53],
        [ 4,  7, 14, 29, 44, 53],
        [ 3, 14, 29, 53, 57, 15],
        [ 3,  4, 14, 24, 53, 29],
        [12, 16, 18, 23, 33, 56],
        [20, 27, 41, 57, 63, 59],
        [23, 27, 41, 57, 63, 29],
        [11, 12, 18, 33, 35, 16],
        [12, 16, 18, 54, 56, 50],
        [ 2,  4, 14, 40, 53, 29],
        [ 6, 12, 24, 35, 43,  5],
        [ 3, 27, 29, 41, 53,  6],
        [ 2, 14, 44, 53, 61, 15],
        [ 2,  3, 14, 47, 53, 33],
        [14, 24, 25, 31, 53, 60],
        [14, 24, 33, 53, 62, 61],
        [ 6, 12, 16, 23, 33, 56],
        [ 0, 26, 43, 52, 58, 19],
        [ 0,  7, 25, 49, 58, 43],
        [ 6, 15, 26, 53, 60, 14],
        [ 2, 22, 53, 57, 60, 30],
        [ 2, 25, 31, 53, 60, 14],
        [11, 12, 16, 18, 50, 46],
        [11, 16, 46, 50, 56, 37],
        [ 0,  2,  7, 14, 19, 53],
        [12, 19, 35, 50, 56, 16],
        [ 2,  4, 26, 29, 44, 19],
        [ 2,  4, 14, 19, 29, 53],
        [ 0,  8, 26, 43, 52,  9],
        [ 7, 25, 43, 49, 58,  0],
        [ 2, 14, 36, 53, 57, 58],
        [ 2,  3, 29, 57, 63,  4],
        [ 2,  3, 53, 57, 63, 59],
        [ 2, 31, 53, 57, 60, 22],
        [ 1, 12, 16, 18, 50, 22],
        [ 2,  8, 36, 43, 53, 25],
        [ 2,  5, 29, 43, 53, 60],
        [ 0,  7,  8, 14, 44, 34],
        [ 2,  5, 14, 44, 53,  7],
        [11, 12, 16, 18, 50, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 2.600(2740)[0m | [32mExpert 53: 2.400(2767)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert  1: 1.400(2623)[0m | 
[32mExpert  7: 1.400(2803)[0m | [32mExpert 33: 1.400(2701)[0m | [32mExpert 41: 1.400(2728)[0m | [32mExpert 46: 1.400(2743)[0m | 
[32mExpert 16: 1.200(2644)[0m | [32mExpert 17: 1.200(2647)[0m | [32mExpert 34: 1.200(2704)[0m | [32mExpert 44: 1.200(2737)[0m | 
[32mExpert  9: 1.000(2809)[0m | [32mExpert 13: 1.000(2635)[0m | [32mExpert 50: 1.000(2758)[0m | [32mExpert 55: 1.000(2773)[0m | 
[32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 22: 0.800(2665)[0m | [32mExpert 24: 0.800(2671)[0m | 
[32mExpert 32: 0.800(2698)[0m | [32mExpert 19: 0.600(2653)[0m | [32mExpert 23: 0.600(2668)[0m | [32mExpert 31: 0.600(2695)[0m | 
[32mExpert 35: 0.600(2707)[0m | [32mExpert 47: 0.600(2746)[0m | [32mExpert 48: 0.600(2749)[0m | [32mExpert 51: 0.600(2761)[0m | 
[32mExpert 62: 0.600(2797)[0m | [33mExpert  3: 0.400(2689)[0m | [33mExpert  4: 0.400(2722)[0m | [33mExpert  5: 0.400(2755)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29
Prefetch Node: task: Task: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
[2698, 2653, 2668, 2695, 2707, 2746, 2749, 2761, 2797, 2689, 2722, 2755]
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  3,  4,  5, 19, 23, 31, 32, 35, 47, 48, 51, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[28]:1.0 | [43]:1.0 | [44]:1.0 | [58]:1.0 | [62]:1.0 | [18]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[2]:1.0 | [11]:1.0 | [30]:1.0 | [39]:1.0 | [54]:1.0 | [47]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[12]:1.0 | [13]:1.0 | [22]:1.0 | [27]:1.0 | [31]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E4 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[2]:1.0 | [9]:1.0 | [13]:1.0 | [42]:1.0 | [47]:1.0 | [31]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[10]:1.0 | [11]:1.0 | [17]:1.0 | [18]:1.0 | [27]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[4]:1.0 | [30]:1.0 | [37]:1.0 | [50]:1.0 | [59]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
tensor([[ 4, 30, 37, 50, 59,  3],
        [12, 17, 29, 47, 59, 41],
        [20, 30, 34, 44, 55, 49],
        [30, 44, 47, 50, 57, 34],
        [ 5, 12, 30, 37, 57, 16],
        [16, 30, 31, 44, 53, 11],
        [16, 18, 30, 44, 52, 31],
        [29, 38, 41, 44, 57, 30],
        [26, 31, 32, 37, 56, 47],
        [ 4, 16, 23, 28, 29, 46],
        [29, 30, 41, 42, 44, 57],
        [29, 30, 41, 44, 57, 42],
        [30, 34, 41, 44, 57, 58],
        [22, 31, 44, 52, 57, 11],
        [12, 56, 57, 59, 61, 33],
        [16, 18, 31, 33, 59, 22],
        [18, 22, 31, 44, 52, 57],
        [12, 28, 41, 47, 61, 10],
        [ 5, 12, 56, 59, 61, 20],
        [ 4,  5, 31, 56, 59, 22],
        [ 3, 20, 50, 51, 59, 33],
        [ 5, 22, 31, 56, 63,  4],
        [15, 47, 50, 54, 61,  3],
        [ 4, 17, 56, 59, 61,  3],
        [ 0, 10, 15, 17, 30, 47],
        [ 3, 10, 30, 47, 59, 15],
        [22, 31, 33, 56, 59,  1],
        [22, 25, 31, 48, 52, 44],
        [ 1, 30, 31, 44, 57, 18],
        [10, 30, 43, 44, 57, 61],
        [ 8, 31, 44, 52, 57, 22],
        [41, 43, 44, 57, 61,  7],
        [ 8, 16, 31, 33, 59, 62],
        [ 8, 31, 44, 52, 57, 11],
        [12, 28, 41, 57, 61, 47],
        [ 3,  8, 22, 31, 59, 35],
        [ 8, 31, 44, 52, 57, 11],
        [ 7, 30, 44, 47, 57, 43],
        [ 9, 17, 30, 44, 57, 58],
        [30, 37, 44, 57, 58,  9],
        [ 0,  9, 30, 44, 57, 51],
        [16, 21, 31, 57, 63, 55],
        [ 1, 18, 44, 57, 63, 30],
        [ 1,  8, 18, 44, 57,  0],
        [ 7, 29, 38, 42, 46, 43],
        [ 4, 23, 28, 37, 62, 29],
        [29, 38, 41, 44, 57,  7],
        [ 7, 30, 41, 44, 57,  9],
        [30, 34, 41, 44, 57, 13],
        [16, 22, 31, 56, 61, 32],
        [22, 31, 44, 52, 62, 61],
        [18, 22, 31, 44, 52, 57],
        [12, 13, 28, 41, 61,  0],
        [12, 28, 41, 47, 61,  9],
        [ 2,  3, 33, 34, 61, 31],
        [22, 31, 33, 52, 56, 16],
        [16, 22, 31, 44, 52, 33],
        [13, 28, 41, 44, 61, 48],
        [13, 30, 44, 59, 61, 50],
        [ 1, 13, 44, 57, 61, 39],
        [10, 13, 41, 45, 61,  3],
        [ 3, 34, 45, 53, 61, 60],
        [ 3, 16, 22, 34, 61, 31],
        [22, 25, 44, 48, 52, 19],
        [30, 31, 44, 53, 57, 33],
        [20, 31, 44, 53, 57, 43],
        [11, 22, 31, 44, 52, 57],
        [12, 23, 37, 44, 57, 53],
        [31, 44, 50, 53, 57, 23],
        [ 3, 44, 51, 57, 59, 50],
        [11, 18, 31, 44, 52, 22],
        [11, 18, 44, 53, 57,  1],
        [ 7, 29, 42, 43, 46, 38],
        [ 4, 23, 28, 37, 62, 29],
        [29, 38, 41, 47, 57, 30],
        [30, 41, 44, 47, 57,  7],
        [30, 34, 41, 44, 57, 13],
        [12, 16, 22, 31, 59, 56],
        [21, 22, 31, 44, 52, 57],
        [33, 44, 53, 61, 62,  1],
        [18, 21, 22, 52, 61, 50],
        [10, 12, 13, 41, 61, 28],
        [ 2,  9, 12, 37, 61, 47],
        [22, 32, 33, 61, 63,  1],
        [26, 33, 47, 59, 61, 37],
        [18, 22, 32, 33, 61, 52],
        [18, 22, 31, 52, 61, 16],
        [10, 41, 45, 48, 61, 13],
        [ 3, 55, 56, 59, 61, 20],
        [ 3, 33, 59, 61, 63, 45],
        [ 5, 34, 56, 59, 61, 33],
        [ 0, 18, 22, 52, 61,  1],
        [19, 22, 25, 31, 52, 18],
        [ 2, 19, 37, 43, 57, 50],
        [11, 22, 31, 52, 57, 44],
        [ 2,  9, 12, 57, 61, 43],
        [16, 22, 31, 33, 35, 11],
        [11, 22, 31, 44, 52, 57],
        [11, 25, 31, 52, 57, 44],
        [51, 53, 55, 57, 62, 33],
        [ 1, 33, 50, 53, 57, 51],
        [ 1,  8, 18, 52, 57, 11],
        [ 7, 29, 38, 43, 46, 42],
        [ 4, 23, 28, 37, 62, 56],
        [29, 41, 42, 47, 57, 38],
        [ 7,  9, 41, 44, 57, 47],
        [ 0, 30, 43, 44, 57, 13],
        [13, 16, 22, 31, 52, 61],
        [16, 22, 25, 31, 52, 44],
        [ 0, 34, 44, 55, 57, 30],
        [16, 18, 33, 53, 63, 47],
        [18, 22, 30, 44, 52, 31],
        [28, 30, 44, 57, 61, 41],
        [ 3, 16, 22, 31, 59, 12],
        [22, 31, 44, 50, 52, 61],
        [18, 28, 31, 38, 44, 57],
        [ 7, 41, 44, 47, 57, 30],
        [ 1, 18, 32, 44, 57, 30],
        [12, 14, 30, 41, 61, 44],
        [16, 18, 22, 23, 31, 21],
        [ 0,  1, 16, 18, 22, 52],
        [16, 18, 21, 22, 52, 62],
        [ 1,  3, 18, 21, 22, 52],
        [ 0,  1, 18, 22, 52, 32],
        [28, 41, 44, 48, 61, 45],
        [17, 44, 51, 57, 60, 30],
        [20, 43, 44, 55, 57, 30],
        [11, 12, 34, 55, 59, 47],
        [11, 18, 31, 33, 52, 50],
        [ 1, 11, 18, 33, 59, 23],
        [ 7, 38, 47, 48, 57,  8],
        [ 7, 29, 38, 43, 46, 42],
        [ 0,  1, 44, 57, 60, 30],
        [30, 41, 44, 57, 60, 39],
        [16, 30, 31, 44, 59, 57],
        [18, 21, 30, 44, 57, 31],
        [17, 39, 44, 57, 60, 30],
        [20, 43, 44, 55, 57, 12],
        [11, 15, 44, 53, 55, 57],
        [11, 31, 44, 52, 57, 21],
        [11, 31, 52, 57, 63, 47],
        [ 1, 11, 32, 55, 57, 33],
        [ 7,  9, 44, 47, 57, 60],
        [30, 33, 44, 53, 57, 14],
        [ 1, 18, 21, 44, 63, 52],
        [20, 30, 44, 51, 57, 10],
        [ 0,  1, 18, 30, 44, 57],
        [ 7, 38, 43, 47, 57, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 40: 2.400(2963)[0m | [32mExpert 16: 2.200(2882)[0m | [32mExpert 49: 2.200(2990)[0m | [32mExpert 48: 1.800(2987)[0m | 
[32mExpert 15: 1.600(2879)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert 36: 1.400(2948)[0m | [32mExpert 61: 1.400(3032)[0m | 
[32mExpert  0: 1.200(2858)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert  4: 1.000(2960)[0m | 
[32mExpert 11: 1.000(2867)[0m | [32mExpert 52: 1.000(3002)[0m | [32mExpert 14: 0.800(2876)[0m | [32mExpert 31: 0.800(2933)[0m | 
[32mExpert 32: 0.800(2936)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert 55: 0.800(3011)[0m | [32mExpert  2: 0.600(2894)[0m | 
[32mExpert  5: 0.600(2993)[0m | [32mExpert  6: 0.600(3026)[0m | [32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | 
[32mExpert 26: 0.600(2915)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 38: 0.600(2954)[0m | 
[32mExpert 44: 0.600(2975)[0m | [32mExpert 50: 0.600(2996)[0m | [32mExpert 57: 0.600(3017)[0m | [33mExpert  1: 0.400(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2993, 3026, 2909, 2912, 2915, 2930, 2942, 2954, 2975, 2996, 3017, 2861]
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  5,  6, 24, 25, 26, 30, 34, 38, 44, 50, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:1.0 | [24]:1.0 | [34]:1.0 | [36]:1.0 | [47]:1.0 | [58]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:1.0 | [7]:1.0 | [23]:1.0 | [27]:1.0 | [51]:1.0 | [24]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[5]:1.0 | [14]:1.0 | [48]:1.0 | [52]:1.0 | [55]:1.0 | [36]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E24 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E38 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E57 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:1.0 | [13]:1.0 | [26]:1.0 | [33]:1.0 | [63]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[0]:1.0 | [11]:1.0 | [18]:1.0 | [26]:1.0 | [43]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[2]:1.0 | [5]:1.0 | [39]:1.0 | [56]:1.0 | [61]:1.0 | [49]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 2,  5, 39, 56, 61, 49],
        [ 1, 18, 31, 35, 53, 21],
        [ 0, 18, 31, 37, 54, 33],
        [17, 18, 35, 37, 43, 39],
        [ 1, 17, 32, 33, 36, 24],
        [ 1, 14, 17, 35, 43, 37],
        [ 5, 14, 19, 35, 47,  0],
        [ 9, 18, 30, 46, 53, 23],
        [14, 18, 39, 50, 59, 42],
        [13, 18, 22, 46, 52, 30],
        [ 9, 18, 46, 50, 53, 13],
        [ 9, 18, 23, 46, 53, 30],
        [18, 23, 31, 40, 55, 17],
        [ 1, 14, 17, 44, 49, 43],
        [ 1, 30, 43, 58, 59, 17],
        [ 1, 14, 50, 58, 59,  5],
        [ 1, 14, 35, 44, 49, 18],
        [18, 30, 40, 51, 61, 53],
        [ 2, 33, 36, 56, 62,  1],
        [ 2, 11, 32, 49, 56, 58],
        [28, 38, 47, 56, 62, 58],
        [10, 47, 49, 54, 56,  2],
        [ 2, 28, 49, 56, 61, 25],
        [ 2, 30, 56, 58, 59, 32],
        [21, 25, 32, 47, 56, 58],
        [ 1, 31, 32, 47, 56, 43],
        [ 2,  8, 19, 47, 56,  0],
        [23, 35, 44, 49, 57, 20],
        [ 1,  7, 23, 33, 35,  5],
        [ 1, 23, 31, 34, 37, 40],
        [ 1, 14, 35, 47, 63, 18],
        [ 1, 18, 23, 31, 37, 34],
        [ 1,  2, 23, 36, 56, 49],
        [ 1, 14, 23, 35, 49, 37],
        [18, 23, 32, 34, 37,  1],
        [ 1,  2, 23, 36, 56, 58],
        [ 1, 10, 14, 35, 49, 50],
        [23, 35, 37, 51, 57,  3],
        [ 1, 31, 35, 37, 45, 43],
        [ 1,  9, 35, 44, 57, 45],
        [ 1, 17, 33, 37, 40, 43],
        [ 5, 17, 43, 44, 48, 35],
        [ 1, 14, 17, 35, 43, 47],
        [33, 35, 47, 55, 58,  1],
        [18, 23, 30, 46, 59, 53],
        [13, 22, 23, 52, 59, 50],
        [ 8, 18, 23, 50, 53, 46],
        [23, 37, 46, 53, 57, 45],
        [18, 23, 37, 40, 55, 17],
        [ 1,  2, 23, 32, 49, 38],
        [ 1, 14, 23, 44, 49, 17],
        [ 1, 14, 23, 35, 44, 49],
        [23, 40, 46, 53, 61, 51],
        [23, 32, 50, 58, 59, 28],
        [14, 48, 56, 58, 59, 17],
        [ 0, 10, 23, 49, 51,  2],
        [23, 35, 44, 49, 57, 37],
        [23, 37, 40, 51, 57, 34],
        [ 1, 23, 25, 37, 56, 44],
        [ 1, 15, 23, 25, 44, 57],
        [15, 23, 25, 34, 51, 37],
        [15, 39, 47, 48, 56, 29],
        [ 0,  7, 10, 47, 56, 13],
        [23, 35, 37, 44, 57, 20],
        [ 1, 23, 39, 42, 43, 14],
        [17, 23, 31, 34, 37, 40],
        [ 1,  2, 14, 23, 37, 49],
        [22, 36, 37, 42, 52, 24],
        [ 1, 17, 37, 39, 52,  5],
        [ 0,  1, 17, 36, 56, 19],
        [ 1, 14, 35, 44, 47, 37],
        [14, 17, 19, 37, 47, 44],
        [18, 23, 46, 53, 57, 30],
        [13, 22, 23, 41, 52, 42],
        [ 8, 23, 46, 53, 63, 37],
        [18, 23, 37, 46, 53, 51],
        [23, 33, 37, 40, 55, 18],
        [ 1,  2, 36, 49, 56, 27],
        [ 1, 27, 44, 49, 50, 37],
        [ 1, 27, 33, 38, 39,  5],
        [ 1, 23, 44, 50, 53, 47],
        [27, 34, 38, 50, 53, 63],
        [ 2, 38, 50, 58, 59, 30],
        [19, 32, 50, 56, 58, 14],
        [15, 32, 50, 58, 59, 10],
        [19, 47, 49, 50, 63, 15],
        [35, 44, 49, 50, 57, 47],
        [26, 40, 43, 48, 50, 23],
        [19, 36, 50, 56, 59, 30],
        [ 5, 32, 36, 56, 58, 47],
        [ 1,  2,  6, 47, 56, 58],
        [ 6, 47, 49, 54, 63,  0],
        [27, 35, 44, 49, 57, 23],
        [ 1, 23, 24, 44, 56, 27],
        [ 1, 37, 43, 44, 49, 17],
        [18, 23, 37, 39, 44,  1],
        [ 1,  2, 23, 32, 49, 44],
        [ 1, 14, 23, 44, 49, 16],
        [17, 20, 27, 43, 48, 23],
        [ 1, 17, 27, 33, 36, 59],
        [ 1, 17, 27, 43, 54, 30],
        [ 1, 14, 44, 47, 55, 33],
        [18, 30, 46, 53, 59, 35],
        [13, 22, 23, 42, 52, 28],
        [ 8, 23, 32, 35, 50, 53],
        [23, 29, 37, 46, 53, 35],
        [18, 23, 31, 37, 40, 27],
        [ 2, 23, 27, 37, 38, 49],
        [11, 14, 29, 43, 45, 35],
        [ 1, 17, 23, 33, 43, 40],
        [ 5, 12, 14, 38, 43, 39],
        [ 2,  5, 14, 44, 47, 39],
        [18, 23, 37, 57, 63, 17],
        [ 1,  2, 36, 37, 56, 23],
        [ 1,  2, 14, 17, 39, 44],
        [ 1, 14, 30, 47, 57, 37],
        [ 3, 14, 37, 51, 57, 35],
        [ 0,  1, 14, 19, 44, 18],
        [39, 40, 43, 46, 53, 18],
        [ 2,  4, 12, 39, 49,  0],
        [ 5, 29, 35, 39, 47,  0],
        [ 0, 35, 39, 43, 47,  5],
        [ 7, 24, 39, 47, 54, 43],
        [ 0, 35, 39, 47, 55, 14],
        [18, 37, 39, 46, 53, 51],
        [20, 30, 31, 37, 43, 17],
        [17, 31, 37, 40, 43, 18],
        [ 1, 31, 55, 56, 59, 33],
        [ 1,  5, 14, 39, 44, 43],
        [ 1,  7, 47, 54, 55, 17],
        [ 8, 23, 35, 50, 57, 32],
        [18, 30, 46, 53, 59, 23],
        [13, 17, 31, 35, 37, 30],
        [18, 31, 34, 37, 46, 17],
        [ 1,  5, 23, 33, 36, 37],
        [ 1, 17, 35, 37, 44, 34],
        [17, 31, 34, 35, 37, 23],
        [18, 31, 37, 40, 55, 54],
        [ 1, 19, 27, 36, 54, 44],
        [ 1, 14, 44, 48, 54, 31],
        [35, 39, 43, 48, 54, 44],
        [13, 19, 35, 47, 54, 50],
        [ 3, 17, 35, 37, 51, 57],
        [17, 27, 37, 43, 54, 23],
        [ 1, 17, 35, 37, 44, 14],
        [ 1, 17, 31, 33, 37, 35],
        [ 1, 17, 35, 47, 55, 33],
        [30, 35, 37, 46, 57, 51]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 59: 2.200(4241)[0m | EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4247
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1363,3c0000002b] (16MB) STATE(0) TENSOR[4246,4247,4245,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4259
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1363,3c0000002b] (16MB) STATE(0) TENSOR[4246,4247,4245,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1310,70000002b] (16MB) STATE(0) TENSOR[4258,4259,4257,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
[32mExpert 27: 1.800(4136)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert 13: 1.600(4091)[0m | 
[32mExpert 45: 1.600(4196)[0m | [32mExpert 21: 1.400(4118)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | 
[32mExpert 55: 1.400(4229)[0m | [32mExpert 62: 1.400(4253)[0m | [32mExpert 19: 1.200(4109)[0m | [32mExpert 51: 1.200(4217)[0m | 
[32mExpert  2: 1.000(4112)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 12: 0.800(4088)[0m | [32mExpert 14: 0.800(4094)[0m | 
[32mExpert 44: 0.800(4193)[0m | [32mExpert 52: 0.800(4220)[0m | [32mExpert 54: 0.800(4226)[0m | [32mExpert  6: 0.600(4244)[0m | 
[32mExpert 31: 0.600(4151)[0m | [32mExpert 35: 0.600(4163)[0m | [32mExpert 42: 0.600(4187)[0m | [32mExpert 47: 0.600(4202)[0m | 
[32mExpert 53: 0.600(4223)[0m | [32mExpert 58: 0.600(4238)[0m | [32mExpert 60: 0.600(4247)[0m | [32mExpert 61: 0.600(4250)[0m | 
[33mExpert  1: 0.400(4079)[0m | [33mExpert  4: 0.400(4178)[0m | [33mExpert  5: 0.400(4211)[0m | [33mExpert  7: 0.400(4259)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4151, 4163, 4187, 4202, 4223, 4238, 4247, 4250, 4079, 4178, 4211, 4259]
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4247[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4259[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  4,  5,  7, 31, 35, 42, 47, 53, 58, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:1.0 | [6]:1.0 | [23]:1.0 | [44]:1.0 | [54]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[1]:1.0 | [20]:1.0 | [26]:1.0 | [36]:1.0 | [38]:1.0 | [57]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[16]:1.0 | [19]:1.0 | [21]:1.0 | [53]:1.0 | [54]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E4 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E7 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E60 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:1.0 | [3]:1.0 | [5]:1.0 | [8]:1.0 | [55]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[3]:1.0 | [5]:1.0 | [16]:1.0 | [45]:1.0 | [47]:1.0 | [0]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[10]:1.0 | [24]:1.0 | [47]:1.0 | [62]:1.0 | [63]:1.0 | [5]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[10, 24, 47, 62, 63,  5],
        [ 0, 24, 28, 36, 42, 62],
        [22, 24, 28, 36, 63, 40],
        [16, 22, 24, 28, 36, 63],
        [ 0, 16, 24, 33, 36, 34],
        [ 7, 15, 16, 24, 36, 19],
        [ 2, 16, 18, 24, 55,  3],
        [16, 28, 37, 51, 61, 50],
        [34, 37, 42, 50, 61, 12],
        [10, 33, 48, 52, 62, 51],
        [28, 41, 51, 58, 61, 16],
        [16, 19, 28, 37, 41, 50],
        [16, 19, 28, 36, 40, 60],
        [16, 18, 19, 28, 36,  2],
        [ 8, 10, 36, 53, 61,  6],
        [ 5, 23, 35, 36, 51, 52],
        [18, 19, 28, 50, 51, 24],
        [ 1,  7, 37, 44, 50, 31],
        [24, 33, 34, 47, 63, 62],
        [ 4, 24, 47, 53, 60, 26],
        [23, 24, 30, 54, 63, 60],
        [24, 25, 36, 54, 60, 51],
        [25, 30, 37, 50, 51, 24],
        [ 4, 20, 30, 54, 63, 23],
        [20, 30, 48, 54, 62, 13],
        [ 4, 20, 23, 30, 63, 26],
        [20, 23, 36, 52, 53, 30],
        [18, 19, 28, 29, 36, 38],
        [ 3, 19, 30, 36, 58, 62],
        [19, 22, 28, 40, 58, 12],
        [ 3, 18, 28, 51, 60, 20],
        [19, 28, 37, 40, 50, 36],
        [23, 33, 35, 36, 47, 62],
        [ 3,  8, 52, 53, 60, 54],
        [12, 19, 28, 50, 52, 22],
        [23, 33, 35, 36, 47, 58],
        [ 3, 18, 28, 52, 54, 20],
        [19, 21, 28, 37, 50, 14],
        [19, 28, 29, 31, 41, 38],
        [19, 28, 29, 38, 41, 31],
        [19, 24, 28, 36, 40, 21],
        [ 7, 19, 24, 28, 36, 43],
        [ 3, 18, 20, 24, 36,  9],
        [ 3, 18, 20, 28, 52,  9],
        [22, 50, 52, 58, 61, 53],
        [ 6, 27, 33, 35, 52, 26],
        [51, 52, 58, 60, 61, 50],
        [19, 24, 28, 37, 50, 31],
        [19, 28, 40, 42, 60, 22],
        [ 7, 24, 28, 36, 47, 19],
        [19, 24, 28, 47, 60, 36],
        [18, 19, 24, 51, 60, 26],
        [ 5, 50, 51, 60, 61, 26],
        [ 8, 10, 32, 50, 53,  7],
        [ 7,  8, 17, 44, 63, 59],
        [ 7, 23, 47, 52, 60, 26],
        [18, 19, 26, 29, 60, 21],
        [ 5, 26, 47, 50, 60, 61],
        [ 0, 19, 26, 47, 62, 30],
        [24, 41, 45, 47, 51, 52],
        [ 7, 17, 37, 41, 43, 40],
        [ 7, 11, 12, 41, 47, 34],
        [ 9, 23, 47, 52, 58, 62],
        [18, 19, 21, 28, 38, 29],
        [ 7, 15, 24, 47, 53, 36],
        [19, 28, 40, 42, 48, 52],
        [ 3, 18, 19, 20, 42, 60],
        [ 7, 24, 33, 62, 63, 53],
        [ 7, 20, 24, 28, 33, 36],
        [23, 30, 39, 48, 60, 56],
        [ 3,  9, 18, 20, 28, 48],
        [ 3, 18, 19, 20, 24, 55],
        [26, 50, 52, 60, 61,  8],
        [11, 26, 33, 34, 52, 27],
        [50, 52, 58, 60, 61, 51],
        [12, 19, 28, 37, 50, 60],
        [19, 22, 24, 28, 40, 60],
        [24, 30, 35, 36, 47, 26],
        [24, 28, 36, 40, 60, 47],
        [ 2, 15, 24, 40, 47, 12],
        [18, 20, 24, 35, 60, 45],
        [11, 45, 56, 60, 61,  6],
        [ 7,  8, 10, 36, 53, 50],
        [ 6,  8, 11, 35, 53, 54],
        [ 8, 10, 32, 41, 53, 24],
        [ 7, 23, 47, 52, 53, 36],
        [ 9, 18, 20, 24, 28, 47],
        [ 2, 11, 40, 41, 43,  7],
        [23, 30, 35, 54, 63, 36],
        [ 6, 30, 39, 54, 60,  4],
        [ 5, 23, 30, 60, 63, 48],
        [11, 15, 18, 23, 53,  9],
        [ 9, 18, 20, 24, 28, 12],
        [ 0, 24, 33, 36, 47, 19],
        [19, 20, 24, 28, 48, 36],
        [22, 24, 40, 42, 50, 19],
        [20, 23, 24, 36, 47, 33],
        [18, 20, 24, 44, 52, 28],
        [24, 28, 40, 43, 44, 36],
        [24, 30, 33, 36, 44, 10],
        [ 3, 15, 20, 24, 36, 44],
        [ 3, 18, 20, 24, 45, 44],
        [ 6, 50, 52, 60, 61, 27],
        [33, 34, 35, 47, 62, 52],
        [ 4, 50, 52, 58, 60,  6],
        [12, 19, 28, 31, 37, 50],
        [19, 28, 40, 52, 60, 25],
        [ 1,  7, 24, 26, 36, 19],
        [ 1, 19, 24, 32, 41, 31],
        [ 1, 19, 22, 32, 40, 24],
        [ 1, 15, 19, 24, 36, 32],
        [15, 18, 19, 20, 24, 28],
        [ 1, 19, 21, 28, 37, 24],
        [ 1, 23, 24, 33, 36, 35],
        [16, 18, 19, 24, 28, 23],
        [ 4, 18, 19, 20, 24, 28],
        [ 1, 19, 24, 28, 37, 41],
        [24, 45, 51, 56, 61, 28],
        [ 1, 22, 24, 32, 34, 37],
        [15, 16, 24, 32, 34,  7],
        [15, 18, 24, 32, 34, 11],
        [ 1, 15, 18, 24, 34, 32],
        [11, 15, 18, 21, 24, 55],
        [15, 18, 24, 30, 52,  4],
        [ 1, 16, 25, 34, 50, 37],
        [ 4, 19, 21, 24, 62, 30],
        [ 1, 22, 24, 28, 40, 16],
        [23, 33, 35, 36, 47, 30],
        [ 3,  7,  9, 18, 24, 12],
        [ 3,  9, 18, 23, 48, 24],
        [ 6,  8, 45, 52, 53, 10],
        [28, 50, 52, 60, 61, 53],
        [19, 24, 28, 36, 45, 22],
        [19, 28, 31, 37, 51, 43],
        [19, 24, 33, 35, 36, 61],
        [19, 24, 28, 31, 44, 43],
        [ 4, 19, 31, 43, 44, 28],
        [19, 22, 28, 36, 40, 16],
        [ 2, 10, 19, 24, 36, 16],
        [18, 19, 22, 24, 36, 44],
        [ 3, 12, 18, 24, 36,  9],
        [ 3,  8,  9, 18, 52, 26],
        [14, 19, 28, 31, 37, 50],
        [19, 24, 36, 40, 55,  2],
        [19, 24, 31, 44, 45, 18],
        [19, 22, 24, 36, 40, 28],
        [ 3, 18, 19, 36, 45, 52],
        [ 8, 28, 37, 50, 61, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:1.0 | [11]:1.0 | [38]:1.0 | [39]:1.0 | [45]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[9]:1.0 | [34]:1.0 | [54]:1.0 | [56]:1.0 | [57]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[1]
write out information.

EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:1.0 | [18]:1.0 | [31]:1.0 | [50]:1.0 | [57]:2.0 | [11]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[8]:1.0 | [37]:1.0 | [59]:1.0 | [62]:2.0 | [63]:2.0 | [36]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[0]:1.0 | [21]:1.0 | [22]:1.0 | [46]:1.0 | [48]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[3]:1.0 | [18]:1.0 | [22]:1.0 | [34]:1.0 | [60]:1.0 | [13]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[12]:1.0 | [18]:1.0 | [39]:1.0 | [41]:1.0 | [50]:1.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[11]:1.0 | [37]:1.0 | [46]:1.0 | [50]:1.0 | [56]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[11, 37, 46, 50, 56, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 2.600(2740)[0m | [32mExpert 53: 2.400(2767)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 22: 1.600(2665)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 31: 1.400(2695)[0m | [32mExpert  1: 1.400(2623)[0m | 
[32mExpert  7: 1.400(2803)[0m | [32mExpert 33: 1.400(2701)[0m | [32mExpert 41: 1.400(2728)[0m | [32mExpert 46: 1.400(2743)[0m | 
[32mExpert 12: 1.200(2632)[0m | [32mExpert 16: 1.200(2644)[0m | [32mExpert 17: 1.200(2647)[0m | [32mExpert 34: 1.200(2704)[0m | 
[32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | [32mExpert 50: 1.000(2758)[0m | [32mExpert 55: 1.000(2773)[0m | 
[32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 24: 0.800(2671)[0m | [32mExpert 32: 0.800(2698)[0m | 
[32mExpert 19: 0.600(2653)[0m | [32mExpert 23: 0.600(2668)[0m | [32mExpert 35: 0.600(2707)[0m | [32mExpert 47: 0.600(2746)[0m | 
[32mExpert 48: 0.600(2749)[0m | [32mExpert 51: 0.600(2761)[0m | [32mExpert 62: 0.600(2797)[0m | [33mExpert  3: 0.400(2689)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2656, 2629, 2671, 2698, 2653, 2668, 2707, 2746, 2749, 2761, 2797, 2689]
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  3, 11, 19, 23, 24, 32, 35, 47, 48, 51, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:1.0 | [38]:1.0 | [41]:1.0 | [42]:1.0 | [50]:1.0 | [26]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[6]:1.0 | [8]:1.0 | [33]:1.0 | [45]:1.0 | [55]:1.0 | [46]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[35]:1.0 | [41]:1.0 | [45]:1.0 | [46]:1.0 | [48]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[17]:1.0 | [30]:1.0 | [41]:1.0 | [55]:1.0 | [60]:1.0 | [59]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[8]:1.0 | [28]:1.0 | [43]:1.0 | [47]:1.0 | [54]:2.0 | [16]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[16]:1.0 | [29]:1.0 | [38]:1.0 | [41]:1.0 | [46]:1.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[16, 29, 38, 41, 46, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 2.600(2987)[0m | [32mExpert 40: 2.400(2963)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert 16: 2.200(2882)[0m | 
[32mExpert 49: 2.200(2990)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 55: 1.600(3011)[0m | 
[32mExpert 15: 1.600(2879)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert  5: 1.400(2993)[0m | [32mExpert 61: 1.400(3032)[0m | 
[32mExpert  0: 1.200(2858)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert  4: 1.000(2960)[0m | 
[32mExpert 11: 1.000(2867)[0m | [32mExpert 31: 0.800(2933)[0m | [32mExpert 32: 0.800(2936)[0m | [32mExpert 33: 0.800(2939)[0m | 
[32mExpert  2: 0.600(2894)[0m | [32mExpert  6: 0.600(3026)[0m | [32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | 
[32mExpert 26: 0.600(2915)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 38: 0.600(2954)[0m | 
[32mExpert 44: 0.600(2975)[0m | [32mExpert 50: 0.600(2996)[0m | [32mExpert 57: 0.600(3017)[0m | [33mExpert  1: 0.400(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2894, 3026, 2909, 2912, 2915, 2930, 2942, 2954, 2975, 2996, 3017, 2861]
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  2,  6, 24, 25, 26, 30, 34, 38, 44, 50, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:1.0 | [21]:1.0 | [29]:1.0 | [33]:1.0 | [44]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[9]:1.0 | [25]:1.0 | [28]:1.0 | [30]:1.0 | [33]:1.0 | [50]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:1.0 | [15]:1.0 | [16]:1.0 | [19]:1.0 | [49]:1.0 | [50]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[15]:1.0 | [16]:1.0 | [17]:1.0 | [24]:1.0 | [41]:1.0 | [33]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[25]:1.0 | [26]:2.0 | [40]:1.0 | [55]:1.0 | [62]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[18]:1.0 | [30]:1.0 | [46]:1.0 | [53]:1.0 | [57]:1.0 | [17]:1.0 | EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4247
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1363,3c0000002b] (16MB) STATE(0) TENSOR[4246,4247,4245,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4178
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[1363,3c0000002b] (16MB) STATE(0) TENSOR[4246,4247,4245,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1307,40000002b] (16MB) STATE(0) TENSOR[4177,4178,4176,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25

---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[18, 30, 46, 53, 57, 17]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 21: 2.200(4118)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert 19: 2.000(4109)[0m | [32mExpert 27: 1.800(4136)[0m | 
[32mExpert 54: 1.600(4226)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | 
[32mExpert 53: 1.400(4223)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | [32mExpert 55: 1.400(4229)[0m | 
[32mExpert 62: 1.400(4253)[0m | [32mExpert 16: 1.200(4100)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert 28: 1.000(4139)[0m | 
[32mExpert  2: 1.000(4112)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 12: 0.800(4088)[0m | [32mExpert 14: 0.800(4094)[0m | 
[32mExpert 44: 0.800(4193)[0m | [32mExpert 52: 0.800(4220)[0m | [32mExpert  6: 0.600(4244)[0m | [32mExpert 31: 0.600(4151)[0m | 
[32mExpert 35: 0.600(4163)[0m | [32mExpert 42: 0.600(4187)[0m | [32mExpert 47: 0.600(4202)[0m | [32mExpert 58: 0.600(4238)[0m | 
[32mExpert 60: 0.600(4247)[0m | [32mExpert 61: 0.600(4250)[0m | [33mExpert  1: 0.400(4079)[0m | [33mExpert  4: 0.400(4178)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4193, 4220, 4244, 4151, 4163, 4187, 4202, 4238, 4247, 4250, 4079, 4178]
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4247[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4178[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  4,  6, 31, 35, 42, 44, 47, 52, 58, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:1.0 | [19]:1.0 | [24]:1.0 | [41]:1.0 | [47]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[15]:1.0 | [22]:1.0 | [25]:1.0 | [44]:1.0 | [50]:1.0 | [53]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[12]:1.0 | [14]:1.0 | [27]:1.0 | [48]:1.0 | [62]:1.0 | [61]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[11]:2.0 | [21]:1.0 | [35]:1.0 | [40]:1.0 | [60]:1.0 | [5]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[6]:1.0 | [22]:1.0 | [23]:1.0 | [40]:1.0 | [57]:1.0 | [7]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[28]:1.0 | [37]:1.0 | [50]:1.0 | [52]:1.0 | [61]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[28, 37, 50, 52, 61, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [12]:1.0 | [57]:1.0 | [63]:1.0 | [45]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[26]:1.0 | [30]:1.0 | [34]:2.0 | [42]:1.0 | [56]:2.0 | [63]:1.0 | 
---------------------------------------
return EAMC[1]

EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3026
[1m[33mEnqueueTask: [0m[32mTask: node: ID[919,60000001f] (16MB) STATE(0) TENSOR[3025,3026,3024,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[11]:2.0 | [18]:2.0 | [31]:2.0 | [50]:2.0 | [57]:3.0 | [14]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[8]:2.0 | [27]:1.0 | [38]:2.0 | [62]:3.0 | [63]:3.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[0]:2.0 | [5]:1.0 | [21]:2.0 | [46]:2.0 | [48]:2.0 | [22]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[3]:2.0 | [18]:2.0 | [22]:2.0 | [34]:2.0 | [60]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[12]:2.0 | [18]:2.0 | [29]:1.0 | [39]:2.0 | [50]:2.0 | [38]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[11]:2.0 | [16]:2.0 | [37]:2.0 | [46]:2.0 | [56]:2.0 | [50]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[11, 16, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 3.400(2740)[0m | [32mExpert 53: 2.400(2767)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 41: 2.200(2728)[0m | 
[32mExpert 46: 2.200(2743)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert 26: 1.600(2677)[0m | [32mExpert 31: 1.400(2695)[0m | [32mExpert 35: 1.400(2707)[0m | [32mExpert 48: 1.400(2749)[0m | 
[32mExpert  7: 1.400(2803)[0m | [32mExpert 33: 1.400(2701)[0m | [32mExpert 12: 1.200(2632)[0m | [32mExpert 16: 1.200(2644)[0m | 
[32mExpert 17: 1.200(2647)[0m | [32mExpert 34: 1.200(2704)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | 
[32mExpert 50: 1.000(2758)[0m | [32mExpert 55: 1.000(2773)[0m | [32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | 
[32mExpert 24: 0.800(2671)[0m | [32mExpert 32: 0.800(2698)[0m | [32mExpert 19: 0.600(2653)[0m | [32mExpert 23: 0.600(2668)[0m | 
[32mExpert 47: 0.600(2746)[0m | [32mExpert 51: 0.600(2761)[0m | [32mExpert 62: 0.600(2797)[0m | [33mExpert  3: 0.400(2689)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2758, 2773, 2656, 2629, 2671, 2698, 2653, 2668, 2746, 2761, 2797, 2689]
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  3, 11, 19, 23, 24, 32, 47, 50, 51, 55, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:2.0 | [38]:2.0 | [41]:2.0 | [42]:2.0 | [50]:2.0 | [8]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[8]:2.0 | [33]:2.0 | [45]:2.0 | [46]:2.0 | [55]:2.0 | [6]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[1]:2.0 | [35]:2.0 | [41]:2.0 | [45]:2.0 | [46]:2.0 | [48]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[30]:2.0 | [41]:2.0 | [55]:2.0 | [59]:2.0 | [60]:2.0 | [17]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[8]:2.0 | [28]:2.0 | [43]:2.0 | [47]:2.0 | [54]:3.0 | [16]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[29]:2.0 | [38]:2.0 | [41]:2.0 | [42]:2.0 | [46]:2.0 | [7]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[29, 38, 41, 42, 46,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 3.000(2882)[0m | [32mExpert 49: 3.000(2990)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 15: 2.400(2879)[0m | 
[32mExpert 40: 2.400(2963)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert  0: 2.000(2858)[0m | [32mExpert 52: 1.800(3002)[0m | 
[32mExpert 14: 1.600(2876)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert  5: 1.400(2993)[0m | 
[32mExpert 50: 1.400(2996)[0m | [32mExpert 61: 1.400(3032)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | 
[32mExpert  4: 1.000(2960)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 19: 0.800(2891)[0m | [32mExpert 31: 0.800(2933)[0m | 
[32mExpert 32: 0.800(2936)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | [32mExpert  6: 0.600(3026)[0m | 
[32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | [32mExpert 26: 0.600(2915)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 34: 0.600(2942)[0m | [32mExpert 38: 0.600(2954)[0m | [32mExpert 44: 0.600(2975)[0m | [32mExpert 57: 0.600(3017)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2936, 2939, 2894, 3026, 2909, 2912, 2915, 2930, 2942, 2954, 2975, 3017]
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 3026[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  6, 24, 25, 26, 30, 32, 33, 34, 38, 44, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:2.0 | [21]:2.0 | [29]:2.0 | [33]:2.0 | [44]:2.0 | [41]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[9]:2.0 | [25]:2.0 | [28]:2.0 | [30]:2.0 | [33]:2.0 | [50]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:2.0 | [6]:1.0 | [16]:2.0 | [19]:2.0 | [49]:2.0 | [15]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[15]:2.0 | [17]:2.0 | [24]:2.0 | [41]:2.0 | [58]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[25]:2.0 | [28]:1.0 | [40]:2.0 | [52]:1.0 | [55]:2.0 | [57]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[18]:2.0 | [30]:2.0 | [46]:2.0 | [51]:1.0 | [53]:2.0 | [40]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[18, 30, 46, 51, 53, 40]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 27: 2.600(4136)[0m | [32mExpert 21: 2.200(4118)[0m | [32mExpert 62: 2.200(4253)[0m | [32mExpert 59: 2.200(4241)[0m | 
[32mExpert 19: 2.000(4109)[0m | [32mExpert 12: 1.600(4088)[0m | EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4247
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1363,3c0000002b] (16MB) STATE(0) TENSOR[4246,4247,4245,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[1363,3c0000002b] (16MB) STATE(0) TENSOR[4246,4247,4245,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
[32mExpert 14: 1.600(4094)[0m | [32mExpert 54: 1.600(4226)[0m | 
[32mExpert 10: 1.600(4082)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | [32mExpert 53: 1.400(4223)[0m | 
[32mExpert 61: 1.400(4250)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | [32mExpert 55: 1.400(4229)[0m | 
[32mExpert 16: 1.200(4100)[0m | [32mExpert 48: 1.200(4205)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert 28: 1.000(4139)[0m | 
[32mExpert  2: 1.000(4112)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 44: 0.800(4193)[0m | [32mExpert 52: 0.800(4220)[0m | 
[32mExpert  6: 0.600(4244)[0m | [32mExpert 31: 0.600(4151)[0m | [32mExpert 35: 0.600(4163)[0m | [32mExpert 42: 0.600(4187)[0m | 
[32mExpert 47: 0.600(4202)[0m | [32mExpert 58: 0.600(4238)[0m | [32mExpert 60: 0.600(4247)[0m | [33mExpert  1: 0.400(4079)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4112, 4232, 4193, 4220, 4244, 4151, 4163, 4187, 4202, 4238, 4247, 4079]
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4247[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  2,  6, 31, 35, 42, 44, 47, 52, 56, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:2.0 | [24]:2.0 | [41]:2.0 | [47]:2.0 | [60]:2.0 | [30]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[15]:2.0 | [22]:2.0 | [25]:2.0 | [44]:2.0 | [50]:2.0 | [34]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[8]:1.0 | [14]:2.0 | [27]:2.0 | [48]:2.0 | [62]:2.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:2.0 | [35]:2.0 | [37]:1.0 | [39]:1.0 | [60]:2.0 | [40]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[6]:2.0 | [7]:2.0 | [23]:2.0 | [40]:2.0 | [57]:2.0 | [58]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[19]:1.0 | [22]:1.0 | [28]:2.0 | [50]:2.0 | [61]:2.0 | [37]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[19, 22, 28, 50, 61, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:2.0 | [10]:2.0 | [12]:2.0 | [21]:1.0 | [57]:2.0 | [63]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[26]:2.0 | [30]:2.0 | [34]:3.0 | [36]:1.0 | [56]:3.0 | [42]:2.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2689
[1m[33mEnqueueTask: [0m[32mTask: node: ID[526,300000013] (16MB) STATE(0) TENSOR[2688,2689,2687,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:1.0 | [9]:1.0 | [13]:1.0 | [42]:1.0 | [52]:1.0 | [37]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[22]:1.0 | [35]:2.0 | [42]:1.0 | [58]:1.0 | [63]:4.0 | [14]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[0]:3.0 | [7]:1.0 | [42]:1.0 | [48]:3.0 | [62]:1.0 | [17]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[10]:1.0 | [18]:3.0 | [34]:3.0 | [38]:1.0 | [59]:1.0 | [60]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[18]:3.0 | [38]:2.0 | [39]:3.0 | [41]:2.0 | [50]:3.0 | [40]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[6]:1.0 | [19]:1.0 | [37]:3.0 | [46]:3.0 | [56]:3.0 | [50]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 6, 19, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 4.200(2740)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 41: 3.000(2728)[0m | [32mExpert 46: 3.000(2743)[0m | 
[32mExpert 53: 2.400(2767)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert 13: 1.800(2635)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 31: 1.400(2695)[0m | 
[32mExpert  7: 1.400(2803)[0m | [32mExpert 33: 1.400(2701)[0m | [32mExpert 12: 1.200(2632)[0m | [32mExpert 16: 1.200(2644)[0m | 
[32mExpert 17: 1.200(2647)[0m | [32mExpert 34: 1.200(2704)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | 
[32mExpert 50: 1.000(2758)[0m | [32mExpert 55: 1.000(2773)[0m | [32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | 
[32mExpert 24: 0.800(2671)[0m | [32mExpert 32: 0.800(2698)[0m | [32mExpert 19: 0.600(2653)[0m | [32mExpert 23: 0.600(2668)[0m | 
[32mExpert 47: 0.600(2746)[0m | [32mExpert 51: 0.600(2761)[0m | [32mExpert 62: 0.600(2797)[0m | [33mExpert  3: 0.400(2689)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2758, 2773, 2656, 2629, 2671, 2698, 2653, 2668, 2746, 2761, 2797, 2689]
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2689[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  3, 11, 19, 23, 24, 32, 47, 50, 51, 55, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:2.0 | [16]:1.0 | [38]:3.0 | [41]:3.0 | [50]:3.0 | [6]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[8]:3.0 | [32]:1.0 | [33]:3.0 | [46]:3.0 | [49]:1.0 | [45]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[19]:1.0 | [41]:3.0 | [45]:3.0 | [46]:3.0 | [53]:1.0 | [38]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:3.0 | [41]:3.0 | [50]:1.0 | [57]:1.0 | [59]:3.0 | [44]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[23]:1.0 | [28]:3.0 | [31]:1.0 | [43]:3.0 | [44]:1.0 | [16]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[4]:2.0 | [28]:1.0 | [29]:3.0 | [37]:2.0 | [41]:3.0 | [46]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 4, 28, 29, 37, 41, 46]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 3.800(2882)[0m | [32mExpert 49: 3.800(2990)[0m | [32mExpert 15: 3.200(2879)[0m | [32mExpert  0: 2.800(2858)[0m | 
[32mExpert 48: 2.600(2987)[0m | [32mExpert 40: 2.400(2963)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert 52: 1.800(3002)[0m | 
[32mExpert 19: 1.600(2891)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert 18: 1.600(2888)[0m | 
[32mExpert  5: 1.400(2993)[0m | [32mExpert  6: 1.400(3026)[0m | [32mExpert 50: 1.400(2996)[0m | [32mExpert 61: 1.400(3032)[0m | 
[32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert  4: 1.000(2960)[0m | [32mExpert 11: 1.000(2867)[0m | 
[32mExpert 31: 0.800(2933)[0m | [32mExpert 32: 0.800(2936)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | 
[32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | [32mExpert 26: 0.600(2915)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 34: 0.600(2942)[0m | [32mExpert 38: 0.600(2954)[0m | [32mExpert 44: 0.600(2975)[0m | [32mExpert 57: 0.600(3017)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2933, 2936, 2939, 2894, 2909, 2912, 2915, 2930, 2942, 2954, 2975, 3017]
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2, 24, 25, 26, 30, 31, 32, 33, 34, 38, 44, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:3.0 | [10]:1.0 | [18]:1.0 | [29]:3.0 | [44]:3.0 | [5]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[7]:2.0 | [9]:3.0 | [26]:1.0 | [28]:3.0 | [49]:1.0 | [56]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:3.0 | [10]:1.0 | [16]:3.0 | [49]:3.0 | [58]:1.0 | [50]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 16 MLP ==
[0m
[8]:1.0 | [16]:2.0 | [21]:1.0 | [24]:3.0 | [41]:3.0 | [5]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[3]:1.0 | [5]:1.0 | [25]:3.0 | [35]:1.0 | [40]:3.0 | [62]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[13]:1.0 | [22]:1.0 | [46]:3.0 | [52]:1.0 | [53]:3.0 | [8]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[13, 22, 46, 52, 53,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 27: 3.400(4136)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 14: 2.400(4094)[0m | [32mExpert 21: 2.200(4118)[0m | 
[32mExpert 59: 2.200(4241)[0m | [32mExpert 48: 2.000(4205)[0m | EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4247
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1363,3c0000002b] (16MB) STATE(0) TENSOR[4246,4247,4245,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[1363,3c0000002b] (16MB) STATE(0) TENSOR[4246,4247,4245,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
[32mExpert 19: 2.000(4109)[0m | [32mExpert 12: 1.600(4088)[0m | 
[32mExpert 54: 1.600(4226)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | 
[32mExpert 42: 1.400(4187)[0m | [32mExpert 53: 1.400(4223)[0m | [32mExpert 61: 1.400(4250)[0m | [32mExpert 26: 1.400(4133)[0m | 
[32mExpert 41: 1.400(4184)[0m | [32mExpert 55: 1.400(4229)[0m | [32mExpert 16: 1.200(4100)[0m | [32mExpert 51: 1.200(4217)[0m | 
[32mExpert 28: 1.000(4139)[0m | [32mExpert  2: 1.000(4112)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert  8: 0.800(4262)[0m | 
[32mExpert 44: 0.800(4193)[0m | [32mExpert 52: 0.800(4220)[0m | [32mExpert  6: 0.600(4244)[0m | [32mExpert 31: 0.600(4151)[0m | 
[32mExpert 35: 0.600(4163)[0m | [32mExpert 47: 0.600(4202)[0m | [32mExpert 58: 0.600(4238)[0m | [32mExpert 60: 0.600(4247)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4139, 4112, 4232, 4262, 4193, 4220, 4244, 4151, 4163, 4202, 4238, 4247]
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4247[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  6,  8, 28, 31, 35, 44, 47, 52, 56, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:1.0 | [14]:3.0 | [24]:3.0 | [29]:1.0 | [31]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[6]:1.0 | [15]:3.0 | [38]:2.0 | [43]:1.0 | [55]:1.0 | [50]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[17]:1.0 | [21]:2.0 | [25]:1.0 | [43]:1.0 | [48]:3.0 | [2]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E2 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[2]:1.0 | [4]:1.0 | [11]:3.0 | [21]:3.0 | [58]:1.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[13]:1.0 | [22]:2.0 | [35]:1.0 | [47]:2.0 | [54]:1.0 | [3]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[23]:1.0 | [33]:1.0 | [36]:1.0 | [48]:1.0 | [52]:2.0 | [10]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[23, 33, 36, 48, 52, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[25]:1.0 | [47]:1.0 | [48]:1.0 | [54]:2.0 | [62]:1.0 | [2]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[8]:1.0 | [20]:1.0 | [29]:1.0 | [49]:1.0 | [59]:1.0 | [38]:1.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:1.0 | [20]:1.0 | [26]:2.0 | [52]:2.0 | [56]:2.0 | [9]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[35]:3.0 | [38]:3.0 | [42]:2.0 | [57]:1.0 | [63]:5.0 | [0]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[0]:4.0 | [5]:2.0 | [7]:2.0 | [22]:3.0 | [42]:2.0 | [54]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[13]:2.0 | [18]:4.0 | [26]:1.0 | [34]:4.0 | [59]:2.0 | [29]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[10]:1.0 | [38]:3.0 | [39]:4.0 | [41]:3.0 | [50]:4.0 | [40]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[19]:2.0 | [28]:1.0 | [35]:1.0 | [46]:4.0 | [56]:4.0 | [12]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[19, 28, 35, 46, 56, 12]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 5.000(2740)[0m | [32mExpert 41: 3.800(2728)[0m | [32mExpert 46: 3.800(2743)[0m | [32mExpert 53: 3.200(2767)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert 13: 1.800(2635)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 19: 1.400(2653)[0m | 
[32mExpert 31: 1.400(2695)[0m | [32mExpert  7: 1.400(2803)[0m | [32mExpert 33: 1.400(2701)[0m | [32mExpert 12: 1.200(2632)[0m | 
[32mExpert 38: 1.200(2716)[0m | [32mExpert 16: 1.200(2644)[0m | [32mExpert 17: 1.200(2647)[0m | [32mExpert 34: 1.200(2704)[0m | 
[32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | [32mExpert 50: 1.000(2758)[0m | [32mExpert 55: 1.000(2773)[0m | 
[32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 24: 0.800(2671)[0m | [32mExpert 32: 0.800(2698)[0m | 
[32mExpert 23: 0.600(2668)[0m | [32mExpert 47: 0.600(2746)[0m | [32mExpert 51: 0.600(2761)[0m | [32mExpert 62: 0.600(2797)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2680, 2809, 2758, 2773, 2656, 2629, 2671, 2698, 2668, 2746, 2761, 2797]
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  9, 11, 23, 24, 27, 32, 47, 50, 51, 55, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:3.0 | [26]:2.0 | [41]:4.0 | [42]:3.0 | [50]:4.0 | [12]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[6]:3.0 | [8]:4.0 | [18]:1.0 | [46]:4.0 | [49]:2.0 | [45]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[33]:1.0 | [38]:2.0 | [41]:4.0 | [46]:4.0 | [53]:2.0 | [17]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[30]:4.0 | [41]:4.0 | [50]:2.0 | [51]:1.0 | [57]:2.0 | [59]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[28]:4.0 | [34]:1.0 | [43]:4.0 | [47]:3.0 | [53]:1.0 | [5]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[12]:1.0 | [29]:4.0 | [38]:3.0 | [41]:4.0 | [42]:3.0 | [58]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[12, 29, 38, 41, 42, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.600(2882)[0m | [32mExpert 49: 4.600(2990)[0m | [32mExpert  0: 3.600(2858)[0m | [32mExpert 15: 3.200(2879)[0m | 
[32mExpert 48: 2.600(2987)[0m | [32mExpert 40: 2.400(2963)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 36: 2.200(2948)[0m | 
[32mExpert 52: 1.800(3002)[0m | [32mExpert 19: 1.600(2891)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 55: 1.600(3011)[0m | 
[32mExpert 18: 1.600(2888)[0m | [32mExpert  5: 1.400(2993)[0m | [32mExpert  6: 1.400(3026)[0m | [32mExpert 61: 1.400(3032)[0m | 
[32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert  4: 1.000(2960)[0m | 
[32mExpert 11: 1.000(2867)[0m | [32mExpert 58: 0.800(3020)[0m | [32mExpert 31: 0.800(2933)[0m | [32mExpert 32: 0.800(2936)[0m | 
[32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | [32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | 
[32mExpert 26: 0.600(2915)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 38: 0.600(2954)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2867, 3020, 2933, 2936, 2939, 2894, 2909, 2912, 2915, 2930, 2942, 2954]
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2, 11, 24, 25, 26, 30, 31, 32, 33, 34, 38, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:1.0 | [29]:4.0 | [30]:1.0 | [33]:3.0 | [44]:4.0 | [17]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[9]:4.0 | [28]:4.0 | [33]:3.0 | [50]:3.0 | [63]:1.0 | [36]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:4.0 | [6]:2.0 | [16]:4.0 | [49]:4.0 | [61]:1.0 | [4]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 16 MLP ==
[0m
[15]:3.0 | [17]:3.0 | [24]:4.0 | [41]:4.0 | [50]:1.0 | [10]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[15]:1.0 | [25]:4.0 | [40]:4.0 | [55]:3.0 | [57]:2.0 | [52]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[8]:2.0 | [18]:3.0 | [40]:2.0 | [46]:4.0 | [53]:4.0 | [23]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 8, 18, 40, 46, 53, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 27: 3.400(4136)[0m | [32mExpert 21: 3.000(4118)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 48: 2.800(4205)[0m | 
[32mExpert 14: 2.400(4094)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert 19: 2.000(4109)[0m | [32mExpert  2: 1.800(4112)[0m | 
[32mExpert 12: 1.600(4088)[0m | [32mExpert 54: 1.600(4226)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert 13: 1.600(4091)[0m | 
[32mExpert 45: 1.600(4196)[0m | EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
[32mExpert 42: 1.400(4187)[0m | [32mExpert 53: 1.400(4223)[0m | [32mExpert 61: 1.400(4250)[0m | 
[32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | [32mExpert 55: 1.400(4229)[0m | [32mExpert 16: 1.200(4100)[0m | 
[32mExpert 17: 1.200(4103)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert 28: 1.000(4139)[0m | [32mExpert 56: 1.000(4232)[0m | 
[32mExpert  8: 0.800(4262)[0m | [32mExpert 25: 0.800(4130)[0m | [32mExpert 43: 0.800(4190)[0m | [32mExpert 44: 0.800(4193)[0m | 
[32mExpert 52: 0.800(4220)[0m | [32mExpert  6: 0.600(4244)[0m | [32mExpert 31: 0.600(4151)[0m | [32mExpert 35: 0.600(4163)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4103, 4217, 4139, 4232, 4262, 4130, 4190, 4193, 4220, 4244, 4151, 4163]
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  8, 17, 25, 28, 31, 35, 43, 44, 51, 52, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:1.0 | [14]:4.0 | [41]:3.0 | [47]:3.0 | [60]:3.0 | [61]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[15]:4.0 | [25]:3.0 | [37]:1.0 | [50]:4.0 | [63]:1.0 | [22]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[14]:3.0 | [42]:2.0 | [48]:4.0 | [55]:1.0 | [61]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 22 MLP ==
[0m
[21]:4.0 | [35]:3.0 | [50]:1.0 | [57]:1.0 | [60]:3.0 | [40]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[7]:3.0 | [23]:3.0 | [38]:1.0 | [51]:1.0 | [57]:3.0 | [16]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[28]:3.0 | [51]:1.0 | [58]:1.0 | [60]:2.0 | [61]:3.0 | [52]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[28, 51, 58, 60, 61, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:2.0 | [10]:3.0 | [12]:3.0 | [45]:3.0 | [54]:3.0 | [2]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[12]:1.0 | [32]:1.0 | [51]:1.0 | [52]:1.0 | [56]:4.0 | [27]:1.0 | 
---------------------------------------
return EAMC[1]
1. EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:2.0 | [11]:3.0 | [13]:2.0 | [27]:1.0 | [56]:3.0 | [57]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [14]:2.0 | [29]:2.0 | [38]:4.0 | [11]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[7]:3.0 | [10]:1.0 | [22]:4.0 | [42]:3.0 | [46]:3.0 | [23]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[13]:3.0 | [26]:2.0 | [34]:5.0 | [41]:1.0 | [59]:3.0 | [45]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[15]:1.0 | [38]:4.0 | [40]:3.0 | [41]:4.0 | [50]:5.0 | [39]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[6]:2.0 | [19]:3.0 | [35]:2.0 | [46]:5.0 | [56]:5.0 | [39]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 6, 19, 35, 46, 56, 39]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 45: 5.000(2740)[0m | [32mExpert 41: 4.600(2728)[0m | [32mExpert 46: 4.600(2743)[0m | [32mExpert 53: 4.000(2767)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 33: 2.200(2701)[0m | 
[32mExpert 38: 2.000(2716)[0m | [32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 22: 1.600(2665)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 19: 1.400(2653)[0m | [32mExpert 31: 1.400(2695)[0m | 
[32mExpert  7: 1.400(2803)[0m | [32mExpert 12: 1.200(2632)[0m | [32mExpert 16: 1.200(2644)[0m | [32mExpert 34: 1.200(2704)[0m | 
[32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | [32mExpert 50: 1.000(2758)[0m | [32mExpert 55: 1.000(2773)[0m | 
[32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 24: 0.800(2671)[0m | [32mExpert 32: 0.800(2698)[0m | 
[32mExpert 23: 0.600(2668)[0m | [32mExpert 47: 0.600(2746)[0m | [32mExpert 51: 0.600(2761)[0m | [32mExpert 62: 0.600(2797)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2680, 2809, 2758, 2773, 2656, 2629, 2671, 2698, 2668, 2746, 2761, 2797]
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  9, 11, 23, 24, 27, 32, 47, 50, 51, 55, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:4.0 | [16]:2.0 | [26]:3.0 | [41]:5.0 | [50]:5.0 | [42]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[8]:5.0 | [18]:2.0 | [25]:1.0 | [46]:5.0 | [49]:3.0 | [6]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[19]:2.0 | [38]:3.0 | [41]:5.0 | [46]:5.0 | [61]:1.0 | [53]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[30]:5.0 | [41]:5.0 | [50]:3.0 | [51]:2.0 | [59]:5.0 | [60]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[28]:5.0 | [34]:2.0 | [43]:5.0 | [53]:2.0 | [54]:4.0 | [47]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[29]:5.0 | [41]:5.0 | [42]:4.0 | [45]:1.0 | [57]:1.0 | [30]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[29, 41, 42, 45, 57, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 5.400(2882)[0m | [32mExpert 49: 5.400(2990)[0m | [32mExpert  0: 4.400(2858)[0m | [32mExpert 15: 3.200(2879)[0m | 
[32mExpert 48: 2.600(2987)[0m | [32mExpert 40: 2.400(2963)[0m | [32mExpert  6: 2.200(3026)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 36: 2.200(2948)[0m | [32mExpert 61: 2.200(3032)[0m | [32mExpert  4: 1.800(2960)[0m | [32mExpert 52: 1.800(3002)[0m | 
[32mExpert 19: 1.600(2891)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert 18: 1.600(2888)[0m | 
[32mExpert  5: 1.400(2993)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert 10: 1.000(2864)[0m | 
[32mExpert 11: 1.000(2867)[0m | [32mExpert 58: 0.800(3020)[0m | [32mExpert 31: 0.800(2933)[0m | [32mExpert 32: 0.800(2936)[0m | 
[32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | [32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | 
[32mExpert 26: 0.600(2915)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 38: 0.600(2954)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2867, 3020, 2933, 2936, 2939, 2894, 2909, 2912, 2915, 2930, 2942, 2954]
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2, 11, 24, 25, 26, 30, 31, 32, 33, 34, 38, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[29]:5.0 | [30]:2.0 | [33]:4.0 | [40]:1.0 | [44]:5.0 | [41]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[9]:5.0 | [28]:5.0 | [33]:4.0 | [50]:4.0 | [63]:2.0 | [30]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:5.0 | [4]:2.0 | [6]:3.0 | [15]:3.0 | [16]:5.0 | [49]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 16 MLP ==
[0m
[15]:4.0 | [17]:4.0 | [24]:5.0 | [41]:5.0 | [50]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[25]:5.0 | [40]:5.0 | [53]:1.0 | [56]:1.0 | [57]:3.0 | [15]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[23]:2.0 | [40]:3.0 | [46]:5.0 | [51]:2.0 | [53]:5.0 | [18]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[23, 40, 46, 51, 53, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 3.600(4205)[0m | [32mExpert 27: 3.400(4136)[0m | [32mExpert 14: 3.200(4094)[0m | [32mExpert 21: 3.000(4118)[0m | 
[32mExpert 62: 3.000(4253)[0m | [32mExpert 42: 2.200(4187)[0m | [32mExpert 61: 2.200(4250)[0m | [32mExpert 55: 2.200(4229)[0m | 
[32mExpert 59: 2.200(4241)[0m | [32mExpert 19: 2.000(4109)[0m | [32mExpert  2: 1.800(4112)[0m | [32mExpert 12: 1.600(4088)[0m | 
[32mExpert 54: 1.600(4226)[0m | EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
[32mExpert 10: 1.600(4082)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | 
[32mExpert 53: 1.400(4223)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | [32mExpert 16: 1.200(4100)[0m | 
[32mExpert 17: 1.200(4103)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 28: 1.000(4139)[0m | 
[32mExpert 56: 1.000(4232)[0m | [32mExpert  8: 0.800(4262)[0m | [32mExpert 25: 0.800(4130)[0m | [32mExpert 43: 0.800(4190)[0m | 
[32mExpert 44: 0.800(4193)[0m | [32mExpert 52: 0.800(4220)[0m | [32mExpert  6: 0.600(4244)[0m | [32mExpert 31: 0.600(4151)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4103, 4217, 4265, 4139, 4232, 4262, 4130, 4190, 4193, 4220, 4244, 4151]
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  8,  9, 17, 25, 28, 31, 43, 44, 51, 52, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[13]:1.0 | [14]:5.0 | [41]:4.0 | [47]:4.0 | [60]:4.0 | [37]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[15]:5.0 | [25]:4.0 | [37]:2.0 | [50]:5.0 | [56]:1.0 | [22]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[8]:2.0 | [14]:4.0 | [27]:3.0 | [42]:3.0 | [61]:3.0 | [48]:5.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:5.0 | [35]:4.0 | [37]:2.0 | [39]:2.0 | [60]:4.0 | [50]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[7]:4.0 | [11]:1.0 | [23]:4.0 | [32]:1.0 | [57]:4.0 | [58]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[19]:2.0 | [24]:2.0 | [28]:4.0 | [37]:3.0 | [50]:3.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[19, 24, 28, 37, 50, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:5.0 | [10]:4.0 | [39]:2.0 | [49]:1.0 | [57]:3.0 | [12]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[3]:1.0 | [26]:3.0 | [30]:3.0 | [34]:4.0 | [36]:2.0 | [56]:5.0 | 
---------------------------------------
return EAMC[1]
ä¸­æ–‡EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[6]:1.0 | [7]:1.0 | [30]:1.0 | [33]:1.0 | [62]:1.0 | [46]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[14]:3.0 | [27]:2.0 | [35]:4.0 | [42]:3.0 | [61]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[3]:1.0 | [8]:1.0 | [28]:1.0 | [38]:1.0 | [42]:4.0 | [0]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[5]:1.0 | [11]:2.0 | [24]:1.0 | [25]:1.0 | [35]:1.0 | [4]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[13]:1.0 | [19]:2.0 | [35]:1.0 | [42]:2.0 | [44]:1.0 | [34]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[19]:4.0 | [20]:1.0 | [41]:1.0 | [57]:1.0 | [63]:1.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[19, 20, 41, 57, 63, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.400(2728)[0m | [32mExpert 46: 5.400(2743)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 53: 4.800(2767)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 38: 2.800(2716)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert 33: 2.200(2701)[0m | [32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert 13: 1.800(2635)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 31: 1.400(2695)[0m | 
[32mExpert  7: 1.400(2803)[0m | [32mExpert 12: 1.200(2632)[0m | [32mExpert 61: 1.200(2794)[0m | [32mExpert 16: 1.200(2644)[0m | 
[32mExpert 34: 1.200(2704)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | [32mExpert 50: 1.000(2758)[0m | 
[32mExpert 55: 1.000(2773)[0m | [32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 24: 0.800(2671)[0m | 
[32mExpert 32: 0.800(2698)[0m | [32mExpert 23: 0.600(2668)[0m | [32mExpert 47: 0.600(2746)[0m | [32mExpert 51: 0.600(2761)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2680, 2809, 2758, 2773, 2656, 2629, 2671, 2698, 2668, 2746, 2761]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  9, 11, 23, 24, 27, 32, 34, 47, 50, 51, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[9]:1.0 | [34]:1.0 | [39]:1.0 | [44]:2.0 | [62]:2.0 | [5]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[1]:1.0 | [13]:1.0 | [16]:1.0 | [49]:4.0 | [58]:1.0 | [39]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[0]:1.0 | [4]:1.0 | [7]:1.0 | [23]:1.0 | [26]:1.0 | [51]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[16]:1.0 | [20]:1.0 | [33]:1.0 | [45]:1.0 | [59]:6.0 | [49]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:1.0 | [16]:4.0 | [27]:2.0 | [40]:1.0 | [62]:1.0 | [53]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[21]:1.0 | [22]:1.0 | [31]:1.0 | [44]:1.0 | [45]:2.0 | [61]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[21, 22, 31, 44, 45, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  0: 5.200(2858)[0m | [32mExpert 15: 4.000(2879)[0m | 
[32mExpert  6: 3.000(3026)[0m | [32mExpert  4: 2.600(2960)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 40: 2.400(2963)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert 61: 2.200(3032)[0m | [32mExpert 52: 1.800(3002)[0m | 
[32mExpert 19: 1.600(2891)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert 18: 1.600(2888)[0m | 
[32mExpert  5: 1.400(2993)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert 10: 1.000(2864)[0m | 
[32mExpert 11: 1.000(2867)[0m | [32mExpert 58: 0.800(3020)[0m | [32mExpert 31: 0.800(2933)[0m | [32mExpert 32: 0.800(2936)[0m | 
[32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | [32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | 
[32mExpert 26: 0.600(2915)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 38: 0.600(2954)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2867, 3020, 2933, 2936, 2939, 2894, 2909, 2912, 2915, 2930, 2942, 2954]
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2, 11, 24, 25, 26, 30, 31, 32, 33, 34, 38, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:2.0 | [22]:1.0 | [29]:6.0 | [54]:1.0 | [61]:1.0 | [63]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:2.0 | [44]:1.0 | [55]:1.0 | [59]:1.0 | [63]:3.0 | [18]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[4]:3.0 | [15]:4.0 | [32]:1.0 | [36]:2.0 | [39]:1.0 | [5]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[12]:1.0 | [18]:1.0 | [45]:1.0 | [61]:1.0 | [63]:2.0 | [20]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[10]:1.0 | [32]:1.0 | [36]:1.0 | [51]:1.0 | [61]:1.0 | [9]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:1.0 | [17]:2.0 | [18]:5.0 | [44]:1.0 | [49]:2.0 | [14]:1.0 | EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4151
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1334,1f0000002b] (16MB) STATE(0) TENSOR[4150,4151,4149,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22

---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1, 17, 18, 44, 49, 14]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 4.400(4205)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 21: 3.000(4118)[0m | 
[32mExpert 42: 3.000(4187)[0m | [32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 55: 2.200(4229)[0m | 
[32mExpert 59: 2.200(4241)[0m | [32mExpert 19: 2.000(4109)[0m | [32mExpert  2: 1.800(4112)[0m | [32mExpert  8: 1.600(4262)[0m | 
[32mExpert 12: 1.600(4088)[0m | [32mExpert 54: 1.600(4226)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert 13: 1.600(4091)[0m | 
[32mExpert 45: 1.600(4196)[0m | [32mExpert 53: 1.400(4223)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | 
[32mExpert 16: 1.200(4100)[0m | [32mExpert 17: 1.200(4103)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert  9: 1.000(4265)[0m | 
[32mExpert 28: 1.000(4139)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 25: 0.800(4130)[0m | [32mExpert 43: 0.800(4190)[0m | 
[32mExpert 44: 0.800(4193)[0m | [32mExpert 52: 0.800(4220)[0m | [32mExpert  6: 0.600(4244)[0m | [32mExpert 31: 0.600(4151)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4100, 4103, 4217, 4265, 4139, 4232, 4130, 4190, 4193, 4220, 4244, 4151]
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4151[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  9, 16, 17, 25, 28, 31, 43, 44, 51, 52, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:1.0 | [4]:1.0 | [5]:2.0 | [35]:1.0 | [38]:1.0 | [9]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[12]:1.0 | [36]:2.0 | [37]:3.0 | [56]:2.0 | [61]:1.0 | [55]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[2]:2.0 | [8]:3.0 | [10]:1.0 | [18]:1.0 | [48]:6.0 | [0]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 22 MLP ==
[0m
[35]:5.0 | [42]:2.0 | [47]:1.0 | [55]:2.0 | [63]:1.0 | [5]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[5]:2.0 | [13]:2.0 | [33]:1.0 | [46]:1.0 | [57]:5.0 | [58]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[7]:1.0 | [19]:3.0 | [24]:3.0 | [28]:5.0 | [36]:2.0 | [60]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 7, 19, 24, 28, 36, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:6.0 | [18]:1.0 | [26]:1.0 | [28]:1.0 | [54]:4.0 | [6]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[10]:1.0 | [17]:1.0 | [42]:3.0 | [46]:1.0 | [62]:1.0 | [61]:1.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2671
[1m[33mEnqueueTask: [0m[32mTask: node: ID[547,1800000013] (16MB) STATE(0) TENSOR[2670,2671,2669,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[16]:1.0 | [38]:1.0 | [44]:1.0 | [53]:1.0 | [56]:4.0 | [33]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[6]:1.0 | [13]:1.0 | [14]:4.0 | [22]:2.0 | [40]:1.0 | [36]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[0]:6.0 | [14]:1.0 | [28]:2.0 | [52]:1.0 | [56]:1.0 | [21]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[1]:1.0 | [2]:1.0 | [25]:2.0 | [48]:1.0 | [51]:1.0 | [46]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[6]:1.0 | [20]:2.0 | [41]:5.0 | [44]:2.0 | [63]:1.0 | [61]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[1]:1.0 | [6]:3.0 | [20]:2.0 | [41]:2.0 | [47]:2.0 | [32]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 1,  6, 20, 41, 47, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.400(2728)[0m | [32mExpert 46: 5.400(2743)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 53: 4.800(2767)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 38: 2.800(2716)[0m | [32mExpert 26: 2.400(2677)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  7: 2.200(2803)[0m | [32mExpert 33: 2.200(2701)[0m | 
[32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert 23: 1.400(2668)[0m | [32mExpert 31: 1.400(2695)[0m | [32mExpert 51: 1.400(2761)[0m | [32mExpert  4: 1.200(2722)[0m | 
[32mExpert 12: 1.200(2632)[0m | [32mExpert 61: 1.200(2794)[0m | [32mExpert 16: 1.200(2644)[0m | [32mExpert 34: 1.200(2704)[0m | 
[32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | [32mExpert 50: 1.000(2758)[0m | [32mExpert 55: 1.000(2773)[0m | 
[32mExpert  0: 0.800(2620)[0m | [32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 24: 0.800(2671)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2632, 2794, 2644, 2704, 2680, 2809, 2758, 2773, 2620, 2656, 2629, 2671]
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2671[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  9, 11, 12, 16, 24, 27, 34, 50, 55, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:2.0 | [34]:2.0 | [44]:3.0 | [46]:1.0 | [62]:3.0 | [18]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[13]:2.0 | [26]:1.0 | [30]:2.0 | [39]:3.0 | [49]:5.0 | [15]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[0]:2.0 | [4]:2.0 | [16]:1.0 | [18]:1.0 | [50]:1.0 | [38]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E16 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[9]:2.0 | [13]:2.0 | [14]:1.0 | [25]:1.0 | [33]:2.0 | [45]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:2.0 | [16]:5.0 | [17]:2.0 | [22]:1.0 | [49]:1.0 | [40]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[33]:1.0 | [45]:3.0 | [56]:1.0 | [59]:2.0 | [62]:1.0 | [47]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[33, 45, 56, 59, 62, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  0: 5.200(2858)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert  4: 3.400(2960)[0m | [32mExpert  6: 3.000(3026)[0m | [32mExpert 36: 3.000(2948)[0m | [32mExpert 48: 2.600(2987)[0m | 
[32mExpert 40: 2.400(2963)[0m | [32mExpert  5: 2.200(2993)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 61: 2.200(3032)[0m | 
[32mExpert 52: 1.800(3002)[0m | [32mExpert 19: 1.600(2891)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 32: 1.600(2936)[0m | 
[32mExpert 55: 1.600(3011)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | 
[32mExpert 10: 1.000(2864)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 39: 0.800(2957)[0m | [32mExpert 58: 0.800(3020)[0m | 
[32mExpert 31: 0.800(2933)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | [32mExpert 24: 0.600(2909)[0m | 
[32mExpert 25: 0.600(2912)[0m | [32mExpert 26: 0.600(2915)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 34: 0.600(2942)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2864, 2867, 2957, 3020, 2933, 2939, 2894, 2909, 2912, 2915, 2930, 2942]
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2, 10, 11, 24, 25, 26, 30, 31, 33, 34, 39, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:3.0 | [15]:1.0 | [45]:1.0 | [48]:1.0 | [58]:2.0 | [35]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[0]:1.0 | [19]:1.0 | [27]:2.0 | [47]:1.0 | [48]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[5]:3.0 | [11]:1.0 | [30]:1.0 | [40]:1.0 | [55]:2.0 | [6]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E11 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E30 â•‘[0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:2.0 | [16]:3.0 | [33]:3.0 | [37]:1.0 | [53]:1.0 | [26]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[10]:2.0 | [26]:3.0 | [38]:1.0 | [48]:1.0 | [62]:3.0 | [31]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[13]:2.0 | [30]:3.0 | [32]:1.0 | [58]:1.0 | [59]:1.0 | [17]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[13, 30, 32, 58, 59, 17]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 5.200(4205)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 21: 3.000(4118)[0m | 
[32mExpert 42: 3.000(4187)[0m | [32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert  2: 2.600(4112)[0m | 
[32mExpert  8: 2.400(4262)[0m | [32mExpert 10: 2.400(4082)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | 
[32mExpert 19: 2.000(4109)[0m | [32mExpert 12: 1.600(4088)[0m | [32mExpert 54: 1.600(4226)[0m | [32mExpert 13: 1.600(4091)[0m | 
[32mExpert 45: 1.600(4196)[0m | [32mExpert 53: 1.400(4223)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | 
[32mExpert 16: 1.200(4100)[0m | [32mExpert 17: 1.200(4103)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert  0: 1.000(4076)[0m | 
[32mExpert  9: 1.000(4265)[0m | [32mExpert 18: 1.000(4106)[0m | [32mExpert 28: 1.000(4139)[0m | [32mExpert 56: 1.000(4232)[0m | 
[32mExpert 25: 0.800(4130)[0m | [32mExpert 43: 0.800(4190)[0m | [32mExpert 44: 0.800(4193)[0m | [32mExpert 52: 0.800(4220)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4100, 4103, 4217, 4076, 4265, 4106, 4139, 4232, 4130, 4190, 4193, 4220]
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  9, 16, 17, 18, 25, 28, 43, 44, 51, 52, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:2.0 | [6]:2.0 | [22]:1.0 | [24]:4.0 | [58]:1.0 | [25]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[10]:1.0 | [13]:1.0 | [33]:1.0 | [36]:3.0 | [43]:2.0 | [60]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[1]:1.0 | [17]:2.0 | [21]:3.0 | [23]:1.0 | [56]:1.0 | [10]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E56 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[3]:2.0 | [6]:1.0 | [11]:4.0 | [33]:1.0 | [49]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[0]:2.0 | [3]:3.0 | [12]:1.0 | [22]:3.0 | [47]:3.0 | [16]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[8]:1.0 | [10]:3.0 | [16]:1.0 | [53]:1.0 | [61]:4.0 | [32]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 8, 10, 16, 53, 61, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:3.0 | [23]:1.0 | [31]:1.0 | [38]:2.0 | [45]:4.0 | [44]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[11]:1.0 | [17]:2.0 | [27]:2.0 | [32]:2.0 | [57]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[1]
è°šEnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2632
[1m[33mEnqueueTask: [0m[32mTask: node: ID[535,c00000013] (16MB) STATE(0) TENSOR[2631,2632,2630,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:1.0 | [15]:1.0 | [16]:2.0 | [28]:1.0 | [50]:3.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[16]:1.0 | [23]:1.0 | [30]:2.0 | [49]:1.0 | [54]:1.0 | [4]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[14]:2.0 | [20]:1.0 | [28]:3.0 | [37]:1.0 | [42]:5.0 | [25]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[1]:2.0 | [21]:2.0 | [24]:2.0 | [25]:3.0 | [28]:1.0 | [6]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[6]:2.0 | [13]:2.0 | [30]:1.0 | [34]:2.0 | [61]:2.0 | [20]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[2]:1.0 | [3]:1.0 | [20]:3.0 | [29]:2.0 | [33]:1.0 | [26]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 2,  3, 20, 29, 33, 26]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.400(2728)[0m | [32mExpert 46: 5.400(2743)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 53: 4.800(2767)[0m | 
[32mExpert 38: 3.600(2716)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 26: 2.400(2677)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  7: 2.200(2803)[0m | [32mExpert 33: 2.200(2701)[0m | 
[32mExpert  4: 2.000(2722)[0m | [32mExpert 16: 2.000(2644)[0m | [32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert 13: 1.800(2635)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert 23: 1.400(2668)[0m | [32mExpert 31: 1.400(2695)[0m | [32mExpert 51: 1.400(2761)[0m | [32mExpert 12: 1.200(2632)[0m | 
[32mExpert 61: 1.200(2794)[0m | [32mExpert 34: 1.200(2704)[0m | [32mExpert 18: 1.000(2650)[0m | [32mExpert 27: 1.000(2680)[0m | 
[32mExpert  9: 1.000(2809)[0m | [32mExpert 55: 1.000(2773)[0m | [32mExpert  2: 0.800(2656)[0m | [32mExpert 11: 0.800(2629)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2668, 2695, 2761, 2632, 2794, 2704, 2650, 2680, 2809, 2773, 2656, 2629]
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2632[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  9, 11, 12, 18, 23, 27, 31, 34, 51, 55, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[9]:2.0 | [37]:1.0 | [44]:4.0 | [49]:1.0 | [62]:4.0 | [10]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[9]:1.0 | [14]:1.0 | [15]:2.0 | [16]:2.0 | [39]:4.0 | [38]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[7]:2.0 | [12]:2.0 | [23]:2.0 | [60]:1.0 | [63]:1.0 | [22]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[13]:3.0 | [20]:2.0 | [34]:1.0 | [45]:3.0 | [49]:2.0 | [16]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:3.0 | [17]:3.0 | [22]:2.0 | [33]:1.0 | [55]:1.0 | [16]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[18]:1.0 | [31]:2.0 | [33]:2.0 | [45]:4.0 | [59]:3.0 | [16]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[18, 31, 33, 45, 59, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  0: 5.200(2858)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert  6: 3.800(3026)[0m | [32mExpert  4: 3.400(2960)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert  5: 3.000(2993)[0m | 
[32mExpert 36: 3.000(2948)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 55: 2.400(3011)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 61: 2.200(3032)[0m | [32mExpert 11: 1.800(2867)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 19: 1.600(2891)[0m | 
[32mExpert 14: 1.600(2876)[0m | [32mExpert 32: 1.600(2936)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert 30: 1.400(2930)[0m | 
[32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 39: 0.800(2957)[0m | 
[32mExpert 58: 0.800(3020)[0m | [32mExpert 31: 0.800(2933)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | 
[32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | [32mExpert 26: 0.600(2915)[0m | [32mExpert 34: 0.600(2942)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3047, 2924, 2864, 2957, 3020, 2933, 2939, 2894, 2909, 2912, 2915, 2942]
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  9, 10, 24, 25, 26, 29, 31, 33, 34, 39, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:2.0 | [11]:4.0 | [14]:1.0 | [55]:1.0 | [63]:2.0 | [58]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[18]:2.0 | [19]:2.0 | [31]:1.0 | [46]:1.0 | [47]:2.0 | [59]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[4]:4.0 | [5]:4.0 | [11]:2.0 | [36]:3.0 | [41]:1.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 16 MLP ==
[0m
[9]:3.0 | [26]:3.0 | [30]:2.0 | [45]:2.0 | [47]:1.0 | [5]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[27]:1.0 | [28]:2.0 | [38]:2.0 | [41]:2.0 | [45]:1.0 | [9]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[0]:1.0 | [1]:2.0 | [14]:2.0 | [50]:1.0 | [58]:2.0 | [59]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 0,  1, 14, 50, 58, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[90mTop 20 Experts:[0m
[32mExpert 48: 5.200(4205)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 21: 3.800(4118)[0m | 
[32mExpert 10: 3.200(4082)[0m | [32mExpert 42: 3.000(4187)[0m | [32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | 
[32mExpert 17: 2.000(4103)[0m | [32mExpert 19: 2.000(4109)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 12: 1.600(4088)[0m | 
[32mExpert 54: 1.600(4226)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | [32mExpert 53: 1.400(4223)[0m | 
[32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | [32mExpert  1: 1.200(4079)[0m | [32mExpert 16: 1.200(4100)[0m | 
[32mExpert 51: 1.200(4217)[0m | [32mExpert  0: 1.000(4076)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 18: 1.000(4106)[0m | 
[32mExpert 28: 1.000(4139)[0m | [32mExpert 23: 0.800(4124)[0m | [32mExpert 25: 0.800(4130)[0m | [32mExpert 43: 0.800(4190)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4133, 4184, 4079, 4100, 4217, 4076, 4265, 4106, 4139, 4124, 4130, 4190]
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  9, 16, 18, 23, 25, 26, 28, 41, 43, 51 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:2.0 | [6]:3.0 | [38]:2.0 | [40]:2.0 | [49]:1.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[11]:1.0 | [20]:2.0 | [38]:3.0 | [46]:1.0 | [48]:1.0 | [10]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[5]:1.0 | [15]:1.0 | [28]:2.0 | [30]:1.0 | [36]:1.0 | [56]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E28 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[32]:1.0 | [33]:2.0 | [49]:2.0 | [57]:2.0 | [58]:2.0 | [62]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[12]:2.0 | [15]:1.0 | [21]:1.0 | [41]:1.0 | [59]:1.0 | [47]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[5]:2.0 | [23]:2.0 | [35]:1.0 | [39]:1.0 | [51]:2.0 | [60]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 5, 23, 35, 39, 51, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[18]:2.0 | [19]:1.0 | [33]:1.0 | [47]:2.0 | [54]:5.0 | [41]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[10]:2.0 | [13]:1.0 | [14]:2.0 | [32]:3.0 | [47]:1.0 | [51]:2.0 | 
---------------------------------------
return EAMC[1]
è¯­EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[22]:1.0 | [28]:2.0 | [29]:2.0 | [48]:1.0 | [49]:1.0 | [23]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[2]:2.0 | [4]:2.0 | [30]:3.0 | [49]:2.0 | [53]:1.0 | [54]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[20]:2.0 | [25]:3.0 | [28]:4.0 | [33]:1.0 | [37]:2.0 | [40]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[1]:3.0 | [6]:2.0 | [9]:1.0 | [24]:3.0 | [28]:2.0 | [62]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[6]:3.0 | [13]:3.0 | [30]:2.0 | [34]:3.0 | [61]:3.0 | [19]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[2]:2.0 | [3]:2.0 | [20]:4.0 | [29]:3.0 | [33]:2.0 | [47]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 2,  3, 20, 29, 33, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 5.400(2728)[0m | [32mExpert 46: 5.400(2743)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 53: 4.800(2767)[0m | 
[32mExpert 38: 3.600(2716)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert  7: 3.000(2803)[0m | [32mExpert 22: 2.400(2665)[0m | 
[32mExpert 26: 2.400(2677)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 23: 2.200(2668)[0m | [32mExpert 35: 2.200(2707)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert 33: 2.200(2701)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 12: 2.000(2632)[0m | 
[32mExpert 16: 2.000(2644)[0m | [32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | [32mExpert 31: 1.400(2695)[0m | [32mExpert 51: 1.400(2761)[0m | 
[32mExpert 60: 1.200(2791)[0m | [32mExpert 61: 1.200(2794)[0m | [32mExpert 63: 1.200(2800)[0m | [32mExpert 34: 1.200(2704)[0m | 
[32mExpert 18: 1.000(2650)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | [32mExpert 55: 1.000(2773)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2758, 2620, 2695, 2761, 2791, 2794, 2800, 2704, 2650, 2680, 2809, 2773]
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  9, 18, 27, 31, 34, 50, 51, 55, 60, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:3.0 | [7]:1.0 | [9]:3.0 | [44]:5.0 | [49]:2.0 | [10]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[9]:2.0 | [15]:3.0 | [16]:3.0 | [17]:1.0 | [38]:2.0 | [49]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[7]:3.0 | [23]:3.0 | [46]:6.0 | [60]:2.0 | [63]:2.0 | [26]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E60 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E63 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[16]:3.0 | [20]:3.0 | [33]:3.0 | [45]:4.0 | [59]:7.0 | [34]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:4.0 | [13]:1.0 | [16]:7.0 | [33]:2.0 | [53]:4.0 | [55]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[8]:1.0 | [18]:2.0 | [22]:2.0 | [31]:3.0 | [45]:5.0 | [25]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 8, 18, 22, 31, 45, 25]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  0: 5.200(2858)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert  4: 4.200(2960)[0m | [32mExpert  5: 3.800(2993)[0m | [32mExpert  6: 3.800(3026)[0m | [32mExpert 36: 3.800(2948)[0m | 
[32mExpert 40: 3.200(2963)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 55: 2.400(3011)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 61: 2.200(3032)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 19: 1.600(2891)[0m | 
[32mExpert 14: 1.600(2876)[0m | [32mExpert 32: 1.600(2936)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert 30: 1.400(2930)[0m | 
[32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 42: 1.000(2969)[0m | 
[32mExpert 39: 0.800(2957)[0m | [32mExpert 41: 0.800(2966)[0m | [32mExpert 58: 0.800(3020)[0m | [32mExpert 31: 0.800(2933)[0m | 
[32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | [32mExpert 24: 0.600(2909)[0m | [32mExpert 25: 0.600(2912)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3047, 2924, 2864, 2969, 2957, 2966, 3020, 2933, 2939, 2894, 2909, 2912]
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  9, 10, 24, 25, 29, 31, 33, 39, 41, 42, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:5.0 | [30]:3.0 | [55]:2.0 | [60]:1.0 | [63]:3.0 | [36]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:3.0 | [42]:1.0 | [55]:2.0 | [59]:3.0 | [63]:4.0 | [38]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:6.0 | [4]:5.0 | [36]:4.0 | [42]:2.0 | [43]:1.0 | [32]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[24]:6.0 | [25]:1.0 | [41]:6.0 | [45]:3.0 | [50]:3.0 | [61]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[41]:3.0 | [45]:2.0 | [57]:4.0 | [58]:1.0 | [61]:2.0 | [27]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:3.0 | [8]:3.0 | [14]:3.0 | [18]:6.0 | [44]:2.0 | [49]:3.0 | EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9

---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1,  8, 14, 18, 44, 49]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 5.200(4205)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 21: 3.800(4118)[0m | 
[32mExpert 10: 3.200(4082)[0m | [32mExpert 42: 3.000(4187)[0m | [32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert 56: 2.600(4232)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 55: 2.200(4229)[0m | 
[32mExpert 59: 2.200(4241)[0m | [32mExpert 17: 2.000(4103)[0m | [32mExpert 19: 2.000(4109)[0m | [32mExpert 28: 1.800(4139)[0m | 
[32mExpert 12: 1.600(4088)[0m | [32mExpert 54: 1.600(4226)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | 
[32mExpert 53: 1.400(4223)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 41: 1.400(4184)[0m | [32mExpert  1: 1.200(4079)[0m | 
[32mExpert  5: 1.200(4211)[0m | [32mExpert 15: 1.200(4097)[0m | [32mExpert 16: 1.200(4100)[0m | [32mExpert 51: 1.200(4217)[0m | 
[32mExpert  0: 1.000(4076)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 18: 1.000(4106)[0m | [32mExpert 30: 1.000(4148)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4223, 4133, 4184, 4079, 4211, 4097, 4100, 4217, 4076, 4265, 4106, 4148]
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  9, 15, 16, 18, 26, 30, 41, 51, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:3.0 | [9]:3.0 | [14]:6.0 | [38]:3.0 | [49]:2.0 | [50]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[4]:1.0 | [15]:6.0 | [32]:1.0 | [37]:4.0 | [54]:1.0 | [12]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[0]:2.0 | [25]:2.0 | [26]:1.0 | [41]:1.0 | [48]:7.0 | [18]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E18 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[5]:4.0 | [35]:6.0 | [46]:1.0 | [47]:2.0 | [56]:1.0 | [33]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[5]:3.0 | [16]:4.0 | [33]:2.0 | [46]:2.0 | [57]:6.0 | [0]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[19]:4.0 | [24]:4.0 | [28]:6.0 | [45]:1.0 | [60]:5.0 | [52]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[19, 24, 28, 45, 60, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:7.0 | [7]:1.0 | [18]:3.0 | [44]:2.0 | [47]:3.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[10]:3.0 | [25]:1.0 | [26]:4.0 | [37]:1.0 | [48]:2.0 | [38]:2.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[25]:1.0 | [26]:3.0 | [55]:1.0 | [60]:2.0 | [62]:2.0 | [13]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[15]:1.0 | [19]:1.0 | [36]:3.0 | [47]:1.0 | [60]:2.0 | [35]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[9]:2.0 | [15]:1.0 | [22]:5.0 | [48]:4.0 | [62]:2.0 | [60]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[13]:4.0 | [26]:3.0 | [29]:3.0 | [57]:1.0 | [59]:4.0 | [41]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[10]:2.0 | [15]:2.0 | [41]:6.0 | [60]:1.0 | [63]:2.0 | [42]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[6]:4.0 | [23]:1.0 | [33]:3.0 | [35]:3.0 | [39]:2.0 | [55]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 6, 23, 33, 35, 39, 55]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.200(2743)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 53: 4.800(2767)[0m | 
[32mExpert  7: 3.800(2803)[0m | [32mExpert 38: 3.600(2716)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 23: 3.000(2668)[0m | [32mExpert 22: 2.400(2665)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert 33: 2.200(2701)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 12: 2.000(2632)[0m | 
[32mExpert 60: 2.000(2791)[0m | [32mExpert 63: 2.000(2800)[0m | [32mExpert 16: 2.000(2644)[0m | [32mExpert 17: 2.000(2647)[0m | 
[32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | 
[32mExpert 31: 1.400(2695)[0m | [32mExpert 51: 1.400(2761)[0m | [32mExpert 61: 1.200(2794)[0m | [32mExpert 34: 1.200(2704)[0m | 
[32mExpert 18: 1.000(2650)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | [32mExpert 55: 1.000(2773)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2737, 2635, 2758, 2620, 2695, 2761, 2794, 2704, 2650, 2680, 2809, 2773]
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  9, 13, 18, 27, 31, 34, 44, 50, 51, 55, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:5.0 | [12]:2.0 | [16]:3.0 | [41]:6.0 | [50]:6.0 | [32]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[8]:6.0 | [18]:3.0 | [26]:2.0 | [31]:1.0 | [46]:6.0 | [50]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[38]:5.0 | [46]:7.0 | [47]:1.0 | [53]:4.0 | [61]:2.0 | [17]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[39]:1.0 | [41]:6.0 | [50]:4.0 | [51]:3.0 | [59]:8.0 | [33]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[28]:6.0 | [34]:3.0 | [43]:6.0 | [51]:1.0 | [53]:5.0 | [4]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[12]:2.0 | [28]:2.0 | [45]:6.0 | [47]:2.0 | [61]:2.0 | [50]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[12, 28, 45, 47, 61, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  0: 6.000(2858)[0m | [32mExpert  4: 5.000(2960)[0m | 
[32mExpert 15: 4.800(2879)[0m | [32mExpert 36: 4.600(2948)[0m | [32mExpert  5: 3.800(2993)[0m | [32mExpert  6: 3.800(3026)[0m | 
[32mExpert 40: 3.200(2963)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 32: 2.400(2936)[0m | 
[32mExpert 55: 2.400(3011)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 61: 2.200(3032)[0m | [32mExpert 42: 1.800(2969)[0m | 
[32mExpert 52: 1.800(3002)[0m | [32mExpert 19: 1.600(2891)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 18: 1.600(2888)[0m | 
[32mExpert 30: 1.400(2930)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 29: 1.200(2924)[0m | [32mExpert 10: 1.000(2864)[0m | 
[32mExpert 43: 1.000(2972)[0m | [32mExpert 39: 0.800(2957)[0m | [32mExpert 41: 0.800(2966)[0m | [32mExpert 58: 0.800(3020)[0m | 
[32mExpert 31: 0.800(2933)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  2: 0.600(2894)[0m | [32mExpert 24: 0.600(2909)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2930, 3047, 2924, 2864, 2972, 2957, 2966, 3020, 2933, 2939, 2894, 2909]
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  9, 10, 24, 29, 30, 31, 33, 39, 41, 43, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[16]:1.0 | [17]:2.0 | [33]:5.0 | [43]:1.0 | [48]:2.0 | [10]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[47]:3.0 | [53]:1.0 | [57]:1.0 | [59]:4.0 | [63]:5.0 | [0]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:7.0 | [6]:5.0 | [23]:1.0 | [33]:1.0 | [61]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E29 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:3.0 | [15]:5.0 | [16]:4.0 | [24]:7.0 | [41]:7.0 | [38]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[15]:3.0 | [31]:2.0 | [42]:1.0 | [57]:5.0 | [62]:4.0 | [53]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[18]:7.0 | [23]:3.0 | [30]:4.0 | [40]:4.0 | [53]:6.0 | [59]:3.0 | EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10

---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[18, 23, 30, 40, 53, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.000(4205)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 21: 3.800(4118)[0m | 
[32mExpert 10: 3.200(4082)[0m | [32mExpert 42: 3.000(4187)[0m | [32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert 56: 2.600(4232)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 26: 2.200(4133)[0m | 
[32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert 17: 2.000(4103)[0m | 
[32mExpert 19: 2.000(4109)[0m | [32mExpert  0: 1.800(4076)[0m | [32mExpert 18: 1.800(4106)[0m | [32mExpert 28: 1.800(4139)[0m | 
[32mExpert 25: 1.600(4130)[0m | [32mExpert 12: 1.600(4088)[0m | [32mExpert 54: 1.600(4226)[0m | [32mExpert 13: 1.600(4091)[0m | 
[32mExpert 45: 1.600(4196)[0m | [32mExpert 53: 1.400(4223)[0m | [32mExpert  1: 1.200(4079)[0m | [32mExpert  5: 1.200(4211)[0m | 
[32mExpert 15: 1.200(4097)[0m | [32mExpert 16: 1.200(4100)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert  9: 1.000(4265)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4130, 4088, 4226, 4091, 4196, 4223, 4079, 4211, 4097, 4100, 4217, 4265]
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  5,  9, 12, 13, 15, 16, 25, 45, 51, 53, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[13]:2.0 | [22]:2.0 | [58]:2.0 | [60]:5.0 | [61]:2.0 | [6]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[12]:3.0 | [13]:2.0 | [33]:2.0 | [38]:4.0 | [43]:3.0 | [7]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[6]:1.0 | [25]:3.0 | [42]:4.0 | [54]:2.0 | [56]:3.0 | [53]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E54 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:2.0 | [44]:2.0 | [48]:1.0 | [50]:3.0 | [63]:2.0 | [23]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[11]:2.0 | [16]:5.0 | [26]:1.0 | [40]:3.0 | [58]:4.0 | [12]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[26]:1.0 | [50]:4.0 | [60]:6.0 | [61]:5.0 | [62]:2.0 | [52]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[26, 50, 60, 61, 62, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:8.0 | [26]:2.0 | [44]:3.0 | [52]:1.0 | [63]:3.0 | [35]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[19]:1.0 | [26]:5.0 | [34]:5.0 | [42]:4.0 | [63]:2.0 | [9]:2.0 | 
---------------------------------------
return EAMC[1]
'å¡EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[6]:2.0 | [16]:3.0 | [32]:1.0 | [38]:2.0 | [53]:2.0 | [35]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[33]:1.0 | [35]:6.0 | [39]:1.0 | [42]:4.0 | [63]:6.0 | [31]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[3]:2.0 | [14]:3.0 | [25]:4.0 | [38]:2.0 | [61]:1.0 | [39]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[2]:2.0 | [21]:3.0 | [31]:2.0 | [37]:1.0 | [49]:2.0 | [32]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[28]:1.0 | [35]:2.0 | [42]:4.0 | [44]:3.0 | [63]:3.0 | [55]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[6]:5.0 | [20]:5.0 | [26]:2.0 | [27]:1.0 | [41]:3.0 | [59]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 6, 20, 26, 27, 41, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 45: 5.000(2740)[0m | 
[32mExpert 38: 4.400(2716)[0m | [32mExpert  7: 3.800(2803)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 23: 3.000(2668)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 22: 2.400(2665)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 33: 2.200(2701)[0m | [32mExpert  4: 2.000(2722)[0m | 
[32mExpert 12: 2.000(2632)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert 61: 2.000(2794)[0m | [32mExpert 63: 2.000(2800)[0m | 
[32mExpert 16: 2.000(2644)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 50: 1.800(2758)[0m | 
[32mExpert  0: 1.600(2620)[0m | [32mExpert 31: 1.400(2695)[0m | [32mExpert 47: 1.400(2746)[0m | [32mExpert 51: 1.400(2761)[0m | 
[32mExpert 34: 1.200(2704)[0m | [32mExpert 18: 1.000(2650)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert  9: 1.000(2809)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2644, 2737, 2635, 2758, 2620, 2695, 2746, 2761, 2704, 2650, 2680, 2809]
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  9, 13, 16, 18, 27, 31, 34, 44, 47, 50, 51 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:4.0 | [15]:1.0 | [16]:4.0 | [34]:3.0 | [46]:2.0 | [2]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[13]:3.0 | [30]:3.0 | [39]:5.0 | [40]:1.0 | [54]:2.0 | [11]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[12]:3.0 | [13]:2.0 | [16]:2.0 | [32]:1.0 | [44]:2.0 | [22]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E16 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[9]:3.0 | [13]:4.0 | [18]:1.0 | [25]:2.0 | [42]:2.0 | [2]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:5.0 | [10]:2.0 | [17]:4.0 | [49]:2.0 | [59]:1.0 | [40]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[5]:1.0 | [12]:3.0 | [45]:7.0 | [56]:2.0 | [59]:4.0 | [20]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 5, 12, 45, 56, 59, 20]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 6.800(2858)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | 
[32mExpert 15: 4.800(2879)[0m | [32mExpert  6: 4.600(3026)[0m | [32mExpert 36: 4.600(2948)[0m | [32mExpert  5: 3.800(2993)[0m | 
[32mExpert 40: 3.200(2963)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 48: 2.600(2987)[0m | 
[32mExpert 32: 2.400(2936)[0m | [32mExpert 55: 2.400(3011)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 29: 2.000(2924)[0m | 
[32mExpert 42: 1.800(2969)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 19: 1.600(2891)[0m | [32mExpert 14: 1.600(2876)[0m | 
[32mExpert 33: 1.600(2939)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert 23: 1.200(2906)[0m | 
[32mExpert  9: 1.200(3047)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 43: 1.000(2972)[0m | [32mExpert 39: 0.800(2957)[0m | 
[32mExpert 41: 0.800(2966)[0m | [32mExpert 58: 0.800(3020)[0m | [32mExpert 31: 0.800(2933)[0m | [32mExpert  2: 0.600(2894)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2888, 2930, 2906, 3047, 2864, 2972, 2957, 2966, 3020, 2933, 2894]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  9, 10, 18, 23, 30, 31, 33, 39, 41, 43, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[13]:1.0 | [35]:2.0 | [46]:1.0 | [47]:2.0 | [58]:4.0 | [45]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:4.0 | [7]:3.0 | [27]:3.0 | [51]:2.0 | [61]:1.0 | [31]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[5]:5.0 | [14]:2.0 | [24]:1.0 | [41]:2.0 | [55]:3.0 | [1]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:4.0 | [19]:1.0 | [26]:4.0 | [33]:4.0 | [37]:2.0 | [20]:2.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 17 MLP ==
[0m
[26]:4.0 | [27]:3.0 | [29]:1.0 | [38]:3.0 | [54]:1.0 | [43]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:4.0 | [2]:2.0 | [33]:1.0 | [36]:1.0 | [58]:3.0 | [5]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1,  2, 33, 36, 58,  5]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.000(4205)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 21: 3.800(4118)[0m | 
[32mExpert 42: 3.800(4187)[0m | [32mExpert 56: 3.400(4232)[0m | [32mExpert 10: 3.200(4082)[0m | [32mExpert 61: 3.000(4250)[0m | 
[32mExpert 62: 3.000(4253)[0m | [32mExpert  2: 2.600(4112)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 25: 2.400(4130)[0m | 
[32mExpert 54: 2.400(4226)[0m | [32mExpert 53: 2.200(4223)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert 41: 2.200(4184)[0m | 
[32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert 17: 2.000(4103)[0m | [32mExpert 19: 2.000(4109)[0m | 
[32mExpert  0: 1.800(4076)[0m | [32mExpert 18: 1.800(4106)[0m | [32mExpert 28: 1.800(4139)[0m | [32mExpert 12: 1.600(4088)[0m | 
[32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | [32mExpert  6: 1.400(4244)[0m | [32mExpert  1: 1.200(4079)[0m | 
[32mExpert  5: 1.200(4211)[0m | [32mExpert 15: 1.200(4097)[0m | [32mExpert 16: 1.200(4100)[0m | [32mExpert 51: 1.200(4217)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4076, 4106, 4139, 4088, 4091, 4196, 4244, 4079, 4211, 4097, 4100, 4217]
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  6, 12, 13, 15, 16, 18, 28, 45, 51 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[0]:1.0 | [18]:1.0 | [22]:3.0 | [23]:2.0 | [40]:3.0 | [58]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[1]:2.0 | [13]:3.0 | [20]:3.0 | [38]:5.0 | [48]:2.0 | [36]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[6]:2.0 | [10]:3.0 | [15]:2.0 | [28]:3.0 | [46]:1.0 | [25]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E15 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E28 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[31]:1.0 | [32]:2.0 | [45]:1.0 | [54]:1.0 | [58]:3.0 | [49]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[15]:2.0 | [48]:1.0 | [56]:1.0 | [58]:5.0 | [61]:1.0 | [21]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[24]:5.0 | [26]:2.0 | [47]:2.0 | [62]:3.0 | [63]:2.0 | [5]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[24, 26, 47, 62, 63,  5]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[19]:2.0 | [31]:2.0 | [38]:3.0 | [44]:4.0 | [54]:6.0 | [41]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[11]:2.0 | [14]:3.0 | [17]:3.0 | [35]:1.0 | [62]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[1]
ç¿EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2800
[1m[33mEnqueueTask: [0m[32mTask: node: ID[586,3f00000013] (16MB) STATE(0) TENSOR[2799,2800,2798,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[35]:2.0 | [39]:1.0 | [43]:2.0 | [49]:2.0 | [53]:3.0 | [61]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[4]:3.0 | [10]:2.0 | [20]:1.0 | [31]:2.0 | [50]:1.0 | [6]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[11]:2.0 | [32]:1.0 | [35]:1.0 | [41]:1.0 | [43]:1.0 | [23]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[15]:1.0 | [33]:2.0 | [37]:2.0 | [49]:3.0 | [51]:2.0 | [1]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[8]:1.0 | [9]:1.0 | [28]:2.0 | [52]:2.0 | [54]:2.0 | [4]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[13]:2.0 | [15]:1.0 | [17]:1.0 | [22]:2.0 | [27]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[13, 15, 17, 22, 27, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 45: 5.000(2740)[0m | 
[32mExpert 38: 4.400(2716)[0m | [32mExpert  7: 3.800(2803)[0m | [32mExpert 22: 3.200(2665)[0m | [32mExpert 26: 3.200(2677)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 23: 3.000(2668)[0m | [32mExpert 12: 2.800(2632)[0m | [32mExpert 16: 2.800(2644)[0m | 
[32mExpert 17: 2.800(2647)[0m | [32mExpert 44: 2.800(2737)[0m | [32mExpert 13: 2.600(2635)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 33: 2.200(2701)[0m | [32mExpert  4: 2.000(2722)[0m | 
[32mExpert 60: 2.000(2791)[0m | [32mExpert 61: 2.000(2794)[0m | [32mExpert 63: 2.000(2800)[0m | [32mExpert 50: 1.800(2758)[0m | 
[32mExpert  0: 1.600(2620)[0m | [32mExpert 32: 1.600(2698)[0m | [32mExpert 31: 1.400(2695)[0m | [32mExpert 47: 1.400(2746)[0m | 
[32mExpert 51: 1.400(2761)[0m | [32mExpert 34: 1.200(2704)[0m | [32mExpert 18: 1.000(2650)[0m | [32mExpert 27: 1.000(2680)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2791, 2794, 2800, 2758, 2620, 2698, 2695, 2746, 2761, 2704, 2650, 2680]
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2800[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0, 18, 27, 31, 32, 34, 47, 50, 51, 60, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[28]:2.0 | [43]:2.0 | [44]:6.0 | [46]:3.0 | [58]:2.0 | [13]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[11]:3.0 | [30]:4.0 | [39]:6.0 | [47]:2.0 | [54]:3.0 | [23]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[13]:3.0 | [22]:4.0 | [31]:2.0 | [44]:3.0 | [63]:3.0 | [30]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E63 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[9]:4.0 | [16]:4.0 | [18]:2.0 | [42]:3.0 | [47]:2.0 | [15]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:6.0 | [17]:5.0 | [26]:1.0 | [59]:2.0 | [61]:1.0 | [40]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[4]:3.0 | [5]:2.0 | [31]:4.0 | [56]:3.0 | [59]:5.0 | [22]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 4,  5, 31, 56, 59, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 6.800(2858)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | 
[32mExpert 15: 4.800(2879)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert  6: 4.600(3026)[0m | [32mExpert 36: 4.600(2948)[0m | 
[32mExpert 55: 3.200(3011)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 11: 2.600(2867)[0m | 
[32mExpert 48: 2.600(2987)[0m | [32mExpert 14: 2.400(2876)[0m | [32mExpert 32: 2.400(2936)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 29: 2.000(2924)[0m | [32mExpert 42: 1.800(2969)[0m | [32mExpert 52: 1.800(3002)[0m | [32mExpert 19: 1.600(2891)[0m | 
[32mExpert 41: 1.600(2966)[0m | [32mExpert 33: 1.600(2939)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert 24: 1.400(2909)[0m | 
[32mExpert 30: 1.400(2930)[0m | [32mExpert  1: 1.200(2861)[0m | [32mExpert 23: 1.200(2906)[0m | [32mExpert  9: 1.200(3047)[0m | 
[32mExpert 10: 1.000(2864)[0m | [32mExpert 43: 1.000(2972)[0m | [32mExpert 39: 0.800(2957)[0m | [32mExpert 58: 0.800(3020)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2966, 2939, 2888, 2909, 2930, 2861, 2906, 3047, 2864, 2972, 2957, 3020]
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 10, 18, 23, 24, 30, 33, 39, 41, 43, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[14]:2.0 | [35]:3.0 | [47]:3.0 | [58]:5.0 | [63]:4.0 | [15]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[7]:4.0 | [27]:4.0 | [31]:3.0 | [47]:4.0 | [51]:3.0 | [5]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[12]:1.0 | [14]:3.0 | [24]:2.0 | [43]:2.0 | [55]:4.0 | [25]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E24 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E43 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:5.0 | [16]:5.0 | [33]:5.0 | [61]:3.0 | [63]:3.0 | [18]:2.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 17 MLP ==
[0m
[0]:2.0 | [26]:5.0 | [27]:4.0 | [32]:2.0 | [48]:2.0 | [28]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[2]:3.0 | [11]:1.0 | [32]:2.0 | [49]:4.0 | [56]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 2, 11, 32, 49, 56, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.000(4205)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert 14: 4.000(4094)[0m | 
[32mExpert 21: 3.800(4118)[0m | [32mExpert 42: 3.800(4187)[0m | [32mExpert 56: 3.400(4232)[0m | [32mExpert 25: 3.200(4130)[0m | 
[32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 28: 2.600(4139)[0m | [32mExpert  2: 2.600(4112)[0m | 
[32mExpert  8: 2.400(4262)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | [32mExpert 53: 2.200(4223)[0m | 
[32mExpert 26: 2.200(4133)[0m | [32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | 
[32mExpert 15: 2.000(4097)[0m | [32mExpert 17: 2.000(4103)[0m | [32mExpert 19: 2.000(4109)[0m | [32mExpert  0: 1.800(4076)[0m | 
[32mExpert 18: 1.800(4106)[0m | [32mExpert 12: 1.600(4088)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | 
[32mExpert  1: 1.200(4079)[0m | [32mExpert  5: 1.200(4211)[0m | [32mExpert 16: 1.200(4100)[0m | [32mExpert 46: 1.200(4199)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4097, 4103, 4109, 4076, 4106, 4088, 4091, 4196, 4079, 4211, 4100, 4199]
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5, 12, 13, 15, 16, 17, 18, 19, 45, 46 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[22]:4.0 | [23]:3.0 | [36]:1.0 | [49]:3.0 | [58]:4.0 | [5]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[1]:3.0 | [29]:1.0 | [35]:1.0 | [38]:6.0 | [59]:1.0 | [46]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[10]:4.0 | [19]:2.0 | [23]:2.0 | [30]:2.0 | [44]:1.0 | [24]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[5]:5.0 | [7]:1.0 | [33]:4.0 | [38]:1.0 | [59]:1.0 | [10]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[12]:4.0 | [15]:3.0 | [16]:6.0 | [59]:2.0 | [61]:2.0 | [47]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[4]:1.0 | [26]:3.0 | [47]:3.0 | [53]:2.0 | [60]:7.0 | [39]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 4, 26, 47, 53, 60, 39]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:2.0 | [44]:5.0 | [45]:5.0 | [54]:7.0 | [61]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[4]:1.0 | [27]:3.0 | [41]:1.0 | [50]:1.0 | [62]:3.0 | [17]:4.0 | 
---------------------------------------
return EAMC[1]
å¤±EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[11]:4.0 | [16]:4.0 | [22]:2.0 | [38]:3.0 | [58]:1.0 | [53]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[5]:1.0 | [12]:1.0 | [16]:2.0 | [22]:3.0 | [28]:1.0 | [31]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[2]:1.0 | [41]:2.0 | [52]:2.0 | [53]:1.0 | [56]:2.0 | [39]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[21]:4.0 | [27]:1.0 | [31]:3.0 | [44]:1.0 | [56]:1.0 | [2]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[28]:3.0 | [45]:1.0 | [47]:2.0 | [58]:1.0 | [63]:4.0 | [33]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[20]:6.0 | [22]:3.0 | [45]:2.0 | [60]:1.0 | [62]:1.0 | [47]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[20, 22, 45, 60, 62, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 45: 5.000(2740)[0m | 
[32mExpert 38: 4.400(2716)[0m | [32mExpert 22: 4.000(2665)[0m | [32mExpert  7: 3.800(2803)[0m | [32mExpert 44: 3.600(2737)[0m | 
[32mExpert 13: 3.400(2635)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 23: 3.000(2668)[0m | 
[32mExpert 12: 2.800(2632)[0m | [32mExpert 63: 2.800(2800)[0m | [32mExpert 16: 2.800(2644)[0m | [32mExpert 17: 2.800(2647)[0m | 
[32mExpert 19: 2.200(2653)[0m | [32mExpert 31: 2.200(2695)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | 
[32mExpert 33: 2.200(2701)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert 61: 2.000(2794)[0m | 
[32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | [32mExpert 32: 1.600(2698)[0m | [32mExpert 47: 1.400(2746)[0m | 
[32mExpert 51: 1.400(2761)[0m | [32mExpert 34: 1.200(2704)[0m | [32mExpert 18: 1.000(2650)[0m | [32mExpert 27: 1.000(2680)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2722, 2791, 2794, 2758, 2620, 2698, 2746, 2761, 2704, 2650, 2680]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4, 18, 27, 32, 33, 34, 47, 50, 51, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:1.0 | [2]:2.0 | [15]:2.0 | [35]:1.0 | [45]:1.0 | [57]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[23]:2.0 | [26]:3.0 | [40]:2.0 | [57]:1.0 | [59]:1.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[16]:3.0 | [31]:3.0 | [36]:1.0 | [42]:1.0 | [62]:1.0 | [13]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[8]:1.0 | [13]:5.0 | [15]:2.0 | [25]:3.0 | [42]:4.0 | [26]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:7.0 | [22]:3.0 | [26]:2.0 | [49]:3.0 | [59]:3.0 | [11]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[3]:2.0 | [20]:2.0 | [45]:8.0 | [51]:1.0 | [59]:6.0 | [34]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 3, 20, 45, 51, 59, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 6.800(2858)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | 
[32mExpert 15: 4.800(2879)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert  6: 4.600(3026)[0m | [32mExpert 36: 4.600(2948)[0m | 
[32mExpert 55: 4.000(3011)[0m | [32mExpert 14: 3.200(2876)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 61: 3.000(3032)[0m | 
[32mExpert 11: 2.600(2867)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 32: 2.400(2936)[0m | [32mExpert 24: 2.200(2909)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 29: 2.000(2924)[0m | [32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | 
[32mExpert 52: 1.800(3002)[0m | [32mExpert 19: 1.600(2891)[0m | [32mExpert 41: 1.600(2966)[0m | [32mExpert 33: 1.600(2939)[0m | 
[32mExpert 18: 1.600(2888)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert  1: 1.200(2861)[0m | 
[32mExpert 12: 1.200(2870)[0m | [32mExpert 23: 1.200(2906)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 10: 1.000(2864)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 2891, 2966, 2939, 2888, 2912, 2930, 2861, 2870, 2906, 3047, 2864]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 10, 12, 18, 19, 23, 25, 30, 33, 41, 52 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[13]:2.0 | [34]:2.0 | [36]:3.0 | [47]:4.0 | [58]:6.0 | [7]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[7]:5.0 | [18]:3.0 | [27]:5.0 | [51]:4.0 | [61]:2.0 | [19]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[5]:6.0 | [41]:3.0 | [47]:1.0 | [53]:1.0 | [55]:5.0 | [52]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[23]:1.0 | [30]:3.0 | [33]:6.0 | [49]:1.0 | [63]:4.0 | [53]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[0]:3.0 | [28]:4.0 | [29]:2.0 | [43]:3.0 | [54]:2.0 | [38]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:5.0 | [33]:2.0 | [47]:1.0 | [50]:2.0 | [56]:3.0 | [58]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1, 33, 47, 50, 56, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
[90mTop 20 Experts:[0m
[32mExpert 48: 6.000(4205)[0m | [32mExpert 10: 4.800(4082)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | 
[32mExpert 21: 3.800(4118)[0m | [32mExpert 42: 3.800(4187)[0m | [32mExpert 56: 3.400(4232)[0m | [32mExpert 25: 3.200(4130)[0m | 
[32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 19: 2.800(4109)[0m | [32mExpert 28: 2.600(4139)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | 
[32mExpert 53: 2.200(4223)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | 
[32mExpert 59: 2.200(4241)[0m | [32mExpert 15: 2.000(4097)[0m | [32mExpert 17: 2.000(4103)[0m | [32mExpert  0: 1.800(4076)[0m | 
[32mExpert 18: 1.800(4106)[0m | [32mExpert 30: 1.800(4148)[0m | [32mExpert 23: 1.600(4124)[0m | [32mExpert 12: 1.600(4088)[0m | 
[32mExpert 44: 1.600(4193)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | [32mExpert  1: 1.200(4079)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4241, 4097, 4103, 4076, 4106, 4148, 4124, 4088, 4193, 4091, 4196, 4079]
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1, 12, 13, 15, 17, 18, 23, 30, 44, 45, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[0]:2.0 | [18]:2.0 | [22]:5.0 | [23]:4.0 | [40]:4.0 | [2]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[1]:4.0 | [20]:4.0 | [48]:3.0 | [58]:1.0 | [59]:2.0 | [35]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[5]:2.0 | [15]:3.0 | [19]:3.0 | [21]:4.0 | [25]:5.0 | [28]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E15 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[1]:1.0 | [31]:2.0 | [33]:5.0 | [45]:2.0 | [58]:4.0 | [54]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[12]:5.0 | [43]:1.0 | [50]:1.0 | [59]:3.0 | [62]:1.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[23]:3.0 | [26]:4.0 | [30]:1.0 | [60]:8.0 | [63]:3.0 | [54]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[23, 26, 30, 60, 63, 54]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[19]:3.0 | [30]:1.0 | [44]:6.0 | [51]:1.0 | [54]:8.0 | [23]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[6]:1.0 | [14]:4.0 | [28]:1.0 | [60]:1.0 | [62]:4.0 | [50]:2.0 | 
---------------------------------------
return EAMC[1]
é©¬EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2650
[1m[33mEnqueueTask: [0m[32mTask: node: ID[541,1200000013] (16MB) STATE(0) TENSOR[2649,2650,2648,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[28]:3.0 | [29]:3.0 | [30]:2.0 | [31]:3.0 | [34]:1.0 | [33]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[6]:3.0 | [13]:2.0 | [49]:3.0 | [50]:2.0 | [56]:1.0 | [20]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[2]:2.0 | [21]:4.0 | [25]:5.0 | [35]:2.0 | [41]:3.0 | [50]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[12]:1.0 | [33]:3.0 | [37]:3.0 | [44]:2.0 | [56]:2.0 | [32]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[4]:2.0 | [8]:2.0 | [28]:4.0 | [37]:1.0 | [57]:1.0 | [47]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[20]:7.0 | [27]:3.0 | [45]:3.0 | [60]:2.0 | [62]:2.0 | [22]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[20, 27, 45, 60, 62, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 45: 5.000(2740)[0m | 
[32mExpert 38: 4.400(2716)[0m | [32mExpert 13: 4.200(2635)[0m | [32mExpert 22: 4.000(2665)[0m | [32mExpert  7: 3.800(2803)[0m | 
[32mExpert 16: 3.600(2644)[0m | [32mExpert 44: 3.600(2737)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 23: 3.000(2668)[0m | [32mExpert 31: 3.000(2695)[0m | [32mExpert 12: 2.800(2632)[0m | [32mExpert 63: 2.800(2800)[0m | 
[32mExpert 17: 2.800(2647)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | 
[32mExpert 33: 2.200(2701)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert 61: 2.000(2794)[0m | 
[32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | [32mExpert 32: 1.600(2698)[0m | [32mExpert 47: 1.400(2746)[0m | 
[32mExpert 51: 1.400(2761)[0m | [32mExpert 62: 1.400(2797)[0m | [32mExpert 34: 1.200(2704)[0m | [32mExpert 18: 1.000(2650)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2722, 2791, 2794, 2758, 2620, 2698, 2746, 2761, 2797, 2704, 2650]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2650[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4, 18, 32, 33, 34, 47, 50, 51, 60, 61, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[27]:1.0 | [35]:2.0 | [45]:2.0 | [57]:2.0 | [59]:1.0 | [43]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[11]:4.0 | [23]:3.0 | [39]:7.0 | [47]:3.0 | [57]:2.0 | [54]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[9]:1.0 | [22]:5.0 | [31]:4.0 | [44]:4.0 | [63]:4.0 | [34]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[8]:2.0 | [9]:5.0 | [13]:6.0 | [16]:5.0 | [42]:5.0 | [32]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:8.0 | [17]:6.0 | [26]:3.0 | [52]:1.0 | [59]:4.0 | [38]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[5]:3.0 | [22]:4.0 | [31]:5.0 | [56]:4.0 | [63]:1.0 | [45]:9.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 5, 22, 31, 56, 63, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 6.800(2858)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  5: 5.400(2993)[0m | 
[32mExpert  4: 5.000(2960)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert 55: 4.800(3011)[0m | [32mExpert  6: 4.600(3026)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 14: 3.200(2876)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 61: 3.000(3032)[0m | 
[32mExpert 11: 2.600(2867)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 52: 2.600(3002)[0m | [32mExpert 41: 2.400(2966)[0m | 
[32mExpert 32: 2.400(2936)[0m | [32mExpert 24: 2.200(2909)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 29: 2.000(2924)[0m | 
[32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | [32mExpert 19: 1.600(2891)[0m | [32mExpert 33: 1.600(2939)[0m | 
[32mExpert 18: 1.600(2888)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert  1: 1.200(2861)[0m | 
[32mExpert 12: 1.200(2870)[0m | [32mExpert 23: 1.200(2906)[0m | [32mExpert 53: 1.200(3005)[0m | [32mExpert  9: 1.200(3047)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2969, 2972, 2891, 2939, 2888, 2912, 2930, 2861, 2870, 2906, 3005, 3047]
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 12, 18, 19, 23, 25, 30, 33, 42, 43, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:3.0 | [35]:4.0 | [36]:4.0 | [47]:5.0 | [63]:5.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:6.0 | [23]:2.0 | [27]:6.0 | [31]:4.0 | [51]:5.0 | [59]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[14]:4.0 | [24]:3.0 | [25]:2.0 | [28]:1.0 | [55]:6.0 | [31]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[16]:6.0 | [19]:2.0 | [45]:4.0 | [61]:4.0 | [63]:5.0 | [13]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[13]:1.0 | [26]:6.0 | [27]:5.0 | [42]:2.0 | [46]:1.0 | [45]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[2]:4.0 | [10]:1.0 | [47]:2.0 | [49]:5.0 | [56]:4.0 | [54]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 2, 10, 47, 49, 56, 54]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
[90mTop 20 Experts:[0m
[32mExpert 48: 6.000(4205)[0m | [32mExpert 10: 4.800(4082)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 27: 4.200(4136)[0m | 
[32mExpert 14: 4.000(4094)[0m | [32mExpert 25: 4.000(4130)[0m | [32mExpert 42: 3.800(4187)[0m | [32mExpert 19: 3.600(4109)[0m | 
[32mExpert 28: 3.400(4139)[0m | [32mExpert 56: 3.400(4232)[0m | [32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | 
[32mExpert 15: 2.800(4097)[0m | [32mExpert  2: 2.600(4112)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 54: 2.400(4226)[0m | 
[32mExpert  6: 2.200(4244)[0m | [32mExpert 53: 2.200(4223)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert 41: 2.200(4184)[0m | 
[32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | 
[32mExpert  0: 1.800(4076)[0m | [32mExpert 18: 1.800(4106)[0m | [32mExpert 30: 1.800(4148)[0m | [32mExpert 23: 1.600(4124)[0m | 
[32mExpert 12: 1.600(4088)[0m | [32mExpert 44: 1.600(4193)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4229, 4241, 4211, 4103, 4076, 4106, 4148, 4124, 4088, 4193, 4091, 4196]
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  5, 12, 13, 17, 18, 23, 30, 44, 45, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[12]:1.0 | [23]:5.0 | [36]:2.0 | [56]:1.0 | [63]:1.0 | [38]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[4]:2.0 | [11]:2.0 | [21]:1.0 | [29]:2.0 | [57]:2.0 | [46]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[0]:3.0 | [15]:4.0 | [25]:6.0 | [47]:1.0 | [53]:3.0 | [19]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[10]:2.0 | [38]:2.0 | [57]:3.0 | [59]:2.0 | [61]:1.0 | [56]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[12]:6.0 | [26]:2.0 | [48]:2.0 | [52]:1.0 | [59]:4.0 | [46]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[6]:1.0 | [25]:1.0 | [52]:6.0 | [54]:2.0 | [60]:9.0 | [39]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 6, 25, 52, 54, 60, 39]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:3.0 | [47]:4.0 | [53]:1.0 | [55]:1.0 | [63]:4.0 | [54]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[25]:2.0 | [27]:4.0 | [43]:1.0 | [50]:3.0 | [62]:5.0 | [41]:2.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:2.0 | [12]:1.0 | [47]:1.0 | [51]:1.0 | [54]:1.0 | [18]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[0]:2.0 | [8]:3.0 | [15]:2.0 | [46]:1.0 | [47]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[1]:1.0 | [9]:3.0 | [15]:2.0 | [24]:1.0 | [60]:3.0 | [55]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[16]:1.0 | [26]:4.0 | [29]:4.0 | [39]:1.0 | [52]:1.0 | [57]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[8]:3.0 | [17]:1.0 | [27]:1.0 | [31]:1.0 | [63]:5.0 | [60]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[1]:2.0 | [6]:6.0 | [22]:5.0 | [34]:1.0 | [55]:2.0 | [18]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 1,  6, 22, 34, 55, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 45: 5.000(2740)[0m | 
[32mExpert 22: 4.800(2665)[0m | [32mExpert 38: 4.400(2716)[0m | [32mExpert 44: 4.400(2737)[0m | [32mExpert 13: 4.200(2635)[0m | 
[32mExpert  7: 3.800(2803)[0m | [32mExpert 31: 3.800(2695)[0m | [32mExpert 16: 3.600(2644)[0m | [32mExpert 63: 3.600(2800)[0m | 
[32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 23: 3.000(2668)[0m | [32mExpert 12: 2.800(2632)[0m | 
[32mExpert 17: 2.800(2647)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | 
[32mExpert 33: 2.200(2701)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert 61: 2.000(2794)[0m | 
[32mExpert 34: 2.000(2704)[0m | [32mExpert  9: 1.800(2809)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | 
[32mExpert 32: 1.600(2698)[0m | [32mExpert 47: 1.400(2746)[0m | [32mExpert 51: 1.400(2761)[0m | [32mExpert 62: 1.400(2797)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2722, 2791, 2794, 2704, 2809, 2758, 2620, 2698, 2746, 2761, 2797]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4,  9, 32, 33, 34, 47, 50, 51, 60, 61, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:4.0 | [8]:6.0 | [24]:1.0 | [32]:2.0 | [55]:1.0 | [17]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[6]:5.0 | [12]:1.0 | [26]:4.0 | [30]:5.0 | [63]:1.0 | [40]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[8]:1.0 | [13]:5.0 | [17]:3.0 | [58]:1.0 | [61]:3.0 | [33]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[12]:1.0 | [26]:2.0 | [41]:7.0 | [51]:4.0 | [61]:1.0 | [29]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[0]:1.0 | [4]:2.0 | [26]:4.0 | [53]:6.0 | [59]:5.0 | [34]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[3]:3.0 | [45]:10.0 | [47]:3.0 | [50]:3.0 | [62]:2.0 | [43]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 3, 45, 47, 50, 62, 43]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 6.800(2858)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert 55: 5.600(3011)[0m | 
[32mExpert  5: 5.400(2993)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert  6: 4.600(3026)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 24: 3.000(2909)[0m | 
[32mExpert 61: 3.000(3032)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 52: 2.600(3002)[0m | 
[32mExpert 41: 2.400(2966)[0m | [32mExpert 32: 2.400(2936)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 29: 2.000(2924)[0m | [32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | [32mExpert 19: 1.600(2891)[0m | 
[32mExpert 31: 1.600(2933)[0m | [32mExpert 33: 1.600(2939)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert 30: 1.400(2930)[0m | 
[32mExpert  1: 1.200(2861)[0m | [32mExpert 12: 1.200(2870)[0m | [32mExpert 23: 1.200(2906)[0m | [32mExpert 53: 1.200(3005)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2924, 2969, 2972, 2891, 2933, 2939, 2888, 2930, 2861, 2870, 2906, 3005]
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 12, 18, 19, 23, 29, 30, 31, 33, 42, 43, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:2.0 | [5]:4.0 | [9]:1.0 | [17]:3.0 | [35]:5.0 | [43]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[0]:3.0 | [5]:7.0 | [46]:2.0 | [47]:5.0 | [57]:2.0 | [59]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[23]:2.0 | [33]:2.0 | [47]:2.0 | [50]:3.0 | [63]:1.0 | [30]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4196
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
Prefetch Node: task: Task: node: ID[1348,2d0000002b] (16MB) STATE(0) TENSOR[4195,4196,4194,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[32]:2.0 | [37]:3.0 | [38]:2.0 | [46]:1.0 | [63]:6.0 | [60]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[2]:1.0 | [30]:1.0 | [31]:3.0 | [42]:3.0 | [45]:4.0 | [28]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[23]:4.0 | [28]:1.0 | [32]:3.0 | [50]:3.0 | [56]:5.0 | [61]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[23, 28, 32, 50, 56, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.000(4205)[0m | [32mExpert 25: 4.800(4130)[0m | [32mExpert 10: 4.800(4082)[0m | [32mExpert 21: 4.600(4118)[0m | 
[32mExpert 19: 4.400(4109)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 42: 3.800(4187)[0m | 
[32mExpert 15: 3.600(4097)[0m | [32mExpert 28: 3.400(4139)[0m | [32mExpert 56: 3.400(4232)[0m | [32mExpert 53: 3.000(4223)[0m | 
[32mExpert 61: 3.000(4250)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert  0: 2.600(4076)[0m | [32mExpert  2: 2.600(4112)[0m | 
[32mExpert  8: 2.400(4262)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | [32mExpert 26: 2.200(4133)[0m | 
[32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | 
[32mExpert 17: 2.000(4103)[0m | [32mExpert 18: 1.800(4106)[0m | [32mExpert 30: 1.800(4148)[0m | [32mExpert 23: 1.600(4124)[0m | 
[32mExpert 12: 1.600(4088)[0m | [32mExpert 44: 1.600(4193)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert 45: 1.600(4196)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4184, 4229, 4241, 4211, 4103, 4106, 4148, 4124, 4088, 4193, 4091, 4196]
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4196[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5, 12, 13, 17, 18, 23, 30, 41, 44, 45, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[23]:6.0 | [35]:2.0 | [36]:3.0 | [39]:1.0 | [58]:5.0 | [53]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[11]:3.0 | [28]:1.0 | [34]:2.0 | [36]:5.0 | [46]:4.0 | [41]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[10]:5.0 | [12]:2.0 | [15]:5.0 | [46]:2.0 | [53]:4.0 | [25]:7.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[10]:3.0 | [23]:2.0 | [40]:4.0 | [44]:3.0 | [57]:4.0 | [5]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[11]:3.0 | [26]:3.0 | [38]:2.0 | [40]:4.0 | [61]:3.0 | [16]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[25]:2.0 | [50]:5.0 | [51]:3.0 | [58]:2.0 | [60]:10.0 | [62]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[25, 50, 51, 58, 60, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:4.0 | [2]:9.0 | [42]:1.0 | [52]:2.0 | [63]:5.0 | [44]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[4]:2.0 | [34]:6.0 | [54]:2.0 | [62]:6.0 | [63]:3.0 | [26]:6.0 | 
---------------------------------------
return EAMC[1]
ï¼Œç„‰EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[22]:3.0 | [35]:3.0 | [43]:3.0 | [53]:5.0 | [63]:1.0 | [12]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[7]:1.0 | [16]:3.0 | [59]:2.0 | [61]:2.0 | [63]:7.0 | [48]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[14]:4.0 | [30]:1.0 | [41]:4.0 | [52]:3.0 | [53]:2.0 | [15]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[8]:1.0 | [9]:2.0 | [21]:5.0 | [30]:1.0 | [44]:3.0 | [2]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[17]:2.0 | [24]:1.0 | [35]:3.0 | [45]:2.0 | [57]:2.0 | [54]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[10]:1.0 | [22]:6.0 | [40]:1.0 | [45]:4.0 | [52]:1.0 | [60]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[10, 22, 40, 45, 52, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 13: 5.000(2635)[0m | 
[32mExpert 45: 5.000(2740)[0m | [32mExpert 22: 4.800(2665)[0m | [32mExpert 38: 4.400(2716)[0m | [32mExpert 44: 4.400(2737)[0m | 
[32mExpert  7: 3.800(2803)[0m | [32mExpert 31: 3.800(2695)[0m | [32mExpert 16: 3.600(2644)[0m | [32mExpert 17: 3.600(2647)[0m | 
[32mExpert 63: 3.600(2800)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 23: 3.000(2668)[0m | 
[32mExpert 33: 3.000(2701)[0m | [32mExpert 12: 2.800(2632)[0m | [32mExpert 61: 2.800(2794)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 60: 2.000(2791)[0m | 
[32mExpert 34: 2.000(2704)[0m | [32mExpert  9: 1.800(2809)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | 
[32mExpert 32: 1.600(2698)[0m | [32mExpert 47: 1.400(2746)[0m | [32mExpert 51: 1.400(2761)[0m | [32mExpert 62: 1.400(2797)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2749, 2722, 2791, 2704, 2809, 2758, 2620, 2698, 2746, 2761, 2797]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4,  9, 32, 34, 35, 47, 48, 50, 51, 60, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[25]:1.0 | [30]:1.0 | [36]:1.0 | [40]:1.0 | [46]:4.0 | [34]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[4]:1.0 | [13]:4.0 | [26]:5.0 | [30]:6.0 | [59]:2.0 | [39]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[12]:4.0 | [13]:6.0 | [16]:4.0 | [25]:1.0 | [44]:5.0 | [5]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[4]:1.0 | [9]:6.0 | [13]:7.0 | [23]:1.0 | [25]:4.0 | [42]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:9.0 | [10]:3.0 | [17]:7.0 | [26]:5.0 | [59]:6.0 | [49]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[3]:4.0 | [17]:1.0 | [45]:11.0 | [56]:5.0 | [59]:7.0 | [4]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 3, 17, 45, 56, 59,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 6.800(2858)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert 55: 5.600(3011)[0m | 
[32mExpert  5: 5.400(2993)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert  6: 4.600(3026)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 24: 3.000(2909)[0m | 
[32mExpert 50: 3.000(2996)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 48: 2.600(2987)[0m | 
[32mExpert 52: 2.600(3002)[0m | [32mExpert 41: 2.400(2966)[0m | [32mExpert 32: 2.400(2936)[0m | [32mExpert 33: 2.400(2939)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 23: 2.000(2906)[0m | [32mExpert 29: 2.000(2924)[0m | 
[32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | [32mExpert 47: 1.800(2984)[0m | [32mExpert 19: 1.600(2891)[0m | 
[32mExpert 31: 1.600(2933)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert  1: 1.200(2861)[0m | [32mExpert 12: 1.200(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2930, 2906, 2924, 2969, 2972, 2984, 2891, 2933, 2888, 2861, 2870]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 12, 18, 19, 23, 25, 29, 30, 31, 42, 43, 47 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[14]:3.0 | [15]:3.0 | [27]:1.0 | [34]:3.0 | [35]:6.0 | [47]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[7]:6.0 | [19]:4.0 | [24]:2.0 | [27]:7.0 | [46]:3.0 | [32]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[5]:7.0 | [11]:3.0 | [46]:1.0 | [55]:7.0 | [63]:2.0 | [24]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 16 MLP ==
[0m
[3]:1.0 | [9]:6.0 | [16]:7.0 | [33]:7.0 | [63]:7.0 | [30]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[0]:4.0 | [10]:3.0 | [26]:7.0 | [38]:5.0 | [44]:1.0 | [29]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[2]:5.0 | [30]:5.0 | [56]:6.0 | [58]:5.0 | [59]:4.0 | [32]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 2, 30, 56, 58, 59, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.000(4205)[0m | [32mExpert 25: 5.600(4130)[0m | [32mExpert 10: 5.600(4082)[0m | [32mExpert 21: 4.600(4118)[0m | 
[32mExpert 15: 4.400(4097)[0m | [32mExpert 19: 4.400(4109)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 14: 4.000(4094)[0m | 
[32mExpert 42: 3.800(4187)[0m | [32mExpert 53: 3.800(4223)[0m | [32mExpert 28: 3.400(4139)[0m | [32mExpert 56: 3.400(4232)[0m | 
[32mExpert 61: 3.000(4250)[0m | EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
[32mExpert 62: 3.000(4253)[0m | [32mExpert  0: 2.600(4076)[0m | [32mExpert  2: 2.600(4112)[0m | 
[32mExpert  8: 2.400(4262)[0m | [32mExpert 12: 2.400(4088)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | 
[32mExpert 26: 2.200(4133)[0m | [32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | 
[32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | [32mExpert 46: 2.000(4199)[0m | [32mExpert 18: 1.800(4106)[0m | 
[32mExpert 30: 1.800(4148)[0m | [32mExpert 23: 1.600(4124)[0m | [32mExpert 44: 1.600(4193)[0m | [32mExpert 13: 1.600(4091)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4133, 4184, 4229, 4241, 4211, 4103, 4199, 4106, 4148, 4124, 4193, 4091]
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5, 13, 17, 18, 23, 26, 30, 41, 44, 46, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[22]:6.0 | [23]:7.0 | [24]:5.0 | [36]:4.0 | [42]:2.0 | [0]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[24]:1.0 | [34]:3.0 | [36]:6.0 | [38]:7.0 | [41]:2.0 | [11]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[10]:6.0 | [15]:6.0 | [20]:1.0 | [46]:3.0 | [56]:4.0 | [61]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E46 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[33]:6.0 | [38]:3.0 | [40]:5.0 | [44]:4.0 | [59]:3.0 | [10]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[1]:1.0 | [29]:2.0 | [41]:2.0 | [51]:2.0 | [59]:5.0 | [43]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[4]:2.0 | [5]:4.0 | [27]:1.0 | [30]:2.0 | [60]:11.0 | [13]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 4,  5, 27, 30, 60, 13]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[0]:1.0 | [44]:8.0 | [45]:6.0 | [48]:2.0 | [61]:2.0 | [54]:10.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[4]:3.0 | [14]:5.0 | [47]:2.0 | [52]:2.0 | [60]:2.0 | [41]:3.0 | 
---------------------------------------
return EAMC[1]
çŸ¥EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2797
[1m[33mEnqueueTask: [0m[32mTask: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 30
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[585,3e00000013] (16MB) STATE(0) TENSOR[2796,2797,2795,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2888
[1m[33mEnqueueTask: [0m[32mTask: node: ID[931,120000001f] (16MB) STATE(0) TENSOR[2887,2888,2886,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[11]:5.0 | [14]:2.0 | [22]:4.0 | [28]:4.0 | [34]:2.0 | [38]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[10]:3.0 | [16]:4.0 | [24]:1.0 | [48]:3.0 | [49]:4.0 | [7]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[2]:3.0 | [4]:2.0 | [16]:1.0 | [44]:1.0 | [52]:4.0 | [58]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[9]:3.0 | [21]:6.0 | [27]:2.0 | [30]:2.0 | [44]:4.0 | [8]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[3]:1.0 | [24]:2.0 | [51]:1.0 | [52]:3.0 | [57]:3.0 | [23]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[5]:1.0 | [10]:2.0 | [22]:7.0 | [45]:5.0 | [60]:4.0 | [52]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 5, 10, 22, 45, 60, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 13: 5.800(2635)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | 
[32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 22: 4.800(2665)[0m | [32mExpert 16: 4.400(2644)[0m | 
[32mExpert 38: 4.400(2716)[0m | [32mExpert  7: 3.800(2803)[0m | [32mExpert 31: 3.800(2695)[0m | [32mExpert 12: 3.600(2632)[0m | 
[32mExpert 17: 3.600(2647)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 23: 3.000(2668)[0m | [32mExpert 33: 3.000(2701)[0m | [32mExpert 61: 2.800(2794)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 60: 2.000(2791)[0m | 
[32mExpert 34: 2.000(2704)[0m | [32mExpert  9: 1.800(2809)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | 
[32mExpert 32: 1.600(2698)[0m | [32mExpert 47: 1.400(2746)[0m | [32mExpert 51: 1.400(2761)[0m | [32mExpert 62: 1.400(2797)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2749, 2722, 2791, 2704, 2809, 2758, 2620, 2698, 2746, 2761, 2797]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2797[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4,  9, 32, 34, 35, 47, 48, 50, 51, 60, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[4]:1.0 | [25]:2.0 | [36]:2.0 | [37]:2.0 | [58]:3.0 | [45]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[23]:4.0 | [26]:6.0 | [30]:7.0 | [59]:3.0 | [63]:2.0 | [19]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[2]:1.0 | [12]:5.0 | [13]:7.0 | [16]:5.0 | [40]:1.0 | [42]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[4]:2.0 | [12]:2.0 | [13]:8.0 | [23]:2.0 | [63]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:10.0 | [11]:3.0 | [26]:6.0 | [57]:1.0 | [59]:7.0 | [46]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[10]:1.0 | [15]:1.0 | [30]:3.0 | [34]:2.0 | [45]:12.0 | [17]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[10, 15, 30, 34, 45, 17]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 6.800(2858)[0m | [32mExpert 55: 6.400(3011)[0m | [32mExpert  5: 6.200(2993)[0m | [32mExpert 16: 6.200(2882)[0m | 
[32mExpert 49: 6.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert  6: 4.600(3026)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 24: 3.800(2909)[0m | [32mExpert 11: 3.400(2867)[0m | 
[32mExpert 40: 3.200(2963)[0m | [32mExpert 50: 3.000(2996)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 48: 2.600(2987)[0m | 
[32mExpert 52: 2.600(3002)[0m | [32mExpert 41: 2.400(2966)[0m | [32mExpert 32: 2.400(2936)[0m | [32mExpert 33: 2.400(2939)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 23: 2.000(2906)[0m | [32mExpert 29: 2.000(2924)[0m | 
[32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | [32mExpert 47: 1.800(2984)[0m | [32mExpert 63: 1.800(3038)[0m | 
[32mExpert 19: 1.600(2891)[0m | [32mExpert 31: 1.600(2933)[0m | [32mExpert 18: 1.600(2888)[0m | [32mExpert  1: 1.200(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2930, 2906, 2924, 2969, 2972, 2984, 3038, 2891, 2933, 2888, 2861]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2888[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 18, 19, 23, 25, 29, 30, 31, 42, 43, 47, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[17]:4.0 | [27]:2.0 | [34]:4.0 | [47]:7.0 | [48]:3.0 | [15]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[0]:4.0 | [19]:5.0 | [22]:1.0 | [24]:3.0 | [46]:4.0 | [5]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[9]:1.0 | [26]:1.0 | [50]:4.0 | [53]:2.0 | [63]:3.0 | [5]:8.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E63 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[3]:2.0 | [7]:1.0 | [32]:3.0 | [48]:2.0 | [62]:1.0 | [30]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[0]:5.0 | [4]:1.0 | [26]:8.0 | [31]:4.0 | [43]:4.0 | [10]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[21]:1.0 | [25]:1.0 | [32]:5.0 | [47]:3.0 | [56]:7.0 | [58]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[21, 25, 32, 47, 56, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.400(4082)[0m | [32mExpert 48: 6.000(4205)[0m | [32mExpert 25: 5.600(4130)[0m | [32mExpert 15: 5.200(4097)[0m | 
[32mExpert 21: 4.600(4118)[0m | [32mExpert 19: 4.400(4109)[0m | EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
[32mExpert 27: 4.200(4136)[0m | [32mExpert 56: 4.200(4232)[0m | 
[32mExpert 14: 4.000(4094)[0m | [32mExpert 42: 3.800(4187)[0m | [32mExpert 53: 3.800(4223)[0m | [32mExpert 61: 3.800(4250)[0m | 
[32mExpert 28: 3.400(4139)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 46: 2.800(4199)[0m | [32mExpert  0: 2.600(4076)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 12: 2.400(4088)[0m | [32mExpert 54: 2.400(4226)[0m | 
[32mExpert  6: 2.200(4244)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | 
[32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | [32mExpert 18: 1.800(4106)[0m | 
[32mExpert 30: 1.800(4148)[0m | [32mExpert 23: 1.600(4124)[0m | [32mExpert 44: 1.600(4193)[0m | [32mExpert 13: 1.600(4091)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4244, 4133, 4184, 4229, 4241, 4211, 4103, 4106, 4148, 4124, 4193, 4091]
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 13, 17, 18, 23, 26, 30, 41, 44, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:4.0 | [22]:7.0 | [36]:5.0 | [42]:3.0 | [63]:2.0 | [39]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[5]:1.0 | [11]:5.0 | [28]:2.0 | [32]:2.0 | [42]:1.0 | [36]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[15]:7.0 | [19]:5.0 | [23]:3.0 | [50]:1.0 | [63]:1.0 | [61]:5.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[7]:2.0 | [10]:5.0 | [33]:7.0 | [56]:3.0 | [57]:5.0 | [28]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[0]:4.0 | [16]:8.0 | [17]:1.0 | [51]:3.0 | [61]:4.0 | [50]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[5]:5.0 | [13]:2.0 | [30]:3.0 | [48]:2.0 | [60]:12.0 | [54]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 5, 13, 30, 48, 60, 54]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[5]:1.0 | [14]:2.0 | [44]:9.0 | [50]:1.0 | [61]:3.0 | [38]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[4]:4.0 | [6]:2.0 | [32]:4.0 | [60]:3.0 | [62]:7.0 | [12]:2.0 | 
---------------------------------------
return EAMC[1]
éEnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 31
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[28]:5.0 | [30]:3.0 | [36]:1.0 | [52]:3.0 | [53]:6.0 | [49]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[3]:2.0 | [5]:2.0 | [16]:5.0 | [31]:4.0 | [53]:2.0 | [7]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[2]:4.0 | [19]:1.0 | [25]:6.0 | [52]:5.0 | [53]:3.0 | [16]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[8]:3.0 | [9]:4.0 | [21]:7.0 | [27]:3.0 | [44]:5.0 | [2]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[6]:4.0 | [45]:3.0 | [51]:2.0 | [57]:4.0 | [63]:6.0 | [8]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[5]:2.0 | [8]:1.0 | [43]:1.0 | [45]:6.0 | [52]:3.0 | [60]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 5,  8, 43, 45, 52, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 13: 6.600(2635)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | 
[32mExpert 16: 5.200(2644)[0m | [32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 22: 4.800(2665)[0m | 
[32mExpert 12: 4.400(2632)[0m | [32mExpert 38: 4.400(2716)[0m | [32mExpert  7: 3.800(2803)[0m | [32mExpert 31: 3.800(2695)[0m | 
[32mExpert 17: 3.600(2647)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 23: 3.000(2668)[0m | [32mExpert 33: 3.000(2701)[0m | [32mExpert 61: 2.800(2794)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 60: 2.000(2791)[0m | 
[32mExpert 34: 2.000(2704)[0m | [32mExpert 42: 1.800(2731)[0m | [32mExpert  9: 1.800(2809)[0m | [32mExpert 50: 1.800(2758)[0m | 
[32mExpert  0: 1.600(2620)[0m | [32mExpert  2: 1.600(2656)[0m | [32mExpert 32: 1.600(2698)[0m | [32mExpert 47: 1.400(2746)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2749, 2722, 2791, 2704, 2731, 2809, 2758, 2620, 2656, 2698, 2746]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  4,  9, 32, 34, 35, 42, 47, 48, 50, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[30]:2.0 | [36]:3.0 | [40]:2.0 | [51]:1.0 | [58]:4.0 | [45]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[13]:5.0 | [19]:2.0 | [40]:4.0 | [52]:1.0 | [59]:4.0 | [30]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[2]:2.0 | [13]:8.0 | [16]:6.0 | [25]:2.0 | [29]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E2 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[12]:3.0 | [23]:3.0 | [25]:5.0 | [47]:3.0 | [63]:2.0 | [61]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:11.0 | [20]:1.0 | [22]:4.0 | [26]:7.0 | [59]:8.0 | [46]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[3]:5.0 | [17]:3.0 | [33]:3.0 | [45]:13.0 | [59]:8.0 | [47]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 3, 17, 33, 45, 59, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  5: 7.000(2993)[0m | [32mExpert  0: 6.800(2858)[0m | [32mExpert 55: 6.400(3011)[0m | [32mExpert 16: 6.200(2882)[0m | 
[32mExpert 49: 6.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert  6: 4.600(3026)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 24: 3.800(2909)[0m | [32mExpert 50: 3.800(2996)[0m | 
[32mExpert 11: 3.400(2867)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 63: 2.600(3038)[0m | 
[32mExpert 48: 2.600(2987)[0m | [32mExpert 52: 2.600(3002)[0m | [32mExpert 41: 2.400(2966)[0m | [32mExpert 32: 2.400(2936)[0m | 
[32mExpert 33: 2.400(2939)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 23: 2.000(2906)[0m | 
[32mExpert 53: 2.000(3005)[0m | [32mExpert  9: 2.000(3047)[0m | [32mExpert 29: 2.000(2924)[0m | [32mExpert 42: 1.800(2969)[0m | 
[32mExpert 43: 1.800(2972)[0m | [32mExpert 47: 1.800(2984)[0m | [32mExpert 19: 1.600(2891)[0m | [32mExpert 31: 1.600(2933)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2912, 2930, 2906, 3005, 3047, 2924, 2969, 2972, 2984, 2891, 2933]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  9, 19, 23, 25, 29, 30, 31, 33, 42, 43, 47, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[0]:1.0 | [27]:3.0 | [34]:5.0 | [47]:8.0 | [48]:4.0 | [35]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[19]:6.0 | [27]:8.0 | [34]:1.0 | [46]:5.0 | [62]:1.0 | [48]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[5]:9.0 | [6]:6.0 | [9]:2.0 | [11]:4.0 | [31]:2.0 | [52]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[0]:1.0 | [3]:3.0 | [30]:6.0 | [32]:4.0 | [47]:2.0 | [49]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[0]:6.0 | [31]:5.0 | [38]:6.0 | [43]:5.0 | [44]:2.0 | [29]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[31]:1.0 | [32]:6.0 | [43]:1.0 | [47]:4.0 | [56]:8.0 | [58]:7.0 | EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29

---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[31, 32, 43, 47, 56, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 6.400(4082)[0m | [32mExpert 15: 6.000(4097)[0m | [32mExpert 48: 6.000(4205)[0m | [32mExpert 25: 5.600(4130)[0m | 
[32mExpert 19: 5.200(4109)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 61: 4.600(4250)[0m | [32mExpert 27: 4.200(4136)[0m | 
[32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 42: 3.800(4187)[0m | [32mExpert 53: 3.800(4223)[0m | 
[32mExpert 28: 3.400(4139)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 46: 2.800(4199)[0m | [32mExpert  0: 2.600(4076)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 12: 2.400(4088)[0m | 
[32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert 41: 2.200(4184)[0m | 
[32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | 
[32mExpert 18: 1.800(4106)[0m | [32mExpert 30: 1.800(4148)[0m | [32mExpert 44: 1.600(4193)[0m | [32mExpert 13: 1.600(4091)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4226, 4244, 4133, 4184, 4229, 4241, 4211, 4103, 4106, 4148, 4193, 4091]
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 13, 17, 18, 26, 30, 41, 44, 54, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[35]:3.0 | [36]:6.0 | [39]:3.0 | [55]:1.0 | [58]:6.0 | [40]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[11]:6.0 | [36]:8.0 | [41]:3.0 | [45]:1.0 | [46]:5.0 | [28]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[10]:7.0 | [15]:8.0 | [19]:6.0 | [20]:2.0 | [46]:4.0 | [61]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 22 MLP ==
[0m
[10]:6.0 | [33]:8.0 | [44]:5.0 | [56]:4.0 | [58]:5.0 | [7]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[0]:5.0 | [12]:7.0 | [26]:4.0 | [50]:3.0 | [59]:6.0 | [29]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[4]:3.0 | [23]:4.0 | [26]:5.0 | [30]:4.0 | [60]:13.0 | [27]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 4, 23, 26, 30, 60, 27]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[14]:3.0 | [19]:4.0 | [44]:10.0 | [50]:2.0 | [58]:1.0 | [23]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[14]:6.0 | [23]:1.0 | [27]:5.0 | [28]:2.0 | [62]:8.0 | [6]:3.0 | 
---------------------------------------
return EAMC[1]
ç¦EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 32
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[16]:5.0 | [19]:1.0 | [31]:4.0 | [35]:4.0 | [38]:5.0 | [3]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[7]:4.0 | [16]:6.0 | [18]:1.0 | [24]:2.0 | [49]:5.0 | [31]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[2]:5.0 | [25]:7.0 | [35]:3.0 | [49]:1.0 | [52]:6.0 | [14]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[9]:5.0 | [12]:2.0 | [44]:6.0 | [53]:1.0 | [56]:3.0 | [46]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[6]:5.0 | [8]:5.0 | [37]:2.0 | [45]:4.0 | [57]:5.0 | [31]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[15]:2.0 | [53]:1.0 | [59]:2.0 | [60]:6.0 | [62]:3.0 | [20]:8.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[15, 53, 59, 60, 62, 20]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 7.400(2635)[0m | [32mExpert 46: 7.000(2743)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 53: 5.600(2767)[0m | 
[32mExpert 41: 5.400(2728)[0m | [32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 22: 4.800(2665)[0m | 
[32mExpert 12: 4.400(2632)[0m | [32mExpert 38: 4.400(2716)[0m | [32mExpert  7: 3.800(2803)[0m | [32mExpert 31: 3.800(2695)[0m | 
[32mExpert 17: 3.600(2647)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 23: 3.000(2668)[0m | [32mExpert 33: 3.000(2701)[0m | [32mExpert 61: 2.800(2794)[0m | [32mExpert  2: 2.400(2656)[0m | 
[32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  4: 2.000(2722)[0m | 
[32mExpert 60: 2.000(2791)[0m | [32mExpert 34: 2.000(2704)[0m | [32mExpert 42: 1.800(2731)[0m | [32mExpert  9: 1.800(2809)[0m | 
[32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | [32mExpert 25: 1.600(2674)[0m | [32mExpert 32: 1.600(2698)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2653, 2707, 2749, 2722, 2791, 2704, 2731, 2809, 2758, 2620, 2674, 2698]
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4,  9, 19, 25, 32, 34, 35, 42, 48, 50, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[27]:2.0 | [35]:3.0 | [37]:3.0 | [45]:5.0 | [56]:1.0 | [63]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[5]:1.0 | [19]:3.0 | [23]:5.0 | [57]:3.0 | [59]:5.0 | [11]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[9]:2.0 | [11]:1.0 | [29]:2.0 | [31]:5.0 | [34]:2.0 | [22]:6.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[9]:7.0 | [13]:9.0 | [32]:2.0 | [42]:7.0 | [45]:5.0 | [8]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:12.0 | [17]:8.0 | [38]:2.0 | [52]:2.0 | [59]:9.0 | [56]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[22]:5.0 | [31]:6.0 | [33]:4.0 | [56]:6.0 | [59]:9.0 | [26]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[22, 31, 33, 56, 59, 26]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  5: 7.800(2993)[0m | [32mExpert  0: 6.800(2858)[0m | [32mExpert 55: 6.400(3011)[0m | [32mExpert 16: 6.200(2882)[0m | 
[32mExpert 49: 6.200(2990)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 24: 3.800(2909)[0m | 
[32mExpert 50: 3.800(2996)[0m | [32mExpert 52: 3.400(3002)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 61: 3.000(3032)[0m | 
[32mExpert  9: 2.800(3047)[0m | [32mExpert 63: 2.600(3038)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 41: 2.400(2966)[0m | 
[32mExpert 31: 2.400(2933)[0m | [32mExpert 32: 2.400(2936)[0m | [32mExpert 33: 2.400(2939)[0m | [32mExpert 25: 2.200(2912)[0m | 
[32mExpert 30: 2.200(2930)[0m | [32mExpert 23: 2.000(2906)[0m | [32mExpert 53: 2.000(3005)[0m | [32mExpert 29: 2.000(2924)[0m | 
[32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | [32mExpert 47: 1.800(2984)[0m | [32mExpert 19: 1.600(2891)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2933, 2936, 2939, 2912, 2930, 2906, 3005, 2924, 2969, 2972, 2984, 2891]
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 19, 23, 25, 29, 30, 31, 32, 33, 42, 43, 47, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:5.0 | [35]:8.0 | [42]:2.0 | [61]:2.0 | [63]:6.0 | [16]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:9.0 | [27]:9.0 | [52]:1.0 | [59]:7.0 | [61]:3.0 | [31]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[25]:3.0 | [28]:2.0 | [29]:2.0 | [38]:1.0 | [41]:4.0 | [4]:6.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E29 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[20]:3.0 | [32]:5.0 | [45]:5.0 | [55]:1.0 | [63]:8.0 | [9]:7.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 30

[1;36m== Layer 17 MLP ==
[0m
[0]:7.0 | [7]:1.0 | [13]:2.0 | [26]:9.0 | [41]:4.0 | [6]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[0]:2.0 | [8]:4.0 | [23]:5.0 | [47]:5.0 | [49]:6.0 | [2]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 0,  8, 23, 47, 49,  2]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 7.200(4082)[0m | [32mExpert 15: 6.800(4097)[0m | [32mExpert 19: 6.000(4109)[0m | [32mExpert 48: 6.000(4205)[0m | 
[32mExpert 25: 5.600(4130)[0m | [32mExpert 61: 5.400(4250)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 27: 4.200(4136)[0m | 
[32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 42: 3.800(4187)[0m | [32mExpert 53: 3.800(4223)[0m | 
[32mExpert 46: 3.600(4199)[0m | [32mExpert 28: 3.400(4139)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert  0: 2.600(4076)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 12: 2.400(4088)[0m | 
[32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert 41: 2.200(4184)[0m | 
[32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | 
[32mExpert 18: 1.800(4106)[0m | [32mExpert 30: 1.800(4148)[0m | [32mExpert 20: 1.600(4115)[0m | [32mExpert 44: 1.600(4193)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4226, 4244, 4133, 4184, 4229, 4241, 4211, 4103, 4106, 4148, 4115, 4193]
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 17, 18, 20, 26, 30, 41, 44, 54, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:4.0 | [12]:2.0 | [19]:2.0 | [38]:5.0 | [58]:7.0 | [22]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[4]:3.0 | [18]:1.0 | [29]:3.0 | [36]:9.0 | [55]:3.0 | [25]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[25]:8.0 | [26]:2.0 | [48]:8.0 | [51]:1.0 | [53]:5.0 | [38]:1.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[5]:7.0 | [8]:2.0 | [47]:3.0 | [56]:5.0 | [61]:2.0 | [51]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[1]:2.0 | [10]:1.0 | [46]:4.0 | [54]:2.0 | [61]:5.0 | [26]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[23]:5.0 | [36]:3.0 | [48]:3.0 | [52]:7.0 | [54]:4.0 | [8]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[23, 36, 48, 52, 54,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:4.0 | [16]:1.0 | [17]:1.0 | [47]:5.0 | [52]:3.0 | [14]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[29]:2.0 | [43]:2.0 | [49]:2.0 | [57]:3.0 | [62]:9.0 | [38]:3.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 33
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[13]:4.0 | [25]:2.0 | [26]:4.0 | [60]:3.0 | [62]:3.0 | [55]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[15]:3.0 | [19]:2.0 | [36]:4.0 | [47]:3.0 | [62]:4.0 | [46]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[9]:4.0 | [15]:4.0 | [45]:1.0 | [46]:4.0 | [60]:4.0 | [1]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[29]:5.0 | [52]:2.0 | [57]:3.0 | [59]:5.0 | [63]:1.0 | [39]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[17]:3.0 | [27]:2.0 | [53]:1.0 | [56]:1.0 | [63]:7.0 | [55]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[6]:7.0 | [11]:3.0 | [12]:2.0 | [33]:4.0 | [47]:5.0 | [16]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 6, 11, 12, 33, 47, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 7.400(2635)[0m | [32mExpert 46: 7.000(2743)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 22: 5.600(2665)[0m | 
[32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | 
[32mExpert 31: 4.600(2695)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 38: 4.400(2716)[0m | [32mExpert  7: 3.800(2803)[0m | 
[32mExpert 17: 3.600(2647)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 26: 3.200(2677)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert 23: 3.000(2668)[0m | [32mExpert 33: 3.000(2701)[0m | [32mExpert 61: 2.800(2794)[0m | [32mExpert 34: 2.800(2704)[0m | 
[32mExpert  9: 2.600(2809)[0m | [32mExpert  2: 2.400(2656)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert 42: 1.800(2731)[0m | 
[32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | [32mExpert 25: 1.600(2674)[0m | [32mExpert 29: 1.600(2686)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2809, 2656, 2653, 2707, 2749, 2722, 2791, 2731, 2758, 2620, 2674, 2686]
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  4,  9, 19, 25, 29, 35, 42, 48, 50, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:5.0 | [8]:7.0 | [9]:4.0 | [42]:5.0 | [44]:7.0 | [6]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[6]:6.0 | [10]:1.0 | [25]:2.0 | [30]:9.0 | [39]:9.0 | [15]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[13]:9.0 | [38]:6.0 | [46]:8.0 | [58]:2.0 | [61]:4.0 | [7]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[16]:6.0 | [30]:6.0 | [33]:5.0 | [45]:6.0 | [60]:4.0 | [59]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[16]:8.0 | [33]:3.0 | [52]:3.0 | [53]:7.0 | [55]:3.0 | [40]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[22]:6.0 | [25]:2.0 | [31]:7.0 | [48]:1.0 | [52]:1.0 | [45]:14.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[22, 25, 31, 48, 52, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  5: 7.800(2993)[0m | [32mExpert  0: 6.800(2858)[0m | [32mExpert 55: 6.400(3011)[0m | [32mExpert 16: 6.200(2882)[0m | 
[32mExpert 49: 6.200(2990)[0m | [32mExpert  4: 5.800(2960)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 24: 3.800(2909)[0m | 
[32mExpert 50: 3.800(2996)[0m | [32mExpert 52: 3.400(3002)[0m | [32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | 
[32mExpert 25: 3.000(2912)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert  9: 2.800(3047)[0m | [32mExpert 29: 2.800(2924)[0m | 
[32mExpert 63: 2.600(3038)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 31: 2.400(2933)[0m | [32mExpert 32: 2.400(2936)[0m | 
[32mExpert 33: 2.400(2939)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 23: 2.000(2906)[0m | [32mExpert 53: 2.000(3005)[0m | 
[32mExpert 28: 1.800(2921)[0m | [32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | [32mExpert 47: 1.800(2984)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3038, 2987, 2933, 2936, 2939, 2930, 2906, 3005, 2921, 2969, 2972, 2984]
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 23, 28, 30, 31, 32, 33, 42, 43, 47, 48, 53, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:3.0 | [11]:6.0 | [30]:4.0 | [60]:2.0 | [61]:3.0 | [57]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:10.0 | [9]:6.0 | [30]:4.0 | [59]:8.0 | [63]:6.0 | [28]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:8.0 | [4]:7.0 | [23]:3.0 | [38]:2.0 | [62]:1.0 | [29]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[24]:8.0 | [25]:2.0 | [45]:6.0 | [50]:4.0 | [58]:2.0 | [38]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[13]:3.0 | [33]:1.0 | [53]:3.0 | [57]:6.0 | [61]:3.0 | [6]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[23]:6.0 | [35]:1.0 | [44]:3.0 | [49]:7.0 | [57]:2.0 | [8]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[23, 35, 44, 49, 57,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 7.200(4082)[0m | [32mExpert 15: 6.800(4097)[0m | [32mExpert 48: 6.800(4205)[0m | [32mExpert 25: 6.400(4130)[0m | 
[32mExpert 19: 6.000(4109)[0m | [32mExpert 61: 5.400(4250)[0m | EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
[32mExpert 21: 4.600(4118)[0m | [32mExpert 53: 4.600(4223)[0m | 
[32mExpert 27: 4.200(4136)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 42: 3.800(4187)[0m | 
[32mExpert 46: 3.600(4199)[0m | [32mExpert 28: 3.400(4139)[0m | [32mExpert 26: 3.000(4133)[0m | [32mExpert 62: 3.000(4253)[0m | 
[32mExpert  0: 2.600(4076)[0m | [32mExpert  2: 2.600(4112)[0m | [32mExpert  8: 2.400(4262)[0m | [32mExpert 23: 2.400(4124)[0m | 
[32mExpert 12: 2.400(4088)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | [32mExpert 41: 2.200(4184)[0m | 
[32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | 
[32mExpert 51: 2.000(4217)[0m | [32mExpert 18: 1.800(4106)[0m | [32mExpert 30: 1.800(4148)[0m | [32mExpert 20: 1.600(4115)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4088, 4226, 4244, 4184, 4229, 4241, 4211, 4103, 4217, 4106, 4148, 4115]
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 12, 17, 18, 20, 30, 41, 51, 54, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:5.0 | [9]:5.0 | [38]:6.0 | [49]:4.0 | [50]:2.0 | [41]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[0]:1.0 | [15]:7.0 | [37]:5.0 | [54]:2.0 | [56]:3.0 | [36]:10.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[8]:4.0 | [26]:3.0 | [35]:1.0 | [37]:1.0 | [61]:7.0 | [12]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:3.0 | [9]:1.0 | [22]:1.0 | [35]:7.0 | [57]:6.0 | [56]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[5]:4.0 | [24]:1.0 | [33]:3.0 | [46]:5.0 | [57]:7.0 | [32]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[19]:5.0 | [24]:6.0 | [28]:7.0 | [29]:1.0 | [36]:4.0 | [21]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[19, 24, 28, 29, 36, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:10.0 | [6]:5.0 | [7]:2.0 | [10]:5.0 | [28]:2.0 | [55]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[10]:4.0 | [37]:2.0 | [38]:4.0 | [39]:1.0 | [56]:6.0 | [17]:5.0 | 
---------------------------------------
return EAMC[1]
'ç¿»è¯‘EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 34
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[1]:1.0 | [7]:2.0 | [10]:1.0 | [22]:5.0 | [41]:1.0 | [54]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[9]:1.0 | [30]:4.0 | [33]:2.0 | [42]:5.0 | [55]:1.0 | [61]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[0]:7.0 | [28]:5.0 | [37]:3.0 | [60]:5.0 | [61]:2.0 | [42]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[1]:5.0 | [20]:1.0 | [29]:6.0 | [31]:4.0 | [50]:1.0 | [6]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[6]:6.0 | [7]:1.0 | [19]:4.0 | [22]:1.0 | [46]:1.0 | [49]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[2]:3.0 | [7]:1.0 | [29]:4.0 | [33]:5.0 | [44]:1.0 | [20]:9.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 2,  7, 29, 33, 44, 20]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 22: 5.600(2665)[0m | 
[32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 38: 5.200(2716)[0m | [32mExpert 44: 5.200(2737)[0m | 
[32mExpert 45: 5.000(2740)[0m | [32mExpert  7: 4.600(2803)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 17: 3.600(2647)[0m | [32mExpert 61: 3.600(2794)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 26: 3.200(2677)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 23: 3.000(2668)[0m | [32mExpert 33: 3.000(2701)[0m | [32mExpert 34: 2.800(2704)[0m | 
[32mExpert  9: 2.600(2809)[0m | [32mExpert  2: 2.400(2656)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 58: 2.000(2782)[0m | [32mExpert 60: 2.000(2791)[0m | 
[32mExpert 42: 1.800(2731)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert  0: 1.600(2620)[0m | [32mExpert 25: 1.600(2674)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2809, 2656, 2653, 2707, 2749, 2722, 2782, 2791, 2731, 2758, 2620, 2674]
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  4,  9, 19, 25, 35, 42, 48, 50, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:2.0 | [9]:5.0 | [10]:3.0 | [44]:8.0 | [54]:1.0 | [15]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[9]:3.0 | [17]:2.0 | [29]:2.0 | [38]:3.0 | [49]:7.0 | [16]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[21]:1.0 | [23]:4.0 | [26]:3.0 | [36]:2.0 | [40]:2.0 | [11]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[24]:1.0 | [33]:6.0 | [35]:1.0 | [45]:7.0 | [56]:1.0 | [59]:10.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:13.0 | [16]:9.0 | [21]:1.0 | [33]:4.0 | [53]:8.0 | [55]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[1]:1.0 | [31]:8.0 | [44]:2.0 | [45]:15.0 | [57]:2.0 | [18]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 1, 31, 44, 45, 57, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  5: 7.800(2993)[0m | [32mExpert  0: 7.600(2858)[0m | [32mExpert  4: 6.600(2960)[0m | [32mExpert 55: 6.400(3011)[0m | 
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 24: 3.800(2909)[0m | 
[32mExpert 50: 3.800(2996)[0m | [32mExpert 29: 3.600(2924)[0m | [32mExpert 52: 3.400(3002)[0m | [32mExpert 41: 3.200(2966)[0m | 
[32mExpert 40: 3.200(2963)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 23: 2.800(2906)[0m | 
[32mExpert  9: 2.800(3047)[0m | [32mExpert 63: 2.600(3038)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 31: 2.400(2933)[0m | 
[32mExpert 32: 2.400(2936)[0m | [32mExpert 33: 2.400(2939)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 38: 2.200(2954)[0m | 
[32mExpert 53: 2.000(3005)[0m | [32mExpert 28: 1.800(2921)[0m | [32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3047, 3038, 2987, 2933, 2936, 2939, 2930, 2954, 3005, 2921, 2969, 2972]
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  9, 28, 30, 31, 32, 33, 38, 42, 43, 48, 53, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:7.0 | [29]:7.0 | [30]:5.0 | [38]:1.0 | [57]:2.0 | [36]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:11.0 | [20]:1.0 | [35]:1.0 | [59]:9.0 | [63]:7.0 | [38]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:9.0 | [4]:8.0 | [23]:4.0 | [27]:1.0 | [44]:1.0 | [32]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[26]:5.0 | [33]:8.0 | [35]:1.0 | [36]:1.0 | [47]:3.0 | [41]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[11]:2.0 | [46]:2.0 | [51]:2.0 | [54]:3.0 | [61]:4.0 | [22]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:6.0 | [7]:1.0 | [33]:3.0 | [35]:2.0 | [47]:6.0 | [23]:7.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1,  7, 33, 35, 47, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 10: 7.200(4082)[0m | [32mExpert 15: 6.800(4097)[0m | [32mExpert 48: 6.800(4205)[0m | [32mExpert 25: 6.400(4130)[0m | 
[32mExpert 61: 6.200(4250)[0m | [32mExpert 19: 6.000(4109)[0m | EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[32mExpert 21: 4.600(4118)[0m | [32mExpert 53: 4.600(4223)[0m | 
[32mExpert 27: 4.200(4136)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 26: 3.800(4133)[0m | 
[32mExpert 42: 3.800(4187)[0m | [32mExpert 46: 3.600(4199)[0m | [32mExpert 28: 3.400(4139)[0m | [32mExpert  8: 3.200(4262)[0m | 
[32mExpert 12: 3.200(4088)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert  0: 2.600(4076)[0m | [32mExpert  2: 2.600(4112)[0m | 
[32mExpert 23: 2.400(4124)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | [32mExpert 41: 2.200(4184)[0m | 
[32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | 
[32mExpert 51: 2.000(4217)[0m | [32mExpert 18: 1.800(4106)[0m | [32mExpert 30: 1.800(4148)[0m | [32mExpert 20: 1.600(4115)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4124, 4226, 4244, 4184, 4229, 4241, 4211, 4103, 4217, 4106, 4148, 4115]
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 17, 18, 20, 23, 30, 41, 51, 54, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:6.0 | [9]:6.0 | [27]:1.0 | [38]:7.0 | [59]:1.0 | [60]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[14]:1.0 | [37]:6.0 | [54]:3.0 | [55]:4.0 | [63]:2.0 | [44]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[0]:4.0 | [12]:4.0 | [15]:9.0 | [18]:3.0 | [26]:4.0 | [50]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E18 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:4.0 | [17]:1.0 | [28]:2.0 | [35]:8.0 | [56]:7.0 | [43]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[1]:3.0 | [30]:1.0 | [32]:3.0 | [46]:6.0 | [58]:6.0 | [33]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[15]:1.0 | [19]:6.0 | [21]:2.0 | [24]:7.0 | [44]:1.0 | [36]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[15, 19, 21, 24, 44, 36]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[17]:2.0 | [18]:4.0 | [21]:2.0 | [22]:1.0 | [47]:6.0 | [20]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[10]:5.0 | [17]:6.0 | [20]:2.0 | [48]:3.0 | [60]:4.0 | [37]:3.0 | 
---------------------------------------
return EAMC[1]
æˆEnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[9]:3.0 | [28]:6.0 | [38]:6.0 | [49]:4.0 | [50]:4.0 | [53]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[3]:3.0 | [17]:1.0 | [19]:3.0 | [34]:1.0 | [53]:3.0 | [14]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[12]:2.0 | [19]:2.0 | [26]:1.0 | [37]:4.0 | [47]:1.0 | [62]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[6]:4.0 | [20]:2.0 | [23]:1.0 | [29]:7.0 | [61]:1.0 | [17]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[0]:1.0 | [19]:5.0 | [36]:1.0 | [58]:2.0 | [62]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[7]:2.0 | [33]:6.0 | [43]:2.0 | [49]:1.0 | [58]:1.0 | [47]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[ 7, 33, 43, 49, 58, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 22: 5.600(2665)[0m | 
[32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 38: 5.200(2716)[0m | [32mExpert 44: 5.200(2737)[0m | 
[32mExpert 45: 5.000(2740)[0m | [32mExpert  7: 4.600(2803)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 26: 4.000(2677)[0m | [32mExpert 23: 3.800(2668)[0m | [32mExpert 17: 3.600(2647)[0m | [32mExpert 61: 3.600(2794)[0m | 
[32mExpert 63: 3.600(2800)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 33: 3.000(2701)[0m | [32mExpert 34: 2.800(2704)[0m | 
[32mExpert  9: 2.600(2809)[0m | [32mExpert  2: 2.400(2656)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  4: 2.000(2722)[0m | [32mExpert 58: 2.000(2782)[0m | 
[32mExpert 60: 2.000(2791)[0m | [32mExpert 36: 1.800(2710)[0m | [32mExpert 40: 1.800(2725)[0m | [32mExpert 42: 1.800(2731)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2809, 2656, 2629, 2653, 2707, 2749, 2722, 2782, 2791, 2710, 2725, 2731]
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  4,  9, 11, 19, 35, 36, 40, 42, 48, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:3.0 | [9]:6.0 | [12]:3.0 | [48]:1.0 | [51]:2.0 | [54]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[17]:3.0 | [26]:7.0 | [29]:3.0 | [34]:1.0 | [60]:1.0 | [16]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[21]:2.0 | [36]:3.0 | [38]:7.0 | [54]:1.0 | [61]:5.0 | [42]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E36 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[6]:1.0 | [26]:3.0 | [33]:7.0 | [39]:2.0 | [52]:1.0 | [50]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[5]:2.0 | [19]:1.0 | [32]:1.0 | [39]:1.0 | [53]:9.0 | [34]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[30]:4.0 | [43]:2.0 | [44]:3.0 | [45]:16.0 | [57]:3.0 | [0]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[30, 43, 44, 45, 57,  0]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 8.400(2858)[0m | [32mExpert  5: 7.800(2993)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 55: 6.400(3011)[0m | 
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 24: 3.800(2909)[0m | 
[32mExpert 50: 3.800(2996)[0m | [32mExpert 23: 3.600(2906)[0m | [32mExpert 29: 3.600(2924)[0m | [32mExpert 52: 3.400(3002)[0m | 
[32mExpert 32: 3.200(2936)[0m | [32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 25: 3.000(2912)[0m | 
[32mExpert 61: 3.000(3032)[0m | [32mExpert  9: 2.800(3047)[0m | [32mExpert 63: 2.600(3038)[0m | [32mExpert 48: 2.600(2987)[0m | 
[32mExpert 31: 2.400(2933)[0m | [32mExpert 33: 2.400(2939)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 38: 2.200(2954)[0m | 
[32mExpert 53: 2.000(3005)[0m | [32mExpert 28: 1.800(2921)[0m | [32mExpert 42: 1.800(2969)[0m | [32mExpert 43: 1.800(2972)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3032, 3047, 3038, 2987, 2933, 2939, 2930, 2954, 3005, 2921, 2969, 2972]
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  9, 28, 30, 31, 33, 38, 42, 43, 48, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[7]:2.0 | [11]:8.0 | [12]:1.0 | [13]:3.0 | [38]:2.0 | [17]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[29]:1.0 | [36]:2.0 | [57]:3.0 | [59]:10.0 | [63]:8.0 | [20]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[1]:2.0 | [2]:1.0 | [21]:1.0 | [23]:5.0 | [33]:3.0 | [0]:10.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[29]:1.0 | [31]:1.0 | [35]:2.0 | [48]:3.0 | [59]:1.0 | [52]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[21]:1.0 | [31]:6.0 | [43]:6.0 | [53]:4.0 | [61]:5.0 | [54]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:7.0 | [23]:8.0 | [31]:2.0 | [33]:4.0 | [37]:1.0 | [17]:4.0 | EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21

---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1, 23, 31, 33, 37, 17]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 15: 7.600(4097)[0m | [32mExpert 10: 7.200(4082)[0m | [32mExpert 48: 6.800(4205)[0m | [32mExpert 25: 6.400(4130)[0m | 
[32mExpert 61: 6.200(4250)[0m | [32mExpert 19: 6.000(4109)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 26: 4.600(4133)[0m | 
[32mExpert 53: 4.600(4223)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 12: 4.000(4088)[0m | 
[32mExpert 14: 4.000(4094)[0m | [32mExpert 42: 3.800(4187)[0m | [32mExpert 46: 3.600(4199)[0m | [32mExpert  0: 3.400(4076)[0m | 
[32mExpert 28: 3.400(4139)[0m | [32mExpert  8: 3.200(4262)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 18: 2.600(4106)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  6: 2.200(4244)[0m | 
[32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | 
[32mExpert 17: 2.000(4103)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 30: 1.800(4148)[0m | [32mExpert 50: 1.800(4214)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4112, 4124, 4226, 4244, 4184, 4229, 4241, 4211, 4103, 4217, 4148, 4214]
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 17, 23, 30, 41, 50, 51, 54, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:7.0 | [13]:3.0 | [18]:3.0 | [37]:2.0 | [60]:7.0 | [59]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[8]:1.0 | [28]:4.0 | [37]:7.0 | [56]:4.0 | [63]:3.0 | [3]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[8]:5.0 | [12]:5.0 | [54]:3.0 | [57]:1.0 | [63]:2.0 | [50]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E54 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[18]:1.0 | [28]:3.0 | [35]:9.0 | [39]:3.0 | [50]:4.0 | [55]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[11]:4.0 | [32]:4.0 | [44]:1.0 | [57]:8.0 | [58]:7.0 | [16]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[19]:7.0 | [22]:2.0 | [24]:8.0 | [28]:8.0 | [40]:1.0 | [36]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[19, 22, 24, 28, 40, 36]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:11.0 | [9]:1.0 | [18]:5.0 | [50]:3.0 | [59]:1.0 | [26]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[3]:2.0 | [9]:3.0 | [15]:1.0 | [20]:3.0 | [31]:1.0 | [10]:6.0 | 
---------------------------------------
return EAMC[1]
è‹±æ–‡EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2921
[1m[33mEnqueueTask: [0m[32mTask: node: ID[941,1c0000001f] (16MB) STATE(0) TENSOR[2920,2921,2919,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:3.0 | [22]:6.0 | [24]:1.0 | [30]:4.0 | [62]:4.0 | [1]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[3]:4.0 | [18]:2.0 | [27]:3.0 | [30]:5.0 | [60]:3.0 | [37]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[3]:3.0 | [28]:6.0 | [33]:2.0 | [37]:5.0 | [38]:3.0 | [27]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[11]:3.0 | [19]:1.0 | [24]:4.0 | [25]:4.0 | [35]:2.0 | [1]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[6]:7.0 | [13]:4.0 | [19]:6.0 | [34]:4.0 | [42]:5.0 | [25]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[27]:4.0 | [29]:5.0 | [41]:4.0 | [57]:2.0 | [63]:2.0 | [59]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[27, 29, 41, 57, 63, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 38: 6.000(2716)[0m | 
[32mExpert 22: 5.600(2665)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 44: 5.200(2737)[0m | 
[32mExpert 45: 5.000(2740)[0m | [32mExpert  7: 4.600(2803)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 61: 4.400(2794)[0m | [32mExpert 26: 4.000(2677)[0m | [32mExpert 23: 3.800(2668)[0m | [32mExpert 17: 3.600(2647)[0m | 
[32mExpert 63: 3.600(2800)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 33: 3.000(2701)[0m | [32mExpert 34: 2.800(2704)[0m | 
[32mExpert 36: 2.600(2710)[0m | [32mExpert 42: 2.600(2731)[0m | [32mExpert  9: 2.600(2809)[0m | [32mExpert  2: 2.400(2656)[0m | 
[32mExpert 11: 2.400(2629)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | 
[32mExpert  4: 2.000(2722)[0m | [32mExpert 58: 2.000(2782)[0m | [32mExpert 60: 2.000(2791)[0m | [32mExpert 21: 1.800(2662)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2710, 2731, 2809, 2656, 2629, 2653, 2707, 2749, 2722, 2782, 2791, 2662]
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  4,  9, 11, 19, 21, 35, 36, 42, 48, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[9]:7.0 | [34]:5.0 | [39]:2.0 | [44]:9.0 | [62]:5.0 | [5]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[4]:2.0 | [16]:6.0 | [38]:4.0 | [49]:8.0 | [58]:2.0 | [13]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[4]:3.0 | [7]:5.0 | [23]:5.0 | [32]:2.0 | [63]:5.0 | [26]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E4 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[20]:4.0 | [33]:8.0 | [42]:8.0 | [45]:8.0 | [49]:3.0 | [16]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[16]:10.0 | [27]:3.0 | [40]:6.0 | [52]:4.0 | [53]:10.0 | [2]:14.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[22]:7.0 | [31]:9.0 | [44]:4.0 | [45]:17.0 | [57]:4.0 | [52]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[22, 31, 44, 45, 57, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 9.200(2858)[0m | [32mExpert  5: 7.800(2993)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 55: 6.400(3011)[0m | 
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 23: 4.400(2906)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 14: 4.000(2876)[0m | 
[32mExpert 24: 3.800(2909)[0m | [32mExpert 50: 3.800(2996)[0m | [32mExpert 29: 3.600(2924)[0m | [32mExpert 52: 3.400(3002)[0m | 
[32mExpert 32: 3.200(2936)[0m | [32mExpert 33: 3.200(2939)[0m | [32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | 
[32mExpert 25: 3.000(2912)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert  9: 2.800(3047)[0m | [32mExpert 63: 2.600(3038)[0m | 
[32mExpert 48: 2.600(2987)[0m | [32mExpert 31: 2.400(2933)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 38: 2.200(2954)[0m | 
[32mExpert  1: 2.000(2861)[0m | [32mExpert 53: 2.000(3005)[0m | [32mExpert 28: 1.800(2921)[0m | [32mExpert 42: 1.800(2969)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 3032, 3047, 3038, 2987, 2933, 2930, 2954, 2861, 3005, 2921, 2969]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2921[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 28, 30, 31, 38, 42, 48, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:9.0 | [24]:2.0 | [54]:2.0 | [61]:4.0 | [63]:7.0 | [29]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[8]:1.0 | [44]:2.0 | [55]:3.0 | [59]:11.0 | [63]:9.0 | [9]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:11.0 | [4]:9.0 | [27]:2.0 | [36]:5.0 | [38]:3.0 | [44]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E38 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[24]:9.0 | [25]:3.0 | [32]:6.0 | [41]:9.0 | [63]:9.0 | [22]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[10]:5.0 | [32]:3.0 | [46]:3.0 | [51]:3.0 | [61]:6.0 | [15]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:8.0 | [35]:3.0 | [47]:7.0 | [54]:2.0 | [57]:3.0 | [14]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1, 35, 47, 54, 57, 14]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
[90mTop 20 Experts:[0m
[32mExpert 15: 7.600(4097)[0m | [32mExpert 10: 7.200(4082)[0m | [32mExpert 48: 6.800(4205)[0m | [32mExpert 25: 6.400(4130)[0m | 
[32mExpert 61: 6.200(4250)[0m | [32mExpert 19: 6.000(4109)[0m | [32mExpert 12: 4.800(4088)[0m | [32mExpert 21: 4.600(4118)[0m | 
[32mExpert 26: 4.600(4133)[0m | [32mExpert 53: 4.600(4223)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 56: 4.200(4232)[0m | 
[32mExpert  8: 4.000(4262)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 42: 3.800(4187)[0m | [32mExpert 46: 3.600(4199)[0m | 
[32mExpert  0: 3.400(4076)[0m | [32mExpert 28: 3.400(4139)[0m | [32mExpert 54: 3.200(4226)[0m | [32mExpert 62: 3.000(4253)[0m | 
[32mExpert 18: 2.600(4106)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert  2: 2.600(4112)[0m | [32mExpert 23: 2.400(4124)[0m | 
[32mExpert  6: 2.200(4244)[0m | [32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | 
[32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | [32mExpert 63: 2.000(4256)[0m | [32mExpert 51: 2.000(4217)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4106, 4214, 4112, 4124, 4244, 4184, 4229, 4241, 4211, 4103, 4256, 4217]
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 17, 18, 23, 41, 50, 51, 55, 59, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:8.0 | [9]:7.0 | [38]:8.0 | [46]:1.0 | [59]:3.0 | [1]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[21]:2.0 | [23]:1.0 | [37]:8.0 | [54]:4.0 | [55]:5.0 | [50]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[0]:5.0 | [18]:4.0 | [26]:5.0 | [35]:2.0 | [48]:9.0 | [50]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E18 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[19]:1.0 | [35]:10.0 | [43]:2.0 | [55]:4.0 | [56]:8.0 | [22]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[13]:3.0 | [18]:1.0 | [24]:2.0 | [33]:5.0 | [46]:7.0 | [27]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[18]:1.0 | [19]:8.0 | [24]:9.0 | [45]:2.0 | [51]:4.0 | [3]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[18, 19, 24, 45, 51,  3]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:3.0 | [17]:3.0 | [18]:6.0 | [47]:7.0 | [55]:3.0 | [44]:11.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[10]:7.0 | [24]:1.0 | [26]:7.0 | [38]:5.0 | [48]:4.0 | [58]:1.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[12]:3.0 | [44]:2.0 | [51]:2.0 | [52]:4.0 | [54]:3.0 | [4]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[0]:3.0 | [11]:2.0 | [14]:6.0 | [33]:3.0 | [46]:3.0 | [37]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[1]:3.0 | [9]:5.0 | [24]:2.0 | [51]:1.0 | [60]:6.0 | [55]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[16]:2.0 | [26]:5.0 | [29]:8.0 | [39]:3.0 | [57]:4.0 | [52]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[10]:3.0 | [17]:4.0 | [55]:3.0 | [56]:2.0 | [63]:8.0 | [27]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[12]:3.0 | [18]:2.0 | [34]:2.0 | [35]:4.0 | [55]:3.0 | [22]:8.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[12, 18, 34, 35, 55, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 38: 6.000(2716)[0m | 
[32mExpert 22: 5.600(2665)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert  7: 5.400(2803)[0m | [32mExpert 41: 5.400(2728)[0m | 
[32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 26: 4.800(2677)[0m | [32mExpert 23: 4.600(2668)[0m | 
[32mExpert 31: 4.600(2695)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 61: 4.400(2794)[0m | [32mExpert 63: 4.400(2800)[0m | 
[32mExpert 17: 3.600(2647)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert 33: 3.000(2701)[0m | [32mExpert  4: 2.800(2722)[0m | 
[32mExpert 34: 2.800(2704)[0m | [32mExpert 36: 2.600(2710)[0m | [32mExpert 42: 2.600(2731)[0m | [32mExpert  9: 2.600(2809)[0m | 
[32mExpert  2: 2.400(2656)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 32: 2.400(2698)[0m | [32mExpert 19: 2.200(2653)[0m | 
[32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 58: 2.000(2782)[0m | [32mExpert 60: 2.000(2791)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2710, 2731, 2809, 2656, 2629, 2698, 2653, 2707, 2749, 2782, 2791]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  9, 11, 19, 32, 34, 35, 36, 42, 48, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:8.0 | [32]:3.0 | [34]:6.0 | [40]:3.0 | [55]:2.0 | [6]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[12]:2.0 | [17]:4.0 | [22]:1.0 | [26]:8.0 | [33]:4.0 | [42]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[8]:2.0 | [25]:3.0 | [32]:3.0 | [33]:3.0 | [61]:6.0 | [17]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[3]:1.0 | [33]:9.0 | [39]:3.0 | [51]:5.0 | [59]:11.0 | [11]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[0]:2.0 | [4]:3.0 | [5]:3.0 | [7]:1.0 | [53]:11.0 | [16]:11.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[30]:5.0 | [41]:6.0 | [43]:3.0 | [45]:18.0 | [57]:5.0 | [47]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[30, 41, 43, 45, 57, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 10.000(2858)[0m | [32mExpert  4: 8.200(2960)[0m | [32mExpert  5: 7.800(2993)[0m | [32mExpert 55: 6.400(3011)[0m | 
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert 36: 5.400(2948)[0m | 
[32mExpert 15: 4.800(2879)[0m | [32mExpert 23: 4.400(2906)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 14: 4.000(2876)[0m | 
[32mExpert 24: 3.800(2909)[0m | [32mExpert 50: 3.800(2996)[0m | [32mExpert 29: 3.600(2924)[0m | [32mExpert 52: 3.400(3002)[0m | 
[32mExpert 32: 3.200(2936)[0m | [32mExpert 33: 3.200(2939)[0m | [32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | 
[32mExpert 25: 3.000(2912)[0m | [32mExpert 38: 3.000(2954)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert  9: 2.800(3047)[0m | 
[32mExpert 63: 2.600(3038)[0m | [32mExpert 48: 2.600(2987)[0m | [32mExpert 31: 2.400(2933)[0m | [32mExpert 30: 2.200(2930)[0m | 
[32mExpert 44: 2.200(2975)[0m | [32mExpert  1: 2.000(2861)[0m | [32mExpert 53: 2.000(3005)[0m | [32mExpert 27: 1.800(2918)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2954, 3032, 3047, 3038, 2987, 2933, 2930, 2975, 2861, 3005, 2918]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 27, 30, 31, 38, 44, 48, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[7]:3.0 | [16]:3.0 | [43]:3.0 | [48]:5.0 | [54]:3.0 | [29]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[24]:4.0 | [36]:3.0 | [47]:6.0 | [48]:3.0 | [57]:4.0 | [63]:10.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[1]:3.0 | [23]:6.0 | [33]:4.0 | [34]:1.0 | [53]:3.0 | [50]:5.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[29]:2.0 | [38]:4.0 | [46]:2.0 | [47]:4.0 | [48]:4.0 | [9]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[23]:1.0 | [26]:10.0 | [31]:7.0 | [42]:4.0 | [53]:5.0 | [38]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[23]:9.0 | [32]:7.0 | [37]:2.0 | [50]:4.0 | [58]:8.0 | [39]:2.0 | EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[23, 32, 37, 50, 58, 39]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 15: 7.600(4097)[0m | [32mExpert 48: 7.600(4205)[0m | [32mExpert 10: 7.200(4082)[0m | [32mExpert 25: 6.400(4130)[0m | 
[32mExpert 61: 6.200(4250)[0m | [32mExpert 19: 6.000(4109)[0m | [32mExpert 26: 5.400(4133)[0m | [32mExpert 12: 4.800(4088)[0m | 
[32mExpert 21: 4.600(4118)[0m | [32mExpert 53: 4.600(4223)[0m | [32mExpert  0: 4.200(4076)[0m | [32mExpert 27: 4.200(4136)[0m | 
[32mExpert 56: 4.200(4232)[0m | [32mExpert  8: 4.000(4262)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 42: 3.800(4187)[0m | 
[32mExpert 46: 3.600(4199)[0m | [32mExpert 18: 3.400(4106)[0m | [32mExpert 28: 3.400(4139)[0m | [32mExpert 50: 3.400(4214)[0m | 
[32mExpert 54: 3.200(4226)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert  2: 2.600(4112)[0m | [32mExpert 23: 2.400(4124)[0m | 
[32mExpert  6: 2.200(4244)[0m | [32mExpert 35: 2.200(4163)[0m | [32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | 
[32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 17: 2.000(4103)[0m | [32mExpert 63: 2.000(4256)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4226, 4253, 4112, 4124, 4244, 4163, 4184, 4229, 4241, 4211, 4103, 4256]
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 17, 23, 35, 41, 54, 55, 59, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:4.0 | [6]:5.0 | [13]:4.0 | [37]:3.0 | [59]:4.0 | [61]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[9]:1.0 | [10]:3.0 | [11]:7.0 | [56]:5.0 | [63]:4.0 | [29]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[8]:6.0 | [12]:6.0 | [17]:3.0 | [42]:5.0 | [61]:8.0 | [6]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[32]:3.0 | [35]:11.0 | [50]:5.0 | [57]:7.0 | [59]:4.0 | [47]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[3]:4.0 | [12]:8.0 | [15]:4.0 | [16]:10.0 | [58]:8.0 | [59]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[6]:2.0 | [8]:3.0 | [19]:9.0 | [26]:6.0 | [42]:2.0 | [62]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 6,  8, 19, 26, 42, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:12.0 | [30]:2.0 | [41]:3.0 | [42]:2.0 | [52]:4.0 | [35]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[9]:4.0 | [26]:8.0 | [32]:5.0 | [51]:3.0 | [54]:3.0 | [27]:6.0 | 
---------------------------------------
return EAMC[1]
ã€æ³•EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:2.0 | [15]:2.0 | [24]:2.0 | [29]:4.0 | [38]:7.0 | [1]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[1]:1.0 | [14]:7.0 | [44]:1.0 | [59]:3.0 | [63]:8.0 | [30]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[3]:4.0 | [14]:6.0 | [28]:7.0 | [38]:4.0 | [59]:1.0 | [0]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[11]:4.0 | [24]:5.0 | [35]:3.0 | [37]:4.0 | [44]:7.0 | [25]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[13]:5.0 | [20]:4.0 | [25]:2.0 | [42]:6.0 | [44]:4.0 | [54]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[22]:9.0 | [27]:5.0 | [41]:5.0 | [59]:4.0 | [63]:3.0 | [1]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[22, 27, 41, 59, 63,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 6.000(2644)[0m | [32mExpert 38: 6.000(2716)[0m | 
[32mExpert 22: 5.600(2665)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert  7: 5.400(2803)[0m | [32mExpert 41: 5.400(2728)[0m | 
[32mExpert 61: 5.200(2794)[0m | [32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 26: 4.800(2677)[0m | 
[32mExpert 23: 4.600(2668)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 17: 4.400(2647)[0m | 
[32mExpert 63: 4.400(2800)[0m | [32mExpert 33: 3.800(2701)[0m | [32mExpert 32: 3.200(2698)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert  4: 2.800(2722)[0m | [32mExpert 34: 2.800(2704)[0m | [32mExpert 36: 2.600(2710)[0m | [32mExpert 42: 2.600(2731)[0m | 
[32mExpert  9: 2.600(2809)[0m | [32mExpert 25: 2.400(2674)[0m | [32mExpert  2: 2.400(2656)[0m | [32mExpert 11: 2.400(2629)[0m | 
[32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  8: 2.000(2806)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2722, 2704, 2710, 2731, 2809, 2674, 2656, 2629, 2653, 2707, 2749, 2806]
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  2,  4,  8,  9, 11, 19, 25, 34, 35, 36, 42, 48 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:7.0 | [34]:7.0 | [39]:3.0 | [43]:4.0 | [62]:6.0 | [18]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[4]:3.0 | [16]:7.0 | [30]:10.0 | [39]:10.0 | [48]:1.0 | [58]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[4]:4.0 | [16]:7.0 | [32]:4.0 | [55]:1.0 | [63]:6.0 | [7]:6.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E4 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[18]:3.0 | [25]:6.0 | [27]:1.0 | [42]:9.0 | [49]:4.0 | [45]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:15.0 | [16]:12.0 | [17]:9.0 | [27]:4.0 | [40]:7.0 | [49]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[4]:5.0 | [16]:3.0 | [31]:10.0 | [45]:19.0 | [59]:10.0 | [33]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 4, 16, 31, 45, 59, 33]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 10.000(2858)[0m | [32mExpert  4: 8.200(2960)[0m | [32mExpert  5: 7.800(2993)[0m | [32mExpert 55: 6.400(3011)[0m | 
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert 36: 5.400(2948)[0m | 
[32mExpert 23: 5.200(2906)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert 50: 4.600(2996)[0m | [32mExpert 11: 4.200(2867)[0m | 
[32mExpert 14: 4.000(2876)[0m | [32mExpert 33: 4.000(2939)[0m | [32mExpert 24: 3.800(2909)[0m | [32mExpert 29: 3.600(2924)[0m | 
[32mExpert 52: 3.400(3002)[0m | [32mExpert 32: 3.200(2936)[0m | [32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | 
[32mExpert 25: 3.000(2912)[0m | [32mExpert 38: 3.000(2954)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert  1: 2.800(2861)[0m | 
[32mExpert 53: 2.800(3005)[0m | [32mExpert  9: 2.800(3047)[0m | [32mExpert 63: 2.600(3038)[0m | [32mExpert 48: 2.600(2987)[0m | 
[32mExpert 31: 2.400(2933)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 44: 2.200(2975)[0m | [32mExpert 27: 1.800(2918)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2954, 3032, 2861, 3005, 3047, 3038, 2987, 2933, 2930, 2975, 2918]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 27, 30, 31, 38, 44, 48, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:6.0 | [16]:4.0 | [54]:4.0 | [58]:7.0 | [61]:5.0 | [36]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[7]:7.0 | [18]:4.0 | [19]:7.0 | [27]:10.0 | [31]:6.0 | [48]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[5]:10.0 | [11]:5.0 | [17]:1.0 | [24]:5.0 | [55]:8.0 | [23]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 16 MLP ==
[0m
[9]:9.0 | [19]:3.0 | [26]:6.0 | [33]:9.0 | [63]:10.0 | [37]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[10]:6.0 | [23]:2.0 | [26]:11.0 | [27]:6.0 | [32]:4.0 | [41]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:9.0 | [2]:7.0 | [23]:10.0 | [36]:2.0 | [56]:9.0 | [49]:8.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1,  2, 23, 36, 56, 49]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 15: 7.600(4097)[0m | [32mExpert 48: 7.600(4205)[0m | [32mExpert 10: 7.200(4082)[0m | [32mExpert 61: 7.000(4250)[0m | 
[32mExpert 25: 6.400(4130)[0m | [32mExpert 19: 6.000(4109)[0m | EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
[32mExpert 12: 5.600(4088)[0m | [32mExpert 26: 5.400(4133)[0m | 
[32mExpert  8: 4.800(4262)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 42: 4.600(4187)[0m | [32mExpert 53: 4.600(4223)[0m | 
[32mExpert  0: 4.200(4076)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | 
[32mExpert 46: 3.600(4199)[0m | [32mExpert 18: 3.400(4106)[0m | [32mExpert 28: 3.400(4139)[0m | [32mExpert 50: 3.400(4214)[0m | 
[32mExpert 54: 3.200(4226)[0m | [32mExpert  6: 3.000(4244)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert 17: 2.800(4103)[0m | 
[32mExpert  2: 2.600(4112)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 35: 2.200(4163)[0m | [32mExpert 41: 2.200(4184)[0m | 
[32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 63: 2.000(4256)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4226, 4244, 4253, 4103, 4112, 4124, 4163, 4184, 4229, 4241, 4211, 4256]
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 17, 23, 35, 41, 54, 55, 59, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:6.0 | [22]:9.0 | [35]:4.0 | [40]:6.0 | [42]:4.0 | [4]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[3]:2.0 | [20]:5.0 | [38]:8.0 | [48]:4.0 | [63]:5.0 | [10]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[2]:3.0 | [15]:10.0 | [19]:7.0 | [28]:5.0 | [61]:9.0 | [36]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E2 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[14]:1.0 | [32]:4.0 | [47]:5.0 | [49]:4.0 | [58]:6.0 | [23]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[13]:4.0 | [15]:5.0 | [45]:2.0 | [58]:9.0 | [60]:1.0 | [41]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[6]:3.0 | [23]:6.0 | [35]:2.0 | [36]:7.0 | [47]:4.0 | [26]:7.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 6, 23, 35, 36, 47, 26]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[16]:2.0 | [19]:5.0 | [30]:3.0 | [33]:2.0 | [41]:4.0 | [58]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[13]:2.0 | [32]:6.0 | [41]:4.0 | [47]:3.0 | [49]:3.0 | [11]:3.0 | 
---------------------------------------
return EAMC[1]
æ–‡EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:4.0 | [11]:6.0 | [49]:5.0 | [50]:5.0 | [62]:5.0 | [36]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[2]:3.0 | [10]:4.0 | [30]:7.0 | [40]:2.0 | [44]:2.0 | [4]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[10]:2.0 | [28]:8.0 | [37]:6.0 | [38]:5.0 | [41]:5.0 | [42]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[11]:5.0 | [24]:6.0 | [25]:6.0 | [35]:4.0 | [40]:1.0 | [32]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[13]:6.0 | [19]:7.0 | [20]:5.0 | [34]:5.0 | [42]:7.0 | [25]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[27]:6.0 | [41]:6.0 | [57]:3.0 | [59]:5.0 | [63]:4.0 | [29]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[27, 41, 57, 59, 63, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 6.800(2644)[0m | [32mExpert  7: 6.200(2803)[0m | 
[32mExpert 38: 6.000(2716)[0m | [32mExpert 22: 5.600(2665)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | 
[32mExpert 61: 5.200(2794)[0m | [32mExpert 63: 5.200(2800)[0m | [32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | 
[32mExpert 26: 4.800(2677)[0m | [32mExpert 23: 4.600(2668)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 17: 4.400(2647)[0m | [32mExpert 32: 4.000(2698)[0m | [32mExpert 33: 3.800(2701)[0m | [32mExpert  4: 3.600(2722)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 34: 2.800(2704)[0m | [32mExpert 36: 2.600(2710)[0m | [32mExpert 42: 2.600(2731)[0m | 
[32mExpert  9: 2.600(2809)[0m | [32mExpert 25: 2.400(2674)[0m | [32mExpert  2: 2.400(2656)[0m | [32mExpert 11: 2.400(2629)[0m | 
[32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  8: 2.000(2806)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2623, 2704, 2710, 2731, 2809, 2674, 2656, 2629, 2653, 2707, 2749, 2806]
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  8,  9, 11, 19, 25, 34, 35, 36, 42, 48 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[9]:8.0 | [34]:8.0 | [39]:4.0 | [44]:10.0 | [62]:7.0 | [5]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[4]:4.0 | [13]:7.0 | [16]:8.0 | [39]:11.0 | [48]:2.0 | [17]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[4]:5.0 | [7]:7.0 | [23]:6.0 | [60]:3.0 | [63]:7.0 | [26]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[25]:7.0 | [33]:10.0 | [42]:10.0 | [45]:10.0 | [49]:5.0 | [16]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[16]:13.0 | [27]:5.0 | [40]:8.0 | [52]:5.0 | [53]:12.0 | [33]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[8]:2.0 | [22]:8.0 | [31]:11.0 | [44]:5.0 | [52]:3.0 | [33]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 8, 22, 31, 44, 52, 33]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 10.000(2858)[0m | [32mExpert  5: 8.600(2993)[0m | [32mExpert  4: 8.200(2960)[0m | [32mExpert 55: 7.200(3011)[0m | 
[32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert 23: 6.000(2906)[0m | [32mExpert  6: 5.400(3026)[0m | 
[32mExpert 36: 5.400(2948)[0m | [32mExpert 11: 5.000(2867)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert 24: 4.600(2909)[0m | 
[32mExpert 50: 4.600(2996)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 33: 4.000(2939)[0m | [32mExpert 29: 3.600(2924)[0m | 
[32mExpert 52: 3.400(3002)[0m | [32mExpert 32: 3.200(2936)[0m | [32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | 
[32mExpert 25: 3.000(2912)[0m | [32mExpert 38: 3.000(2954)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert  1: 2.800(2861)[0m | 
[32mExpert 53: 2.800(3005)[0m | [32mExpert  9: 2.800(3047)[0m | [32mExpert 63: 2.600(3038)[0m | [32mExpert 48: 2.600(2987)[0m | 
[32mExpert 31: 2.400(2933)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 44: 2.200(2975)[0m | [32mExpert 27: 1.800(2918)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2954, 3032, 2861, 3005, 3047, 3038, 2987, 2933, 2930, 2975, 2918]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 27, 30, 31, 38, 44, 48, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:10.0 | [53]:1.0 | [54]:5.0 | [61]:6.0 | [63]:8.0 | [36]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[47]:7.0 | [48]:5.0 | [55]:4.0 | [59]:12.0 | [63]:11.0 | [46]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[4]:10.0 | [36]:6.0 | [37]:1.0 | [39]:2.0 | [48]:2.0 | [26]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:10.0 | [25]:4.0 | [37]:5.0 | [53]:3.0 | [63]:11.0 | [32]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[10]:7.0 | [13]:4.0 | [32]:5.0 | [46]:4.0 | [61]:7.0 | [23]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:10.0 | [2]:8.0 | [14]:5.0 | [35]:4.0 | [50]:5.0 | [30]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1,  2, 14, 35, 50, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 15: 8.400(4097)[0m | [32mExpert 61: 7.800(4250)[0m | [32mExpert 48: 7.600(4205)[0m | [32mExpert 10: 7.200(4082)[0m | 
[32mExpert 19: 6.800(4109)[0m | [32mExpert 25: 6.400(4130)[0m | EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4103
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1320,110000002b] (16MB) STATE(0) TENSOR[4102,4103,4101,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
[32mExpert 12: 5.600(4088)[0m | [32mExpert 26: 5.400(4133)[0m | 
[32mExpert  8: 4.800(4262)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 42: 4.600(4187)[0m | [32mExpert 53: 4.600(4223)[0m | 
[32mExpert  0: 4.200(4076)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 28: 4.200(4139)[0m | [32mExpert 56: 4.200(4232)[0m | 
[32mExpert 14: 4.000(4094)[0m | [32mExpert 46: 3.600(4199)[0m | [32mExpert  2: 3.400(4112)[0m | [32mExpert 18: 3.400(4106)[0m | 
[32mExpert 50: 3.400(4214)[0m | [32mExpert 54: 3.200(4226)[0m | [32mExpert  6: 3.000(4244)[0m | [32mExpert 62: 3.000(4253)[0m | 
[32mExpert 17: 2.800(4103)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 35: 2.200(4163)[0m | [32mExpert 41: 2.200(4184)[0m | 
[32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | [32mExpert 63: 2.000(4256)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4214, 4226, 4244, 4253, 4103, 4124, 4163, 4184, 4229, 4241, 4211, 4256]
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4103[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 17, 23, 35, 41, 50, 54, 55, 59, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[2]:3.0 | [6]:7.0 | [8]:1.0 | [9]:8.0 | [38]:9.0 | [24]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[3]:3.0 | [23]:2.0 | [29]:5.0 | [34]:4.0 | [54]:5.0 | [36]:11.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[10]:8.0 | [17]:4.0 | [18]:5.0 | [26]:6.0 | [52]:1.0 | [47]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[3]:3.0 | [8]:5.0 | [33]:9.0 | [43]:3.0 | [56]:9.0 | [10]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[1]:4.0 | [13]:5.0 | [15]:6.0 | [45]:3.0 | [47]:6.0 | [41]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[45]:3.0 | [48]:4.0 | [52]:8.0 | [60]:14.0 | [61]:6.0 | [8]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[45, 48, 52, 60, 61,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:6.0 | [18]:7.0 | [45]:7.0 | [47]:8.0 | [54]:11.0 | [38]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[10]:8.0 | [27]:7.0 | [32]:7.0 | [38]:6.0 | [43]:3.0 | [57]:4.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[11]:7.0 | [47]:2.0 | [51]:3.0 | [52]:5.0 | [54]:4.0 | [12]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[0]:4.0 | [11]:3.0 | [14]:8.0 | [15]:4.0 | [33]:4.0 | [10]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[1]:4.0 | [9]:6.0 | [18]:1.0 | [24]:3.0 | [51]:2.0 | [10]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[16]:3.0 | [26]:6.0 | [29]:9.0 | [42]:1.0 | [57]:5.0 | [44]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[17]:5.0 | [31]:3.0 | [47]:4.0 | [54]:5.0 | [63]:9.0 | [10]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[32]:3.0 | [34]:3.0 | [39]:3.0 | [42]:2.0 | [55]:4.0 | [22]:10.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[32, 34, 39, 42, 55, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert  7: 7.000(2803)[0m | [32mExpert 16: 6.800(2644)[0m | 
[32mExpert 38: 6.000(2716)[0m | [32mExpert 63: 6.000(2800)[0m | [32mExpert 22: 5.600(2665)[0m | [32mExpert 26: 5.600(2677)[0m | 
[32mExpert 53: 5.600(2767)[0m | [32mExpert 23: 5.400(2668)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 61: 5.200(2794)[0m | 
[32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert  4: 4.400(2722)[0m | 
[32mExpert 12: 4.400(2632)[0m | [32mExpert 17: 4.400(2647)[0m | [32mExpert 32: 4.000(2698)[0m | [32mExpert 33: 3.800(2701)[0m | 
[32mExpert  1: 3.000(2623)[0m | [32mExpert 60: 2.800(2791)[0m | [32mExpert 34: 2.800(2704)[0m | [32mExpert 36: 2.600(2710)[0m | 
[32mExpert 42: 2.600(2731)[0m | [32mExpert  9: 2.600(2809)[0m | [32mExpert 25: 2.400(2674)[0m | [32mExpert  2: 2.400(2656)[0m | 
[32mExpert 11: 2.400(2629)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | [32mExpert 48: 2.200(2749)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2623, 2791, 2704, 2710, 2731, 2809, 2674, 2656, 2629, 2653, 2707, 2749]
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  9, 11, 19, 25, 34, 35, 36, 42, 48, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[18]:4.0 | [32]:4.0 | [34]:9.0 | [40]:4.0 | [55]:3.0 | [20]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[12]:3.0 | [17]:6.0 | [22]:2.0 | [26]:9.0 | [42]:2.0 | [54]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[8]:3.0 | [17]:5.0 | [30]:2.0 | [32]:5.0 | [33]:4.0 | [25]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[12]:4.0 | [27]:2.0 | [33]:11.0 | [51]:6.0 | [59]:12.0 | [9]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[0]:3.0 | [4]:4.0 | [5]:4.0 | [7]:2.0 | [53]:13.0 | [16]:14.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[12]:4.0 | [43]:4.0 | [45]:20.0 | [47]:6.0 | [57]:6.0 | [41]:7.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[12, 43, 45, 47, 57, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 10.000(2858)[0m | [32mExpert  4: 9.000(2960)[0m | [32mExpert  5: 8.600(2993)[0m | [32mExpert 55: 7.200(3011)[0m | 
[32mExpert 36: 6.200(2948)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | [32mExpert 23: 6.000(2906)[0m | 
[32mExpert  6: 5.400(3026)[0m | [32mExpert 11: 5.000(2867)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert 24: 4.600(2909)[0m | 
[32mExpert 50: 4.600(2996)[0m | [32mExpert 14: 4.000(2876)[0m | [32mExpert 33: 4.000(2939)[0m | [32mExpert 29: 3.600(2924)[0m | 
[32mExpert 52: 3.400(3002)[0m | [32mExpert 48: 3.400(2987)[0m | [32mExpert 32: 3.200(2936)[0m | [32mExpert 41: 3.200(2966)[0m | 
[32mExpert 40: 3.200(2963)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 38: 3.000(2954)[0m | [32mExpert 61: 3.000(3032)[0m | 
[32mExpert  1: 2.800(2861)[0m | [32mExpert 53: 2.800(3005)[0m | [32mExpert  9: 2.800(3047)[0m | [32mExpert 63: 2.600(3038)[0m | 
[32mExpert 31: 2.400(2933)[0m | [32mExpert 26: 2.200(2915)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 44: 2.200(2975)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2963, 2912, 2954, 3032, 2861, 3005, 3047, 3038, 2933, 2915, 2930, 2975]
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 26, 30, 31, 38, 40, 44, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[17]:6.0 | [29]:10.0 | [43]:4.0 | [48]:6.0 | [54]:6.0 | [35]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[0]:5.0 | [36]:4.0 | [46]:7.0 | [47]:8.0 | [57]:5.0 | [48]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[23]:8.0 | [33]:5.0 | [34]:2.0 | [52]:4.0 | [61]:3.0 | [30]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[29]:3.0 | [32]:8.0 | [38]:5.0 | [46]:3.0 | [47]:5.0 | [53]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[15]:5.0 | [28]:6.0 | [38]:8.0 | [42]:5.0 | [53]:6.0 | [2]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[23]:11.0 | [32]:8.0 | [34]:1.0 | [37]:3.0 | [58]:9.0 | EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
[50]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[23, 32, 34, 37, 58, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 15: 8.400(4097)[0m | [32mExpert 10: 8.000(4082)[0m | [32mExpert 61: 7.800(4250)[0m | [32mExpert 48: 7.600(4205)[0m | 
[32mExpert 19: 6.800(4109)[0m | [32mExpert 25: 6.400(4130)[0m | [32mExpert 26: 6.200(4133)[0m | [32mExpert 12: 5.600(4088)[0m | 
[32mExpert  8: 4.800(4262)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 42: 4.600(4187)[0m | [32mExpert 53: 4.600(4223)[0m | 
[32mExpert  0: 4.200(4076)[0m | [32mExpert 18: 4.200(4106)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 28: 4.200(4139)[0m | 
[32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 17: 3.600(4103)[0m | [32mExpert 46: 3.600(4199)[0m | 
[32mExpert  2: 3.400(4112)[0m | [32mExpert 50: 3.400(4214)[0m | [32mExpert 54: 3.200(4226)[0m | [32mExpert  6: 3.000(4244)[0m | 
[32mExpert 62: 3.000(4253)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 35: 2.200(4163)[0m | [32mExpert 47: 2.200(4202)[0m | 
[32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | [32mExpert  5: 2.000(4211)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4112, 4214, 4226, 4244, 4253, 4124, 4163, 4202, 4184, 4229, 4241, 4211]
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 23, 35, 41, 47, 50, 54, 55, 59, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:5.0 | [13]:5.0 | [22]:10.0 | [58]:8.0 | [60]:8.0 | [6]:8.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[9]:2.0 | [11]:8.0 | [28]:5.0 | [56]:6.0 | [63]:6.0 | [10]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[1]:2.0 | [12]:7.0 | [17]:5.0 | [36]:3.0 | [61]:10.0 | [8]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 22 MLP ==
[0m
[0]:3.0 | [33]:10.0 | [35]:12.0 | [44]:6.0 | [50]:6.0 | [49]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[15]:7.0 | [16]:11.0 | [58]:10.0 | [60]:2.0 | [62]:2.0 | [12]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[42]:3.0 | [48]:5.0 | [50]:6.0 | [52]:9.0 | [61]:7.0 | [6]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[42, 48, 50, 52, 61,  6]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:13.0 | [14]:5.0 | [30]:4.0 | [41]:5.0 | [50]:4.0 | [23]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[26]:9.0 | [32]:8.0 | [50]:4.0 | [51]:4.0 | [54]:4.0 | [9]:5.0 | 
---------------------------------------
return EAMC[1]
ã€æ—¥EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[6]:3.0 | [24]:3.0 | [33]:4.0 | [38]:8.0 | [55]:3.0 | [15]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[1]:2.0 | [31]:6.0 | [44]:3.0 | [59]:4.0 | [60]:4.0 | [35]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[3]:5.0 | [8]:2.0 | [14]:7.0 | [27]:2.0 | [38]:6.0 | [28]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[11]:6.0 | [25]:7.0 | [35]:5.0 | [37]:5.0 | [44]:9.0 | [2]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[4]:3.0 | [13]:7.0 | [25]:4.0 | [42]:8.0 | [44]:5.0 | [54]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[20]:10.0 | [27]:7.0 | [41]:7.0 | [59]:6.0 | [63]:5.0 | [23]:2.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[20, 27, 41, 59, 63, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert  7: 7.000(2803)[0m | [32mExpert 16: 6.800(2644)[0m | 
[32mExpert 38: 6.000(2716)[0m | [32mExpert 63: 6.000(2800)[0m | [32mExpert 22: 5.600(2665)[0m | [32mExpert 26: 5.600(2677)[0m | 
[32mExpert 53: 5.600(2767)[0m | [32mExpert 23: 5.400(2668)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 61: 5.200(2794)[0m | 
[32mExpert 17: 5.200(2647)[0m | [32mExpert 44: 5.200(2737)[0m | [32mExpert 45: 5.000(2740)[0m | [32mExpert 32: 4.800(2698)[0m | 
[32mExpert 31: 4.600(2695)[0m | [32mExpert 33: 4.600(2701)[0m | [32mExpert  4: 4.400(2722)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 25: 3.200(2674)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert  8: 2.800(2806)[0m | [32mExpert 60: 2.800(2791)[0m | 
[32mExpert 34: 2.800(2704)[0m | [32mExpert 36: 2.600(2710)[0m | [32mExpert 42: 2.600(2731)[0m | [32mExpert  9: 2.600(2809)[0m | 
[32mExpert  2: 2.400(2656)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 19: 2.200(2653)[0m | [32mExpert 35: 2.200(2707)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2674, 2623, 2806, 2791, 2704, 2710, 2731, 2809, 2656, 2629, 2653, 2707]
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  8,  9, 11, 19, 25, 34, 35, 36, 42, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:9.0 | [13]:2.0 | [34]:10.0 | [39]:5.0 | [62]:8.0 | [24]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[16]:9.0 | [30]:11.0 | [39]:12.0 | [48]:3.0 | [58]:4.0 | [47]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[4]:6.0 | [7]:8.0 | [16]:8.0 | [55]:2.0 | [63]:8.0 | [32]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 10 MLP ==
[0m
[16]:9.0 | [25]:8.0 | [33]:12.0 | [42]:11.0 | [45]:11.0 | [18]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[2]:16.0 | [16]:15.0 | [17]:10.0 | [27]:6.0 | [40]:9.0 | [58]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[3]:6.0 | [16]:4.0 | [31]:12.0 | [45]:21.0 | [59]:11.0 | [35]:1.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 3, 16, 31, 45, 59, 35]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 10.000(2858)[0m | [32mExpert  4: 9.000(2960)[0m | [32mExpert  5: 8.600(2993)[0m | [32mExpert 55: 7.200(3011)[0m | 
[32mExpert 23: 6.800(2906)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | 
[32mExpert  6: 5.400(3026)[0m | [32mExpert 11: 5.000(2867)[0m | [32mExpert 15: 4.800(2879)[0m | [32mExpert 33: 4.800(2939)[0m | 
[32mExpert 24: 4.600(2909)[0m | [32mExpert 50: 4.600(2996)[0m | [32mExpert 52: 4.200(3002)[0m | [32mExpert 14: 4.000(2876)[0m | 
[32mExpert 61: 3.800(3032)[0m | [32mExpert 29: 3.600(2924)[0m | [32mExpert 48: 3.400(2987)[0m | [32mExpert 32: 3.200(2936)[0m | 
[32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 30: 3.000(2930)[0m | 
[32mExpert 38: 3.000(2954)[0m | [32mExpert  1: 2.800(2861)[0m | [32mExpert 53: 2.800(3005)[0m | [32mExpert  9: 2.800(3047)[0m | 
[32mExpert 63: 2.600(3038)[0m | [32mExpert 31: 2.400(2933)[0m | [32mExpert 26: 2.200(2915)[0m | [32mExpert 34: 2.200(2942)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2966, 2963, 2912, 2930, 2954, 2861, 3005, 3047, 3038, 2933, 2915, 2942]
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 26, 30, 31, 34, 38, 40, 41, 53, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:7.0 | [35]:10.0 | [54]:7.0 | [58]:8.0 | [61]:7.0 | [14]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[18]:5.0 | [19]:8.0 | [27]:11.0 | [31]:7.0 | [46]:8.0 | [44]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[5]:11.0 | [11]:6.0 | [17]:2.0 | [24]:6.0 | [55]:9.0 | [23]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 16 MLP ==
[0m
[19]:4.0 | [32]:9.0 | [33]:10.0 | [37]:6.0 | [53]:5.0 | [9]:11.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[10]:8.0 | [23]:4.0 | [27]:7.0 | [32]:6.0 | [35]:2.0 | [5]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:11.0 | [2]:9.0 | [23]:12.0 | [56]:10.0 | [58]:10.0 | [50]:7.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1,  2, 23, 56, 58, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 61: 8.600(4250)[0m | [32mExpert 15: 8.400(4097)[0m | [32mExpert 10: 8.000(4082)[0m | [32mExpert 48: 7.600(4205)[0m | 
[32mExpert 19: 6.800(4109)[0m | [32mExpert 12: 6.400(4088)[0m | [32mExpert 25: 6.400(4130)[0m | [32mExpert 26: 6.200(4133)[0m | 
[32mExpert  8: 5.600(4262)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 42: 4.600(4187)[0m | [32mExpert 53: 4.600(4223)[0m | 
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
[32mExpert 17: 4.400(4103)[0m | [32mExpert  0: 4.200(4076)[0m | [32mExpert 18: 4.200(4106)[0m | [32mExpert 27: 4.200(4136)[0m | 
[32mExpert 28: 4.200(4139)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 46: 3.600(4199)[0m | 
[32mExpert  2: 3.400(4112)[0m | [32mExpert 50: 3.400(4214)[0m | [32mExpert 54: 3.200(4226)[0m | [32mExpert  6: 3.000(4244)[0m | 
[32mExpert 62: 3.000(4253)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 36: 2.400(4166)[0m | [32mExpert 35: 2.200(4163)[0m | 
[32mExpert 47: 2.200(4202)[0m | [32mExpert 41: 2.200(4184)[0m | [32mExpert 55: 2.200(4229)[0m | [32mExpert 59: 2.200(4241)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4112, 4214, 4226, 4244, 4253, 4124, 4166, 4163, 4202, 4184, 4229, 4241]
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  6, 23, 35, 36, 41, 47, 50, 54, 55, 59, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:9.0 | [20]:1.0 | [22]:11.0 | [35]:5.0 | [40]:7.0 | [42]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[3]:4.0 | [10]:6.0 | [20]:6.0 | [48]:5.0 | [63]:7.0 | [59]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[5]:3.0 | [15]:11.0 | [28]:6.0 | [36]:4.0 | [61]:11.0 | [52]:2.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E36 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[14]:2.0 | [32]:5.0 | [49]:6.0 | [56]:10.0 | [58]:7.0 | [4]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[1]:5.0 | [13]:6.0 | [58]:11.0 | [59]:8.0 | [60]:3.0 | [48]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[23]:7.0 | [24]:10.0 | [33]:2.0 | [35]:3.0 | [36]:8.0 | [47]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[23, 24, 33, 35, 36, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[19]:6.0 | [25]:2.0 | [33]:3.0 | [41]:6.0 | [58]:3.0 | [46]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[13]:3.0 | [41]:5.0 | [47]:4.0 | [49]:4.0 | [51]:5.0 | [11]:4.0 | 
---------------------------------------
return EAMC[1]
æ–‡EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:5.0 | [15]:4.0 | [35]:5.0 | [44]:3.0 | [62]:6.0 | [50]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[4]:5.0 | [14]:9.0 | [30]:8.0 | [40]:3.0 | [44]:4.0 | [10]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[10]:4.0 | [27]:3.0 | [28]:10.0 | [36]:1.0 | [38]:7.0 | [3]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[11]:7.0 | [24]:7.0 | [25]:8.0 | [35]:6.0 | [40]:2.0 | [36]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[13]:8.0 | [19]:8.0 | [20]:6.0 | [25]:5.0 | [42]:9.0 | [34]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[29]:7.0 | [41]:8.0 | [57]:4.0 | [59]:7.0 | [63]:6.0 | [27]:8.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[29, 41, 57, 59, 63, 27]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 8.200(2635)[0m | [32mExpert  7: 7.800(2803)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 7.600(2644)[0m | 
[32mExpert 63: 6.800(2800)[0m | [32mExpert 38: 6.000(2716)[0m | [32mExpert 22: 5.600(2665)[0m | [32mExpert 32: 5.600(2698)[0m | 
[32mExpert 26: 5.600(2677)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 23: 5.400(2668)[0m | [32mExpert 41: 5.400(2728)[0m | 
[32mExpert  4: 5.200(2722)[0m | [32mExpert 61: 5.200(2794)[0m | [32mExpert 17: 5.200(2647)[0m | [32mExpert 44: 5.200(2737)[0m | 
[32mExpert 45: 5.000(2740)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert 33: 4.600(2701)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 25: 3.200(2674)[0m | [32mExpert  1: 3.000(2623)[0m | [32mExpert  8: 2.800(2806)[0m | [32mExpert 60: 2.800(2791)[0m | 
[32mExpert 34: 2.800(2704)[0m | [32mExpert 36: 2.600(2710)[0m | [32mExpert 42: 2.600(2731)[0m | [32mExpert  9: 2.600(2809)[0m | 
[32mExpert 55: 2.600(2773)[0m | [32mExpert  2: 2.400(2656)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 19: 2.200(2653)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2674, 2623, 2806, 2791, 2704, 2710, 2731, 2809, 2773, 2656, 2629, 2653]
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  8,  9, 11, 19, 25, 34, 36, 42, 55, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[9]:9.0 | [34]:11.0 | [39]:6.0 | [44]:11.0 | [62]:9.0 | [5]:10.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[4]:5.0 | [16]:10.0 | [17]:7.0 | [38]:5.0 | [48]:4.0 | [44]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[7]:9.0 | [23]:7.0 | [26]:6.0 | [34]:3.0 | [60]:4.0 | [63]:9.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E60 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[33]:13.0 | [42]:12.0 | [45]:12.0 | [49]:6.0 | [58]:1.0 | [16]:10.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[16]:16.0 | [27]:7.0 | [40]:10.0 | [52]:6.0 | [53]:14.0 | [33]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[8]:3.0 | [22]:9.0 | [31]:13.0 | [44]:6.0 | [52]:4.0 | [18]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 8, 22, 31, 44, 52, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 10.000(2858)[0m | [32mExpert  5: 9.400(2993)[0m | [32mExpert  4: 9.000(2960)[0m | [32mExpert 55: 8.000(3011)[0m | 
[32mExpert 23: 7.600(2906)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert 16: 6.200(2882)[0m | [32mExpert 49: 6.200(2990)[0m | 
[32mExpert 11: 5.800(2867)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert 24: 5.400(2909)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert 33: 4.800(2939)[0m | [32mExpert 50: 4.600(2996)[0m | [32mExpert 52: 4.200(3002)[0m | [32mExpert 14: 4.000(2876)[0m | 
[32mExpert 61: 3.800(3032)[0m | [32mExpert 29: 3.600(2924)[0m | [32mExpert 48: 3.400(2987)[0m | [32mExpert 32: 3.200(2936)[0m | 
[32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 30: 3.000(2930)[0m | 
[32mExpert 38: 3.000(2954)[0m | [32mExpert  1: 2.800(2861)[0m | [32mExpert 53: 2.800(3005)[0m | [32mExpert  9: 2.800(3047)[0m | 
[32mExpert 63: 2.600(3038)[0m | [32mExpert 31: 2.400(2933)[0m | [32mExpert 26: 2.200(2915)[0m | [32mExpert 34: 2.200(2942)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2966, 2963, 2912, 2930, 2954, 2861, 3005, 3047, 3038, 2933, 2915, 2942]
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 26, 30, 31, 34, 38, 40, 41, 53, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:11.0 | [30]:6.0 | [53]:2.0 | [57]:3.0 | [63]:9.0 | [29]:11.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[5]:12.0 | [8]:2.0 | [55]:5.0 | [59]:13.0 | [63]:12.0 | [48]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[4]:11.0 | [27]:3.0 | [36]:7.0 | [44]:3.0 | [48]:3.0 | [49]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 16 MLP ==
[0m
[25]:5.0 | [32]:10.0 | [36]:2.0 | [41]:10.0 | [45]:7.0 | [24]:10.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[7]:2.0 | [10]:9.0 | [13]:5.0 | [46]:5.0 | [61]:8.0 | [32]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[1]:12.0 | [2]:10.0 | [8]:6.0 | [35]:5.0 | [47]:8.0 | [54]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 1,  2,  8, 35, 47, 54]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 61: 9.400(4250)[0m | [32mExpert 15: 9.200(4097)[0m | [32mExpert 10: 8.000(4082)[0m | [32mExpert 48: 7.600(4205)[0m | 
[32mExpert 19: 6.800(4109)[0m | [32mExpert 12: 6.400(4088)[0m | [32mExpert 25: 6.400(4130)[0m | [32mExpert 26: 6.200(4133)[0m | 
[32mExpert  8: 5.600(4262)[0m | [32mExpert 28: 5.000(4139)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 42: 4.600(4187)[0m | 
[32mExpert 53: 4.600(4223)[0m | [32mExpert 17: 4.400(4103)[0m | [32mExpert  0: 4.200(4076)[0m | [32mExpert 18: 4.200(4106)[0m | 
[32mExpert 27: 4.200(4136)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | [32mExpert 46: 3.600(4199)[0m | 
[32mExpert  2: 3.400(4112)[0m | [32mExpert 50: 3.400(4214)[0m | [32mExpert 36: 3.200(4166)[0m | [32mExpert 54: 3.200(4226)[0m | 
[32mExpert  6: 3.000(4244)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert  5: 2.800(4211)[0m | [32mExpert 23: 2.400(4124)[0m | 
[32mExpert 52: 2.400(4220)[0m | [32mExpert 35: 2.200(4163)[0m | [32mExpert 47: 2.200(4202)[0m | [32mExpert 41: 2.200(4184)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4112, 4214, 4166, 4226, 4244, 4253, 4211, 4124, 4220, 4163, 4202, 4184]
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 23, 35, 36, 41, 47, 50, 52, 54, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:10.0 | [8]:2.0 | [9]:9.0 | [38]:10.0 | [63]:3.0 | [57]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[3]:5.0 | [23]:3.0 | [37]:9.0 | [44]:4.0 | [55]:6.0 | [54]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[0]:6.0 | [18]:6.0 | [26]:7.0 | [35]:3.0 | [51]:2.0 | [50]:5.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:6.0 | [19]:2.0 | [22]:3.0 | [43]:4.0 | [56]:11.0 | [9]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[1]:6.0 | [10]:2.0 | [18]:2.0 | [27]:2.0 | [46]:8.0 | [24]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[3]:2.0 | [18]:2.0 | [24]:11.0 | [44]:2.0 | [45]:4.0 | [51]:5.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[ 3, 18, 24, 44, 45, 51]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:4.0 | [17]:4.0 | [18]:8.0 | [20]:2.0 | [47]:9.0 | [55]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[10]:9.0 | [39]:2.0 | [40]:1.0 | [56]:7.0 | [58]:2.0 | [25]:3.0 | 
---------------------------------------
return EAMC[1]
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2653
[1m[33mEnqueueTask: [0m[32mTask: node: ID[542,1300000013] (16MB) STATE(0) TENSOR[2652,2653,2651,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2954
[1m[33mEnqueueTask: [0m[32mTask: node: ID[951,260000001f] (16MB) STATE(0) TENSOR[2953,2954,2952,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:4.0 | [12]:5.0 | [18]:4.0 | [51]:4.0 | [54]:5.0 | [61]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[0]:5.0 | [8]:4.0 | [14]:10.0 | [33]:5.0 | [46]:4.0 | [47]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[1]:5.0 | [22]:6.0 | [24]:4.0 | [55]:3.0 | [60]:7.0 | [0]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[16]:4.0 | [22]:3.0 | [29]:10.0 | [39]:4.0 | [52]:4.0 | [57]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[12]:3.0 | [27]:4.0 | [43]:1.0 | [53]:2.0 | [56]:3.0 | [41]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[12]:4.0 | [16]:4.0 | [18]:3.0 | [35]:5.0 | [54]:1.0 | [56]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[12, 16, 18, 35, 54, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 8.600(2803)[0m | [32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 7.600(2644)[0m | 
[32mExpert 63: 7.600(2800)[0m | [32mExpert 26: 6.400(2677)[0m | [32mExpert 23: 6.200(2668)[0m | [32mExpert 38: 6.000(2716)[0m | 
[32mExpert 22: 5.600(2665)[0m | [32mExpert 32: 5.600(2698)[0m | [32mExpert 53: 5.600(2767)[0m | [32mExpert 41: 5.400(2728)[0m | 
[32mExpert  4: 5.200(2722)[0m | [32mExpert 61: 5.200(2794)[0m | [32mExpert 17: 5.200(2647)[0m | [32mExpert 44: 5.200(2737)[0m | 
[32mExpert 45: 5.000(2740)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert 33: 4.600(2701)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 34: 3.600(2704)[0m | [32mExpert 60: 3.600(2791)[0m | [32mExpert 25: 3.200(2674)[0m | [32mExpert  1: 3.000(2623)[0m | 
[32mExpert  8: 2.800(2806)[0m | [32mExpert 36: 2.600(2710)[0m | [32mExpert 42: 2.600(2731)[0m | [32mExpert  9: 2.600(2809)[0m | 
[32mExpert 55: 2.600(2773)[0m | [32mExpert  2: 2.400(2656)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 19: 2.200(2653)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2791, 2674, 2623, 2806, 2710, 2731, 2809, 2773, 2656, 2629, 2653]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2653[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  8,  9, 11, 19, 25, 34, 36, 42, 55, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:9.0 | [19]:1.0 | [21]:1.0 | [41]:7.0 | [42]:6.0 | [6]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[6]:7.0 | [10]:2.0 | [17]:8.0 | [26]:10.0 | [45]:5.0 | [12]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[1]:3.0 | [41]:6.0 | [48]:3.0 | [58]:3.0 | [61]:7.0 | [38]:8.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[11]:2.0 | [29]:2.0 | [30]:7.0 | [51]:7.0 | [60]:5.0 | [44]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[0]:4.0 | [16]:17.0 | [53]:15.0 | [54]:5.0 | [57]:2.0 | [8]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[7]:2.0 | [45]:22.0 | [47]:7.0 | [57]:7.0 | [58]:2.0 | [41]:8.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[ 7, 45, 47, 57, 58, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 10.000(2858)[0m | [32mExpert  4: 9.800(2960)[0m | [32mExpert  5: 9.400(2993)[0m | [32mExpert 55: 8.000(3011)[0m | 
[32mExpert 23: 7.600(2906)[0m | [32mExpert 36: 7.000(2948)[0m | [32mExpert 49: 7.000(2990)[0m | [32mExpert 16: 6.200(2882)[0m | 
[32mExpert 11: 5.800(2867)[0m | [32mExpert  6: 5.400(3026)[0m | [32mExpert 24: 5.400(2909)[0m | [32mExpert 15: 4.800(2879)[0m | 
[32mExpert 33: 4.800(2939)[0m | [32mExpert 50: 4.600(2996)[0m | [32mExpert 48: 4.200(2987)[0m | [32mExpert 52: 4.200(3002)[0m | 
[32mExpert 14: 4.000(2876)[0m | [32mExpert 61: 3.800(3032)[0m | [32mExpert 29: 3.600(2924)[0m | [32mExpert 32: 3.200(2936)[0m | 
[32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 30: 3.000(2930)[0m | 
[32mExpert 38: 3.000(2954)[0m | [32mExpert 44: 3.000(2975)[0m | [32mExpert  1: 2.800(2861)[0m | [32mExpert 53: 2.800(3005)[0m | 
[32mExpert  9: 2.800(3047)[0m | [32mExpert 27: 2.600(2918)[0m | [32mExpert 63: 2.600(3038)[0m | [32mExpert 31: 2.400(2933)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2966, 2963, 2912, 2930, 2954, 2975, 2861, 3005, 3047, 2918, 3038, 2933]
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2954[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 27, 30, 31, 38, 40, 41, 44, 53, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[21]:3.0 | [30]:7.0 | [31]:1.0 | [40]:2.0 | [57]:4.0 | [29]:12.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[4]:1.0 | [25]:3.0 | [30]:5.0 | [50]:5.0 | [59]:14.0 | [43]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[0]:12.0 | [4]:12.0 | [13]:1.0 | [15]:5.0 | [33]:6.0 | [38]:4.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E38 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[38]:6.0 | [41]:11.0 | [48]:5.0 | [50]:5.0 | [58]:3.0 | [15]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[55]:4.0 | [56]:2.0 | [57]:7.0 | [59]:1.0 | [61]:9.0 | [42]:6.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[3]:1.0 | [21]:2.0 | [35]:6.0 | [51]:3.0 | [57]:4.0 | [50]:8.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[ 3, 21, 35, 51, 57, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[90mTop 20 Experts:[0m
[32mExpert 61: 9.400(4250)[0m | [32mExpert 15: 9.200(4097)[0m | [32mExpert 10: 8.000(4082)[0m | [32mExpert 48: 7.600(4205)[0m | 
[32mExpert 26: 7.000(4133)[0m | [32mExpert 19: 6.800(4109)[0m | [32mExpert 12: 6.400(4088)[0m | [32mExpert 25: 6.400(4130)[0m | 
[32mExpert  8: 5.600(4262)[0m | [32mExpert  0: 5.000(4076)[0m | [32mExpert 18: 5.000(4106)[0m | [32mExpert 28: 5.000(4139)[0m | 
[32mExpert 21: 4.600(4118)[0m | [32mExpert 42: 4.600(4187)[0m | [32mExpert 53: 4.600(4223)[0m | [32mExpert 17: 4.400(4103)[0m | 
[32mExpert 27: 4.200(4136)[0m | [32mExpert 50: 4.200(4214)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 14: 4.000(4094)[0m | 
[32mExpert 46: 3.600(4199)[0m | [32mExpert  2: 3.400(4112)[0m | [32mExpert 36: 3.200(4166)[0m | [32mExpert 54: 3.200(4226)[0m | 
[32mExpert  6: 3.000(4244)[0m | [32mExpert 35: 3.000(4163)[0m | [32mExpert 62: 3.000(4253)[0m | [32mExpert  5: 2.800(4211)[0m | 
[32mExpert 51: 2.800(4217)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 52: 2.400(4220)[0m | [32mExpert 47: 2.200(4202)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4199, 4112, 4166, 4226, 4244, 4163, 4253, 4211, 4217, 4124, 4220, 4202]
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 23, 35, 36, 46, 47, 51, 52, 54, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:10.0 | [38]:11.0 | [47]:5.0 | [50]:3.0 | [53]:2.0 | [4]:11.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[0]:2.0 | [3]:6.0 | [15]:8.0 | [37]:10.0 | [40]:1.0 | [9]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[14]:5.0 | [37]:2.0 | [52]:3.0 | [54]:4.0 | [61]:12.0 | [62]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E54 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:7.0 | [24]:1.0 | [35]:13.0 | [52]:1.0 | [57]:8.0 | [9]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[6]:3.0 | [7]:5.0 | [38]:3.0 | [46]:9.0 | [58]:12.0 | [47]:7.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[19]:10.0 | [24]:12.0 | [28]:9.0 | [37]:4.0 | [45]:5.0 | [50]:7.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[19, 24, 28, 37, 45, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:5.0 | [10]:6.0 | [21]:3.0 | [42]:3.0 | [57]:4.0 | [47]:10.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[22]:1.0 | [30]:4.0 | [34]:7.0 | [48]:5.0 | [54]:5.0 | [36]:3.0 | 
---------------------------------------
return EAMC[1]
ï¼Œå¹¶EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[12]:6.0 | [20]:2.0 | [24]:4.0 | [42]:2.0 | [52]:6.0 | [3]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 2 MLP ==
[0m
[16]:7.0 | [34]:2.0 | [44]:5.0 | [59]:5.0 | [61]:4.0 | [48]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 3 MLP ==
[0m
[13]:1.0 | [16]:3.0 | [30]:2.0 | [44]:2.0 | [51]:3.0 | [58]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 4 MLP ==
[0m
[6]:5.0 | [16]:5.0 | [17]:2.0 | [30]:3.0 | [39]:5.0 | [29]:11.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 5 MLP ==
[0m
[19]:9.0 | [21]:1.0 | [24]:3.0 | [47]:5.0 | [54]:7.0 | [53]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 6 MLP ==
[0m
[13]:3.0 | [18]:4.0 | [22]:11.0 | [34]:4.0 | [55]:5.0 | [32]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch6 topk= tensor([[13, 18, 22, 34, 55, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 8.600(2803)[0m | [32mExpert 13: 8.200(2635)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 16: 7.600(2644)[0m | 
[32mExpert 63: 7.600(2800)[0m | [32mExpert 38: 6.800(2716)[0m | [32mExpert 26: 6.400(2677)[0m | [32mExpert 23: 6.200(2668)[0m | 
[32mExpert 41: 6.200(2728)[0m | [32mExpert 61: 6.000(2794)[0m | [32mExpert 22: 5.600(2665)[0m | [32mExpert 32: 5.600(2698)[0m | 
[32mExpert 53: 5.600(2767)[0m | [32mExpert  4: 5.200(2722)[0m | [32mExpert 17: 5.200(2647)[0m | [32mExpert 44: 5.200(2737)[0m | 
[32mExpert 45: 5.000(2740)[0m | [32mExpert 31: 4.600(2695)[0m | [32mExpert 33: 4.600(2701)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert  1: 3.800(2623)[0m | [32mExpert 34: 3.600(2704)[0m | [32mExpert 60: 3.600(2791)[0m | [32mExpert 25: 3.200(2674)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert  8: 2.800(2806)[0m | [32mExpert 58: 2.800(2782)[0m | [32mExpert 36: 2.600(2710)[0m | 
[32mExpert 42: 2.600(2731)[0m | [32mExpert  9: 2.600(2809)[0m | [32mExpert 55: 2.600(2773)[0m | [32mExpert  2: 2.400(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2623, 2704, 2791, 2674, 2749, 2806, 2782, 2710, 2731, 2809, 2773, 2656]
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  8,  9, 25, 34, 36, 42, 48, 55, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[25]:3.0 | [30]:3.0 | [32]:5.0 | [33]:1.0 | [40]:5.0 | [10]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 8 MLP ==
[0m
[12]:5.0 | [17]:9.0 | [26]:11.0 | [42]:3.0 | [54]:6.0 | [43]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 9 MLP ==
[0m
[8]:4.0 | [12]:6.0 | [25]:5.0 | [33]:5.0 | [61]:8.0 | [38]:9.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[0]:1.0 | [3]:2.0 | [11]:3.0 | [33]:14.0 | [37]:1.0 | [9]:9.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 11 MLP ==
[0m
[7]:3.0 | [16]:18.0 | [20]:2.0 | [46]:3.0 | [53]:16.0 | [0]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 12 MLP ==
[0m
[17]:4.0 | [44]:7.0 | [45]:23.0 | [47]:8.0 | [57]:8.0 | [30]:6.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch12 topk= tensor([[17, 44, 45, 47, 57, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 10.800(2858)[0m | [32mExpert  4: 10.600(2960)[0m | [32mExpert  5: 9.400(2993)[0m | [32mExpert 55: 8.000(3011)[0m | 
[32mExpert 23: 7.600(2906)[0m | [32mExpert 36: 7.000(2948)[0m | [32mExpert 49: 7.000(2990)[0m | [32mExpert 16: 6.200(2882)[0m | 
[32mExpert 11: 5.800(2867)[0m | [32mExpert 33: 5.600(2939)[0m | [32mExpert 15: 5.600(2879)[0m | [32mExpert  6: 5.400(3026)[0m | 
[32mExpert 24: 5.400(2909)[0m | [32mExpert 50: 4.600(2996)[0m | [32mExpert 48: 4.200(2987)[0m | [32mExpert 52: 4.200(3002)[0m | 
[32mExpert 14: 4.000(2876)[0m | [32mExpert 38: 3.800(2954)[0m | [32mExpert 61: 3.800(3032)[0m | [32mExpert 29: 3.600(2924)[0m | 
[32mExpert 32: 3.200(2936)[0m | [32mExpert 41: 3.200(2966)[0m | [32mExpert 40: 3.200(2963)[0m | [32mExpert 25: 3.000(2912)[0m | 
[32mExpert 30: 3.000(2930)[0m | [32mExpert 44: 3.000(2975)[0m | [32mExpert  1: 2.800(2861)[0m | [32mExpert 53: 2.800(3005)[0m | 
[32mExpert  9: 2.800(3047)[0m | [32mExpert 27: 2.600(2918)[0m | [32mExpert 63: 2.600(3038)[0m | [32mExpert 31: 2.400(2933)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2936, 2966, 2963, 2912, 2930, 2975, 2861, 3005, 3047, 2918, 3038, 2933]
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 25, 27, 30, 31, 32, 40, 41, 44, 53, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[2]:1.0 | [11]:12.0 | [30]:8.0 | [34]:6.0 | [57]:5.0 | [23]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 14 MLP ==
[0m
[21]:1.0 | [25]:4.0 | [43]:2.0 | [50]:6.0 | [59]:15.0 | [24]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 15 MLP ==
[0m
[4]:13.0 | [13]:2.0 | [15]:6.0 | [31]:3.0 | [62]:2.0 | [34]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[22]:2.0 | [39]:1.0 | [47]:6.0 | [50]:6.0 | [63]:12.0 | [18]:3.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 17 MLP ==
[0m
[8]:1.0 | [31]:8.0 | [36]:2.0 | [44]:3.0 | [56]:3.0 | [23]:5.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 18 MLP ==
[0m
[20]:1.0 | [23]:13.0 | [35]:7.0 | [45]:2.0 | [50]:9.0 | EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4202
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29
Prefetch Node: task: Task: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[1350,2f0000002b] (16MB) STATE(0) TENSOR[4201,4202,4200,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
[21]:3.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch18 topk= tensor([[20, 23, 35, 45, 50, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 61: 10.200(4250)[0m | [32mExpert 15: 9.200(4097)[0m | [32mExpert 10: 8.000(4082)[0m | [32mExpert 48: 7.600(4205)[0m | 
[32mExpert 26: 7.000(4133)[0m | [32mExpert 19: 6.800(4109)[0m | [32mExpert 12: 6.400(4088)[0m | [32mExpert 25: 6.400(4130)[0m | 
[32mExpert  8: 5.600(4262)[0m | [32mExpert  0: 5.000(4076)[0m | [32mExpert 18: 5.000(4106)[0m | [32mExpert 28: 5.000(4139)[0m | 
[32mExpert 14: 4.800(4094)[0m | [32mExpert 21: 4.600(4118)[0m | [32mExpert 42: 4.600(4187)[0m | [32mExpert 53: 4.600(4223)[0m | 
[32mExpert 17: 4.400(4103)[0m | [32mExpert 27: 4.200(4136)[0m | [32mExpert 50: 4.200(4214)[0m | [32mExpert 56: 4.200(4232)[0m | 
[32mExpert 54: 4.000(4226)[0m | [32mExpert 62: 3.800(4253)[0m | [32mExpert 46: 3.600(4199)[0m | [32mExpert  2: 3.400(4112)[0m | 
[32mExpert 36: 3.200(4166)[0m | [32mExpert 52: 3.200(4220)[0m | [32mExpert  6: 3.000(4244)[0m | [32mExpert 35: 3.000(4163)[0m | 
[32mExpert  5: 2.800(4211)[0m | [32mExpert 51: 2.800(4217)[0m | [32mExpert 23: 2.400(4124)[0m | [32mExpert 47: 2.200(4202)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4226, 4253, 4199, 4112, 4166, 4220, 4244, 4163, 4211, 4217, 4124, 4202]
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4202[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 23, 35, 36, 46, 47, 51, 52, 54, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:11.0 | [38]:12.0 | [50]:4.0 | [52]:1.0 | [53]:3.0 | [4]:12.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 20 MLP ==
[0m
[0]:3.0 | [3]:7.0 | [9]:4.0 | [24]:2.0 | [40]:2.0 | [13]:4.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 21 MLP ==
[0m
[5]:4.0 | [11]:1.0 | [37]:3.0 | [54]:5.0 | [56]:5.0 | [20]:3.0 | 
---------------------------------------
return EAMC[1]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E54 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[3]:4.0 | [8]:8.0 | [15]:1.0 | [24]:2.0 | [52]:2.0 | [25]:1.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 23 MLP ==
[0m
[2]:1.0 | [11]:5.0 | [33]:6.0 | [47]:8.0 | [49]:1.0 | [58]:13.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 24 MLP ==
[0m
[19]:11.0 | [24]:13.0 | [28]:10.0 | [29]:2.0 | [38]:1.0 | [4]:4.0 | 
---------------------------------------
return EAMC[1]
Begin prefetch24 topk= tensor([[19, 24, 28, 29, 38,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:6.0 | [10]:7.0 | [21]:4.0 | [37]:1.0 | [53]:2.0 | [9]:2.0 | 
---------------------------------------
return EAMC[1]

[1;36m== Layer 26 MLP ==
[0m
[2]:1.0 | [21]:1.0 | [22]:2.0 | [37]:4.0 | [52]:3.0 | [36]:4.0 | 
---------------------------------------
return EAMC[2]
åˆ†åˆ«
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2740
[1m[33mEnqueueTask: [0m[32mTask: node: ID[568,2d00000013] (16MB) STATE(0) TENSOR[2739,2740,2738,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefilling time: 1.977790117263794 seconds
Decoding time: 10.787252187728882 seconds
Decoding iterations: 32
Decoding time per iteration: 0.33710163086652756 seconds
Input tokens: 148
input:  è¯·ç”¨å­¦æœ¯è®ºæ–‡é£æ ¼å›ç­”ï¼š
1. å¯¹æ¯”Transformer/RNN/GNNåœ¨æ—¶åºé¢„æµ‹ä¸­çš„ä¼˜åŠ£ï¼ˆéœ€å¼•2020å¹´åè®ºæ–‡ï¼‰
2. ç”¨æ§åˆ¶è®ºè§£é‡ŠAlphaGoçš„å†³ç­–æ ‘ä¼˜åŒ–è¿‡ç¨‹
3. åˆ—å‡ºé‡å­è®¡ç®—å¯¹å¯†ç å­¦çš„ä¸‰å¤§å½±å“ï¼Œå¹¶è¯´æ˜Shorç®—æ³•åŸç†
4. æ’°å†™æ‘˜è¦ï¼šMoEæ¨¡å‹åœ¨è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²çš„æŒ‘æˆ˜ï¼ˆ200å­—å†…ï¼Œå«èƒ½è€—/ç²¾åº¦/å»¶è¿ŸæŒ‡æ ‡ï¼‰
è¦æ±‚ï¼šå…³é”®è®ºç‚¹éœ€æ ‡æ³¨å‚è€ƒæ–‡çŒ®ï¼ˆæ ¼å¼ï¼šAuthor et al., Yearï¼‰ï¼Œé¿å…ä¸»è§‚è¡¨è¿°ã€‚
inputs ...
torch.Size([1, 127])
outputs_text ...

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:1.0 | [26]:1.0 | [56]:1.0 | [57]:1.0 | [60]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[3]:1.0 | [35]:1.0 | [38]:1.0 | [62]:1.0 | [63]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[4]:1.0 | [9]:1.0 | [11]:1.0 | [25]:1.0 | [54]:1.0 | [12]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[11]:1.0 | [21]:1.0 | [31]:1.0 | [33]:1.0 | [49]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[19]:1.0 | [20]:1.0 | [47]:1.0 | [49]:1.0 | [52]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[13]:1.0 | [21]:1.0 | [22]:1.0 | [42]:1.0 | [47]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[13, 21, 22, 42, 47, 32],
        [19, 37, 39, 46, 56, 26],
        [ 0,  7, 19, 26, 44,  4],
        [ 3, 14, 29, 53, 57,  2],
        [ 3,  4, 24, 29, 63, 14],
        [ 2, 14, 29, 38, 57, 33],
        [ 4,  7, 14, 24, 44,  5],
        [ 6, 12, 16, 35, 56, 46],
        [ 1, 23, 39, 42, 45, 32],
        [16, 19, 37, 46, 56, 50],
        [ 5, 12, 16, 19, 56, 46],
        [ 6, 19, 37, 46, 56, 50],
        [ 2, 19, 24, 25, 53, 17],
        [17, 27, 29, 32, 41, 57],
        [ 6, 23, 33, 34, 55, 12],
        [17, 29, 32, 59, 63, 41],
        [ 6, 11, 23, 34, 55, 33],
        [17, 27, 32, 41, 48, 13],
        [ 1, 17, 29, 32, 59, 13],
        [24, 40, 43, 49, 58, 33],
        [ 2, 25, 26, 41, 57, 38],
        [ 2, 17, 25, 29, 57, 53],
        [ 2, 17, 29, 30, 47,  3],
        [33, 36, 43, 47, 54, 49],
        [ 2,  8, 25, 26, 53, 43],
        [ 2, 25, 31, 53, 59, 60],
        [12, 16, 18, 23, 56, 50],
        [ 0,  8, 19, 43, 52, 26],
        [ 4,  7, 14, 26, 52, 44],
        [ 6,  8, 14, 28, 45, 37],
        [ 6,  8, 14, 28, 51, 36],
        [ 1,  6, 37, 46, 51, 45],
        [ 6, 24, 33, 51, 59, 61],
        [24, 26, 28, 51, 57, 61],
        [ 3, 14, 24, 29, 33, 53],
        [12, 16, 18, 35, 56, 54],
        [12, 16, 18, 46, 56, 50],
        [19, 22, 37, 46, 56,  1],
        [16, 18, 19, 24, 34, 12],
        [ 1, 19, 24, 34, 56, 18],
        [ 7, 24, 26, 44, 49,  0],
        [ 2, 25, 30, 53, 57, 29],
        [17, 30, 32, 53, 57,  2],
        [ 2,  5,  7, 44, 53, 24],
        [25, 27, 32, 41, 57, 48],
        [13, 22, 29, 32, 48, 47],
        [ 5, 33, 36, 43, 54, 24],
        [ 2, 17, 30, 44, 53, 62],
        [17, 25, 27, 29, 38, 47],
        [ 2, 17, 25, 44, 47, 42],
        [ 2, 25, 33, 43, 53, 17],
        [11, 12, 16, 18, 56, 46],
        [ 1, 19, 27, 42, 51, 46],
        [11, 16, 34, 50, 56, 46],
        [ 1, 11, 19, 24, 56, 34],
        [ 7, 14, 24, 26, 44, 19],
        [ 7, 14, 19, 24, 44,  5],
        [ 3, 27, 29, 41, 57, 17],
        [ 3, 29, 32, 47, 48, 30],
        [ 7, 43, 49, 52, 58,  5],
        [ 3,  4, 27, 29, 30, 38],
        [ 3, 17, 27, 29, 30,  2],
        [ 8, 28, 36, 43, 58, 42],
        [ 2,  5,  7, 43, 53, 28],
        [ 1, 12, 16, 18, 56, 50],
        [18, 24, 34, 49, 55,  5],
        [ 5,  7, 24, 43, 44, 22],
        [ 6, 27, 32, 41, 48, 42],
        [ 1, 13, 27, 32, 48, 22],
        [ 2, 17, 29, 33, 47, 30],
        [ 2,  5, 33, 43, 53, 47],
        [11, 16, 46, 50, 56, 37],
        [19, 37, 39, 46, 51, 27],
        [11, 16, 46, 50, 56, 37],
        [11, 19, 46, 50, 56,  1],
        [ 4,  7, 14, 24, 44, 19],
        [ 2,  4, 14, 29, 53, 24],
        [ 6, 12, 16, 18, 35, 33],
        [ 6, 23, 27, 41, 48, 32],
        [ 1, 13, 17, 32, 48, 25],
        [ 2, 17, 29, 47, 53, 32],
        [24, 33, 43, 49, 58, 40],
        [ 3, 17, 25, 38, 57, 31],
        [ 3, 29, 32, 38, 57, 63],
        [ 2,  4,  7, 44, 57, 30],
        [ 7, 33, 36, 42, 43, 18],
        [ 2, 31, 43, 53, 60, 52],
        [12, 16, 23, 33, 56, 11],
        [11, 16, 46, 50, 56, 37],
        [ 6, 23, 24, 33, 51, 19],
        [ 1,  6, 23, 32, 51, 28],
        [14, 28, 29, 33, 51, 24],
        [14, 25, 28, 45, 51, 52],
        [12, 16, 18, 28, 35, 56],
        [ 7, 26, 28, 34, 43, 58],
        [ 2, 25, 26, 30, 53, 58],
        [ 2,  3, 25, 30, 31, 60],
        [ 6, 18, 34, 39, 55, 33],
        [ 2, 25, 30, 31, 59, 29],
        [ 6, 27, 34, 39, 55, 35],
        [ 2, 25, 30, 31, 59, 53],
        [ 2, 24, 25, 30, 53, 14],
        [11, 12, 16, 18, 50, 56],
        [11, 37, 46, 50, 56, 16],
        [ 0,  7, 14, 19, 52,  2],
        [12, 19, 35, 50, 56, 10],
        [ 2,  8, 14, 36, 53, 57],
        [ 2, 24, 26, 29, 53,  5],
        [ 2,  5, 19, 24, 53, 28],
        [ 0,  8, 26, 43, 52,  9],
        [ 2,  7, 14, 38, 44, 29],
        [ 2, 14, 24, 26, 53,  4],
        [ 2,  4, 14, 24, 29, 63],
        [12, 16, 18, 23, 35, 34],
        [ 2,  4, 14, 25, 57, 38],
        [ 6, 12, 35, 39, 43, 23],
        [ 6, 15, 21, 48, 63, 29],
        [21, 23, 34, 35, 55,  6],
        [15, 21, 24, 29, 61,  6],
        [ 6, 23, 24, 35, 39, 12],
        [14, 25, 48, 59, 63, 29],
        [ 6, 11, 12, 33, 35, 16],
        [11, 12, 16, 18, 50, 35],
        [ 0,  7, 17, 52, 60, 62],
        [ 2,  5, 53, 57, 60, 31],
        [ 2,  5, 44, 53, 60, 14],
        [11, 16, 18, 50, 56, 12]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 1.800(2803)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 38: 1.800(2716)[0m | [32mExpert 63: 1.800(2800)[0m | 
[32mExpert 16: 1.600(2644)[0m | [32mExpert 46: 1.600(2743)[0m | [32mExpert 61: 1.600(2794)[0m | [32mExpert 23: 1.400(2668)[0m | 
[32mExpert  4: 1.200(2722)[0m | [32mExpert 12: 1.200(2632)[0m | [32mExpert 22: 1.200(2665)[0m | [32mExpert 26: 1.200(2677)[0m | 
[32mExpert 32: 1.200(2698)[0m | [32mExpert 41: 1.200(2728)[0m | [32mExpert 17: 1.000(2647)[0m | [32mExpert 25: 1.000(2674)[0m | 
[32mExpert 31: 1.000(2695)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 44: 1.000(2737)[0m | [32mExpert  8: 0.800(2806)[0m | 
[32mExpert 53: 0.800(2767)[0m | [32mExpert 60: 0.800(2791)[0m | [32mExpert  1: 0.600(2623)[0m | [32mExpert 34: 0.600(2704)[0m | 
[32mExpert 36: 0.600(2710)[0m | [32mExpert 42: 0.600(2731)[0m | [32mExpert 45: 0.600(2740)[0m | [32mExpert 48: 0.600(2749)[0m | 
[32mExpert 58: 0.600(2782)[0m | [33mExpert  0: 0.400(2620)[0m | [33mExpert  2: 0.400(2656)[0m | [33mExpert  9: 0.400(2809)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2767, 2791, 2623, 2704, 2710, 2731, 2740, 2749, 2782, 2620, 2656, 2809]
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2740[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[568,2d00000013] (16MB) STATE(0) TENSOR[2739,2740,2738,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 35
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2987
[1m[33mEnqueueTask: [0m[32mTask: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[961,300000001f] (16MB) STATE(0) TENSOR[2986,2987,2985,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  1,  2,  9, 34, 36, 42, 45, 48, 53, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[28]:1.0 | [43]:1.0 | [44]:1.0 | [58]:1.0 | [62]:1.0 | [18]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[2]:1.0 | [11]:1.0 | [30]:1.0 | [39]:1.0 | [54]:1.0 | [47]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[12]:1.0 | [13]:1.0 | [22]:1.0 | [27]:1.0 | [31]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E2 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E36 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E45 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E60 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[2]:1.0 | [9]:1.0 | [13]:1.0 | [42]:1.0 | [47]:1.0 | [31]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[10]:1.0 | [11]:1.0 | [17]:1.0 | [18]:1.0 | [27]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[4]:1.0 | [30]:1.0 | [37]:1.0 | [50]:1.0 | [59]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 4, 30, 37, 50, 59,  3],
        [12, 17, 29, 47, 59, 41],
        [12, 30, 44, 47, 57, 41],
        [11, 16, 26, 44, 57, 55],
        [11, 18, 22, 44, 52, 31],
        [11, 18, 44, 53, 57,  1],
        [ 0, 30, 41, 44, 57, 34],
        [16, 38, 41, 48, 57, 29],
        [26, 31, 32, 37, 56, 47],
        [ 4, 29, 37, 38, 41, 28],
        [29, 41, 42, 48, 57,  4],
        [29, 41, 42, 47, 57, 16],
        [ 1, 30, 41, 44, 57, 10],
        [18, 22, 31, 33, 52, 23],
        [10, 13, 41, 57, 61,  9],
        [18, 22, 23, 31, 52, 11],
        [10, 23, 41, 57, 61, 47],
        [12, 23, 28, 37, 61, 26],
        [18, 22, 23, 31, 52,  8],
        [ 2, 19, 43, 55, 57, 36],
        [ 3, 11, 55, 59, 61, 63],
        [ 3, 22, 50, 53, 63, 18],
        [ 1, 18, 22, 33, 52, 16],
        [11, 19, 25, 52, 57, 53],
        [ 1, 33, 37, 57, 59,  4],
        [ 1, 11, 33, 37, 57, 32],
        [28, 30, 41, 48, 57, 61],
        [17, 30, 44, 57, 60, 51],
        [30, 44, 51, 57, 59, 11],
        [23, 28, 30, 37, 44, 57],
        [23, 28, 37, 44, 57,  6],
        [28, 30, 46, 54, 56, 50],
        [11, 16, 28, 38, 54, 48],
        [11, 30, 38, 44, 57,  3],
        [11, 18, 31, 44, 52, 16],
        [28, 38, 44, 48, 57, 16],
        [ 7, 29, 38, 42, 46, 43],
        [ 4, 23, 28, 37, 62, 29],
        [ 7, 38, 41, 48, 57, 43],
        [ 7,  9, 41, 48, 57, 42],
        [30, 41, 44, 55, 57, 43],
        [ 1, 11, 15, 34, 55, 61],
        [11, 18, 22, 31, 52, 16],
        [ 0,  1, 34, 44, 55, 57],
        [12, 15, 23, 56, 61, 16],
        [21, 22, 23, 31, 52, 25],
        [13, 25, 31, 36, 53, 19],
        [ 1, 18, 25, 44, 52, 21],
        [18, 21, 22, 52, 63,  5],
        [ 1, 18, 20, 34, 52, 21],
        [ 1,  3, 18, 25, 52, 19],
        [ 7, 16, 29, 38, 46, 42],
        [ 4, 23, 28, 37, 62, 56],
        [16, 38, 41, 43, 57, 48],
        [ 9, 12, 16, 41, 57, 48],
        [30, 37, 44, 57, 59,  5],
        [13, 30, 41, 44, 57, 47],
        [15, 21, 22, 31, 63, 26],
        [18, 22, 31, 52, 62, 21],
        [14, 24, 36, 55, 57, 13],
        [18, 21, 33, 52, 63, 62],
        [18, 22, 33, 52, 63, 21],
        [23, 37, 51, 53, 57, 36],
        [ 0,  1,  8, 18, 57, 33],
        [ 7, 30, 41, 48, 57,  9],
        [ 9, 30, 41, 44, 57, 17],
        [ 0,  9, 13, 44, 57, 30],
        [12, 16, 23, 37, 61, 62],
        [22, 31, 33, 52, 56, 35],
        [18, 21, 22, 25, 52, 31],
        [ 1,  8, 18, 52, 57, 25],
        [ 7, 29, 38, 43, 46, 16],
        [ 4, 23, 28, 37, 62, 56],
        [12, 16, 38, 41, 57, 47],
        [ 9, 12, 16, 41, 57, 47],
        [34, 41, 44, 55, 57, 30],
        [18, 22, 28, 32, 44, 33],
        [12, 41, 42, 44, 57, 43],
        [12, 16, 23, 61, 62, 37],
        [18, 22, 23, 31, 33, 62],
        [18, 21, 22, 31, 52, 57],
        [ 2, 24, 41, 43, 55, 57],
        [11, 16, 33, 61, 63, 31],
        [11, 22, 31, 52, 63,  6],
        [ 1,  6, 11, 18, 52, 21],
        [ 1, 16, 19, 53, 57, 25],
        [ 1,  8, 16, 18, 33, 57],
        [28, 41, 44, 48, 57, 30],
        [16, 29, 31, 38, 43, 23],
        [23, 28, 37, 46, 54,  3],
        [ 6, 23, 28, 37, 44, 27],
        [ 6, 28, 44, 50, 57, 23],
        [ 6, 11, 30, 44, 57,  8],
        [ 9, 30, 44, 47, 57,  7],
        [10, 44, 51, 54, 57, 20],
        [ 6, 17, 44, 55, 57, 63],
        [ 1,  6, 18, 52, 63, 22],
        [ 6,  9, 14, 41, 57, 55],
        [ 1,  6, 18, 21, 52, 11],
        [ 6,  9, 10, 14, 41, 15],
        [ 1,  3,  6, 18, 20, 52],
        [ 1,  6, 11, 18, 52,  0],
        [ 7, 38, 43, 44, 57, 16],
        [ 7, 29, 38, 43, 46, 48],
        [ 1, 30, 44, 57, 60,  0],
        [30, 41, 44, 57, 60, 47],
        [30, 33, 44, 53, 57, 21],
        [44, 47, 50, 57, 59, 16],
        [ 1, 18, 21, 44, 57, 52],
        [17, 30, 44, 51, 60, 57],
        [ 0, 10, 30, 44, 57, 20],
        [11, 18, 30, 44, 57,  1],
        [11, 18, 32, 44, 52, 30],
        [28, 30, 44, 47, 57, 10],
        [18, 21, 30, 44, 47, 11],
        [10, 30, 41, 44, 47, 12],
        [ 8, 28, 31, 44, 61, 33],
        [ 8, 28, 47, 57, 62, 33],
        [ 8, 16, 28, 31, 62, 48],
        [28, 41, 43, 48, 57,  8],
        [ 3,  4,  8, 28, 38, 54],
        [ 8, 28, 38, 44, 56, 32],
        [ 7, 30, 44, 47, 57,  9],
        [17, 44, 51, 57, 60, 10],
        [11, 33, 47, 53, 57, 44],
        [ 1, 11, 18, 44, 52, 56],
        [ 7, 29, 38, 43, 47, 44]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  4: 2.600(2960)[0m | [32mExpert  0: 2.400(2858)[0m | [32mExpert  5: 2.200(2993)[0m | [32mExpert 23: 1.800(2906)[0m | 
[32mExpert 55: 1.800(3011)[0m | [32mExpert 36: 1.400(2948)[0m | [32mExpert  6: 1.200(3026)[0m | [32mExpert 11: 1.200(2867)[0m | 
[32mExpert 15: 1.200(2879)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 33: 1.200(2939)[0m | [32mExpert 49: 1.200(2990)[0m | 
[32mExpert 16: 1.000(2882)[0m | [32mExpert 50: 1.000(2996)[0m | [32mExpert 14: 0.800(2876)[0m | [32mExpert 38: 0.800(2954)[0m | 
[32mExpert 41: 0.800(2966)[0m | [32mExpert 52: 0.800(3002)[0m | [32mExpert  1: 0.600(2861)[0m | [32mExpert 25: 0.600(2912)[0m | 
[32mExpert 27: 0.600(2918)[0m | [32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 31: 0.600(2933)[0m | 
[32mExpert 32: 0.600(2936)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 44: 0.600(2975)[0m | [32mExpert 48: 0.600(2987)[0m | 
[32mExpert 53: 0.600(3005)[0m | [32mExpert 61: 0.600(3032)[0m | [32mExpert 63: 0.600(3038)[0m | [33mExpert  9: 0.400(3047)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2918, 2924, 2930, 2933, 2936, 2942, 2975, 2987, 3005, 3032, 3038, 3047]
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 2987[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  9, 27, 29, 30, 31, 32, 34, 44, 48, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:1.0 | [24]:1.0 | [34]:1.0 | [36]:1.0 | [47]:1.0 | [58]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[5]:1.0 | [7]:1.0 | [23]:1.0 | [27]:1.0 | [51]:1.0 | [24]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[5]:1.0 | [14]:1.0 | [48]:1.0 | [52]:1.0 | [55]:1.0 | [36]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E29 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E31 â•‘[0m
EnqueuePrefetch: 4118
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1324,150000002b] (16MB) STATE(0) TENSOR[4117,4118,4116,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E63 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:1.0 | [13]:1.0 | [26]:1.0 | [33]:1.0 | [63]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[0]:1.0 | [11]:1.0 | [18]:1.0 | [26]:1.0 | [43]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:1.0 | [5]:1.0 | [39]:1.0 | [56]:1.0 | [61]:1.0 | [49]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2,  5, 39, 56, 61, 49],
        [ 1, 18, 31, 35, 53, 21],
        [ 1, 18, 31, 33, 37,  9],
        [ 5, 14, 17, 18, 43, 37],
        [14, 17, 37, 43, 44, 50],
        [14, 35, 37, 43, 47, 50],
        [18, 33, 40, 46, 47, 55],
        [18, 30, 40, 46, 53, 50],
        [14, 18, 39, 50, 59, 42],
        [13, 18, 22, 46, 52, 30],
        [18, 40, 46, 50, 53, 13],
        [18, 40, 46, 50, 53, 17],
        [ 1, 31, 33, 40, 55, 47],
        [ 2,  9, 14, 49, 63, 50],
        [ 9, 27, 40, 50, 63, 31],
        [ 2, 14, 47, 49, 63, 58],
        [ 2,  9, 27, 50, 63, 21],
        [ 2,  9, 50, 58, 63, 59],
        [ 2, 14, 47, 49, 58, 10],
        [ 9, 27, 40, 44, 63, 31],
        [ 1, 19, 27, 36, 56,  9],
        [ 1,  9, 14, 19, 43, 44],
        [ 5,  7, 44, 47, 55, 14],
        [17, 39, 43, 47, 48, 35],
        [ 1, 36, 56, 58, 59, 47],
        [19, 35, 36, 47, 56, 58],
        [17, 34, 37, 43, 57, 63],
        [17, 20, 31, 37, 43, 30],
        [ 1, 17, 31, 33, 43, 36],
        [13, 17, 22, 43, 52, 36],
        [17, 22, 24, 37, 52,  6],
        [13, 22, 30, 52, 59,  6],
        [22, 24, 50, 52, 63,  6],
        [17, 20, 24, 37, 50, 52],
        [14, 17, 43, 44, 50,  1],
        [35, 37, 47, 50, 57, 30],
        [18, 30, 37, 46, 59, 23],
        [13, 22, 23, 52, 59, 50],
        [ 8, 18, 23, 46, 50, 40],
        [ 9, 40, 46, 51, 53, 37],
        [ 9, 17, 31, 33, 63,  1],
        [ 9, 14, 27, 43, 55,  5],
        [ 1,  5, 14, 47, 49, 27],
        [27, 33, 40, 47, 55,  1],
        [ 2,  9, 32, 49, 63,  4],
        [ 2, 11, 44, 49, 63, 14],
        [ 4, 27, 47, 48, 49, 11],
        [ 5,  9, 19, 47, 55, 39],
        [ 1, 14, 44, 47, 49,  9],
        [ 5,  7, 29, 33, 47, 55],
        [19, 35, 44, 47, 58, 50],
        [18, 30, 46, 50, 59, 23],
        [13, 22, 23, 50, 52,  4],
        [ 8, 18, 46, 50, 53, 40],
        [40, 46, 50, 51, 53, 18],
        [ 1, 17, 33, 36, 47, 43],
        [17, 33, 40, 50, 53, 63],
        [ 1,  2, 27, 49, 56, 39],
        [ 4,  5, 44, 49, 55, 24],
        [ 4, 26, 27, 40, 63, 41],
        [ 1,  4,  5, 14, 49,  2],
        [17, 26, 43, 47, 48, 28],
        [17, 26, 36, 43, 48, 27],
        [19, 35, 47, 55, 58, 50],
        [ 3, 35, 50, 51, 57, 17],
        [17, 35, 43, 45, 53, 50],
        [ 4, 17, 25, 33, 40, 55],
        [ 2, 32, 50, 58, 63, 23],
        [11, 27, 49, 50, 58, 32],
        [14, 44, 47, 49, 50, 45],
        [13, 35, 44, 47, 50, 19],
        [18, 30, 35, 46, 59, 53],
        [13, 22, 23, 28, 52, 42],
        [ 8, 18, 23, 46, 50, 53],
        [40, 46, 50, 51, 53,  4],
        [17, 33, 37, 40, 43, 47],
        [ 1, 14, 37, 46, 47, 35],
        [18, 40, 46, 50, 53, 37],
        [ 2, 32, 50, 58, 63, 59],
        [ 2, 14, 49, 58, 63,  0],
        [14, 35, 44, 47, 50, 60],
        [ 4,  9, 40, 44, 63, 47],
        [ 4, 14, 16, 19, 44,  1],
        [ 4, 11, 14, 44, 47, 12],
        [ 7, 32, 33, 44, 47,  5],
        [ 4, 17, 26, 43, 47, 48],
        [19, 35, 39, 47, 55, 16],
        [17, 18, 37, 50, 57, 63],
        [ 9, 46, 50, 59, 63, 18],
        [ 6, 22, 24, 37, 52, 13],
        [ 6, 22, 37, 43, 52, 30],
        [ 1,  6, 35, 37, 52, 47],
        [ 1,  6, 35, 37, 52, 47],
        [17, 34, 37, 51, 57, 18],
        [ 1, 17, 33, 37, 43, 31],
        [ 1,  4, 17, 41, 43, 20],
        [ 4, 16, 41, 47, 54, 39],
        [ 4,  9, 12, 26, 41, 27],
        [19, 35, 44, 47, 48, 16],
        [ 4,  9, 26, 27, 34, 21],
        [19, 33, 35, 39, 47, 32],
        [14, 17, 43, 44, 47,  1],
        [23, 35, 47, 50, 57, 13],
        [18, 30, 35, 46, 59, 53],
        [17, 31, 35, 37, 43, 19],
        [17, 31, 37, 43, 46, 34],
        [ 1, 17, 27, 37, 43, 19],
        [ 1,  5, 17, 36, 43, 35],
        [ 1, 17, 35, 37, 44, 20],
        [17, 20, 31, 37, 43, 35],
        [ 1, 17, 33, 37, 43, 31],
        [ 1, 14, 17, 33, 55, 54],
        [ 1, 14, 17, 35, 44, 50],
        [17, 18, 37, 51, 63, 31],
        [14, 18, 35, 37, 44,  1],
        [18, 37, 46, 50, 63,  9],
        [ 0,  6, 11, 14, 50,  8],
        [ 1, 17, 21, 50, 58,  6],
        [ 0,  8, 11, 49, 50, 58],
        [ 0,  6, 21, 37, 50,  8],
        [ 0,  6, 19, 22, 52, 50],
        [11, 14, 30, 35, 57, 50],
        [17, 37, 43, 51, 57, 34],
        [17, 26, 31, 34, 43, 37],
        [ 1, 14, 17, 43, 48, 39],
        [10, 32, 35, 43, 47,  1],
        [17, 30, 46, 57, 59, 35]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 61: 2.400(4250)[0m | [32mExpert 15: 2.200(4097)[0m | [32mExpert 48: 1.800(4205)[0m | [32mExpert 10: 1.600(4082)[0m | 
[32mExpert 25: 1.600(4130)[0m | [32mExpert  8: 1.400(4262)[0m | [32mExpert 12: 1.400(4088)[0m | [32mExpert 19: 1.400(4109)[0m | 
[32mExpert 26: 1.400(4133)[0m | [32mExpert  0: 1.200(4076)[0m | [32mExpert 18: 1.200(4106)[0m | [32mExpert 28: 1.200(4139)[0m | 
[32mExpert 14: 1.000(4094)[0m | [32mExpert 17: 1.000(4103)[0m | [32mExpert 42: 1.000(4187)[0m | [32mExpert 50: 1.000(4214)[0m | 
[32mExpert 53: 1.000(4223)[0m | [32mExpert 54: 1.000(4226)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert  5: 0.800(4211)[0m | 
[32mExpert 21: 0.800(4118)[0m | [32mExpert 36: 0.800(4166)[0m | [32mExpert 46: 0.800(4199)[0m | [32mExpert  2: 0.600(4112)[0m | 
[32mExpert  6: 0.600(4244)[0m | [32mExpert 20: 0.600(4115)[0m | [32mExpert 23: 0.600(4124)[0m | [32mExpert 27: 0.600(4136)[0m | 
[32mExpert 35: 0.600(4163)[0m | [32mExpert 37: 0.600(4169)[0m | [32mExpert 52: 0.600(4220)[0m | [32mExpert 62: 0.600(4253)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4118, 4166, 4199, 4112, 4244, 4115, 4124, 4136, 4163, 4169, 4220, 4253]
Prefetching [1;36mTensor 4118[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  6, 20, 21, 23, 27, 35, 36, 37, 46, 52, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:1.0 | [6]:1.0 | [23]:1.0 | [44]:1.0 | [54]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[1]:1.0 | [20]:1.0 | [26]:1.0 | [36]:1.0 | [38]:1.0 | [57]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[16]:1.0 | [19]:1.0 | [21]:1.0 | [53]:1.0 | [54]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E2 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E20 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E36 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E46 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:1.0 | [3]:1.0 | [5]:1.0 | [8]:1.0 | [55]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[3]:1.0 | [5]:1.0 | [16]:1.0 | [45]:1.0 | [47]:1.0 | [0]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[10]:1.0 | [24]:1.0 | [47]:1.0 | [62]:1.0 | [63]:1.0 | [5]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[10, 24, 47, 62, 63,  5],
        [ 0, 24, 28, 36, 42, 62],
        [16, 24, 28, 36, 40, 25],
        [ 7, 18, 19, 24, 36, 16],
        [18, 19, 24, 28, 36, 58],
        [18, 19, 24, 31, 41, 36],
        [19, 24, 40, 42, 51, 28],
        [24, 25, 28, 42, 51, 19],
        [34, 37, 42, 50, 61, 12],
        [10, 33, 48, 51, 62,  8],
        [19, 25, 28, 58, 61, 24],
        [19, 24, 28, 42, 57, 25],
        [16, 24, 25, 28, 57, 40],
        [16, 18, 20, 24, 36, 19],
        [16, 25, 40, 50, 61, 60],
        [16, 18, 24, 44, 57, 20],
        [16, 25, 40, 50, 61, 28],
        [ 8, 10, 32, 33, 53, 54],
        [16, 18, 20, 24, 44, 19],
        [16, 22, 24, 25, 57, 48],
        [ 1, 16, 35, 36, 62, 47],
        [15, 16, 24, 36, 46, 18],
        [16, 18, 20, 24, 44, 15],
        [ 2, 16, 20, 24, 44,  6],
        [20, 23, 24, 30, 35,  7],
        [ 3, 18, 20, 24, 44, 45],
        [16, 24, 28, 37, 61, 21],
        [ 4, 16, 19, 24, 31, 30],
        [19, 21, 24, 30, 36, 62],
        [19, 24, 33, 36, 62, 12],
        [19, 24, 30, 33, 36, 20],
        [ 4,  8, 13, 33, 52, 10],
        [16, 19, 24, 33, 36, 50],
        [16, 19, 21, 24, 36, 40],
        [16, 18, 19, 21, 24, 36],
        [ 8, 20, 50, 53, 61, 52],
        [ 6, 30, 50, 60, 61, 52],
        [ 6, 30, 33, 35, 48, 52],
        [16, 25, 58, 60, 61, 50],
        [ 1, 16, 24, 25, 37, 28],
        [16, 21, 24, 25, 40, 20],
        [15, 16, 18, 24, 47, 36],
        [16, 18, 20, 24, 47, 28],
        [16, 22, 24, 25, 40, 28],
        [16, 32, 33, 53, 58,  7],
        [16, 20, 24, 29, 47, 18],
        [ 2, 15, 16, 20, 24,  7],
        [ 2, 16, 18, 20, 24, 15],
        [ 2, 16, 18, 20, 24, 15],
        [15, 16, 18, 20, 24,  2],
        [10, 18, 20, 24, 45,  9],
        [ 6, 19, 50, 60, 61, 30],
        [ 6, 30, 34, 35, 62, 63],
        [16, 25, 50, 58, 61, 60],
        [16, 22, 24, 25, 37, 28],
        [21, 24, 28, 33, 47, 30],
        [16, 19, 21, 24, 25, 22],
        [ 7, 15, 16, 24, 55, 36],
        [16, 18, 20, 21, 24, 30],
        [16, 22, 24, 25, 40, 55],
        [16, 20, 24, 35, 55, 15],
        [16, 20, 24, 43, 58, 44],
        [ 2, 16, 24, 43, 44, 20],
        [ 9, 18, 20, 24, 45,  3],
        [19, 24, 28, 37, 50, 20],
        [ 4, 19, 24, 28, 31, 12],
        [16, 20, 24, 28, 52, 40],
        [ 0,  8, 10, 25, 32, 33],
        [ 1, 15, 16, 24, 47, 29],
        [12, 16, 18, 20, 24,  2],
        [ 3, 18, 20, 24, 45,  9],
        [ 6, 19, 50, 61, 62,  8],
        [ 6, 34, 35, 47, 63, 30],
        [25, 50, 58, 60, 61, 16],
        [16, 24, 25, 28, 37, 50],
        [16, 19, 21, 22, 24, 40],
        [18, 19, 20, 24, 28, 21],
        [16, 22, 24, 25, 37, 61],
        [ 8, 10, 32, 36, 54, 33],
        [16, 19, 20, 24, 29, 32],
        [16, 19, 20, 24, 29, 45],
        [16, 22, 24, 25, 48, 32],
        [15, 16, 24, 46, 57, 20],
        [15, 16, 18, 20, 24, 48],
        [15, 16, 18, 20, 24, 55],
        [15, 16, 20, 24, 57, 19],
        [ 9, 18, 20, 24, 45,  8],
        [16, 19, 21, 24, 37, 61],
        [13, 30, 33, 45, 52, 63],
        [19, 23, 30, 33, 36, 52],
        [19, 23, 24, 33, 36, 48],
        [19, 23, 24, 36, 38, 20],
        [19, 20, 23, 24, 36, 38],
        [16, 19, 21, 28, 37, 25],
        [16, 19, 22, 24, 40, 21],
        [16, 24, 30, 35, 55, 20],
        [ 2, 15, 16, 18, 24, 55],
        [ 2, 16, 24, 44, 55, 34],
        [ 2, 18, 24, 43, 44, 16],
        [16, 24, 34, 44, 55, 38],
        [ 2, 16, 18, 24, 54, 15],
        [16, 18, 20, 24, 43, 48],
        [ 8, 10, 20, 52, 53, 45],
        [ 8, 19, 28, 50, 61, 52],
        [19, 22, 24, 28, 36, 43],
        [19, 28, 36, 37, 43, 50],
        [ 2, 19, 24, 33, 36, 45],
        [23, 24, 35, 36, 62, 33],
        [18, 19, 31, 43, 45, 24],
        [ 4, 16, 19, 30, 31, 46],
        [ 2, 16, 19, 36, 40, 24],
        [ 3, 18, 19, 24, 36,  2],
        [ 3, 18, 19, 24, 36,  2],
        [16, 19, 21, 28, 37, 50],
        [16, 19, 28, 36, 44, 24],
        [19, 28, 36, 50, 61, 40],
        [19, 23, 25, 36, 56, 45],
        [ 8, 10, 23, 33, 36, 19],
        [19, 23, 24, 33, 36, 58],
        [19, 25, 51, 56, 61, 58],
        [12, 19, 20, 23, 52, 33],
        [ 3,  8, 18, 19, 50, 26],
        [19, 21, 28, 37, 50, 14],
        [16, 19, 40, 43, 44,  4],
        [11, 16, 18, 36, 43, 19],
        [ 3,  9, 18, 34, 52, 13],
        [ 8, 19, 50, 53, 61, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:1.0 | [11]:1.0 | [38]:1.0 | [39]:1.0 | [45]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[9]:1.0 | [34]:1.0 | [54]:1.0 | [56]:1.0 | [57]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[2]
write out information.

EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2740
[1m[33mEnqueueTask: [0m[32mTask: node: ID[568,2d00000013] (16MB) STATE(0) TENSOR[2739,2740,2738,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[568,2d00000013] (16MB) STATE(0) TENSOR[2739,2740,2738,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 36
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:1.0 | [31]:1.0 | [47]:1.0 | [50]:1.0 | [57]:2.0 | [11]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[8]:1.0 | [13]:1.0 | [59]:1.0 | [62]:2.0 | [63]:2.0 | [37]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[0]:1.0 | [22]:1.0 | [46]:1.0 | [48]:1.0 | [60]:1.0 | [21]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[3]:1.0 | [18]:1.0 | [22]:1.0 | [34]:1.0 | [60]:1.0 | [13]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[12]:1.0 | [18]:1.0 | [39]:1.0 | [43]:1.0 | [50]:1.0 | [42]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[11]:1.0 | [37]:1.0 | [46]:1.0 | [50]:1.0 | [56]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[11, 37, 46, 50, 56, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 2.600(2635)[0m | [32mExpert 12: 2.000(2632)[0m | [32mExpert 22: 2.000(2665)[0m | [32mExpert 31: 1.800(2695)[0m | 
[32mExpert 44: 1.800(2737)[0m | [32mExpert  7: 1.800(2803)[0m | [32mExpert 38: 1.800(2716)[0m | [32mExpert 63: 1.800(2800)[0m | 
[32mExpert 16: 1.600(2644)[0m | [32mExpert 46: 1.600(2743)[0m | [32mExpert 61: 1.600(2794)[0m | [32mExpert 23: 1.400(2668)[0m | 
[32mExpert  4: 1.200(2722)[0m | [32mExpert 26: 1.200(2677)[0m | [32mExpert 32: 1.200(2698)[0m | [32mExpert 41: 1.200(2728)[0m | 
[32mExpert 27: 1.000(2680)[0m | [32mExpert 17: 1.000(2647)[0m | [32mExpert 25: 1.000(2674)[0m | [32mExpert 33: 1.000(2701)[0m | 
[32mExpert  8: 0.800(2806)[0m | [32mExpert 53: 0.800(2767)[0m | [32mExpert 60: 0.800(2791)[0m | [32mExpert  1: 0.600(2623)[0m | 
[32mExpert 34: 0.600(2704)[0m | [32mExpert 36: 0.600(2710)[0m | [32mExpert 42: 0.600(2731)[0m | [32mExpert 45: 0.600(2740)[0m | 
[32mExpert 48: 0.600(2749)[0m | [32mExpert 58: 0.600(2782)[0m | [33mExpert  0: 0.400(2620)[0m | [33mExpert  2: 0.400(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2806, 2767, 2791, 2623, 2704, 2710, 2731, 2740, 2749, 2782, 2620, 2656]
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2740[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  1,  2,  8, 34, 36, 42, 45, 48, 53, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:1.0 | [26]:1.0 | [38]:1.0 | [41]:1.0 | [42]:1.0 | [8]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[10]:1.0 | [33]:1.0 | [45]:1.0 | [46]:1.0 | [55]:1.0 | [6]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[35]:1.0 | [41]:1.0 | [45]:1.0 | [46]:1.0 | [48]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E45 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[17]:1.0 | [30]:1.0 | [41]:1.0 | [55]:1.0 | [60]:1.0 | [27]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[8]:1.0 | [28]:1.0 | [43]:1.0 | [47]:1.0 | [54]:2.0 | [16]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[29]:1.0 | [38]:1.0 | [41]:1.0 | [46]:1.0 | [48]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[29, 38, 41, 46, 48, 43]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  5: 3.000(2993)[0m | [32mExpert  4: 2.600(2960)[0m | [32mExpert 55: 2.600(3011)[0m | [32mExpert  0: 2.400(2858)[0m | 
[32mExpert 36: 2.200(2948)[0m | [32mExpert 23: 1.800(2906)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 52: 1.600(3002)[0m | 
[32mExpert 48: 1.400(2987)[0m | [32mExpert  6: 1.200(3026)[0m | [32mExpert 11: 1.200(2867)[0m | [32mExpert 15: 1.200(2879)[0m | 
[32mExpert 24: 1.200(2909)[0m | [32mExpert 33: 1.200(2939)[0m | [32mExpert 49: 1.200(2990)[0m | [32mExpert 16: 1.000(2882)[0m | 
[32mExpert 50: 1.000(2996)[0m | [32mExpert 38: 0.800(2954)[0m | [32mExpert 41: 0.800(2966)[0m | [32mExpert  1: 0.600(2861)[0m | 
[32mExpert 25: 0.600(2912)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 31: 0.600(2933)[0m | [32mExpert 32: 0.600(2936)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 44: 0.600(2975)[0m | 
[32mExpert 53: 0.600(3005)[0m | [32mExpert 61: 0.600(3032)[0m | [32mExpert 63: 0.600(3038)[0m | [33mExpert  9: 0.400(3047)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2918, 2924, 2930, 2933, 2936, 2942, 2975, 3005, 3032, 3038, 3047]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  9, 25, 27, 29, 30, 31, 32, 34, 44, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:1.0 | [21]:1.0 | [29]:1.0 | [33]:1.0 | [44]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[9]:1.0 | [15]:1.0 | [28]:1.0 | [30]:1.0 | [33]:1.0 | [25]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[0]:1.0 | [6]:1.0 | [16]:1.0 | [38]:1.0 | [49]:1.0 | [50]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[15]:1.0 | [16]:1.0 | [17]:1.0 | [24]:1.0 | [41]:1.0 | [5]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[15]:1.0 | [25]:1.0 | [40]:1.0 | [55]:1.0 | [62]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[8]:1.0 | [18]:1.0 | [30]:1.0 | [46]:1.0 | [57]:1.0 | [59]:1.0 | EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 8, 18, 30, 46, 57, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 61: 2.400(4250)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 15: 2.200(4097)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 54: 1.800(4226)[0m | [32mExpert 48: 1.800(4205)[0m | [32mExpert 21: 1.600(4118)[0m | 
[32mExpert 10: 1.600(4082)[0m | [32mExpert 25: 1.600(4130)[0m | [32mExpert  8: 1.400(4262)[0m | [32mExpert 12: 1.400(4088)[0m | 
[32mExpert 26: 1.400(4133)[0m | [32mExpert  0: 1.200(4076)[0m | [32mExpert 18: 1.200(4106)[0m | [32mExpert 16: 1.000(4100)[0m | 
[32mExpert 14: 1.000(4094)[0m | [32mExpert 17: 1.000(4103)[0m | [32mExpert 42: 1.000(4187)[0m | [32mExpert 50: 1.000(4214)[0m | 
[32mExpert 56: 1.000(4232)[0m | [32mExpert  5: 0.800(4211)[0m | [32mExpert 36: 0.800(4166)[0m | [32mExpert 46: 0.800(4199)[0m | 
[32mExpert  2: 0.600(4112)[0m | [32mExpert  6: 0.600(4244)[0m | [32mExpert 20: 0.600(4115)[0m | [32mExpert 23: 0.600(4124)[0m | 
[32mExpert 27: 0.600(4136)[0m | [32mExpert 35: 0.600(4163)[0m | [32mExpert 37: 0.600(4169)[0m | [32mExpert 52: 0.600(4220)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4232, 4211, 4166, 4199, 4112, 4244, 4115, 4124, 4136, 4163, 4169, 4220]
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 20, 23, 27, 35, 36, 37, 46, 52, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:1.0 | [19]:1.0 | [24]:1.0 | [41]:1.0 | [47]:1.0 | [13]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[15]:1.0 | [22]:1.0 | [25]:1.0 | [44]:1.0 | [50]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[13]:1.0 | [14]:1.0 | [17]:1.0 | [27]:1.0 | [48]:1.0 | [51]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[11]:2.0 | [21]:1.0 | [34]:1.0 | [55]:2.0 | [60]:1.0 | [5]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[6]:1.0 | [12]:1.0 | [22]:1.0 | [23]:1.0 | [26]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[6]:1.0 | [30]:1.0 | [50]:1.0 | [52]:1.0 | [61]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 6, 30, 50, 52, 61, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:2.0 | [10]:1.0 | [12]:1.0 | [45]:2.0 | [63]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[11]:1.0 | [26]:1.0 | [30]:1.0 | [56]:2.0 | [63]:1.0 | [57]:2.0 | 
---------------------------------------
return EAMC[2]

EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 37
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3038
[1m[33mEnqueueTask: [0m[32mTask: node: ID[976,3f0000001f] (16MB) STATE(0) TENSOR[3037,3038,3036,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[11]:2.0 | [19]:1.0 | [31]:2.0 | [50]:2.0 | [57]:3.0 | [47]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[8]:2.0 | [27]:1.0 | [38]:2.0 | [62]:3.0 | [63]:3.0 | [59]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[0]:2.0 | [5]:1.0 | [21]:2.0 | [48]:2.0 | [60]:2.0 | [46]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[3]:2.0 | [18]:2.0 | [22]:2.0 | [34]:2.0 | [60]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[12]:2.0 | [18]:2.0 | [39]:2.0 | [42]:2.0 | [50]:2.0 | [38]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[16]:2.0 | [37]:2.0 | [46]:2.0 | [50]:2.0 | [56]:2.0 | [11]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[16, 37, 46, 50, 56, 11]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 13: 2.600(2635)[0m | [32mExpert 46: 2.400(2743)[0m | [32mExpert 12: 2.000(2632)[0m | [32mExpert 22: 2.000(2665)[0m | 
[32mExpert 41: 2.000(2728)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 44: 1.800(2737)[0m | [32mExpert  7: 1.800(2803)[0m | 
[32mExpert 38: 1.800(2716)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert  1: 1.400(2623)[0m | [32mExpert 45: 1.400(2740)[0m | [32mExpert 48: 1.400(2749)[0m | [32mExpert 23: 1.400(2668)[0m | 
[32mExpert 35: 1.200(2707)[0m | [32mExpert  4: 1.200(2722)[0m | [32mExpert 26: 1.200(2677)[0m | [32mExpert 32: 1.200(2698)[0m | 
[32mExpert 27: 1.000(2680)[0m | [32mExpert 17: 1.000(2647)[0m | [32mExpert 25: 1.000(2674)[0m | [32mExpert 33: 1.000(2701)[0m | 
[32mExpert  8: 0.800(2806)[0m | [32mExpert 53: 0.800(2767)[0m | [32mExpert 60: 0.800(2791)[0m | [32mExpert 34: 0.600(2704)[0m | 
[32mExpert 36: 0.600(2710)[0m | [32mExpert 42: 0.600(2731)[0m | [32mExpert 58: 0.600(2782)[0m | [33mExpert  0: 0.400(2620)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2680, 2647, 2674, 2701, 2806, 2767, 2791, 2704, 2710, 2731, 2782, 2620]
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  8, 17, 25, 27, 33, 34, 36, 42, 53, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:2.0 | [38]:2.0 | [41]:2.0 | [42]:2.0 | [50]:1.0 | [8]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[6]:2.0 | [33]:2.0 | [45]:2.0 | [46]:2.0 | [55]:2.0 | [8]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[35]:2.0 | [41]:2.0 | [45]:2.0 | [46]:2.0 | [48]:2.0 | [1]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 10 MLP ==
[0m
[30]:2.0 | [41]:2.0 | [55]:2.0 | [59]:1.0 | [60]:2.0 | [17]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[8]:2.0 | [28]:2.0 | [43]:2.0 | [47]:2.0 | [54]:3.0 | [35]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[29]:2.0 | [38]:2.0 | [41]:2.0 | [42]:1.0 | [46]:2.0 | [7]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[29, 38, 41, 42, 46,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 3.200(2858)[0m | [32mExpert  5: 3.000(2993)[0m | [32mExpert  4: 2.600(2960)[0m | [32mExpert 55: 2.600(3011)[0m | 
[32mExpert 36: 2.200(2948)[0m | [32mExpert  6: 2.000(3026)[0m | [32mExpert 49: 2.000(2990)[0m | [32mExpert 16: 1.800(2882)[0m | 
[32mExpert 50: 1.800(2996)[0m | [32mExpert 23: 1.800(2906)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 38: 1.600(2954)[0m | 
[32mExpert 52: 1.600(3002)[0m | [32mExpert 48: 1.400(2987)[0m | [32mExpert 11: 1.200(2867)[0m | [32mExpert 15: 1.200(2879)[0m | 
[32mExpert 24: 1.200(2909)[0m | [32mExpert 33: 1.200(2939)[0m | [32mExpert 41: 0.800(2966)[0m | [32mExpert  1: 0.600(2861)[0m | 
[32mExpert 25: 0.600(2912)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 31: 0.600(2933)[0m | [32mExpert 32: 0.600(2936)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 44: 0.600(2975)[0m | 
[32mExpert 53: 0.600(3005)[0m | [32mExpert 61: 0.600(3032)[0m | [32mExpert 63: 0.600(3038)[0m | [33mExpert  9: 0.400(3047)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 2918, 2924, 2930, 2933, 2936, 2942, 2975, 3005, 3032, 3038, 3047]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 3038[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  9, 25, 27, 29, 30, 31, 32, 34, 44, 53, 61, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:2.0 | [21]:2.0 | [29]:2.0 | [33]:2.0 | [44]:2.0 | [41]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[9]:2.0 | [15]:2.0 | [28]:2.0 | [30]:2.0 | [33]:2.0 | [25]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[0]:2.0 | [6]:2.0 | [16]:2.0 | [19]:1.0 | [49]:2.0 | [8]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[15]:2.0 | [17]:2.0 | [24]:2.0 | [41]:2.0 | [42]:1.0 | [10]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[15]:2.0 | [25]:2.0 | [40]:2.0 | [52]:1.0 | [55]:2.0 | [42]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[18]:2.0 | [30]:2.0 | [46]:2.0 | [51]:1.0 | [53]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[18, 30, 46, 51, 53, 40]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 2.600(4205)[0m | [32mExpert 61: 2.400(4250)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 15: 2.200(4097)[0m | 
[32mExpert 28: 2.000(4139)[0m | [32mExpert 14: 1.800(4094)[0m | [32mExpert 17: 1.800(4103)[0m | [32mExpert 53: 1.800(4223)[0m | 
[32mExpert 54: 1.800(4226)[0m | [32mExpert 21: 1.600(4118)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert 25: 1.600(4130)[0m | 
[32mExpert 27: 1.400(4136)[0m | EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
[32mExpert  8: 1.400(4262)[0m | [32mExpert 12: 1.400(4088)[0m | [32mExpert 26: 1.400(4133)[0m | 
[32mExpert 51: 1.200(4217)[0m | [32mExpert  0: 1.200(4076)[0m | [32mExpert 18: 1.200(4106)[0m | [32mExpert 16: 1.000(4100)[0m | 
[32mExpert 42: 1.000(4187)[0m | [32mExpert 50: 1.000(4214)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 13: 0.800(4091)[0m | 
[32mExpert  5: 0.800(4211)[0m | [32mExpert 36: 0.800(4166)[0m | [32mExpert 46: 0.800(4199)[0m | [32mExpert  2: 0.600(4112)[0m | 
[32mExpert  6: 0.600(4244)[0m | [32mExpert 20: 0.600(4115)[0m | [32mExpert 23: 0.600(4124)[0m | [32mExpert 35: 0.600(4163)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4187, 4214, 4232, 4091, 4211, 4166, 4199, 4112, 4244, 4115, 4124, 4163]
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5,  6, 13, 20, 23, 35, 36, 42, 46, 50, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:2.0 | [24]:2.0 | [30]:1.0 | [41]:2.0 | [47]:2.0 | [61]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[15]:2.0 | [22]:2.0 | [25]:2.0 | [44]:2.0 | [50]:2.0 | [53]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[6]:1.0 | [14]:2.0 | [27]:2.0 | [48]:2.0 | [62]:1.0 | [54]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:2.0 | [34]:2.0 | [40]:1.0 | [55]:3.0 | [60]:2.0 | [37]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[3]:2.0 | [6]:2.0 | [7]:1.0 | [23]:2.0 | [57]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[19]:1.0 | [28]:1.0 | [37]:1.0 | [50]:2.0 | [61]:2.0 | [22]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[19, 28, 37, 50, 61, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:1.0 | [10]:2.0 | [12]:2.0 | [21]:1.0 | [57]:1.0 | [63]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[26]:2.0 | [30]:2.0 | [34]:2.0 | [36]:1.0 | [56]:3.0 | [57]:3.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2782
[1m[33mEnqueueTask: [0m[32mTask: node: ID[581,3a00000013] (16MB) STATE(0) TENSOR[2781,2782,2780,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 38
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:1.0 | [9]:1.0 | [13]:1.0 | [37]:1.0 | [52]:1.0 | [23]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[22]:1.0 | [35]:2.0 | [42]:1.0 | [58]:1.0 | [63]:4.0 | [14]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[0]:3.0 | [7]:1.0 | [42]:1.0 | [48]:3.0 | [62]:1.0 | [56]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[10]:1.0 | [18]:3.0 | [34]:3.0 | [38]:1.0 | [59]:1.0 | [25]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[18]:3.0 | [38]:2.0 | [39]:3.0 | [41]:1.0 | [50]:3.0 | [42]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[6]:1.0 | [19]:1.0 | [37]:3.0 | [46]:3.0 | [56]:3.0 | [50]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 6, 19, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 3.200(2743)[0m | [32mExpert 41: 2.800(2728)[0m | [32mExpert 13: 2.600(2635)[0m | [32mExpert  1: 2.200(2623)[0m | 
[32mExpert 45: 2.200(2740)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 12: 2.000(2632)[0m | 
[32mExpert 22: 2.000(2665)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 44: 1.800(2737)[0m | [32mExpert  7: 1.800(2803)[0m | 
[32mExpert 38: 1.800(2716)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 23: 1.400(2668)[0m | [32mExpert  4: 1.200(2722)[0m | [32mExpert 26: 1.200(2677)[0m | [32mExpert 32: 1.200(2698)[0m | 
[32mExpert 27: 1.000(2680)[0m | [32mExpert 17: 1.000(2647)[0m | [32mExpert 25: 1.000(2674)[0m | [32mExpert 33: 1.000(2701)[0m | 
[32mExpert  8: 0.800(2806)[0m | [32mExpert 53: 0.800(2767)[0m | [32mExpert 60: 0.800(2791)[0m | [32mExpert 34: 0.600(2704)[0m | 
[32mExpert 36: 0.600(2710)[0m | [32mExpert 42: 0.600(2731)[0m | [32mExpert 58: 0.600(2782)[0m | [33mExpert  0: 0.400(2620)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2680, 2647, 2674, 2701, 2806, 2767, 2791, 2704, 2710, 2731, 2782, 2620]
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2782[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  8, 17, 25, 27, 33, 34, 36, 42, 53, 58, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:3.0 | [16]:1.0 | [38]:3.0 | [41]:3.0 | [50]:2.0 | [61]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[8]:2.0 | [32]:1.0 | [45]:3.0 | [46]:3.0 | [49]:1.0 | [33]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[0]:1.0 | [19]:1.0 | [41]:3.0 | [45]:3.0 | [46]:3.0 | [38]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:3.0 | [41]:3.0 | [50]:1.0 | [57]:1.0 | [59]:2.0 | [55]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[23]:1.0 | [28]:3.0 | [31]:1.0 | [43]:3.0 | [47]:3.0 | [10]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[4]:2.0 | [28]:1.0 | [29]:3.0 | [37]:2.0 | [41]:3.0 | [46]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 4, 28, 29, 37, 41, 46]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 4.000(2858)[0m | [32mExpert  5: 3.000(2993)[0m | [32mExpert  6: 2.800(3026)[0m | [32mExpert 49: 2.800(2990)[0m | 
[32mExpert  4: 2.600(2960)[0m | [32mExpert 16: 2.600(2882)[0m | [32mExpert 55: 2.600(3011)[0m | [32mExpert 36: 2.200(2948)[0m | 
[32mExpert 50: 1.800(2996)[0m | [32mExpert 23: 1.800(2906)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 38: 1.600(2954)[0m | 
[32mExpert 52: 1.600(3002)[0m | [32mExpert 48: 1.400(2987)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 11: 1.200(2867)[0m | 
[32mExpert 15: 1.200(2879)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 33: 1.200(2939)[0m | [32mExpert  8: 0.800(3044)[0m | 
[32mExpert 41: 0.800(2966)[0m | [32mExpert  1: 0.600(2861)[0m | [32mExpert 25: 0.600(2912)[0m | [32mExpert 27: 0.600(2918)[0m | 
[32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 31: 0.600(2933)[0m | [32mExpert 32: 0.600(2936)[0m | 
[32mExpert 34: 0.600(2942)[0m | [32mExpert 44: 0.600(2975)[0m | [32mExpert 53: 0.600(3005)[0m | [32mExpert 61: 0.600(3032)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2966, 2861, 2912, 2918, 2924, 2930, 2933, 2936, 2942, 2975, 3005, 3032]
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 25, 27, 29, 30, 31, 32, 34, 41, 44, 53, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:1.0 | [6]:3.0 | [18]:1.0 | [29]:3.0 | [44]:3.0 | [30]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[9]:3.0 | [15]:3.0 | [26]:1.0 | [28]:3.0 | [49]:1.0 | [33]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[10]:1.0 | [16]:3.0 | [38]:2.0 | [49]:3.0 | [58]:1.0 | [50]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[5]:2.0 | [8]:1.0 | [16]:2.0 | [24]:3.0 | [41]:3.0 | [21]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[3]:1.0 | [5]:1.0 | [25]:3.0 | [40]:3.0 | [62]:2.0 | [24]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[8]:2.0 | [13]:1.0 | [22]:1.0 | [46]:3.0 | [52]:1.0 | [18]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 8, 13, 22, 46, 52, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 3.400(4205)[0m | [32mExpert 14: 2.600(4094)[0m | [32mExpert 54: 2.600(4226)[0m | [32mExpert 61: 2.400(4250)[0m | 
[32mExpert 27: 2.200(4136)[0m | [32mExpert 19: 2.200(4109)[0m | EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
[32mExpert 15: 2.200(4097)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert 17: 1.800(4103)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 21: 1.600(4118)[0m | [32mExpert 10: 1.600(4082)[0m | 
[32mExpert 25: 1.600(4130)[0m | [32mExpert  6: 1.400(4244)[0m | [32mExpert 62: 1.400(4253)[0m | [32mExpert  8: 1.400(4262)[0m | 
[32mExpert 12: 1.400(4088)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert  0: 1.200(4076)[0m | 
[32mExpert 18: 1.200(4106)[0m | [32mExpert 16: 1.000(4100)[0m | [32mExpert 42: 1.000(4187)[0m | [32mExpert 50: 1.000(4214)[0m | 
[32mExpert 56: 1.000(4232)[0m | [32mExpert 13: 0.800(4091)[0m | [32mExpert  5: 0.800(4211)[0m | [32mExpert 36: 0.800(4166)[0m | 
[32mExpert 46: 0.800(4199)[0m | [32mExpert  2: 0.600(4112)[0m | [32mExpert 20: 0.600(4115)[0m | [32mExpert 23: 0.600(4124)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4106, 4100, 4187, 4214, 4232, 4091, 4211, 4166, 4199, 4112, 4115, 4124]
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5, 13, 16, 18, 20, 23, 36, 42, 46, 50, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:3.0 | [24]:3.0 | [29]:1.0 | [31]:1.0 | [53]:1.0 | [12]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[6]:1.0 | [15]:3.0 | [43]:2.0 | [50]:3.0 | [55]:1.0 | [25]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[17]:2.0 | [21]:2.0 | [25]:1.0 | [43]:1.0 | [48]:3.0 | [0]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 22 MLP ==
[0m
[2]:1.0 | [4]:1.0 | [11]:3.0 | [21]:3.0 | [58]:1.0 | [55]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[3]:3.0 | [13]:1.0 | [22]:2.0 | [35]:1.0 | [54]:1.0 | [45]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[10]:2.0 | [23]:1.0 | [33]:1.0 | [52]:2.0 | [61]:3.0 | [62]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[10, 23, 33, 52, 61, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:3.0 | [25]:1.0 | [38]:2.0 | [52]:1.0 | [62]:1.0 | [1]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[20]:1.0 | [29]:1.0 | [49]:1.0 | [57]:4.0 | [59]:1.0 | [56]:4.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:1.0 | [20]:1.0 | [26]:2.0 | [52]:2.0 | [56]:2.0 | [9]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[0]:1.0 | [35]:3.0 | [38]:3.0 | [42]:2.0 | [63]:5.0 | [57]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[0]:4.0 | [5]:2.0 | [7]:2.0 | [22]:2.0 | [42]:2.0 | [54]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[13]:2.0 | [18]:4.0 | [26]:1.0 | [34]:4.0 | [59]:2.0 | [29]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[38]:3.0 | [39]:4.0 | [40]:1.0 | [41]:2.0 | [50]:4.0 | [10]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[12]:1.0 | [19]:2.0 | [35]:1.0 | [46]:4.0 | [56]:4.0 | [28]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[12, 19, 35, 46, 56, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 4.000(2743)[0m | [32mExpert 41: 3.600(2728)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 13: 2.600(2635)[0m | 
[32mExpert 38: 2.600(2716)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 12: 2.000(2632)[0m | [32mExpert 22: 2.000(2665)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 44: 1.800(2737)[0m | 
[32mExpert  7: 1.800(2803)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert  4: 1.200(2722)[0m | 
[32mExpert 26: 1.200(2677)[0m | [32mExpert 32: 1.200(2698)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert 17: 1.000(2647)[0m | 
[32mExpert 25: 1.000(2674)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert  8: 0.800(2806)[0m | [32mExpert 53: 0.800(2767)[0m | 
[32mExpert 60: 0.800(2791)[0m | [32mExpert 34: 0.600(2704)[0m | [32mExpert 36: 0.600(2710)[0m | [32mExpert 42: 0.600(2731)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2677, 2698, 2680, 2647, 2674, 2701, 2806, 2767, 2791, 2704, 2710, 2731]
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  8, 17, 25, 26, 27, 32, 33, 34, 36, 42, 53, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:4.0 | [26]:2.0 | [41]:4.0 | [42]:3.0 | [50]:3.0 | [55]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[6]:3.0 | [8]:3.0 | [18]:1.0 | [46]:4.0 | [49]:2.0 | [45]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[33]:1.0 | [38]:2.0 | [41]:4.0 | [45]:4.0 | [46]:4.0 | [50]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:4.0 | [41]:4.0 | [50]:2.0 | [51]:1.0 | [57]:2.0 | [59]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[28]:4.0 | [34]:1.0 | [43]:4.0 | [47]:4.0 | [53]:1.0 | [54]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[29]:4.0 | [41]:4.0 | [42]:2.0 | [48]:2.0 | [57]:1.0 | [45]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[29, 41, 42, 48, 57, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  0: 4.000(2858)[0m | [32mExpert 49: 3.600(2990)[0m | [32mExpert 16: 3.400(2882)[0m | [32mExpert  5: 3.000(2993)[0m | 
[32mExpert  6: 2.800(3026)[0m | [32mExpert  4: 2.600(2960)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 55: 2.600(3011)[0m | 
[32mExpert 38: 2.400(2954)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert 23: 1.800(2906)[0m | [32mExpert 14: 1.600(2876)[0m | 
[32mExpert 52: 1.600(3002)[0m | [32mExpert 48: 1.400(2987)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 11: 1.200(2867)[0m | 
[32mExpert 15: 1.200(2879)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 33: 1.200(2939)[0m | [32mExpert 10: 1.000(2864)[0m | 
[32mExpert 58: 1.000(3020)[0m | [32mExpert  8: 0.800(3044)[0m | [32mExpert 41: 0.800(2966)[0m | [32mExpert  1: 0.600(2861)[0m | 
[32mExpert 25: 0.600(2912)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 31: 0.600(2933)[0m | [32mExpert 32: 0.600(2936)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 44: 0.600(2975)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3020, 3044, 2966, 2861, 2912, 2918, 2924, 2930, 2933, 2936, 2942, 2975]
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  8, 25, 27, 29, 30, 31, 32, 34, 41, 44, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[29]:4.0 | [30]:2.0 | [33]:3.0 | [41]:2.0 | [44]:4.0 | [57]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[9]:4.0 | [15]:4.0 | [28]:4.0 | [30]:3.0 | [50]:1.0 | [33]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[4]:1.0 | [6]:3.0 | [8]:2.0 | [16]:4.0 | [38]:3.0 | [15]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[17]:3.0 | [24]:4.0 | [41]:4.0 | [48]:1.0 | [50]:1.0 | [38]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[25]:4.0 | [40]:4.0 | [52]:2.0 | [55]:3.0 | [57]:1.0 | [15]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[8]:3.0 | [18]:4.0 | [40]:2.0 | [46]:4.0 | [53]:2.0 | [51]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 8, 18, 40, 46, 53, 51]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4166
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4199
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1349,2e0000002b] (16MB) STATE(0) TENSOR[4198,4199,4197,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4115
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1339,240000002b] (16MB) STATE(0) TENSOR[4165,4166,4164,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1323,140000002b] (16MB) STATE(0) TENSOR[4114,4115,4113,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
[90mTop 20 Experts:[0m
[32mExpert 48: 4.200(4205)[0m | [32mExpert 14: 2.600(4094)[0m | [32mExpert 17: 2.600(4103)[0m | [32mExpert 54: 2.600(4226)[0m | 
[32mExpert 21: 2.400(4118)[0m | [32mExpert 25: 2.400(4130)[0m | [32mExpert 61: 2.400(4250)[0m | [32mExpert 27: 2.200(4136)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert 15: 2.200(4097)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert  6: 1.400(4244)[0m | [32mExpert 62: 1.400(4253)[0m | 
[32mExpert  8: 1.400(4262)[0m | [32mExpert 12: 1.400(4088)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 51: 1.200(4217)[0m | 
[32mExpert 18: 1.200(4106)[0m | [32mExpert 16: 1.000(4100)[0m | [32mExpert 43: 1.000(4190)[0m | [32mExpert 42: 1.000(4187)[0m | 
[32mExpert 50: 1.000(4214)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 13: 0.800(4091)[0m | [32mExpert  5: 0.800(4211)[0m | 
[32mExpert 36: 0.800(4166)[0m | [32mExpert 46: 0.800(4199)[0m | [32mExpert  2: 0.600(4112)[0m | [32mExpert 20: 0.600(4115)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4106, 4100, 4190, 4187, 4214, 4232, 4091, 4211, 4166, 4199, 4112, 4115]
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4166[0m â†’ GPU 0
Prefetching [1;36mTensor 4199[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4115[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  5, 13, 16, 18, 20, 36, 42, 43, 46, 50, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:4.0 | [33]:1.0 | [41]:3.0 | [47]:3.0 | [56]:1.0 | [53]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[10]:1.0 | [15]:4.0 | [32]:1.0 | [42]:1.0 | [53]:2.0 | [50]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[9]:1.0 | [14]:3.0 | [30]:1.0 | [44]:1.0 | [55]:1.0 | [48]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 22 MLP ==
[0m
[21]:4.0 | [33]:1.0 | [44]:1.0 | [60]:3.0 | [62]:1.0 | [5]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[12]:2.0 | [23]:3.0 | [25]:1.0 | [38]:1.0 | [50]:1.0 | [51]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[16]:1.0 | [51]:1.0 | [58]:1.0 | [60]:2.0 | [61]:4.0 | [24]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[16, 51, 58, 60, 61, 24]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:4.0 | [10]:4.0 | [23]:1.0 | [45]:3.0 | [54]:2.0 | [35]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[12]:1.0 | [27]:1.0 | [51]:1.0 | [52]:1.0 | [56]:5.0 | [32]:1.0 | 
---------------------------------------
return EAMC[2]
1. EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:2.0 | [11]:3.0 | [13]:2.0 | [27]:1.0 | [56]:3.0 | [57]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [29]:1.0 | [38]:4.0 | [41]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[7]:3.0 | [10]:1.0 | [22]:3.0 | [42]:3.0 | [46]:3.0 | [23]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[13]:3.0 | [26]:2.0 | [34]:5.0 | [41]:1.0 | [59]:3.0 | [45]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[15]:1.0 | [38]:4.0 | [39]:5.0 | [41]:3.0 | [50]:5.0 | [40]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[6]:2.0 | [19]:3.0 | [24]:1.0 | [46]:5.0 | [56]:5.0 | [35]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 6, 19, 24, 46, 56, 35]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 4.800(2743)[0m | [32mExpert 41: 4.400(2728)[0m | [32mExpert 45: 3.800(2740)[0m | [32mExpert 38: 3.400(2716)[0m | 
[32mExpert 13: 2.600(2635)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 12: 2.000(2632)[0m | [32mExpert 22: 2.000(2665)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | 
[32mExpert 44: 1.800(2737)[0m | [32mExpert  7: 1.800(2803)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 16: 1.600(2644)[0m | 
[32mExpert 61: 1.600(2794)[0m | [32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | [32mExpert 19: 1.200(2653)[0m | 
[32mExpert  4: 1.200(2722)[0m | [32mExpert 26: 1.200(2677)[0m | [32mExpert 32: 1.200(2698)[0m | [32mExpert 27: 1.000(2680)[0m | 
[32mExpert 50: 1.000(2758)[0m | [32mExpert 17: 1.000(2647)[0m | [32mExpert 25: 1.000(2674)[0m | [32mExpert  8: 0.800(2806)[0m | 
[32mExpert 53: 0.800(2767)[0m | [32mExpert 60: 0.800(2791)[0m | [32mExpert 34: 0.600(2704)[0m | [32mExpert 36: 0.600(2710)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2722, 2677, 2698, 2680, 2758, 2647, 2674, 2806, 2767, 2791, 2704, 2710]
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  8, 17, 25, 26, 27, 32, 34, 36, 50, 53, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:5.0 | [12]:1.0 | [26]:3.0 | [41]:5.0 | [50]:4.0 | [19]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[8]:4.0 | [18]:2.0 | [25]:1.0 | [46]:5.0 | [49]:3.0 | [17]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[19]:2.0 | [38]:3.0 | [41]:5.0 | [46]:5.0 | [50]:2.0 | [17]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:5.0 | [41]:5.0 | [50]:3.0 | [51]:2.0 | [59]:4.0 | [57]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[28]:5.0 | [43]:5.0 | [51]:1.0 | [53]:2.0 | [54]:5.0 | [34]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[41]:5.0 | [42]:3.0 | [45]:2.0 | [48]:3.0 | [57]:2.0 | [29]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[41, 42, 45, 48, 57, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.200(2882)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert  6: 3.600(3026)[0m | [32mExpert 49: 3.600(2990)[0m | 
[32mExpert  4: 3.400(2960)[0m | [32mExpert 38: 3.200(2954)[0m | [32mExpert  5: 3.000(2993)[0m | [32mExpert 50: 2.600(2996)[0m | 
[32mExpert 55: 2.600(3011)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert 15: 2.000(2879)[0m | [32mExpert 23: 1.800(2906)[0m | 
[32mExpert  8: 1.600(3044)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 52: 1.600(3002)[0m | [32mExpert 48: 1.400(2987)[0m | 
[32mExpert 19: 1.200(2891)[0m | [32mExpert 11: 1.200(2867)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 33: 1.200(2939)[0m | 
[32mExpert 10: 1.000(2864)[0m | [32mExpert 58: 1.000(3020)[0m | [32mExpert 41: 0.800(2966)[0m | [32mExpert  1: 0.600(2861)[0m | 
[32mExpert 25: 0.600(2912)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 31: 0.600(2933)[0m | [32mExpert 32: 0.600(2936)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 44: 0.600(2975)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2864, 3020, 2966, 2861, 2912, 2918, 2924, 2930, 2933, 2936, 2942, 2975]
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 10, 25, 27, 29, 30, 31, 32, 34, 41, 44, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[29]:5.0 | [30]:3.0 | [33]:4.0 | [41]:3.0 | [44]:5.0 | [40]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[9]:5.0 | [15]:5.0 | [28]:5.0 | [30]:4.0 | [33]:5.0 | [25]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[4]:2.0 | [6]:4.0 | [16]:5.0 | [38]:4.0 | [49]:4.0 | [15]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[15]:3.0 | [17]:4.0 | [24]:5.0 | [41]:5.0 | [50]:2.0 | [48]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[18]:2.0 | [25]:5.0 | [40]:5.0 | [52]:3.0 | [57]:2.0 | [55]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[18]:5.0 | [40]:3.0 | [46]:5.0 | [51]:3.0 | [53]:3.0 | [57]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[18, 40, 46, 51, 53, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4193
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1347,2c0000002b] (16MB) STATE(0) TENSOR[4192,4193,4191,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[90mTop 20 Experts:[0m
[32mExpert 48: 5.000(4205)[0m | [32mExpert 14: 3.400(4094)[0m | [32mExpert 17: 2.600(4103)[0m | [32mExpert 54: 2.600(4226)[0m | 
[32mExpert 21: 2.400(4118)[0m | [32mExpert 25: 2.400(4130)[0m | [32mExpert 61: 2.400(4250)[0m | [32mExpert 27: 2.200(4136)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert 15: 2.200(4097)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert  6: 1.400(4244)[0m | [32mExpert 62: 1.400(4253)[0m | 
[32mExpert  8: 1.400(4262)[0m | [32mExpert 12: 1.400(4088)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 30: 1.200(4148)[0m | 
[32mExpert 51: 1.200(4217)[0m | [32mExpert 18: 1.200(4106)[0m | [32mExpert  9: 1.000(4265)[0m | [32mExpert 16: 1.000(4100)[0m | 
[32mExpert 43: 1.000(4190)[0m | [32mExpert 44: 1.000(4193)[0m | [32mExpert 55: 1.000(4229)[0m | [32mExpert 42: 1.000(4187)[0m | 
[32mExpert 50: 1.000(4214)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 13: 0.800(4091)[0m | [32mExpert  5: 0.800(4211)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4217, 4106, 4265, 4100, 4190, 4193, 4229, 4187, 4214, 4232, 4091, 4211]
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4193[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  9, 13, 16, 18, 42, 43, 44, 50, 51, 55, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:5.0 | [36]:1.0 | [41]:4.0 | [47]:4.0 | [56]:2.0 | [60]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[15]:5.0 | [22]:3.0 | [25]:4.0 | [30]:1.0 | [42]:2.0 | [44]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[13]:2.0 | [14]:4.0 | [37]:1.0 | [42]:1.0 | [44]:2.0 | [9]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:5.0 | [35]:1.0 | [41]:1.0 | [55]:5.0 | [60]:4.0 | [37]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[7]:2.0 | [11]:2.0 | [23]:4.0 | [38]:2.0 | [57]:2.0 | [6]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[16]:2.0 | [22]:2.0 | [24]:3.0 | [37]:2.0 | [44]:1.0 | [57]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[16, 22, 24, 37, 44, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:5.0 | [12]:3.0 | [23]:2.0 | [39]:2.0 | [49]:1.0 | [57]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[26]:3.0 | [30]:3.0 | [34]:3.0 | [48]:1.0 | [56]:6.0 | [44]:1.0 | 
---------------------------------------
return EAMC[2]
å¯¹æ¯”EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 39
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[17]:1.0 | [22]:1.0 | [32]:1.0 | [33]:1.0 | [48]:1.0 | [24]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[14]:2.0 | [19]:1.0 | [38]:5.0 | [42]:3.0 | [61]:1.0 | [57]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[13]:1.0 | [37]:1.0 | [47]:1.0 | [58]:1.0 | [63]:1.0 | [39]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[9]:1.0 | [20]:1.0 | [21]:2.0 | [41]:2.0 | [50]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[0]:1.0 | [3]:1.0 | [7]:1.0 | [35]:1.0 | [36]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[2]:1.0 | [19]:4.0 | [20]:1.0 | [24]:2.0 | [25]:1.0 | [53]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 2, 19, 20, 24, 25, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 4.200(2716)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert 13: 2.600(2635)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 19: 2.000(2653)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 12: 2.000(2632)[0m | [32mExpert 22: 2.000(2665)[0m | [32mExpert 50: 1.800(2758)[0m | 
[32mExpert 17: 1.800(2647)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 44: 1.800(2737)[0m | 
[32mExpert  7: 1.800(2803)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | [32mExpert  4: 1.200(2722)[0m | [32mExpert 26: 1.200(2677)[0m | 
[32mExpert 32: 1.200(2698)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert 25: 1.000(2674)[0m | [32mExpert  8: 0.800(2806)[0m | 
[32mExpert 53: 0.800(2767)[0m | [32mExpert 60: 0.800(2791)[0m | [32mExpert 34: 0.600(2704)[0m | [32mExpert 36: 0.600(2710)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2668, 2620, 2722, 2677, 2698, 2680, 2674, 2806, 2767, 2791, 2704, 2710]
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4,  8, 23, 25, 26, 27, 32, 34, 36, 53, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[4]:1.0 | [10]:1.0 | [44]:2.0 | [49]:1.0 | [54]:1.0 | [56]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[17]:2.0 | [26]:1.0 | [29]:1.0 | [34]:1.0 | [49]:4.0 | [22]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[9]:1.0 | [40]:1.0 | [42]:1.0 | [43]:1.0 | [54]:1.0 | [21]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 10 MLP ==
[0m
[4]:1.0 | [8]:1.0 | [33]:1.0 | [39]:1.0 | [56]:1.0 | [52]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:1.0 | [16]:2.0 | [21]:1.0 | [39]:1.0 | [53]:3.0 | [50]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[1]:1.0 | [30]:2.0 | [41]:6.0 | [45]:3.0 | [57]:3.0 | [55]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 1, 30, 41, 45, 57, 55]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 5.000(2882)[0m | [32mExpert  6: 4.400(3026)[0m | [32mExpert 49: 4.400(2990)[0m | [32mExpert  4: 4.200(2960)[0m | 
[32mExpert 38: 4.000(2954)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert  5: 3.000(2993)[0m | [32mExpert 15: 2.800(2879)[0m | 
[32mExpert 50: 2.600(2996)[0m | [32mExpert 55: 2.600(3011)[0m | [32mExpert 36: 2.200(2948)[0m | [32mExpert 23: 1.800(2906)[0m | 
[32mExpert  8: 1.600(3044)[0m | [32mExpert 14: 1.600(2876)[0m | [32mExpert 52: 1.600(3002)[0m | [32mExpert 48: 1.400(2987)[0m | 
[32mExpert 19: 1.200(2891)[0m | [32mExpert 11: 1.200(2867)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 33: 1.200(2939)[0m | 
[32mExpert 10: 1.000(2864)[0m | [32mExpert 58: 1.000(3020)[0m | [32mExpert 41: 0.800(2966)[0m | [32mExpert  1: 0.600(2861)[0m | 
[32mExpert 25: 0.600(2912)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 31: 0.600(2933)[0m | [32mExpert 32: 0.600(2936)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 44: 0.600(2975)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2864, 3020, 2966, 2861, 2912, 2918, 2924, 2930, 2933, 2936, 2942, 2975]
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 10, 25, 27, 29, 30, 31, 32, 34, 41, 44, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:2.0 | [38]:1.0 | [41]:4.0 | [57]:2.0 | [63]:1.0 | [30]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[5]:2.0 | [20]:1.0 | [24]:2.0 | [35]:1.0 | [59]:1.0 | [63]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[4]:3.0 | [14]:2.0 | [21]:1.0 | [23]:1.0 | [38]:5.0 | [44]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[30]:2.0 | [35]:1.0 | [47]:1.0 | [48]:3.0 | [49]:1.0 | [59]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[11]:2.0 | [31]:1.0 | [51]:1.0 | [54]:1.0 | [61]:1.0 | [15]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[8]:4.0 | [33]:1.0 | [47]:1.0 | [55]:1.0 | [63]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 8, 33, 47, 55, 63,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 5.000(4205)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 17: 2.600(4103)[0m | [32mExpert 54: 2.600(4226)[0m | 
[32mExpert 21: 2.400(4118)[0m | [32mExpert 25: 2.400(4130)[0m | EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4088
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1315,c0000002b] (16MB) STATE(0) TENSOR[4087,4088,4086,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[32mExpert 61: 2.400(4250)[0m | [32mExpert 27: 2.200(4136)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert 15: 2.200(4097)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert  9: 1.800(4265)[0m | [32mExpert 44: 1.800(4193)[0m | [32mExpert 42: 1.800(4187)[0m | [32mExpert 53: 1.800(4223)[0m | 
[32mExpert 13: 1.600(4091)[0m | [32mExpert 10: 1.600(4082)[0m | [32mExpert  6: 1.400(4244)[0m | [32mExpert 37: 1.400(4169)[0m | 
[32mExpert 62: 1.400(4253)[0m | [32mExpert  8: 1.400(4262)[0m | [32mExpert 12: 1.400(4088)[0m | [32mExpert 26: 1.400(4133)[0m | 
[32mExpert 30: 1.200(4148)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert 18: 1.200(4106)[0m | [32mExpert 16: 1.000(4100)[0m | 
[32mExpert 43: 1.000(4190)[0m | [32mExpert 55: 1.000(4229)[0m | [32mExpert 50: 1.000(4214)[0m | [32mExpert 56: 1.000(4232)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4253, 4262, 4088, 4133, 4148, 4217, 4106, 4100, 4190, 4229, 4214, 4232]
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4088[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  8, 12, 16, 18, 26, 30, 43, 50, 51, 55, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:1.0 | [12]:2.0 | [22]:1.0 | [41]:5.0 | [59]:1.0 | [39]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[10]:2.0 | [14]:1.0 | [27]:1.0 | [32]:2.0 | [53]:3.0 | [15]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[12]:1.0 | [44]:3.0 | [50]:1.0 | [55]:2.0 | [63]:1.0 | [61]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[6]:1.0 | [28]:1.0 | [33]:2.0 | [34]:3.0 | [62]:2.0 | [56]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[16]:2.0 | [25]:2.0 | [46]:1.0 | [50]:2.0 | [51]:2.0 | [21]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[12]:1.0 | [16]:3.0 | [24]:4.0 | [25]:1.0 | [60]:3.0 | [34]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[12, 16, 24, 25, 60, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[18]:1.0 | [23]:3.0 | [44]:2.0 | [54]:3.0 | [59]:1.0 | [10]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[9]:2.0 | [10]:1.0 | [26]:4.0 | [31]:1.0 | [48]:2.0 | [51]:2.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 40
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:1.0 | [8]:2.0 | [33]:2.0 | [39]:1.0 | [61]:1.0 | [18]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[20]:1.0 | [27]:2.0 | [35]:4.0 | [60]:2.0 | [63]:6.0 | [6]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[3]:1.0 | [21]:3.0 | [24]:1.0 | [29]:1.0 | [36]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[1]:1.0 | [14]:2.0 | [28]:1.0 | [48]:2.0 | [62]:1.0 | [15]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[2]:1.0 | [7]:2.0 | [34]:1.0 | [44]:1.0 | [61]:1.0 | [13]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[17]:1.0 | [27]:1.0 | [29]:1.0 | [32]:2.0 | [48]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[17, 27, 29, 32, 48, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 4.200(2716)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert 13: 2.600(2635)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 19: 2.000(2653)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 12: 2.000(2632)[0m | [32mExpert 22: 2.000(2665)[0m | [32mExpert 50: 1.800(2758)[0m | 
[32mExpert 17: 1.800(2647)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 44: 1.800(2737)[0m | 
[32mExpert  7: 1.800(2803)[0m | [32mExpert 63: 1.800(2800)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | [32mExpert  9: 1.200(2809)[0m | 
[32mExpert 21: 1.200(2662)[0m | [32mExpert 40: 1.200(2725)[0m | [32mExpert  4: 1.200(2722)[0m | [32mExpert 26: 1.200(2677)[0m | 
[32mExpert 32: 1.200(2698)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert 54: 1.000(2770)[0m | [32mExpert 25: 1.000(2674)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2731, 2668, 2620, 2809, 2662, 2725, 2722, 2677, 2698, 2680, 2770, 2674]
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4,  9, 21, 23, 25, 26, 27, 32, 40, 42, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:1.0 | [27]:1.0 | [28]:2.0 | [39]:1.0 | [47]:1.0 | [31]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[4]:1.0 | [11]:2.0 | [13]:1.0 | [39]:2.0 | [44]:1.0 | [30]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:1.0 | [10]:1.0 | [44]:2.0 | [55]:1.0 | [63]:1.0 | [34]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 10 MLP ==
[0m
[9]:2.0 | [16]:1.0 | [33]:2.0 | [45]:1.0 | [49]:1.0 | [20]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:2.0 | [42]:1.0 | [52]:1.0 | [53]:4.0 | [59]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[18]:1.0 | [22]:1.0 | [31]:1.0 | [33]:1.0 | [45]:4.0 | [32]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[18, 22, 31, 33, 45, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 38: 4.800(2954)[0m | [32mExpert  6: 4.400(3026)[0m | 
[32mExpert 49: 4.400(2990)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert  5: 3.000(2993)[0m | [32mExpert 15: 2.800(2879)[0m | 
[32mExpert 23: 2.600(2906)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 55: 2.600(3011)[0m | [32mExpert 14: 2.400(2876)[0m | 
[32mExpert 36: 2.200(2948)[0m | [32mExpert  8: 1.600(3044)[0m | [32mExpert 52: 1.600(3002)[0m | [32mExpert 44: 1.400(2975)[0m | 
[32mExpert 48: 1.400(2987)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 11: 1.200(2867)[0m | [32mExpert 24: 1.200(2909)[0m | 
[32mExpert 33: 1.200(2939)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 21: 1.000(2900)[0m | [32mExpert 58: 1.000(3020)[0m | 
[32mExpert 41: 0.800(2966)[0m | [32mExpert  1: 0.600(2861)[0m | [32mExpert 25: 0.600(2912)[0m | [32mExpert 27: 0.600(2918)[0m | 
[32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 31: 0.600(2933)[0m | [32mExpert 32: 0.600(2936)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2864, 2900, 3020, 2966, 2861, 2912, 2918, 2924, 2930, 2933, 2936]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 10, 21, 25, 27, 29, 30, 31, 32, 33, 41, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[26]:1.0 | [35]:1.0 | [36]:2.0 | [61]:1.0 | [63]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[20]:2.0 | [22]:1.0 | [37]:1.0 | [55]:1.0 | [59]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[11]:1.0 | [25]:1.0 | [26]:1.0 | [43]:1.0 | [48]:2.0 | [36]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:1.0 | [30]:3.0 | [40]:1.0 | [60]:1.0 | [63]:2.0 | [18]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[3]:2.0 | [10]:1.0 | [45]:1.0 | [50]:1.0 | [58]:1.0 | [24]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:2.0 | [8]:5.0 | [14]:1.0 | [49]:2.0 | [50]:1.0 | [10]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2,  8, 14, 49, 50, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 5.000(4205)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert 44: 2.600(4193)[0m | 
[32mExpert 17: 2.600(4103)[0m | [32mExpert 54: 2.600(4226)[0m | EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4190
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1346,2b0000002b] (16MB) STATE(0) TENSOR[4189,4190,4188,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
[32mExpert 21: 2.400(4118)[0m | [32mExpert 25: 2.400(4130)[0m | 
[32mExpert 27: 2.200(4136)[0m | [32mExpert 12: 2.200(4088)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 15: 2.200(4097)[0m | 
[32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | [32mExpert  9: 1.800(4265)[0m | [32mExpert 55: 1.800(4229)[0m | 
[32mExpert 42: 1.800(4187)[0m | [32mExpert 50: 1.800(4214)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 13: 1.600(4091)[0m | 
[32mExpert 10: 1.600(4082)[0m | [32mExpert  6: 1.400(4244)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 62: 1.400(4253)[0m | 
[32mExpert  8: 1.400(4262)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 30: 1.200(4148)[0m | [32mExpert 51: 1.200(4217)[0m | 
[32mExpert 63: 1.200(4256)[0m | [32mExpert 18: 1.200(4106)[0m | [32mExpert 16: 1.000(4100)[0m | [32mExpert 43: 1.000(4190)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4082, 4244, 4169, 4253, 4262, 4133, 4148, 4217, 4256, 4106, 4100, 4190]
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4190[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  8, 10, 16, 18, 26, 30, 37, 43, 51, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:1.0 | [12]:3.0 | [35]:1.0 | [38]:1.0 | [39]:2.0 | [2]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[4]:1.0 | [5]:1.0 | [18]:1.0 | [41]:1.0 | [62]:1.0 | [10]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[10]:1.0 | [25]:2.0 | [41]:1.0 | [48]:5.0 | [56]:1.0 | [9]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:2.0 | [42]:1.0 | [43]:1.0 | [49]:1.0 | [61]:1.0 | [55]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[0]:2.0 | [13]:2.0 | [45]:3.0 | [46]:2.0 | [54]:2.0 | [5]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[20]:1.0 | [24]:5.0 | [36]:1.0 | [45]:1.0 | [52]:3.0 | [34]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[20, 24, 36, 45, 52, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:1.0 | [17]:1.0 | [31]:1.0 | [54]:4.0 | [55]:1.0 | [38]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[10]:2.0 | [17]:1.0 | [25]:1.0 | [38]:1.0 | [43]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 41
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2918
[1m[33mEnqueueTask: [0m[32mTask: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2924
[1m[33mEnqueueTask: [0m[32mTask: node: ID[942,1d0000001f] (16MB) STATE(0) TENSOR[2923,2924,2922,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[940,1b0000001f] (16MB) STATE(0) TENSOR[2917,2918,2916,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[13]:3.0 | [26]:3.0 | [52]:3.0 | [55]:1.0 | [60]:2.0 | [27]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[0]:2.0 | [15]:1.0 | [19]:2.0 | [46]:1.0 | [47]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[1]:1.0 | [9]:2.0 | [18]:1.0 | [46]:4.0 | [51]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[16]:1.0 | [29]:3.0 | [42]:1.0 | [51]:1.0 | [59]:4.0 | [57]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[10]:2.0 | [17]:1.0 | [41]:4.0 | [56]:1.0 | [63]:1.0 | [33]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[6]:3.0 | [33]:1.0 | [34]:1.0 | [39]:1.0 | [55]:1.0 | [23]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 6, 33, 34, 39, 55, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 4.200(2716)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert  7: 2.600(2803)[0m | [32mExpert 13: 2.600(2635)[0m | [32mExpert 44: 2.600(2737)[0m | [32mExpert 63: 2.600(2800)[0m | 
[32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 12: 2.000(2632)[0m | [32mExpert 22: 2.000(2665)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 17: 1.800(2647)[0m | 
[32mExpert 31: 1.800(2695)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | 
[32mExpert  9: 1.200(2809)[0m | [32mExpert 21: 1.200(2662)[0m | [32mExpert 40: 1.200(2725)[0m | [32mExpert 55: 1.200(2773)[0m | 
[32mExpert  4: 1.200(2722)[0m | [32mExpert 26: 1.200(2677)[0m | [32mExpert 32: 1.200(2698)[0m | [32mExpert 27: 1.000(2680)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2731, 2668, 2620, 2809, 2662, 2725, 2773, 2722, 2677, 2698, 2680]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  4,  9, 21, 23, 26, 27, 32, 34, 40, 42, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[32]:1.0 | [40]:1.0 | [43]:2.0 | [55]:2.0 | [62]:2.0 | [34]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[12]:1.0 | [17]:3.0 | [22]:2.0 | [26]:2.0 | [63]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[2]:1.0 | [8]:1.0 | [33]:2.0 | [47]:1.0 | [55]:2.0 | [10]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[12]:1.0 | [25]:1.0 | [33]:3.0 | [39]:2.0 | [51]:3.0 | [3]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[0]:1.0 | [4]:1.0 | [5]:1.0 | [7]:1.0 | [53]:5.0 | [60]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [41]:7.0 | [45]:5.0 | [57]:4.0 | [13]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 2, 10, 41, 45, 57, 13]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 38: 4.800(2954)[0m | [32mExpert  6: 4.400(3026)[0m | 
[32mExpert 49: 4.400(2990)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 36: 3.000(2948)[0m | [32mExpert  5: 3.000(2993)[0m | 
[32mExpert 15: 2.800(2879)[0m | [32mExpert 23: 2.600(2906)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 55: 2.600(3011)[0m | 
[32mExpert 14: 2.400(2876)[0m | [32mExpert 48: 2.200(2987)[0m | [32mExpert 11: 2.000(2867)[0m | [32mExpert  8: 1.600(3044)[0m | 
[32mExpert 52: 1.600(3002)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 44: 1.400(2975)[0m | [32mExpert 19: 1.200(2891)[0m | 
[32mExpert 26: 1.200(2915)[0m | [32mExpert 43: 1.200(2972)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 33: 1.200(2939)[0m | 
[32mExpert 10: 1.000(2864)[0m | [32mExpert 21: 1.000(2900)[0m | [32mExpert 58: 1.000(3020)[0m | [32mExpert 41: 0.800(2966)[0m | 
[32mExpert  1: 0.600(2861)[0m | [32mExpert 27: 0.600(2918)[0m | [32mExpert 29: 0.600(2924)[0m | [32mExpert 30: 0.600(2930)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2915, 2972, 2909, 2939, 2864, 2900, 3020, 2966, 2861, 2918, 2924, 2930]
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2918[0m â†’ GPU 0
Prefetching [1;36mTensor 2924[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 10, 21, 24, 26, 27, 29, 30, 33, 41, 43, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[9]:1.0 | [18]:2.0 | [35]:2.0 | [43]:1.0 | [48]:2.0 | [47]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[0]:1.0 | [27]:2.0 | [36]:1.0 | [57]:1.0 | [63]:2.0 | [3]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[6]:5.0 | [23]:2.0 | [30]:1.0 | [33]:1.0 | [61]:1.0 | [34]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[30]:4.0 | [32]:1.0 | [38]:2.0 | [40]:2.0 | [46]:1.0 | [5]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[1]:1.0 | [2]:1.0 | [15]:5.0 | [31]:2.0 | [57]:3.0 | [23]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[9]:1.0 | [21]:1.0 | [50]:2.0 | [61]:2.0 | [63]:2.0 | [23]:1.0 | EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6

---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 9, 21, 50, 61, 63, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 5.800(4205)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 25: 3.200(4130)[0m | [32mExpert 61: 3.200(4250)[0m | 
[32mExpert  9: 2.600(4265)[0m | [32mExpert 44: 2.600(4193)[0m | [32mExpert 17: 2.600(4103)[0m | [32mExpert 54: 2.600(4226)[0m | 
[32mExpert 21: 2.400(4118)[0m | [32mExpert 10: 2.400(4082)[0m | [32mExpert 27: 2.200(4136)[0m | [32mExpert 12: 2.200(4088)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert 15: 2.200(4097)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert 55: 1.800(4229)[0m | [32mExpert 42: 1.800(4187)[0m | [32mExpert 50: 1.800(4214)[0m | [32mExpert 53: 1.800(4223)[0m | 
[32mExpert 56: 1.800(4232)[0m | [32mExpert 13: 1.600(4091)[0m | [32mExpert  6: 1.400(4244)[0m | [32mExpert 37: 1.400(4169)[0m | 
[32mExpert 62: 1.400(4253)[0m | [32mExpert  8: 1.400(4262)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 30: 1.200(4148)[0m | 
[32mExpert 51: 1.200(4217)[0m | [32mExpert 63: 1.200(4256)[0m | [32mExpert 18: 1.200(4106)[0m | [32mExpert 16: 1.000(4100)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4232, 4091, 4244, 4169, 4253, 4262, 4133, 4148, 4217, 4256, 4106, 4100]
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  8, 13, 16, 18, 26, 30, 37, 51, 56, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:1.0 | [22]:2.0 | [32]:1.0 | [55]:1.0 | [61]:2.0 | [43]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[7]:1.0 | [10]:4.0 | [30]:2.0 | [32]:3.0 | [33]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[12]:2.0 | [13]:3.0 | [42]:2.0 | [44]:4.0 | [59]:1.0 | [8]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:2.0 | [6]:2.0 | [44]:2.0 | [50]:1.0 | [62]:3.0 | [33]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[12]:3.0 | [16]:3.0 | [25]:3.0 | [26]:2.0 | [50]:3.0 | [60]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[16]:4.0 | [25]:2.0 | [26]:1.0 | [50]:3.0 | [61]:5.0 | [6]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[16, 25, 26, 50, 61,  6]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[23]:4.0 | [41]:1.0 | [44]:3.0 | [45]:4.0 | [54]:5.0 | [52]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[9]:3.0 | [26]:5.0 | [27]:2.0 | [32]:2.0 | [51]:3.0 | [63]:2.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 42
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2915
[1m[33mEnqueueTask: [0m[32mTask: node: ID[939,1a0000001f] (16MB) STATE(0) TENSOR[2914,2915,2913,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:3.0 | [20]:2.0 | [26]:4.0 | [31]:3.0 | [33]:3.0 | [46]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[1]:1.0 | [6]:2.0 | [35]:5.0 | [44]:1.0 | [63]:7.0 | [59]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[3]:2.0 | [17]:1.0 | [21]:4.0 | [27]:1.0 | [36]:2.0 | [29]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[1]:2.0 | [14]:3.0 | [28]:2.0 | [48]:3.0 | [62]:2.0 | [35]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[2]:2.0 | [13]:2.0 | [34]:2.0 | [44]:2.0 | [55]:1.0 | [42]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[17]:2.0 | [29]:2.0 | [32]:3.0 | [41]:2.0 | [59]:1.0 | [63]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[17, 29, 32, 41, 59, 63]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 4.200(2716)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert  7: 2.600(2803)[0m | [32mExpert 13: 2.600(2635)[0m | [32mExpert 33: 2.600(2701)[0m | [32mExpert 44: 2.600(2737)[0m | 
[32mExpert 63: 2.600(2800)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 19: 2.000(2653)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 55: 2.000(2773)[0m | [32mExpert 12: 2.000(2632)[0m | [32mExpert 22: 2.000(2665)[0m | 
[32mExpert 50: 1.800(2758)[0m | [32mExpert 17: 1.800(2647)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 10: 1.600(2626)[0m | 
[32mExpert  8: 1.600(2806)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | [32mExpert 34: 1.400(2704)[0m | 
[32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | [32mExpert  2: 1.200(2656)[0m | 
[32mExpert  9: 1.200(2809)[0m | [32mExpert 21: 1.200(2662)[0m | [32mExpert 40: 1.200(2725)[0m | [32mExpert  4: 1.200(2722)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2806, 2644, 2794, 2704, 2731, 2668, 2620, 2656, 2809, 2662, 2725, 2722]
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  4,  8,  9, 16, 21, 23, 34, 40, 42, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:2.0 | [27]:2.0 | [28]:3.0 | [39]:2.0 | [47]:2.0 | [31]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[4]:2.0 | [11]:3.0 | [13]:2.0 | [30]:3.0 | [48]:1.0 | [44]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:2.0 | [10]:3.0 | [12]:2.0 | [55]:3.0 | [63]:2.0 | [60]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 10 MLP ==
[0m
[9]:3.0 | [16]:2.0 | [33]:4.0 | [45]:2.0 | [49]:2.0 | [20]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:3.0 | [27]:2.0 | [42]:2.0 | [49]:1.0 | [52]:2.0 | [53]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[18]:2.0 | [22]:2.0 | [23]:1.0 | [31]:2.0 | [45]:6.0 | [62]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[18, 22, 23, 31, 45, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 5.200(3026)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 38: 4.800(2954)[0m | 
[32mExpert 49: 4.400(2990)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 23: 3.400(2906)[0m | [32mExpert 36: 3.000(2948)[0m | 
[32mExpert  5: 3.000(2993)[0m | [32mExpert 15: 2.800(2879)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 55: 2.600(3011)[0m | 
[32mExpert 14: 2.400(2876)[0m | [32mExpert 48: 2.200(2987)[0m | [32mExpert 11: 2.000(2867)[0m | [32mExpert 33: 2.000(2939)[0m | 
[32mExpert  8: 1.600(3044)[0m | [32mExpert 52: 1.600(3002)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 30: 1.400(2930)[0m | 
[32mExpert 34: 1.400(2942)[0m | [32mExpert 44: 1.400(2975)[0m | [32mExpert 61: 1.400(3032)[0m | [32mExpert 19: 1.200(2891)[0m | 
[32mExpert 26: 1.200(2915)[0m | [32mExpert 43: 1.200(2972)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 10: 1.000(2864)[0m | 
[32mExpert 21: 1.000(2900)[0m | [32mExpert 58: 1.000(3020)[0m | [32mExpert 41: 0.800(2966)[0m | [32mExpert  1: 0.600(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2942, 2975, 3032, 2891, 2915, 2972, 2909, 2864, 2900, 3020, 2966, 2861]
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2915[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1, 10, 19, 21, 24, 26, 34, 41, 43, 44, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[15]:1.0 | [26]:2.0 | [35]:3.0 | [61]:2.0 | [63]:3.0 | [45]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[19]:1.0 | [46]:1.0 | [47]:1.0 | [55]:2.0 | [59]:3.0 | [37]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[11]:2.0 | [26]:2.0 | [36]:3.0 | [37]:1.0 | [48]:3.0 | [25]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[32]:2.0 | [40]:3.0 | [53]:1.0 | [57]:1.0 | [60]:2.0 | [63]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[3]:3.0 | [10]:2.0 | [23]:2.0 | [45]:2.0 | [58]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:3.0 | [8]:6.0 | [14]:2.0 | [49]:3.0 | [58]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2,  8, 14, 49, 58, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 5.800(4205)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 44: 3.400(4193)[0m | [32mExpert 25: 3.200(4130)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert 12: 3.000(4088)[0m | EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
[32mExpert  9: 2.600(4265)[0m | [32mExpert 17: 2.600(4103)[0m | 
[32mExpert 42: 2.600(4187)[0m | [32mExpert 54: 2.600(4226)[0m | [32mExpert 13: 2.400(4091)[0m | [32mExpert 21: 2.400(4118)[0m | 
[32mExpert 10: 2.400(4082)[0m | [32mExpert 27: 2.200(4136)[0m | [32mExpert  8: 2.200(4262)[0m | [32mExpert 19: 2.200(4109)[0m | 
[32mExpert 15: 2.200(4097)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | [32mExpert 55: 1.800(4229)[0m | 
[32mExpert 50: 1.800(4214)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert  6: 1.400(4244)[0m | 
[32mExpert 37: 1.400(4169)[0m | [32mExpert 62: 1.400(4253)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 30: 1.200(4148)[0m | 
[32mExpert 51: 1.200(4217)[0m | [32mExpert 63: 1.200(4256)[0m | [32mExpert 18: 1.200(4106)[0m | [32mExpert 16: 1.000(4100)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4214, 4223, 4232, 4244, 4169, 4253, 4133, 4148, 4217, 4256, 4106, 4100]
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6, 16, 18, 26, 30, 37, 50, 51, 53, 56, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:2.0 | [12]:4.0 | [22]:3.0 | [38]:2.0 | [42]:1.0 | [39]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[3]:1.0 | [18]:2.0 | [29]:1.0 | [41]:2.0 | [62]:2.0 | [4]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[17]:3.0 | [25]:3.0 | [41]:2.0 | [48]:6.0 | [52]:1.0 | [53]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:3.0 | [33]:4.0 | [42]:2.0 | [43]:2.0 | [61]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[0]:3.0 | [1]:1.0 | [13]:3.0 | [46]:3.0 | [54]:3.0 | [21]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[4]:1.0 | [24]:6.0 | [34]:3.0 | [45]:2.0 | [52]:4.0 | [62]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 4, 24, 34, 45, 52, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:2.0 | [38]:4.0 | [54]:6.0 | [55]:2.0 | [63]:3.0 | [34]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[27]:3.0 | [28]:1.0 | [38]:2.0 | [43]:2.0 | [63]:3.0 | [11]:2.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 43
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[13]:4.0 | [26]:5.0 | [27]:3.0 | [52]:4.0 | [55]:2.0 | [60]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[0]:3.0 | [1]:2.0 | [15]:2.0 | [19]:3.0 | [47]:2.0 | [10]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[1]:2.0 | [9]:3.0 | [18]:2.0 | [46]:5.0 | [51]:2.0 | [16]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[16]:2.0 | [29]:4.0 | [42]:2.0 | [51]:2.0 | [57]:2.0 | [33]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[17]:2.0 | [33]:2.0 | [56]:2.0 | [57]:1.0 | [63]:2.0 | [54]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[23]:2.0 | [27]:2.0 | [34]:2.0 | [39]:2.0 | [55]:2.0 | [6]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[23, 27, 34, 39, 55,  6]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 4.200(2716)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert  7: 3.400(2803)[0m | [32mExpert 63: 3.400(2800)[0m | [32mExpert 55: 2.800(2773)[0m | [32mExpert 12: 2.800(2632)[0m | 
[32mExpert 13: 2.600(2635)[0m | [32mExpert 33: 2.600(2701)[0m | [32mExpert 44: 2.600(2737)[0m | [32mExpert 10: 2.400(2626)[0m | 
[32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 22: 2.000(2665)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 17: 1.800(2647)[0m | [32mExpert 31: 1.800(2695)[0m | 
[32mExpert  8: 1.600(2806)[0m | [32mExpert 60: 1.600(2791)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | 
[32mExpert  2: 1.200(2656)[0m | [32mExpert  9: 1.200(2809)[0m | [32mExpert 21: 1.200(2662)[0m | [32mExpert 40: 1.200(2725)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2806, 2791, 2644, 2794, 2704, 2731, 2668, 2620, 2656, 2809, 2662, 2725]
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  8,  9, 16, 21, 23, 34, 40, 42, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[20]:1.0 | [32]:2.0 | [40]:2.0 | [43]:3.0 | [55]:3.0 | [18]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[12]:2.0 | [17]:4.0 | [22]:3.0 | [26]:3.0 | [40]:2.0 | [59]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[8]:2.0 | [17]:2.0 | [30]:1.0 | [33]:3.0 | [55]:4.0 | [3]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[12]:2.0 | [33]:5.0 | [39]:3.0 | [47]:2.0 | [51]:4.0 | [23]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[0]:2.0 | [4]:2.0 | [5]:2.0 | [53]:7.0 | [60]:2.0 | [7]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[23]:2.0 | [41]:8.0 | [45]:7.0 | [47]:1.0 | [57]:5.0 | [19]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[23, 41, 45, 47, 57, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 5.200(3026)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 38: 4.800(2954)[0m | 
[32mExpert 49: 4.400(2990)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 36: 3.800(2948)[0m | [32mExpert 23: 3.400(2906)[0m | 
[32mExpert 48: 3.000(2987)[0m | [32mExpert  5: 3.000(2993)[0m | [32mExpert 11: 2.800(2867)[0m | [32mExpert 15: 2.800(2879)[0m | 
[32mExpert 50: 2.600(2996)[0m | [32mExpert 55: 2.600(3011)[0m | [32mExpert 14: 2.400(2876)[0m | [32mExpert 25: 2.200(2912)[0m | 
[32mExpert 26: 2.000(2915)[0m | [32mExpert 33: 2.000(2939)[0m | [32mExpert  8: 1.600(3044)[0m | [32mExpert 52: 1.600(3002)[0m | 
[32mExpert 30: 1.400(2930)[0m | [32mExpert 34: 1.400(2942)[0m | [32mExpert 44: 1.400(2975)[0m | [32mExpert 61: 1.400(3032)[0m | 
[32mExpert 19: 1.200(2891)[0m | [32mExpert 43: 1.200(2972)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 10: 1.000(2864)[0m | 
[32mExpert 21: 1.000(2900)[0m | [32mExpert 37: 1.000(2951)[0m | [32mExpert 58: 1.000(3020)[0m | [32mExpert 41: 0.800(2966)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2930, 2942, 2975, 3032, 2891, 2972, 2909, 2864, 2900, 2951, 3020, 2966]
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 10, 19, 21, 24, 30, 34, 37, 41, 43, 44, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[14]:1.0 | [18]:3.0 | [34]:2.0 | [45]:2.0 | [48]:3.0 | [20]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[0]:2.0 | [36]:2.0 | [47]:2.0 | [57]:2.0 | [63]:3.0 | [59]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[7]:1.0 | [31]:1.0 | [33]:2.0 | [53]:1.0 | [61]:2.0 | [23]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[32]:3.0 | [38]:3.0 | [46]:2.0 | [53]:2.0 | [59]:2.0 | [30]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[2]:2.0 | [15]:6.0 | [20]:1.0 | [31]:3.0 | [57]:4.0 | [42]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[9]:2.0 | [32]:1.0 | [50]:3.0 | [61]:3.0 | [63]:3.0 | [28]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 9, 32, 50, 61, 63, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4256
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1366,3f0000002b] (16MB) STATE(0) TENSOR[4255,4256,4254,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 25: 4.000(4130)[0m | [32mExpert 17: 3.400(4103)[0m | 
[32mExpert 44: 3.400(4193)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert 12: 3.000(4088)[0m | [32mExpert  9: 2.600(4265)[0m | 
[32mExpert 42: 2.600(4187)[0m | [32mExpert 53: 2.600(4223)[0m | [32mExpert 54: 2.600(4226)[0m | [32mExpert 13: 2.400(4091)[0m | 
[32mExpert 21: 2.400(4118)[0m | [32mExpert 10: 2.400(4082)[0m | [32mExpert 27: 2.200(4136)[0m | [32mExpert  8: 2.200(4262)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert 15: 2.200(4097)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert 41: 1.800(4184)[0m | [32mExpert 55: 1.800(4229)[0m | [32mExpert 50: 1.800(4214)[0m | [32mExpert 56: 1.800(4232)[0m | 
[32mExpert  6: 1.400(4244)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 52: 1.400(4220)[0m | [32mExpert 62: 1.400(4253)[0m | 
[32mExpert 26: 1.400(4133)[0m | [32mExpert 30: 1.200(4148)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert 63: 1.200(4256)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4184, 4229, 4214, 4232, 4244, 4169, 4220, 4253, 4133, 4148, 4217, 4256]
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4256[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6, 26, 30, 37, 41, 50, 51, 52, 55, 56, 62, 63 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:2.0 | [17]:1.0 | [22]:4.0 | [43]:2.0 | [61]:3.0 | [5]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[3]:2.0 | [10]:5.0 | [30]:3.0 | [32]:4.0 | [33]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[12]:3.0 | [17]:4.0 | [35]:1.0 | [42]:3.0 | [44]:5.0 | [19]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 22 MLP ==
[0m
[0]:3.0 | [6]:3.0 | [33]:5.0 | [50]:2.0 | [62]:4.0 | [44]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[12]:4.0 | [16]:4.0 | [21]:3.0 | [25]:4.0 | [50]:4.0 | [60]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[6]:3.0 | [16]:5.0 | [25]:3.0 | [50]:4.0 | [61]:6.0 | [30]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 6, 16, 25, 50, 61, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:2.0 | [23]:5.0 | [41]:2.0 | [44]:4.0 | [45]:5.0 | [48]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[9]:4.0 | [26]:6.0 | [32]:3.0 | [51]:4.0 | [52]:2.0 | [63]:4.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2692
[1m[33mEnqueueTask: [0m[32mTask: node: ID[553,1e00000013] (16MB) STATE(0) TENSOR[2691,2692,2690,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 44
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[15]:1.0 | [26]:6.0 | [30]:1.0 | [33]:4.0 | [46]:2.0 | [20]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[1]:3.0 | [33]:1.0 | [35]:6.0 | [44]:2.0 | [60]:3.0 | [63]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[3]:3.0 | [11]:2.0 | [14]:1.0 | [17]:2.0 | [49]:1.0 | [31]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[2]:1.0 | [10]:2.0 | [14]:4.0 | [36]:1.0 | [37]:1.0 | [15]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[31]:1.0 | [42]:5.0 | [44]:3.0 | [50]:6.0 | [52]:2.0 | [47]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[13]:2.0 | [15]:1.0 | [20]:2.0 | [27]:3.0 | [41]:3.0 | [32]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[13, 15, 20, 27, 41, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 4.200(2716)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert 55: 3.600(2773)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert  7: 3.400(2803)[0m | [32mExpert 63: 3.400(2800)[0m | 
[32mExpert 12: 2.800(2632)[0m | [32mExpert 13: 2.600(2635)[0m | [32mExpert 17: 2.600(2647)[0m | [32mExpert 44: 2.600(2737)[0m | 
[32mExpert 10: 2.400(2626)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | 
[32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 22: 2.000(2665)[0m | [32mExpert 50: 1.800(2758)[0m | 
[32mExpert 31: 1.800(2695)[0m | [32mExpert 60: 1.600(2791)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | 
[32mExpert  2: 1.200(2656)[0m | [32mExpert  9: 1.200(2809)[0m | [32mExpert 21: 1.200(2662)[0m | [32mExpert 30: 1.200(2692)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2695, 2791, 2644, 2794, 2704, 2731, 2668, 2620, 2656, 2809, 2662, 2692]
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2692[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  9, 16, 21, 23, 30, 31, 34, 42, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:1.0 | [39]:3.0 | [43]:4.0 | [46]:1.0 | [62]:3.0 | [34]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[13]:3.0 | [30]:4.0 | [39]:3.0 | [48]:2.0 | [52]:1.0 | [4]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[4]:1.0 | [10]:4.0 | [13]:2.0 | [16]:1.0 | [55]:5.0 | [24]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E16 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[18]:1.0 | [20]:3.0 | [25]:2.0 | [42]:2.0 | [61]:1.0 | [33]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:4.0 | [27]:3.0 | [40]:1.0 | [49]:2.0 | [61]:1.0 | [15]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[12]:1.0 | [23]:3.0 | [31]:3.0 | [37]:3.0 | [45]:8.0 | [62]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[12, 23, 31, 37, 45, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 5.200(3026)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 38: 4.800(2954)[0m | 
[32mExpert 49: 4.400(2990)[0m | [32mExpert 23: 4.200(2906)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 36: 3.800(2948)[0m | 
[32mExpert 48: 3.000(2987)[0m | [32mExpert  5: 3.000(2993)[0m | [32mExpert 11: 2.800(2867)[0m | [32mExpert 15: 2.800(2879)[0m | 
[32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 55: 2.600(3011)[0m | [32mExpert 14: 2.400(2876)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert 61: 2.200(3032)[0m | [32mExpert 26: 2.000(2915)[0m | [32mExpert  8: 1.600(3044)[0m | 
[32mExpert 52: 1.600(3002)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert 31: 1.400(2933)[0m | [32mExpert 34: 1.400(2942)[0m | 
[32mExpert 44: 1.400(2975)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 43: 1.200(2972)[0m | 
[32mExpert 24: 1.200(2909)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 21: 1.000(2900)[0m | [32mExpert 37: 1.000(2951)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 2930, 2933, 2942, 2975, 3005, 2891, 2972, 2909, 2864, 2900, 2951]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 10, 19, 21, 24, 30, 31, 34, 37, 43, 44, 52, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[15]:2.0 | [45]:3.0 | [48]:4.0 | [54]:1.0 | [58]:2.0 | [5]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[0]:3.0 | [19]:2.0 | [27]:3.0 | [46]:2.0 | [47]:3.0 | [7]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[11]:3.0 | [26]:3.0 | [40]:1.0 | [47]:1.0 | [52]:2.0 | [61]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[18]:2.0 | [32]:4.0 | [33]:2.0 | [37]:1.0 | [53]:3.0 | [9]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[9]:2.0 | [10]:3.0 | [23]:3.0 | [26]:2.0 | [28]:2.0 | [38]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:4.0 | [42]:1.0 | [50]:4.0 | [58]:2.0 | [63]:4.0 | [56]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2, 42, 50, 58, 63, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 17: 4.200(4103)[0m | [32mExpert 44: 4.200(4193)[0m | 
[32mExpert 25: 4.000(4130)[0m | [32mExpert 12: 3.800(4088)[0m | [32mExpert 42: 3.400(4187)[0m | [32mExpert 61: 3.200(4250)[0m | 
[32mExpert 19: 3.000(4109)[0m | [32mExpert  9: 2.600(4265)[0m | [32mExpert 53: 2.600(4223)[0m | [32mExpert 54: 2.600(4226)[0m | 
[32mExpert 13: 2.400(4091)[0m | [32mExpert 21: 2.400(4118)[0m | [32mExpert 10: 2.400(4082)[0m | [32mExpert 27: 2.200(4136)[0m | 
[32mExpert  8: 2.200(4262)[0m | [32mExpert 15: 2.200(4097)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert 41: 1.800(4184)[0m | [32mExpert 55: 1.800(4229)[0m | [32mExpert 50: 1.800(4214)[0m | [32mExpert 56: 1.800(4232)[0m | 
[32mExpert  6: 1.400(4244)[0m | [32mExpert 35: 1.400(4163)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 52: 1.400(4220)[0m | 
[32mExpert 62: 1.400(4253)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 30: 1.200(4148)[0m | [32mExpert 51: 1.200(4217)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4184, 4229, 4214, 4232, 4244, 4163, 4169, 4220, 4253, 4133, 4148, 4217]
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6, 26, 30, 35, 37, 41, 50, 51, 52, 55, 56, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:2.0 | [16]:1.0 | [22]:5.0 | [42]:2.0 | [58]:1.0 | [40]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[1]:2.0 | [13]:1.0 | [18]:3.0 | [38]:2.0 | [60]:1.0 | [36]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[2]:1.0 | [15]:1.0 | [17]:5.0 | [21]:3.0 | [58]:1.0 | [56]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E56 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[3]:2.0 | [6]:4.0 | [11]:4.0 | [33]:6.0 | [49]:2.0 | [17]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[3]:4.0 | [9]:1.0 | [45]:4.0 | [47]:2.0 | [54]:4.0 | [42]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[8]:1.0 | [10]:3.0 | [32]:1.0 | [33]:2.0 | [44]:2.0 | [0]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 8, 10, 32, 33, 44,  0]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:3.0 | [33]:1.0 | [38]:5.0 | [52]:3.0 | [62]:2.0 | [19]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[11]:3.0 | [17]:2.0 | [45]:1.0 | [57]:5.0 | [59]:2.0 | [38]:3.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 45
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:4.0 | [15]:2.0 | [28]:1.0 | [33]:5.0 | [50]:3.0 | [35]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[10]:3.0 | [11]:2.0 | [21]:1.0 | [29]:2.0 | [38]:6.0 | [1]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[3]:4.0 | [10]:2.0 | [17]:3.0 | [36]:3.0 | [42]:4.0 | [31]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[14]:5.0 | [36]:2.0 | [46]:1.0 | [48]:4.0 | [62]:3.0 | [28]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[2]:3.0 | [7]:3.0 | [13]:3.0 | [34]:3.0 | [55]:2.0 | [61]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[1]:1.0 | [17]:3.0 | [29]:3.0 | [32]:5.0 | [59]:2.0 | [13]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 1, 17, 29, 32, 59, 13]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 55: 4.400(2773)[0m | [32mExpert 38: 4.200(2716)[0m | 
[32mExpert 45: 3.800(2740)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert  7: 3.400(2803)[0m | [32mExpert 13: 3.400(2635)[0m | 
[32mExpert 63: 3.400(2800)[0m | [32mExpert 10: 3.200(2626)[0m | [32mExpert 12: 2.800(2632)[0m | [32mExpert 17: 2.600(2647)[0m | 
[32mExpert 44: 2.600(2737)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert 16: 2.400(2644)[0m | [32mExpert  1: 2.200(2623)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert  4: 2.000(2722)[0m | 
[32mExpert 22: 2.000(2665)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 60: 1.600(2791)[0m | 
[32mExpert 61: 1.600(2794)[0m | [32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | 
[32mExpert  0: 1.200(2620)[0m | [32mExpert  2: 1.200(2656)[0m | [32mExpert  9: 1.200(2809)[0m | [32mExpert 21: 1.200(2662)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2665, 2758, 2695, 2791, 2794, 2704, 2731, 2668, 2620, 2656, 2809, 2662]
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  9, 21, 22, 23, 31, 34, 42, 50, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:2.0 | [11]:3.0 | [27]:3.0 | [28]:4.0 | [39]:4.0 | [47]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[4]:4.0 | [13]:4.0 | [30]:5.0 | [39]:4.0 | [48]:3.0 | [11]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[4]:2.0 | [7]:3.0 | [10]:5.0 | [12]:3.0 | [63]:3.0 | [55]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 10 MLP ==
[0m
[16]:3.0 | [20]:4.0 | [33]:7.0 | [45]:3.0 | [49]:3.0 | [9]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:5.0 | [27]:4.0 | [42]:3.0 | [49]:3.0 | [52]:3.0 | [53]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[18]:3.0 | [22]:3.0 | [23]:4.0 | [31]:4.0 | [52]:1.0 | [45]:9.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[18, 22, 23, 31, 52, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 5.200(3026)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 38: 4.800(2954)[0m | 
[32mExpert 49: 4.400(2990)[0m | [32mExpert 23: 4.200(2906)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 36: 3.800(2948)[0m | 
[32mExpert 11: 3.600(2867)[0m | [32mExpert 48: 3.000(2987)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert  5: 3.000(2993)[0m | 
[32mExpert 26: 2.800(2915)[0m | [32mExpert 15: 2.800(2879)[0m | [32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | 
[32mExpert 55: 2.600(3011)[0m | [32mExpert 14: 2.400(2876)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert 25: 2.200(2912)[0m | 
[32mExpert  8: 1.600(3044)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert 31: 1.400(2933)[0m | [32mExpert 34: 1.400(2942)[0m | 
[32mExpert 44: 1.400(2975)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 43: 1.200(2972)[0m | 
[32mExpert 47: 1.200(2984)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 21: 1.000(2900)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3044, 2930, 2933, 2942, 2975, 3005, 2891, 2972, 2984, 2909, 2864, 2900]
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8, 10, 19, 21, 24, 30, 31, 34, 43, 44, 47, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[15]:3.0 | [30]:5.0 | [35]:4.0 | [61]:3.0 | [63]:4.0 | [26]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[22]:2.0 | [42]:1.0 | [46]:3.0 | [55]:3.0 | [59]:5.0 | [19]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[12]:1.0 | [14]:3.0 | [26]:4.0 | [36]:4.0 | [48]:4.0 | [25]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[25]:1.0 | [30]:6.0 | [32]:5.0 | [50]:3.0 | [57]:2.0 | [40]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[3]:4.0 | [10]:4.0 | [13]:1.0 | [46]:1.0 | [58]:3.0 | [45]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:5.0 | [8]:7.0 | [35]:1.0 | [47]:2.0 | [49]:4.0 | [10]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2,  8, 35, 47, 49, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 17: 5.000(4103)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 44: 4.200(4193)[0m | 
[32mExpert 25: 4.000(4130)[0m | [32mExpert 12: 3.800(4088)[0m | [32mExpert 42: 3.400(4187)[0m | [32mExpert 21: 3.200(4118)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert 19: 3.000(4109)[0m | [32mExpert 15: 3.000(4097)[0m | [32mExpert  9: 2.600(4265)[0m | 
[32mExpert 53: 2.600(4223)[0m | EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4184
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1344,290000002b] (16MB) STATE(0) TENSOR[4183,4184,4182,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[32mExpert 54: 2.600(4226)[0m | [32mExpert 56: 2.600(4232)[0m | [32mExpert 13: 2.400(4091)[0m | 
[32mExpert 10: 2.400(4082)[0m | [32mExpert 27: 2.200(4136)[0m | [32mExpert  8: 2.200(4262)[0m | [32mExpert  0: 2.000(4076)[0m | 
[32mExpert 28: 2.000(4139)[0m | [32mExpert 41: 1.800(4184)[0m | [32mExpert 55: 1.800(4229)[0m | [32mExpert 50: 1.800(4214)[0m | 
[32mExpert  2: 1.400(4112)[0m | [32mExpert  6: 1.400(4244)[0m | [32mExpert 35: 1.400(4163)[0m | [32mExpert 37: 1.400(4169)[0m | 
[32mExpert 52: 1.400(4220)[0m | [32mExpert 62: 1.400(4253)[0m | [32mExpert 26: 1.400(4133)[0m | [32mExpert 30: 1.200(4148)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4139, 4184, 4229, 4214, 4112, 4244, 4163, 4169, 4220, 4253, 4133, 4148]
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4184[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  2,  6, 26, 28, 30, 35, 37, 41, 50, 52, 55, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:2.0 | [12]:5.0 | [20]:1.0 | [42]:3.0 | [57]:1.0 | [41]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[3]:3.0 | [5]:2.0 | [23]:1.0 | [44]:4.0 | [62]:3.0 | [41]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[9]:4.0 | [23]:1.0 | [26]:1.0 | [41]:3.0 | [52]:2.0 | [53]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:4.0 | [22]:1.0 | [51]:1.0 | [56]:2.0 | [61]:3.0 | [12]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[5]:3.0 | [11]:3.0 | [18]:1.0 | [46]:4.0 | [54]:5.0 | [1]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[12]:2.0 | [18]:1.0 | [24]:7.0 | [45]:3.0 | [55]:1.0 | [19]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[12, 18, 24, 45, 55, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:4.0 | [17]:2.0 | [20]:1.0 | [29]:1.0 | [33]:2.0 | [15]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[10]:3.0 | [38]:4.0 | [39]:1.0 | [48]:3.0 | [56]:7.0 | [43]:3.0 | 
---------------------------------------
return EAMC[2]
Transformer/RNN/GNNåœ¨EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 46
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[5]:1.0 | [7]:1.0 | [24]:2.0 | [27]:4.0 | [54]:1.0 | [61]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[5]:1.0 | [10]:4.0 | [15]:3.0 | [19]:4.0 | [47]:3.0 | [48]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[4]:2.0 | [18]:3.0 | [19]:1.0 | [30]:1.0 | [47]:2.0 | [60]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[17]:1.0 | [23]:1.0 | [29]:5.0 | [42]:3.0 | [57]:3.0 | [8]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[33]:3.0 | [48]:2.0 | [56]:3.0 | [58]:1.0 | [60]:1.0 | [36]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[24]:3.0 | [33]:2.0 | [43]:1.0 | [49]:1.0 | [58]:1.0 | [61]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[24, 33, 43, 49, 58, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 55: 5.200(2773)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert  7: 4.200(2803)[0m | 
[32mExpert 38: 4.200(2716)[0m | [32mExpert 63: 4.200(2800)[0m | [32mExpert 10: 4.000(2626)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert 12: 3.600(2632)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert 13: 3.400(2635)[0m | [32mExpert  4: 2.800(2722)[0m | 
[32mExpert 17: 2.600(2647)[0m | [32mExpert 44: 2.600(2737)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert 16: 2.400(2644)[0m | 
[32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert 22: 2.000(2665)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 60: 1.600(2791)[0m | 
[32mExpert 61: 1.600(2794)[0m | [32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | 
[32mExpert  0: 1.200(2620)[0m | [32mExpert  2: 1.200(2656)[0m | [32mExpert  9: 1.200(2809)[0m | [32mExpert 21: 1.200(2662)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2665, 2758, 2695, 2791, 2794, 2704, 2731, 2668, 2620, 2656, 2809, 2662]
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0,  2,  9, 21, 22, 23, 31, 34, 42, 50, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[12]:2.0 | [48]:1.0 | [51]:1.0 | [52]:1.0 | [54]:2.0 | [43]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[17]:5.0 | [22]:4.0 | [26]:4.0 | [40]:3.0 | [60]:1.0 | [34]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[21]:2.0 | [29]:1.0 | [38]:4.0 | [39]:1.0 | [54]:2.0 | [47]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[4]:2.0 | [6]:1.0 | [24]:1.0 | [26]:1.0 | [33]:8.0 | [41]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[32]:1.0 | [45]:1.0 | [50]:2.0 | [51]:2.0 | [53]:9.0 | [16]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[2]:2.0 | [43]:2.0 | [45]:10.0 | [55]:2.0 | [57]:6.0 | [20]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 2, 43, 45, 55, 57, 20]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 5.200(3026)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 38: 4.800(2954)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 49: 4.400(2990)[0m | [32mExpert 23: 4.200(2906)[0m | [32mExpert  0: 4.000(2858)[0m | 
[32mExpert 48: 3.800(2987)[0m | [32mExpert 11: 3.600(2867)[0m | [32mExpert 26: 3.600(2915)[0m | [32mExpert 14: 3.200(2876)[0m | 
[32mExpert 25: 3.000(2912)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert  5: 3.000(2993)[0m | [32mExpert 15: 2.800(2879)[0m | 
[32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 55: 2.600(3011)[0m | [32mExpert 52: 2.400(3002)[0m | 
[32mExpert  8: 1.600(3044)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert 31: 1.400(2933)[0m | [32mExpert 34: 1.400(2942)[0m | 
[32mExpert 44: 1.400(2975)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 43: 1.200(2972)[0m | 
[32mExpert 47: 1.200(2984)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 12: 1.000(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3044, 2930, 2933, 2942, 2975, 3005, 2891, 2972, 2984, 2909, 2864, 2870]
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8, 10, 12, 19, 24, 30, 31, 34, 43, 44, 47, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:4.0 | [7]:1.0 | [14]:2.0 | [28]:1.0 | [36]:3.0 | [9]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[0]:4.0 | [13]:1.0 | [19]:4.0 | [29]:1.0 | [46]:4.0 | [59]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[2]:1.0 | [6]:6.0 | [21]:2.0 | [52]:3.0 | [55]:2.0 | [38]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[30]:7.0 | [31]:1.0 | [35]:2.0 | [48]:4.0 | [63]:4.0 | [60]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[1]:2.0 | [16]:1.0 | [23]:4.0 | [43]:2.0 | [53]:1.0 | [0]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[40]:4.0 | [41]:1.0 | [44]:1.0 | [47]:3.0 | [50]:5.0 | [31]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[40, 41, 44, 47, 50, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 17: 5.000(4103)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 44: 4.200(4193)[0m | 
[32mExpert 25: 4.000(4130)[0m | [32mExpert 12: 3.800(4088)[0m | EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[32mExpert  9: 3.400(4265)[0m | [32mExpert 42: 3.400(4187)[0m | 
[32mExpert 53: 3.400(4223)[0m | [32mExpert 21: 3.200(4118)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert 19: 3.000(4109)[0m | 
[32mExpert 15: 3.000(4097)[0m | [32mExpert 41: 2.600(4184)[0m | [32mExpert 54: 2.600(4226)[0m | [32mExpert 56: 2.600(4232)[0m | 
[32mExpert 13: 2.400(4091)[0m | [32mExpert 10: 2.400(4082)[0m | [32mExpert 27: 2.200(4136)[0m | [32mExpert 52: 2.200(4220)[0m | 
[32mExpert  8: 2.200(4262)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 28: 2.000(4139)[0m | 
[32mExpert 55: 1.800(4229)[0m | [32mExpert 50: 1.800(4214)[0m | [32mExpert  2: 1.400(4112)[0m | [32mExpert  6: 1.400(4244)[0m | 
[32mExpert 23: 1.400(4124)[0m | [32mExpert 35: 1.400(4163)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 62: 1.400(4253)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4262, 4133, 4076, 4139, 4229, 4214, 4112, 4244, 4124, 4163, 4169, 4253]
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  2,  6,  8, 23, 26, 28, 35, 37, 50, 55, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:3.0 | [6]:3.0 | [33]:2.0 | [41]:7.0 | [58]:2.0 | [22]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[7]:2.0 | [28]:1.0 | [33]:3.0 | [36]:3.0 | [59]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[6]:2.0 | [12]:4.0 | [42]:4.0 | [44]:6.0 | [54]:3.0 | [39]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E6 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:5.0 | [41]:2.0 | [44]:4.0 | [62]:5.0 | [63]:1.0 | [6]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[8]:1.0 | [12]:5.0 | [34]:1.0 | [47]:3.0 | [50]:5.0 | [16]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[1]:1.0 | [16]:6.0 | [22]:3.0 | [24]:8.0 | [48]:1.0 | [6]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 1, 16, 22, 24, 48,  6]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[14]:1.0 | [23]:6.0 | [44]:5.0 | [54]:7.0 | [59]:2.0 | [50]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[6]:1.0 | [9]:5.0 | [31]:2.0 | [48]:4.0 | [63]:5.0 | [15]:1.0 | 
---------------------------------------
return EAMC[2]
æ—¶EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 47
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2909
[1m[33mEnqueueTask: [0m[32mTask: node: ID[937,180000001f] (16MB) STATE(0) TENSOR[2908,2909,2907,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[20]:4.0 | [33]:6.0 | [42]:1.0 | [47]:3.0 | [59]:1.0 | [18]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[23]:1.0 | [25]:1.0 | [31]:1.0 | [37]:2.0 | [60]:4.0 | [3]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[8]:1.0 | [14]:2.0 | [16]:3.0 | [23]:2.0 | [32]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[2]:2.0 | [7]:1.0 | [19]:1.0 | [36]:3.0 | [48]:5.0 | [54]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[4]:1.0 | [11]:1.0 | [29]:1.0 | [44]:4.0 | [47]:3.0 | [52]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[1]:2.0 | [20]:3.0 | [22]:2.0 | [26]:1.0 | [57]:1.0 | [41]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 1, 20, 22, 26, 57, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 55: 5.200(2773)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 5.000(2716)[0m | 
[32mExpert  7: 4.200(2803)[0m | [32mExpert 63: 4.200(2800)[0m | [32mExpert 10: 4.000(2626)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert 12: 3.600(2632)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert 13: 3.400(2635)[0m | [32mExpert  4: 2.800(2722)[0m | 
[32mExpert 17: 2.600(2647)[0m | [32mExpert 44: 2.600(2737)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert 16: 2.400(2644)[0m | 
[32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 21: 2.000(2662)[0m | 
[32mExpert 35: 2.000(2707)[0m | [32mExpert 22: 2.000(2665)[0m | [32mExpert 47: 1.800(2746)[0m | [32mExpert 50: 1.800(2758)[0m | 
[32mExpert 54: 1.800(2770)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 60: 1.600(2791)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2665, 2746, 2758, 2770, 2695, 2791, 2794, 2704, 2731, 2668, 2620]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0, 22, 23, 31, 34, 35, 42, 47, 50, 54, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:3.0 | [18]:3.0 | [34]:3.0 | [46]:2.0 | [58]:2.0 | [35]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[4]:5.0 | [26]:5.0 | [28]:1.0 | [30]:6.0 | [40]:4.0 | [39]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[13]:3.0 | [16]:2.0 | [19]:3.0 | [22]:2.0 | [44]:3.0 | [5]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E22 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[13]:2.0 | [18]:2.0 | [25]:3.0 | [33]:9.0 | [42]:3.0 | [34]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:6.0 | [10]:3.0 | [17]:2.0 | [22]:1.0 | [49]:4.0 | [27]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[3]:2.0 | [12]:2.0 | [37]:4.0 | [45]:11.0 | [59]:2.0 | [56]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 3, 12, 37, 45, 59, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 6.000(3026)[0m | [32mExpert 38: 5.600(2954)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 49: 4.400(2990)[0m | [32mExpert 23: 4.200(2906)[0m | [32mExpert  0: 4.000(2858)[0m | 
[32mExpert 48: 3.800(2987)[0m | [32mExpert 11: 3.600(2867)[0m | [32mExpert 26: 3.600(2915)[0m | [32mExpert 55: 3.400(3011)[0m | 
[32mExpert 14: 3.200(2876)[0m | [32mExpert 52: 3.200(3002)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 61: 3.000(3032)[0m | 
[32mExpert  5: 3.000(2993)[0m | [32mExpert 15: 2.800(2879)[0m | [32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | 
[32mExpert 21: 1.800(2900)[0m | [32mExpert  8: 1.600(3044)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert 31: 1.400(2933)[0m | 
[32mExpert 34: 1.400(2942)[0m | [32mExpert 44: 1.400(2975)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert 19: 1.200(2891)[0m | 
[32mExpert 43: 1.200(2972)[0m | [32mExpert 47: 1.200(2984)[0m | [32mExpert 24: 1.200(2909)[0m | [32mExpert  2: 1.000(2894)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2900, 3044, 2930, 2933, 2942, 2975, 3005, 2891, 2972, 2984, 2909, 2894]
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2909[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  8, 19, 21, 24, 30, 31, 34, 43, 44, 47, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[34]:3.0 | [35]:5.0 | [45]:4.0 | [48]:5.0 | [58]:3.0 | [54]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[7]:3.0 | [18]:1.0 | [27]:4.0 | [31]:1.0 | [61]:1.0 | [0]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[14]:4.0 | [17]:1.0 | [31]:2.0 | [37]:2.0 | [41]:1.0 | [5]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[3]:1.0 | [8]:2.0 | [19]:1.0 | [33]:3.0 | [49]:2.0 | [12]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[5]:2.0 | [26]:3.0 | [27]:1.0 | [43]:3.0 | [48]:1.0 | [24]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[1]:2.0 | [19]:1.0 | [24]:1.0 | [36]:1.0 | [56]:3.0 | [59]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 1, 19, 24, 36, 56, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 44: 5.000(4193)[0m | [32mExpert 17: 5.000(4103)[0m | [32mExpert 12: 4.600(4088)[0m | 
[32mExpert 14: 4.200(4094)[0m | [32mExpert 42: 4.200(4187)[0m | [32mExpert 25: 4.000(4130)[0m | [32mExpert  9: 3.400(4265)[0m | 
[32mExpert 53: 3.400(4223)[0m | [32mExpert 54: 3.400(4226)[0m | [32mExpert 21: 3.200(4118)[0m | [32mExpert 61: 3.200(4250)[0m | 
[32mExpert 19: 3.000(4109)[0m | [32mExpert 15: 3.000(4097)[0m | [32mExpert 41: 2.600(4184)[0m | [32mExpert 56: 2.600(4232)[0m | 
[32mExpert 13: 2.400(4091)[0m | [32mExpert 10: 2.400(4082)[0m | [32mExpert  6: 2.200(4244)[0m | [32mExpert 27: 2.200(4136)[0m | 
[32mExpert 52: 2.200(4220)[0m | [32mExpert  8: 2.200(4262)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert  0: 2.000(4076)[0m | 
[32mExpert 28: 2.000(4139)[0m | [32mExpert 55: 1.800(4229)[0m | [32mExpert 50: 1.800(4214)[0m | [32mExpert  2: 1.400(4112)[0m | 
[32mExpert 23: 1.400(4124)[0m | [32mExpert 35: 1.400(4163)[0m | [32mExpert 37: 1.400(4169)[0m | [32mExpert 62: 1.400(4253)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4220, 4262, 4133, 4076, 4139, 4229, 4214, 4112, 4124, 4163, 4169, 4253]
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  2,  8, 23, 26, 28, 35, 37, 50, 52, 55, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[24]:4.0 | [29]:2.0 | [40]:3.0 | [42]:4.0 | [63]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[1]:3.0 | [10]:6.0 | [20]:2.0 | [48]:1.0 | [58]:1.0 | [38]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[1]:1.0 | [5]:1.0 | [15]:2.0 | [28]:2.0 | [50]:2.0 | [6]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E28 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[4]:2.0 | [14]:1.0 | [32]:1.0 | [54]:1.0 | [58]:2.0 | [1]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[8]:2.0 | [27]:1.0 | [29]:1.0 | [62]:1.0 | [63]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[1]:2.0 | [30]:3.0 | [35]:1.0 | [47]:2.0 | [62]:4.0 | [6]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 1, 30, 35, 47, 62,  6]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[16]:1.0 | [33]:3.0 | [38]:6.0 | [46]:1.0 | [61]:1.0 | [63]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[13]:1.0 | [14]:2.0 | [35]:1.0 | [47]:1.0 | [63]:6.0 | [19]:1.0 | 
---------------------------------------
return EAMC[2]
åºEnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2620
[1m[33mEnqueueTask: [0m[32mTask: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
Prefetch Node: task: Task: node: ID[523,13] (16MB) STATE(0) TENSOR[2619,2620,2618,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 48
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:2.0 | [24]:3.0 | [32]:2.0 | [35]:2.0 | [53]:1.0 | [17]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[4]:1.0 | [16]:1.0 | [28]:1.0 | [30]:1.0 | [40]:1.0 | [25]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[8]:2.0 | [20]:1.0 | [28]:1.0 | [43]:2.0 | [59]:1.0 | [57]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[1]:3.0 | [7]:2.0 | [24]:1.0 | [48]:6.0 | [62]:4.0 | [19]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[4]:2.0 | [7]:4.0 | [11]:2.0 | [20]:2.0 | [34]:4.0 | [46]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[2]:2.0 | [17]:4.0 | [25]:2.0 | [29]:4.0 | [57]:2.0 | [20]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 2, 17, 25, 29, 57, 20]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 55: 5.200(2773)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 5.000(2716)[0m | 
[32mExpert  7: 4.200(2803)[0m | [32mExpert 13: 4.200(2635)[0m | [32mExpert 63: 4.200(2800)[0m | [32mExpert 10: 4.000(2626)[0m | 
[32mExpert 45: 3.800(2740)[0m | [32mExpert 12: 3.600(2632)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert 44: 3.400(2737)[0m | 
[32mExpert 16: 3.200(2644)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert  4: 2.800(2722)[0m | [32mExpert 22: 2.800(2665)[0m | 
[32mExpert 17: 2.600(2647)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | 
[32mExpert 21: 2.000(2662)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 47: 1.800(2746)[0m | [32mExpert 50: 1.800(2758)[0m | 
[32mExpert 54: 1.800(2770)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 60: 1.600(2791)[0m | [32mExpert 61: 1.600(2794)[0m | 
[32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | [32mExpert  0: 1.200(2620)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2662, 2707, 2746, 2758, 2770, 2695, 2791, 2794, 2704, 2731, 2668, 2620]
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2620[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  0, 21, 23, 31, 34, 35, 42, 47, 50, 54, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[27]:4.0 | [28]:5.0 | [44]:3.0 | [47]:4.0 | [49]:2.0 | [39]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[1]:1.0 | [9]:1.0 | [11]:5.0 | [53]:1.0 | [57]:1.0 | [13]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:4.0 | [11]:1.0 | [27]:2.0 | [51]:1.0 | [63]:4.0 | [12]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 10 MLP ==
[0m
[10]:1.0 | [16]:4.0 | [22]:1.0 | [35]:1.0 | [49]:4.0 | [33]:10.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:7.0 | [30]:2.0 | [42]:4.0 | [48]:1.0 | [59]:2.0 | [52]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[3]:3.0 | [18]:4.0 | [22]:4.0 | [45]:12.0 | [63]:1.0 | [23]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 3, 18, 22, 45, 63, 23]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 6.000(3026)[0m | [32mExpert 38: 5.600(2954)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | 
[32mExpert 36: 4.600(2948)[0m | [32mExpert 49: 4.400(2990)[0m | [32mExpert 23: 4.200(2906)[0m | [32mExpert 14: 4.000(2876)[0m | 
[32mExpert  0: 4.000(2858)[0m | [32mExpert 48: 3.800(2987)[0m | [32mExpert  5: 3.800(2993)[0m | [32mExpert 11: 3.600(2867)[0m | 
[32mExpert 26: 3.600(2915)[0m | [32mExpert 55: 3.400(3011)[0m | [32mExpert 52: 3.200(3002)[0m | [32mExpert 25: 3.000(2912)[0m | 
[32mExpert 61: 3.000(3032)[0m | [32mExpert 15: 2.800(2879)[0m | [32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | 
[32mExpert 31: 2.200(2933)[0m | [32mExpert 21: 1.800(2900)[0m | [32mExpert 37: 1.800(2951)[0m | [32mExpert  8: 1.600(3044)[0m | 
[32mExpert 41: 1.600(2966)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert 34: 1.400(2942)[0m | [32mExpert 44: 1.400(2975)[0m | 
[32mExpert 53: 1.400(3005)[0m | [32mExpert 17: 1.200(2885)[0m | [32mExpert 19: 1.200(2891)[0m | [32mExpert 43: 1.200(2972)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2933, 2900, 2951, 3044, 2966, 2930, 2942, 2975, 3005, 2885, 2891, 2972]
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8, 17, 19, 21, 30, 31, 34, 37, 41, 43, 44, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:3.0 | [22]:1.0 | [26]:4.0 | [35]:6.0 | [63]:5.0 | [4]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[20]:3.0 | [22]:3.0 | [38]:1.0 | [45]:1.0 | [55]:4.0 | [18]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[9]:1.0 | [14]:5.0 | [25]:4.0 | [37]:3.0 | [49]:5.0 | [55]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:2.0 | [20]:1.0 | [28]:1.0 | [30]:8.0 | [61]:1.0 | [32]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[5]:3.0 | [27]:2.0 | [48]:2.0 | [50]:2.0 | [51]:2.0 | [38]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[1]:3.0 | [14]:3.0 | [19]:2.0 | [24]:2.0 | [43]:1.0 | [39]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 1, 14, 19, 24, 43, 39]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 44: 5.000(4193)[0m | [32mExpert 17: 5.000(4103)[0m | [32mExpert 12: 4.600(4088)[0m | 
[32mExpert 14: 4.200(4094)[0m | [32mExpert 42: 4.200(4187)[0m | EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[32mExpert 25: 4.000(4130)[0m | [32mExpert 15: 3.800(4097)[0m | 
[32mExpert  9: 3.400(4265)[0m | [32mExpert 53: 3.400(4223)[0m | [32mExpert 54: 3.400(4226)[0m | [32mExpert 21: 3.200(4118)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert  6: 3.000(4244)[0m | [32mExpert 19: 3.000(4109)[0m | [32mExpert 28: 2.800(4139)[0m | 
[32mExpert 41: 2.600(4184)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert 56: 2.600(4232)[0m | [32mExpert 13: 2.400(4091)[0m | 
[32mExpert 10: 2.400(4082)[0m | [32mExpert 27: 2.200(4136)[0m | [32mExpert 52: 2.200(4220)[0m | [32mExpert  8: 2.200(4262)[0m | 
[32mExpert 26: 2.200(4133)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 55: 1.800(4229)[0m | [32mExpert  5: 1.600(4211)[0m | 
[32mExpert  2: 1.400(4112)[0m | [32mExpert 23: 1.400(4124)[0m | [32mExpert 35: 1.400(4163)[0m | [32mExpert 37: 1.400(4169)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4082, 4136, 4220, 4262, 4133, 4076, 4229, 4211, 4112, 4124, 4163, 4169]
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  2,  5,  8, 10, 23, 26, 27, 35, 37, 52, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:4.0 | [5]:4.0 | [12]:6.0 | [39]:4.0 | [44]:2.0 | [63]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[13]:2.0 | [27]:2.0 | [29]:2.0 | [58]:2.0 | [62]:4.0 | [46]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[5]:2.0 | [18]:1.0 | [41]:4.0 | [44]:7.0 | [56]:3.0 | [59]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:6.0 | [17]:2.0 | [33]:7.0 | [34]:4.0 | [49]:3.0 | [38]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[8]:3.0 | [14]:1.0 | [26]:3.0 | [34]:2.0 | [47]:4.0 | [62]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[12]:3.0 | [15]:1.0 | [24]:9.0 | [36]:2.0 | [53]:1.0 | [56]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[12, 15, 24, 36, 53, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:5.0 | [14]:2.0 | [31]:2.0 | [41]:3.0 | [61]:2.0 | [27]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[11]:4.0 | [17]:3.0 | [28]:2.0 | [57]:6.0 | [62]:1.0 | [27]:4.0 | 
---------------------------------------
return EAMC[2]
é¢„æµ‹EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[10]:1.0 | [17]:3.0 | [32]:3.0 | [33]:7.0 | [48]:2.0 | [22]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[6]:3.0 | [9]:1.0 | [39]:1.0 | [40]:2.0 | [55]:1.0 | [25]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[20]:2.0 | [37]:2.0 | [39]:2.0 | [61]:1.0 | [63]:2.0 | [40]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[1]:4.0 | [28]:4.0 | [48]:7.0 | [50]:2.0 | [62]:5.0 | [43]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[2]:4.0 | [3]:2.0 | [4]:3.0 | [7]:5.0 | [46]:2.0 | [6]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[2]:3.0 | [17]:5.0 | [20]:5.0 | [30]:1.0 | [47]:2.0 | [29]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 2, 17, 20, 30, 47, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.600(2743)[0m | [32mExpert 55: 5.200(2773)[0m | [32mExpert 41: 5.200(2728)[0m | [32mExpert  7: 5.000(2803)[0m | 
[32mExpert 38: 5.000(2716)[0m | [32mExpert 63: 5.000(2800)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 13: 4.200(2635)[0m | 
[32mExpert 10: 4.000(2626)[0m | [32mExpert 45: 3.800(2740)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert 44: 3.400(2737)[0m | 
[32mExpert 16: 3.200(2644)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert  4: 2.800(2722)[0m | [32mExpert 22: 2.800(2665)[0m | 
[32mExpert 17: 2.600(2647)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | 
[32mExpert 21: 2.000(2662)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 27: 1.800(2680)[0m | [32mExpert 47: 1.800(2746)[0m | 
[32mExpert 50: 1.800(2758)[0m | [32mExpert 54: 1.800(2770)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 60: 1.600(2791)[0m | 
[32mExpert 61: 1.600(2794)[0m | [32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2662, 2707, 2680, 2746, 2758, 2770, 2695, 2791, 2794, 2704, 2731, 2668]
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 21, 23, 27, 31, 34, 35, 42, 47, 50, 54, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[27]:5.0 | [28]:6.0 | [37]:1.0 | [47]:5.0 | [49]:3.0 | [44]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[1]:2.0 | [9]:2.0 | [11]:6.0 | [40]:5.0 | [57]:2.0 | [4]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:5.0 | [22]:3.0 | [27]:3.0 | [44]:4.0 | [63]:5.0 | [14]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:2.0 | [16]:5.0 | [33]:11.0 | [35]:2.0 | [49]:5.0 | [45]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:8.0 | [30]:3.0 | [42]:5.0 | [48]:2.0 | [52]:5.0 | [59]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[1]:2.0 | [16]:1.0 | [18]:5.0 | [22]:5.0 | [33]:2.0 | [52]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 1, 16, 18, 22, 33, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 6.000(3026)[0m | [32mExpert 38: 5.600(2954)[0m | [32mExpert 49: 5.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | 
[32mExpert 16: 5.000(2882)[0m | [32mExpert 14: 4.800(2876)[0m | [32mExpert 36: 4.600(2948)[0m | [32mExpert 23: 4.200(2906)[0m | 
[32mExpert 55: 4.200(3011)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 48: 3.800(2987)[0m | 
[32mExpert  5: 3.800(2993)[0m | [32mExpert 11: 3.600(2867)[0m | [32mExpert 26: 3.600(2915)[0m | [32mExpert 52: 3.200(3002)[0m | 
[32mExpert 61: 3.000(3032)[0m | [32mExpert 15: 2.800(2879)[0m | [32mExpert 33: 2.800(2939)[0m | [32mExpert 37: 2.600(2951)[0m | 
[32mExpert 50: 2.600(2996)[0m | [32mExpert 31: 2.200(2933)[0m | [32mExpert 21: 1.800(2900)[0m | [32mExpert  8: 1.600(3044)[0m | 
[32mExpert 41: 1.600(2966)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert 34: 1.400(2942)[0m | [32mExpert 44: 1.400(2975)[0m | 
[32mExpert 53: 1.400(3005)[0m | [32mExpert  9: 1.200(3047)[0m | [32mExpert 17: 1.200(2885)[0m | [32mExpert 19: 1.200(2891)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2933, 2900, 3044, 2966, 2930, 2942, 2975, 3005, 3047, 2885, 2891]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8,  9, 17, 19, 21, 30, 31, 34, 41, 44, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:4.0 | [26]:5.0 | [36]:4.0 | [61]:4.0 | [63]:6.0 | [5]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[22]:4.0 | [35]:2.0 | [38]:2.0 | [55]:5.0 | [59]:7.0 | [24]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[7]:2.0 | [9]:2.0 | [14]:6.0 | [36]:5.0 | [39]:1.0 | [23]:4.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[30]:9.0 | [35]:3.0 | [47]:2.0 | [57]:3.0 | [61]:2.0 | [37]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[11]:3.0 | [19]:1.0 | [24]:4.0 | [38]:3.0 | [50]:3.0 | [62]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[5]:2.0 | [39]:3.0 | [44]:2.0 | [47]:4.0 | [55]:2.0 | [7]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 5, 39, 44, 47, 55,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 44: 5.800(4193)[0m | [32mExpert 17: 5.000(4103)[0m | [32mExpert 12: 4.600(4088)[0m | 
[32mExpert 14: 4.200(4094)[0m | [32mExpert 42: 4.200(4187)[0m | [32mExpert 25: 4.000(4130)[0m | [32mExpert 15: 3.800(4097)[0m | 
[32mExpert  9: 3.400(4265)[0m | [32mExpert 41: 3.400(4184)[0m | [32mExpert 53: 3.400(4223)[0m | [32mExpert 54: 3.400(4226)[0m | 
[32mExpert 56: 3.400(4232)[0m | [32mExpert 21: 3.200(4118)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert  6: 3.000(4244)[0m | 
[32mExpert 19: 3.000(4109)[0m | [32mExpert 28: 2.800(4139)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert 13: 2.400(4091)[0m | 
[32mExpert  5: 2.400(4211)[0m | [32mExpert 10: 2.400(4082)[0m | [32mExpert 27: 2.200(4136)[0m | [32mExpert 52: 2.200(4220)[0m | 
[32mExpert  8: 2.200(4262)[0m | [32mExpert 26: 2.200(4133)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 18: 2.000(4106)[0m | 
[32mExpert 55: 1.800(4229)[0m | [32mExpert 59: 1.600(4241)[0m | [32mExpert  2: 1.400(4112)[0m | [32mExpert 23: 1.400(4124)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4211, 4082, 4136, 4220, 4262, 4133, 4076, 4106, 4229, 4241, 4112, 4124]
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  2,  5,  8, 10, 18, 23, 26, 27, 52, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[8]:1.0 | [9]:3.0 | [27]:1.0 | [53]:3.0 | [58]:3.0 | [39]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[4]:3.0 | [13]:3.0 | [36]:4.0 | [41]:4.0 | [61]:1.0 | [53]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[1]:2.0 | [18]:2.0 | [23]:2.0 | [25]:4.0 | [53]:4.0 | [56]:4.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E18 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[5]:4.0 | [8]:7.0 | [17]:3.0 | [22]:2.0 | [33]:8.0 | [47]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[5]:4.0 | [8]:4.0 | [30]:1.0 | [34]:3.0 | [62]:3.0 | [26]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[15]:2.0 | [24]:10.0 | [26]:2.0 | [34]:4.0 | [55]:2.0 | [52]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[15, 24, 26, 34, 55, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[13]:1.0 | [20]:2.0 | [28]:1.0 | [33]:4.0 | [47]:1.0 | [61]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[10]:4.0 | [32]:4.0 | [38]:5.0 | [39]:2.0 | [43]:4.0 | [62]:2.0 | 
---------------------------------------
return EAMC[2]
ä¸­çš„EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2731
[1m[33mEnqueueTask: [0m[32mTask: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[565,2a00000013] (16MB) STATE(0) TENSOR[2730,2731,2729,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 30
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[15]:3.0 | [20]:5.0 | [45]:1.0 | [49]:1.0 | [61]:3.0 | [29]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[15]:4.0 | [32]:1.0 | [48]:3.0 | [52]:1.0 | [54]:1.0 | [25]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[6]:1.0 | [8]:3.0 | [11]:3.0 | [50]:1.0 | [62]:2.0 | [15]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[4]:1.0 | [5]:1.0 | [29]:6.0 | [57]:4.0 | [63]:1.0 | [58]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[1]:1.0 | [8]:1.0 | [26]:1.0 | [47]:4.0 | [56]:4.0 | [54]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[33]:3.0 | [36]:1.0 | [43]:2.0 | [47]:3.0 | [54]:1.0 | [39]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[33, 36, 43, 47, 54, 39]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 5.800(2803)[0m | [32mExpert 63: 5.800(2800)[0m | [32mExpert 46: 5.600(2743)[0m | [32mExpert 55: 5.200(2773)[0m | 
[32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 5.000(2716)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 13: 4.200(2635)[0m | 
[32mExpert 44: 4.200(2737)[0m | [32mExpert 10: 4.000(2626)[0m | [32mExpert 45: 3.800(2740)[0m | [32mExpert 22: 3.600(2665)[0m | 
[32mExpert 33: 3.400(2701)[0m | [32mExpert 16: 3.200(2644)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert  4: 2.800(2722)[0m | 
[32mExpert 27: 2.600(2680)[0m | [32mExpert 17: 2.600(2647)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert 21: 2.000(2662)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 47: 1.800(2746)[0m | 
[32mExpert 50: 1.800(2758)[0m | [32mExpert 54: 1.800(2770)[0m | [32mExpert 31: 1.800(2695)[0m | [32mExpert 60: 1.600(2791)[0m | 
[32mExpert 61: 1.600(2794)[0m | [32mExpert 34: 1.400(2704)[0m | [32mExpert 42: 1.400(2731)[0m | [32mExpert 23: 1.400(2668)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2749, 2662, 2707, 2746, 2758, 2770, 2695, 2791, 2794, 2704, 2731, 2668]
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2731[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 21, 23, 31, 34, 35, 42, 47, 48, 50, 54, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[7]:1.0 | [43]:6.0 | [52]:2.0 | [56]:2.0 | [60]:1.0 | [6]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[17]:6.0 | [26]:6.0 | [40]:6.0 | [47]:2.0 | [60]:2.0 | [41]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[5]:2.0 | [17]:3.0 | [29]:2.0 | [49]:1.0 | [57]:1.0 | [39]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 10 MLP ==
[0m
[4]:3.0 | [5]:1.0 | [9]:5.0 | [33]:12.0 | [54]:1.0 | [18]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[16]:4.0 | [27]:6.0 | [53]:10.0 | [57]:1.0 | [59]:4.0 | [48]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[19]:2.0 | [32]:2.0 | [45]:13.0 | [56]:2.0 | [57]:7.0 | [25]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[19, 32, 45, 56, 57, 25]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 6.000(3026)[0m | [32mExpert 14: 5.600(2876)[0m | [32mExpert 38: 5.600(2954)[0m | [32mExpert 36: 5.400(2948)[0m | 
[32mExpert 49: 5.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 4.200(3011)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 48: 3.800(2987)[0m | 
[32mExpert  5: 3.800(2993)[0m | [32mExpert 11: 3.600(2867)[0m | [32mExpert 26: 3.600(2915)[0m | [32mExpert 52: 3.200(3002)[0m | 
[32mExpert 61: 3.000(3032)[0m | [32mExpert 15: 2.800(2879)[0m | [32mExpert 33: 2.800(2939)[0m | [32mExpert 37: 2.600(2951)[0m | 
[32mExpert 50: 2.600(2996)[0m | [32mExpert 31: 2.200(2933)[0m | [32mExpert  9: 2.000(3047)[0m | [32mExpert 21: 1.800(2900)[0m | 
[32mExpert  7: 1.600(3041)[0m | [32mExpert  8: 1.600(3044)[0m | [32mExpert 41: 1.600(2966)[0m | [32mExpert 30: 1.400(2930)[0m | 
[32mExpert 34: 1.400(2942)[0m | [32mExpert 44: 1.400(2975)[0m | [32mExpert 53: 1.400(3005)[0m | [32mExpert 17: 1.200(2885)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2933, 3047, 2900, 3041, 3044, 2966, 2930, 2942, 2975, 3005, 2885]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8,  9, 17, 21, 30, 31, 34, 41, 44, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[2]:1.0 | [5]:4.0 | [15]:4.0 | [28]:2.0 | [30]:6.0 | [54]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[0]:6.0 | [14]:1.0 | [19]:5.0 | [46]:5.0 | [59]:8.0 | [51]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[15]:3.0 | [38]:7.0 | [39]:2.0 | [47]:2.0 | [52]:4.0 | [37]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[1]:1.0 | [9]:3.0 | [30]:10.0 | [40]:5.0 | [48]:5.0 | [16]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[10]:5.0 | [16]:2.0 | [19]:2.0 | [22]:1.0 | [26]:4.0 | [23]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[8]:8.0 | [35]:2.0 | [43]:2.0 | [47]:5.0 | [48]:1.0 | [50]:6.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 8, 35, 43, 47, 48, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 44: 5.800(4193)[0m | [32mExpert 17: 5.000(4103)[0m | [32mExpert 25: 4.800(4130)[0m | 
[32mExpert 12: 4.600(4088)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 42: 4.200(4187)[0m | [32mExpert 53: 4.200(4223)[0m | 
[32mExpert 56: 4.200(4232)[0m | [32mExpert 15: 3.800(4097)[0m | [32mExpert  9: 3.400(4265)[0m | [32mExpert 41: 3.400(4184)[0m | 
[32mExpert 54: 3.400(4226)[0m | EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
[32mExpert 21: 3.200(4118)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert  6: 3.000(4244)[0m | 
[32mExpert 19: 3.000(4109)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 28: 2.800(4139)[0m | [32mExpert 50: 2.600(4214)[0m | 
[32mExpert 13: 2.400(4091)[0m | [32mExpert  5: 2.400(4211)[0m | [32mExpert 10: 2.400(4082)[0m | [32mExpert 23: 2.200(4124)[0m | 
[32mExpert 27: 2.200(4136)[0m | [32mExpert 52: 2.200(4220)[0m | [32mExpert  8: 2.200(4262)[0m | [32mExpert 26: 2.200(4133)[0m | 
[32mExpert  1: 2.000(4079)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 55: 1.800(4229)[0m | [32mExpert 59: 1.600(4241)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4091, 4211, 4082, 4124, 4136, 4220, 4262, 4133, 4079, 4076, 4229, 4241]
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  8, 10, 13, 23, 26, 27, 52, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:4.0 | [9]:4.0 | [10]:1.0 | [53]:4.0 | [56]:3.0 | [19]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[2]:1.0 | [3]:4.0 | [5]:3.0 | [28]:2.0 | [36]:5.0 | [31]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[9]:5.0 | [17]:6.0 | [19]:3.0 | [21]:4.0 | [53]:5.0 | [10]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:8.0 | [13]:1.0 | [29]:1.0 | [44]:5.0 | [47]:2.0 | [5]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[0]:4.0 | [9]:2.0 | [12]:6.0 | [30]:2.0 | [56]:1.0 | [31]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[7]:1.0 | [24]:11.0 | [36]:3.0 | [44]:3.0 | [58]:2.0 | [60]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 7, 24, 36, 44, 58, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[9]:1.0 | [13]:2.0 | [43]:1.0 | [52]:4.0 | [54]:8.0 | [35]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[4]:1.0 | [32]:5.0 | [59]:3.0 | [61]:1.0 | [63]:7.0 | [6]:2.0 | 
---------------------------------------
return EAMC[2]
ä¼˜EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2719
[1m[33mEnqueueTask: [0m[32mTask: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2794
[1m[33mEnqueueTask: [0m[32mTask: node: ID[584,3d00000013] (16MB) STATE(0) TENSOR[2793,2794,2792,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[16]:1.0 | [17]:4.0 | [33]:8.0 | [35]:3.0 | [53]:2.0 | [6]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[18]:1.0 | [33]:2.0 | [52]:2.0 | [56]:1.0 | [60]:5.0 | [31]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[2]:1.0 | [14]:3.0 | [33]:1.0 | [50]:2.0 | [52]:1.0 | [35]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[12]:1.0 | [44]:1.0 | [53]:1.0 | [54]:2.0 | [56]:1.0 | [29]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[1]:2.0 | [26]:2.0 | [37]:1.0 | [57]:2.0 | [62]:1.0 | [6]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[2]:4.0 | [20]:6.0 | [25]:3.0 | [26]:2.0 | [53]:2.0 | [31]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 2, 20, 25, 26, 53, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 5.800(2803)[0m | [32mExpert 63: 5.800(2800)[0m | [32mExpert 46: 5.600(2743)[0m | [32mExpert 55: 5.200(2773)[0m | 
[32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 5.000(2716)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 13: 4.200(2635)[0m | 
[32mExpert 44: 4.200(2737)[0m | [32mExpert 10: 4.000(2626)[0m | [32mExpert 45: 3.800(2740)[0m | [32mExpert 22: 3.600(2665)[0m | 
[32mExpert 17: 3.400(2647)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert 16: 3.200(2644)[0m | [32mExpert 19: 2.800(2653)[0m | 
[32mExpert  4: 2.800(2722)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert 21: 2.000(2662)[0m | [32mExpert 29: 2.000(2686)[0m | [32mExpert 35: 2.000(2707)[0m | 
[32mExpert  5: 1.800(2755)[0m | [32mExpert 47: 1.800(2746)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 54: 1.800(2770)[0m | 
[32mExpert 31: 1.800(2695)[0m | [32mExpert 39: 1.600(2719)[0m | [32mExpert 60: 1.600(2791)[0m | [32mExpert 61: 1.600(2794)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2749, 2662, 2686, 2707, 2755, 2746, 2758, 2770, 2695, 2719, 2791, 2794]
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2719[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2794[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5, 21, 29, 31, 35, 39, 47, 48, 50, 54, 60, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[29]:1.0 | [35]:2.0 | [45]:1.0 | [54]:3.0 | [56]:3.0 | [48]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[17]:7.0 | [22]:5.0 | [23]:1.0 | [26]:7.0 | [57]:3.0 | [52]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[9]:2.0 | [29]:3.0 | [32]:1.0 | [49]:2.0 | [62]:1.0 | [11]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E29 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[4]:4.0 | [8]:2.0 | [25]:4.0 | [32]:1.0 | [33]:13.0 | [47]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:9.0 | [16]:5.0 | [17]:3.0 | [22]:2.0 | [56]:1.0 | [48]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[3]:4.0 | [4]:3.0 | [37]:5.0 | [45]:14.0 | [59]:3.0 | [57]:8.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 3,  4, 37, 45, 59, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 6.400(2954)[0m | [32mExpert  6: 6.000(3026)[0m | [32mExpert 14: 5.600(2876)[0m | [32mExpert 36: 5.400(2948)[0m | 
[32mExpert 49: 5.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 4.200(3011)[0m | [32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 25: 3.800(2912)[0m | 
[32mExpert 48: 3.800(2987)[0m | [32mExpert  5: 3.800(2993)[0m | [32mExpert 11: 3.600(2867)[0m | [32mExpert 15: 3.600(2879)[0m | 
[32mExpert 26: 3.600(2915)[0m | [32mExpert 37: 3.400(2951)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 33: 2.800(2939)[0m | 
[32mExpert 50: 2.600(2996)[0m | [32mExpert 31: 2.200(2933)[0m | [32mExpert  9: 2.000(3047)[0m | [32mExpert 39: 2.000(2957)[0m | 
[32mExpert 47: 2.000(2984)[0m | [32mExpert 21: 1.800(2900)[0m | [32mExpert  7: 1.600(3041)[0m | [32mExpert  8: 1.600(3044)[0m | 
[32mExpert 41: 1.600(2966)[0m | [32mExpert 30: 1.400(2930)[0m | [32mExpert 34: 1.400(2942)[0m | [32mExpert 44: 1.400(2975)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2933, 3047, 2957, 2984, 2900, 3041, 3044, 2966, 2930, 2942, 2975]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8,  9, 21, 30, 31, 34, 39, 41, 44, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[0]:1.0 | [36]:5.0 | [42]:1.0 | [47]:3.0 | [48]:6.0 | [14]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[7]:4.0 | [18]:3.0 | [19]:6.0 | [27]:5.0 | [61]:2.0 | [48]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[1]:1.0 | [5]:3.0 | [11]:4.0 | [17]:2.0 | [41]:2.0 | [55]:4.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:4.0 | [33]:4.0 | [47]:3.0 | [49]:3.0 | [53]:4.0 | [26]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[26]:5.0 | [28]:3.0 | [29]:1.0 | [41]:2.0 | [43]:4.0 | [23]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[19]:3.0 | [36]:2.0 | [56]:4.0 | [58]:3.0 | [59]:3.0 | [1]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[19, 36, 56, 58, 59,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 17: 5.800(4103)[0m | [32mExpert 44: 5.800(4193)[0m | [32mExpert 53: 5.000(4223)[0m | 
[32mExpert 25: 4.800(4130)[0m | [32mExpert 12: 4.600(4088)[0m | [32mExpert  9: 4.200(4265)[0m | [32mExpert 14: 4.200(4094)[0m | 
[32mExpert 42: 4.200(4187)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 21: 4.000(4118)[0m | [32mExpert 19: 3.800(4109)[0m | 
[32mExpert 15: 3.800(4097)[0m | [32mExpert 41: 3.400(4184)[0m | [32mExpert 54: 3.400(4226)[0m | [32mExpert 10: 3.200(4082)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert  6: 3.000(4244)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 28: 2.800(4139)[0m | 
[32mExpert 50: 2.600(4214)[0m | [32mExpert 13: 2.400(4091)[0m | [32mExpert  5: 2.400(4211)[0m | [32mExpert 23: 2.200(4124)[0m | 
[32mExpert 27: 2.200(4136)[0m | [32mExpert 52: 2.200(4220)[0m | [32mExpert  8: 2.200(4262)[0m | [32mExpert 26: 2.200(4133)[0m | 
[32mExpert  1: 2.000(4079)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 55: 1.800(4229)[0m | [32mExpert 59: 1.600(4241)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4214, 4091, 4211, 4124, 4136, 4220, 4262, 4133, 4079, 4076, 4229, 4241]
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  8, 13, 23, 26, 27, 50, 52, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:5.0 | [6]:5.0 | [36]:2.0 | [40]:4.0 | [58]:4.0 | [24]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[13]:4.0 | [20]:3.0 | [43]:3.0 | [48]:2.0 | [58]:3.0 | [28]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[5]:3.0 | [6]:4.0 | [15]:3.0 | [21]:5.0 | [49]:1.0 | [28]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[1]:2.0 | [31]:1.0 | [32]:2.0 | [49]:4.0 | [58]:3.0 | [11]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[0]:5.0 | [3]:5.0 | [13]:4.0 | [22]:3.0 | [29]:2.0 | [41]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[7]:2.0 | [10]:4.0 | [23]:2.0 | [24]:12.0 | [30]:4.0 | [35]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 7, 10, 23, 24, 30, 35]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[0]:1.0 | [19]:2.0 | [32]:1.0 | [54]:9.0 | [61]:4.0 | [33]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[4]:2.0 | [13]:2.0 | [14]:3.0 | [47]:2.0 | [57]:7.0 | [11]:5.0 | 
---------------------------------------
return EAMC[2]
åŠ£EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[11]:4.0 | [22]:3.0 | [33]:9.0 | [36]:1.0 | [53]:3.0 | [29]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[4]:2.0 | [26]:1.0 | [49]:1.0 | [52]:3.0 | [56]:2.0 | [43]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[33]:2.0 | [35]:2.0 | [50]:3.0 | [53]:1.0 | [59]:2.0 | [51]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[7]:3.0 | [44]:2.0 | [53]:2.0 | [54]:3.0 | [56]:2.0 | [9]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[1]:3.0 | [6]:3.0 | [26]:3.0 | [37]:2.0 | [62]:2.0 | [0]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[2]:5.0 | [5]:1.0 | [20]:7.0 | [25]:4.0 | [59]:3.0 | [53]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 2,  5, 20, 25, 59, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 5.800(2803)[0m | [32mExpert 63: 5.800(2800)[0m | [32mExpert 46: 5.600(2743)[0m | [32mExpert 55: 5.200(2773)[0m | 
[32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 5.000(2716)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 13: 4.200(2635)[0m | 
[32mExpert 44: 4.200(2737)[0m | [32mExpert 10: 4.000(2626)[0m | [32mExpert 45: 3.800(2740)[0m | [32mExpert 22: 3.600(2665)[0m | 
[32mExpert 17: 3.400(2647)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert 16: 3.200(2644)[0m | [32mExpert 19: 2.800(2653)[0m | 
[32mExpert 29: 2.800(2686)[0m | [32mExpert  4: 2.800(2722)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert  8: 2.400(2806)[0m | 
[32mExpert  1: 2.200(2623)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  9: 2.000(2809)[0m | [32mExpert 11: 2.000(2629)[0m | 
[32mExpert 21: 2.000(2662)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 32: 2.000(2698)[0m | [32mExpert  5: 1.800(2755)[0m | 
[32mExpert 47: 1.800(2746)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 54: 1.800(2770)[0m | [32mExpert 31: 1.800(2695)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2623, 2749, 2809, 2629, 2662, 2707, 2698, 2755, 2746, 2758, 2770, 2695]
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  5,  9, 11, 21, 31, 32, 35, 47, 48, 50, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[10]:2.0 | [36]:1.0 | [45]:2.0 | [54]:4.0 | [56]:4.0 | [51]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[9]:3.0 | [17]:8.0 | [22]:6.0 | [26]:8.0 | [57]:4.0 | [59]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[5]:3.0 | [9]:3.0 | [11]:3.0 | [17]:4.0 | [43]:2.0 | [29]:4.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E11 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[4]:5.0 | [8]:3.0 | [32]:2.0 | [33]:14.0 | [45]:5.0 | [58]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[16]:6.0 | [48]:5.0 | [52]:6.0 | [56]:2.0 | [57]:2.0 | [53]:11.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[1]:3.0 | [3]:5.0 | [18]:6.0 | [33]:3.0 | [57]:9.0 | [8]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 1,  3, 18, 33, 57,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 6.400(2954)[0m | [32mExpert  6: 6.000(3026)[0m | [32mExpert 14: 5.600(2876)[0m | [32mExpert 36: 5.400(2948)[0m | 
[32mExpert 49: 5.200(2990)[0m | [32mExpert  4: 5.000(2960)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert 11: 4.400(2867)[0m | [32mExpert 52: 4.000(3002)[0m | 
[32mExpert  0: 4.000(2858)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 48: 3.800(2987)[0m | [32mExpert 15: 3.600(2879)[0m | 
[32mExpert 26: 3.600(2915)[0m | [32mExpert 37: 3.400(2951)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 33: 2.800(2939)[0m | 
[32mExpert 50: 2.600(2996)[0m | [32mExpert 41: 2.400(2966)[0m | [32mExpert 31: 2.200(2933)[0m | [32mExpert  9: 2.000(3047)[0m | 
[32mExpert 17: 2.000(2885)[0m | [32mExpert 39: 2.000(2957)[0m | [32mExpert 47: 2.000(2984)[0m | [32mExpert 21: 1.800(2900)[0m | 
[32mExpert  7: 1.600(3041)[0m | [32mExpert  8: 1.600(3044)[0m | [32mExpert  1: 1.400(2861)[0m | [32mExpert 30: 1.400(2930)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2966, 2933, 3047, 2885, 2957, 2984, 2900, 3041, 3044, 2861, 2930]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  7,  8,  9, 17, 21, 30, 31, 39, 41, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[29]:6.0 | [30]:7.0 | [42]:2.0 | [57]:3.0 | [63]:7.0 | [36]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[5]:3.0 | [8]:1.0 | [9]:6.0 | [52]:1.0 | [59]:9.0 | [38]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[4]:4.0 | [28]:1.0 | [38]:8.0 | [48]:5.0 | [57]:1.0 | [17]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[28]:2.0 | [41]:6.0 | [45]:1.0 | [49]:4.0 | [54]:1.0 | [5]:4.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4241
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1362,3b0000002b] (16MB) STATE(0) TENSOR[4240,4241,4239,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3

[1;36m== Layer 17 MLP ==
[0m
[7]:1.0 | [24]:5.0 | [41]:3.0 | [46]:2.0 | [61]:2.0 | [47]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[8]:9.0 | [35]:3.0 | [36]:3.0 | [47]:6.0 | [50]:7.0 | [19]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 8, 35, 36, 47, 50, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 6.600(4205)[0m | [32mExpert 17: 5.800(4103)[0m | [32mExpert 44: 5.800(4193)[0m | [32mExpert 53: 5.000(4223)[0m | 
[32mExpert 21: 4.800(4118)[0m | [32mExpert 25: 4.800(4130)[0m | [32mExpert 12: 4.600(4088)[0m | [32mExpert 15: 4.600(4097)[0m | 
[32mExpert  9: 4.200(4265)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 42: 4.200(4187)[0m | [32mExpert 56: 4.200(4232)[0m | 
[32mExpert  6: 3.800(4244)[0m | [32mExpert 19: 3.800(4109)[0m | [32mExpert 28: 3.600(4139)[0m | [32mExpert 41: 3.400(4184)[0m | 
[32mExpert 54: 3.400(4226)[0m | [32mExpert  5: 3.200(4211)[0m | [32mExpert 10: 3.200(4082)[0m | [32mExpert 61: 3.200(4250)[0m | 
[32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert 13: 2.400(4091)[0m | [32mExpert 23: 2.200(4124)[0m | 
[32mExpert 27: 2.200(4136)[0m | [32mExpert 52: 2.200(4220)[0m | [32mExpert  8: 2.200(4262)[0m | [32mExpert 26: 2.200(4133)[0m | 
[32mExpert  1: 2.000(4079)[0m | [32mExpert  0: 2.000(4076)[0m | [32mExpert 55: 1.800(4229)[0m | [32mExpert 59: 1.600(4241)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4106, 4214, 4091, 4124, 4136, 4220, 4262, 4133, 4079, 4076, 4229, 4241]
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4241[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  8, 13, 18, 23, 26, 27, 50, 52, 55, 59 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:5.0 | [20]:2.0 | [38]:3.0 | [57]:2.0 | [58]:5.0 | [6]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[10]:7.0 | [15]:7.0 | [36]:6.0 | [44]:5.0 | [55]:2.0 | [25]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[0]:2.0 | [9]:6.0 | [26]:2.0 | [48]:7.0 | [51]:2.0 | [10]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:9.0 | [12]:2.0 | [33]:9.0 | [51]:2.0 | [56]:3.0 | [55]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[1]:3.0 | [18]:2.0 | [36]:1.0 | [45]:5.0 | [46]:5.0 | [47]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[20]:2.0 | [24]:13.0 | [36]:4.0 | [45]:4.0 | [60]:5.0 | [5]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[20, 24, 36, 45, 60,  5]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[17]:3.0 | [18]:2.0 | [20]:3.0 | [34]:2.0 | [47]:2.0 | [52]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[10]:5.0 | [43]:5.0 | [56]:8.0 | [57]:8.0 | [58]:1.0 | [32]:6.0 | 
---------------------------------------
return EAMC[2]

EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[19]:2.0 | [31]:4.0 | [34]:1.0 | [50]:4.0 | [57]:5.0 | [54]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[8]:3.0 | [15]:5.0 | [46]:2.0 | [47]:4.0 | [62]:4.0 | [37]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[9]:4.0 | [22]:4.0 | [46]:6.0 | [48]:4.0 | [60]:4.0 | [0]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[3]:3.0 | [13]:4.0 | [18]:5.0 | [34]:6.0 | [60]:3.0 | [39]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[12]:3.0 | [18]:4.0 | [41]:5.0 | [50]:7.0 | [56]:5.0 | [39]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[12]:2.0 | [16]:3.0 | [46]:6.0 | [50]:4.0 | [56]:6.0 | [33]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[12, 16, 46, 50, 56, 33]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 5.800(2803)[0m | [32mExpert 63: 5.800(2800)[0m | [32mExpert 46: 5.600(2743)[0m | [32mExpert 55: 5.200(2773)[0m | 
[32mExpert 41: 5.200(2728)[0m | [32mExpert 38: 5.000(2716)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 13: 4.200(2635)[0m | 
[32mExpert 17: 4.200(2647)[0m | [32mExpert 44: 4.200(2737)[0m | [32mExpert 10: 4.000(2626)[0m | [32mExpert 45: 3.800(2740)[0m | 
[32mExpert 22: 3.600(2665)[0m | [32mExpert 29: 3.600(2686)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert 16: 3.200(2644)[0m | 
[32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert  4: 2.800(2722)[0m | 
[32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert 21: 2.000(2662)[0m | [32mExpert 35: 2.000(2707)[0m | [32mExpert 32: 2.000(2698)[0m | 
[32mExpert 47: 1.800(2746)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 54: 1.800(2770)[0m | [32mExpert 31: 1.800(2695)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2755, 2680, 2806, 2623, 2749, 2662, 2707, 2698, 2746, 2758, 2770, 2695]
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  5,  8, 21, 27, 31, 32, 35, 47, 48, 50, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:6.0 | [26]:4.0 | [41]:6.0 | [42]:4.0 | [50]:5.0 | [6]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[6]:4.0 | [8]:5.0 | [45]:5.0 | [46]:6.0 | [49]:5.0 | [10]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[35]:3.0 | [38]:5.0 | [41]:6.0 | [46]:6.0 | [48]:3.0 | [45]:5.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:6.0 | [41]:7.0 | [53]:1.0 | [55]:4.0 | [60]:3.0 | [17]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[8]:3.0 | [16]:7.0 | [28]:6.0 | [43]:6.0 | [47]:5.0 | [60]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[7]:2.0 | [29]:6.0 | [42]:4.0 | [46]:4.0 | [48]:4.0 | [41]:9.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 7, 29, 42, 46, 48, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 7.200(2954)[0m | [32mExpert  6: 6.000(3026)[0m | [32mExpert  4: 5.800(2960)[0m | [32mExpert 14: 5.600(2876)[0m | 
[32mExpert 36: 5.400(2948)[0m | [32mExpert 49: 5.200(2990)[0m | [32mExpert 16: 5.000(2882)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert 48: 4.600(2987)[0m | [32mExpert 11: 4.400(2867)[0m | 
[32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 15: 3.600(2879)[0m | 
[32mExpert 26: 3.600(2915)[0m | [32mExpert 37: 3.400(2951)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 17: 2.800(2885)[0m | 
[32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 41: 2.400(2966)[0m | [32mExpert 31: 2.200(2933)[0m | 
[32mExpert  9: 2.000(3047)[0m | [32mExpert 39: 2.000(2957)[0m | [32mExpert 47: 2.000(2984)[0m | [32mExpert 21: 1.800(2900)[0m | 
[32mExpert  7: 1.600(3041)[0m | [32mExpert  8: 1.600(3044)[0m | [32mExpert  1: 1.400(2861)[0m | [32mExpert 30: 1.400(2930)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2996, 2966, 2933, 3047, 2957, 2984, 2900, 3041, 3044, 2861, 2930]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  7,  8,  9, 21, 30, 31, 33, 39, 41, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:2.0 | [18]:4.0 | [29]:7.0 | [33]:5.0 | [44]:6.0 | [21]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[9]:7.0 | [15]:6.0 | [28]:6.0 | [33]:6.0 | [50]:2.0 | [30]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[4]:5.0 | [6]:7.0 | [16]:6.0 | [38]:9.0 | [49]:6.0 | [19]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[15]:4.0 | [16]:4.0 | [17]:5.0 | [24]:6.0 | [41]:7.0 | [14]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[15]:7.0 | [25]:6.0 | [40]:6.0 | [52]:4.0 | [55]:5.0 | [26]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[18]:6.0 | [30]:3.0 | [40]:5.0 | [46]:6.0 | [51]:4.0 | [53]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[18, 30, 40, 46, 51, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
[90mTop 20 Experts:[0m
[32mExpert 48: 7.400(4205)[0m | [32mExpert 17: 5.800(4103)[0m | [32mExpert 44: 5.800(4193)[0m | [32mExpert  9: 5.000(4265)[0m | 
[32mExpert 53: 5.000(4223)[0m | [32mExpert 21: 4.800(4118)[0m | [32mExpert 25: 4.800(4130)[0m | [32mExpert 12: 4.600(4088)[0m | 
[32mExpert 15: 4.600(4097)[0m | [32mExpert 14: 4.200(4094)[0m | [32mExpert 42: 4.200(4187)[0m | [32mExpert 56: 4.200(4232)[0m | 
[32mExpert 10: 4.000(4082)[0m | [32mExpert  6: 3.800(4244)[0m | [32mExpert 19: 3.800(4109)[0m | [32mExpert 28: 3.600(4139)[0m | 
[32mExpert 41: 3.400(4184)[0m | [32mExpert 54: 3.400(4226)[0m | [32mExpert  5: 3.200(4211)[0m | [32mExpert 61: 3.200(4250)[0m | 
[32mExpert 26: 3.000(4133)[0m | [32mExpert  0: 2.800(4076)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | 
[32mExpert 13: 2.400(4091)[0m | [32mExpert 23: 2.200(4124)[0m | [32mExpert 27: 2.200(4136)[0m | [32mExpert 52: 2.200(4220)[0m | 
[32mExpert  8: 2.200(4262)[0m | [32mExpert  1: 2.000(4079)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert 55: 1.800(4229)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4133, 4076, 4106, 4214, 4091, 4124, 4136, 4220, 4262, 4079, 4217, 4229]
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  8, 13, 18, 23, 26, 27, 50, 51, 52, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:6.0 | [24]:6.0 | [30]:2.0 | [41]:8.0 | [47]:5.0 | [19]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[15]:8.0 | [22]:4.0 | [25]:6.0 | [50]:5.0 | [53]:5.0 | [44]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[13]:4.0 | [14]:5.0 | [27]:3.0 | [30]:2.0 | [48]:8.0 | [54]:4.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E13 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:6.0 | [35]:2.0 | [40]:2.0 | [55]:8.0 | [60]:5.0 | [37]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[6]:4.0 | [7]:3.0 | [16]:6.0 | [22]:4.0 | [23]:5.0 | [57]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[12]:4.0 | [16]:7.0 | [22]:4.0 | [58]:3.0 | [61]:7.0 | [37]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[12, 16, 22, 58, 61, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:7.0 | [12]:4.0 | [23]:7.0 | [40]:1.0 | [57]:3.0 | [44]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[21]:1.0 | [26]:7.0 | [30]:4.0 | [34]:4.0 | [48]:5.0 | [9]:6.0 | 
---------------------------------------
return EAMC[2]

EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[31]:5.0 | [34]:2.0 | [47]:4.0 | [50]:5.0 | [57]:6.0 | [19]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[27]:3.0 | [38]:7.0 | [59]:4.0 | [62]:5.0 | [63]:9.0 | [37]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[0]:6.0 | [22]:5.0 | [46]:7.0 | [48]:5.0 | [60]:5.0 | [21]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[3]:4.0 | [13]:5.0 | [18]:6.0 | [34]:7.0 | [60]:4.0 | [22]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[12]:4.0 | [18]:5.0 | [39]:7.0 | [41]:6.0 | [50]:8.0 | [42]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[16]:4.0 | [37]:4.0 | [46]:7.0 | [50]:5.0 | [56]:7.0 | [35]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[16, 37, 46, 50, 56, 35]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.400(2743)[0m | [32mExpert 41: 6.000(2728)[0m | [32mExpert  7: 5.800(2803)[0m | [32mExpert 38: 5.800(2716)[0m | 
[32mExpert 63: 5.800(2800)[0m | [32mExpert 55: 5.200(2773)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 13: 4.200(2635)[0m | [32mExpert 17: 4.200(2647)[0m | [32mExpert 44: 4.200(2737)[0m | [32mExpert 10: 4.000(2626)[0m | 
[32mExpert 22: 3.600(2665)[0m | [32mExpert 29: 3.600(2686)[0m | [32mExpert 33: 3.400(2701)[0m | [32mExpert 16: 3.200(2644)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | [32mExpert 19: 2.800(2653)[0m | 
[32mExpert 35: 2.800(2707)[0m | [32mExpert  4: 2.800(2722)[0m | [32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | 
[32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 21: 2.000(2662)[0m | [32mExpert 32: 2.000(2698)[0m | 
[32mExpert 47: 1.800(2746)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 54: 1.800(2770)[0m | [32mExpert 31: 1.800(2695)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2722, 2755, 2680, 2806, 2623, 2662, 2698, 2746, 2758, 2770, 2695]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  4,  5,  8, 21, 27, 31, 32, 35, 47, 50, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:7.0 | [26]:5.0 | [38]:4.0 | [41]:7.0 | [50]:6.0 | [42]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[6]:5.0 | [8]:6.0 | [45]:6.0 | [46]:7.0 | [55]:3.0 | [25]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[19]:4.0 | [35]:4.0 | [38]:6.0 | [41]:7.0 | [46]:7.0 | [45]:6.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[17]:4.0 | [30]:7.0 | [41]:8.0 | [55]:5.0 | [60]:4.0 | [27]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[8]:4.0 | [28]:7.0 | [43]:7.0 | [47]:6.0 | [54]:6.0 | [60]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[7]:3.0 | [29]:7.0 | [41]:10.0 | [42]:5.0 | [46]:5.0 | [48]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 7, 29, 41, 42, 46, 48]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 8.000(2954)[0m | [32mExpert  6: 6.800(3026)[0m | [32mExpert  4: 6.600(2960)[0m | [32mExpert 49: 6.000(2990)[0m | 
[32mExpert 16: 5.800(2882)[0m | [32mExpert 14: 5.600(2876)[0m | [32mExpert 36: 5.400(2948)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert 48: 4.600(2987)[0m | [32mExpert 11: 4.400(2867)[0m | 
[32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 15: 3.600(2879)[0m | 
[32mExpert 26: 3.600(2915)[0m | [32mExpert 37: 3.400(2951)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 17: 2.800(2885)[0m | 
[32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 41: 2.400(2966)[0m | [32mExpert 31: 2.200(2933)[0m | 
[32mExpert  9: 2.000(3047)[0m | [32mExpert 19: 2.000(2891)[0m | [32mExpert 39: 2.000(2957)[0m | [32mExpert 47: 2.000(2984)[0m | 
[32mExpert 21: 1.800(2900)[0m | [32mExpert  7: 1.600(3041)[0m | [32mExpert  8: 1.600(3044)[0m | [32mExpert  1: 1.400(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2996, 2966, 2933, 3047, 2891, 2957, 2984, 2900, 3041, 3044, 2861]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  7,  8,  9, 19, 21, 31, 33, 39, 41, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[29]:8.0 | [30]:8.0 | [33]:6.0 | [41]:5.0 | [44]:7.0 | [1]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[9]:8.0 | [15]:7.0 | [28]:7.0 | [30]:6.0 | [33]:7.0 | [50]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[4]:6.0 | [6]:8.0 | [16]:7.0 | [38]:10.0 | [49]:7.0 | [19]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[15]:5.0 | [17]:6.0 | [24]:7.0 | [41]:8.0 | [44]:1.0 | [42]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[15]:8.0 | [25]:7.0 | [40]:7.0 | [52]:5.0 | [55]:6.0 | [49]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[18]:7.0 | [40]:6.0 | [46]:7.0 | [51]:5.0 | [53]:5.0 | [37]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[18, 40, 46, 51, 53, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
[90mTop 20 Experts:[0m
[32mExpert 48: 8.200(4205)[0m | [32mExpert 17: 5.800(4103)[0m | [32mExpert 44: 5.800(4193)[0m | [32mExpert  9: 5.000(4265)[0m | 
[32mExpert 14: 5.000(4094)[0m | [32mExpert 53: 5.000(4223)[0m | [32mExpert 21: 4.800(4118)[0m | [32mExpert 25: 4.800(4130)[0m | 
[32mExpert 12: 4.600(4088)[0m | [32mExpert 15: 4.600(4097)[0m | [32mExpert 42: 4.200(4187)[0m | [32mExpert 54: 4.200(4226)[0m | 
[32mExpert 56: 4.200(4232)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert  6: 3.800(4244)[0m | [32mExpert 19: 3.800(4109)[0m | 
[32mExpert 28: 3.600(4139)[0m | [32mExpert 41: 3.400(4184)[0m | [32mExpert  5: 3.200(4211)[0m | [32mExpert 13: 3.200(4091)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert 26: 3.000(4133)[0m | [32mExpert 27: 3.000(4136)[0m | [32mExpert  0: 2.800(4076)[0m | 
[32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert 23: 2.200(4124)[0m | [32mExpert 52: 2.200(4220)[0m | 
[32mExpert  8: 2.200(4262)[0m | [32mExpert  1: 2.000(4079)[0m | [32mExpert 30: 2.000(4148)[0m | [32mExpert 51: 2.000(4217)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4250, 4133, 4136, 4076, 4106, 4214, 4124, 4220, 4262, 4079, 4148, 4217]
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  8, 18, 23, 26, 27, 30, 50, 51, 52, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:5.0 | [14]:7.0 | [30]:3.0 | [41]:9.0 | [47]:6.0 | [32]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[7]:3.0 | [15]:9.0 | [22]:5.0 | [50]:6.0 | [53]:6.0 | [32]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[13]:5.0 | [14]:6.0 | [27]:4.0 | [30]:3.0 | [55]:3.0 | [40]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:7.0 | [35]:3.0 | [55]:9.0 | [60]:6.0 | [62]:6.0 | [50]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[7]:4.0 | [23]:6.0 | [38]:3.0 | [50]:6.0 | [57]:4.0 | [6]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[16]:8.0 | [22]:5.0 | [37]:4.0 | [60]:6.0 | [61]:8.0 | [25]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[16, 22, 37, 60, 61, 25]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:8.0 | [12]:5.0 | [23]:8.0 | [40]:2.0 | [44]:7.0 | [57]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[9]:7.0 | [26]:8.0 | [30]:5.0 | [34]:5.0 | [48]:6.0 | [0]:1.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:2.0 | [8]:5.0 | [33]:10.0 | [39]:2.0 | [61]:4.0 | [18]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[27]:4.0 | [35]:7.0 | [42]:4.0 | [60]:6.0 | [63]:10.0 | [20]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[3]:5.0 | [21]:6.0 | [29]:3.0 | [36]:4.0 | [43]:3.0 | [24]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[1]:5.0 | [14]:6.0 | [15]:3.0 | [48]:8.0 | [62]:6.0 | [28]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[7]:6.0 | [34]:5.0 | [35]:2.0 | [44]:5.0 | [61]:3.0 | [42]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[17]:6.0 | [20]:8.0 | [27]:4.0 | [29]:6.0 | [32]:6.0 | [48]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[17, 20, 27, 29, 32, 48]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.200(2743)[0m | [32mExpert 41: 6.800(2728)[0m | [32mExpert 38: 6.600(2716)[0m | [32mExpert  7: 5.800(2803)[0m | 
[32mExpert 63: 5.800(2800)[0m | [32mExpert 45: 5.400(2740)[0m | [32mExpert 55: 5.200(2773)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 13: 4.200(2635)[0m | [32mExpert 17: 4.200(2647)[0m | [32mExpert 44: 4.200(2737)[0m | [32mExpert 10: 4.000(2626)[0m | 
[32mExpert 19: 3.600(2653)[0m | [32mExpert 22: 3.600(2665)[0m | [32mExpert 29: 3.600(2686)[0m | [32mExpert 35: 3.600(2707)[0m | 
[32mExpert 33: 3.400(2701)[0m | [32mExpert 16: 3.200(2644)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert  9: 2.800(2809)[0m | 
[32mExpert 11: 2.800(2629)[0m | [32mExpert  4: 2.800(2722)[0m | [32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | 
[32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 21: 2.000(2662)[0m | [32mExpert 32: 2.000(2698)[0m | 
[32mExpert 47: 1.800(2746)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 54: 1.800(2770)[0m | [32mExpert 31: 1.800(2695)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2629, 2722, 2755, 2680, 2806, 2623, 2662, 2698, 2746, 2758, 2770, 2695]
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  4,  5,  8, 11, 21, 27, 31, 32, 47, 50, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:4.0 | [27]:6.0 | [28]:7.0 | [39]:6.0 | [47]:6.0 | [31]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[1]:3.0 | [11]:7.0 | [13]:6.0 | [30]:7.0 | [39]:6.0 | [44]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:6.0 | [34]:2.0 | [44]:5.0 | [55]:7.0 | [63]:6.0 | [10]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 10 MLP ==
[0m
[9]:6.0 | [16]:6.0 | [33]:15.0 | [45]:6.0 | [49]:6.0 | [10]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:10.0 | [30]:4.0 | [42]:6.0 | [52]:7.0 | [59]:5.0 | [16]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[18]:7.0 | [22]:6.0 | [31]:5.0 | [33]:4.0 | [45]:15.0 | [32]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[18, 22, 31, 33, 45, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 8.800(2954)[0m | [32mExpert  6: 7.600(3026)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 49: 6.800(2990)[0m | 
[32mExpert 16: 6.600(2882)[0m | [32mExpert 14: 5.600(2876)[0m | [32mExpert 36: 5.400(2948)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert 48: 4.600(2987)[0m | [32mExpert 11: 4.400(2867)[0m | 
[32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | [32mExpert 25: 3.800(2912)[0m | [32mExpert 15: 3.600(2879)[0m | 
[32mExpert 26: 3.600(2915)[0m | [32mExpert 37: 3.400(2951)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert 17: 2.800(2885)[0m | 
[32mExpert 19: 2.800(2891)[0m | [32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | [32mExpert 41: 2.400(2966)[0m | 
[32mExpert 31: 2.200(2933)[0m | [32mExpert  9: 2.000(3047)[0m | [32mExpert 39: 2.000(2957)[0m | [32mExpert 47: 2.000(2984)[0m | 
[32mExpert 21: 1.800(2900)[0m | [32mExpert  7: 1.600(3041)[0m | [32mExpert  8: 1.600(3044)[0m | [32mExpert  1: 1.400(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2891, 2939, 2996, 2966, 2933, 3047, 2957, 2984, 2900, 3041, 3044, 2861]
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  7,  8,  9, 19, 21, 31, 33, 39, 41, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[26]:6.0 | [36]:7.0 | [60]:1.0 | [61]:5.0 | [63]:8.0 | [35]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[22]:5.0 | [37]:3.0 | [46]:6.0 | [55]:6.0 | [59]:10.0 | [20]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[9]:3.0 | [25]:5.0 | [26]:5.0 | [36]:6.0 | [43]:2.0 | [32]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[18]:3.0 | [30]:11.0 | [40]:6.0 | [45]:2.0 | [60]:4.0 | [6]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[3]:5.0 | [10]:6.0 | [45]:4.0 | [50]:4.0 | [58]:4.0 | [19]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:6.0 | [9]:3.0 | [14]:4.0 | [49]:5.0 | [50]:8.0 | [10]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2,  9, 14, 49, 50, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 8.200(4205)[0m | [32mExpert 14: 5.800(4094)[0m | [32mExpert 17: 5.800(4103)[0m | [32mExpert 44: 5.800(4193)[0m | 
[32mExpert  9: 5.000(4265)[0m | [32mExpert 53: 5.000(4223)[0m | EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
[32mExpert 21: 4.800(4118)[0m | [32mExpert 25: 4.800(4130)[0m | 
[32mExpert 12: 4.600(4088)[0m | [32mExpert 15: 4.600(4097)[0m | [32mExpert 42: 4.200(4187)[0m | [32mExpert 54: 4.200(4226)[0m | 
[32mExpert 56: 4.200(4232)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert 13: 4.000(4091)[0m | [32mExpert  6: 3.800(4244)[0m | 
[32mExpert 19: 3.800(4109)[0m | [32mExpert 27: 3.800(4136)[0m | [32mExpert 28: 3.600(4139)[0m | [32mExpert 41: 3.400(4184)[0m | 
[32mExpert  5: 3.200(4211)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert 26: 3.000(4133)[0m | [32mExpert 30: 2.800(4148)[0m | 
[32mExpert  0: 2.800(4076)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 55: 2.600(4229)[0m | [32mExpert 50: 2.600(4214)[0m | 
[32mExpert 23: 2.200(4124)[0m | [32mExpert 52: 2.200(4220)[0m | [32mExpert  8: 2.200(4262)[0m | [32mExpert  1: 2.000(4079)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4211, 4250, 4133, 4148, 4076, 4106, 4229, 4214, 4124, 4220, 4262, 4079]
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  8, 18, 23, 26, 30, 50, 52, 55, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[12]:7.0 | [35]:2.0 | [38]:4.0 | [39]:6.0 | [49]:1.0 | [53]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[18]:4.0 | [27]:3.0 | [41]:5.0 | [54]:1.0 | [62]:5.0 | [63]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[26]:3.0 | [37]:2.0 | [41]:5.0 | [44]:8.0 | [52]:3.0 | [48]:9.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:10.0 | [42]:3.0 | [43]:3.0 | [49]:5.0 | [56]:4.0 | [9]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[1]:4.0 | [13]:5.0 | [46]:6.0 | [48]:1.0 | [54]:6.0 | [24]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[16]:9.0 | [24]:14.0 | [29]:1.0 | [36]:5.0 | [47]:3.0 | [19]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[16, 24, 29, 36, 47, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:6.0 | [7]:1.0 | [33]:6.0 | [54]:10.0 | [55]:3.0 | [3]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[17]:4.0 | [24]:1.0 | [38]:6.0 | [43]:6.0 | [48]:7.0 | [10]:6.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:2.0 | [12]:1.0 | [25]:1.0 | [51]:1.0 | [52]:5.0 | [54]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[0]:4.0 | [15]:6.0 | [38]:8.0 | [46]:3.0 | [47]:5.0 | [34]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[1]:3.0 | [9]:5.0 | [24]:3.0 | [45]:1.0 | [51]:4.0 | [22]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[16]:3.0 | [26]:3.0 | [29]:8.0 | [42]:4.0 | [57]:5.0 | [52]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[17]:3.0 | [27]:1.0 | [41]:7.0 | [56]:6.0 | [63]:3.0 | [10]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[12]:3.0 | [33]:5.0 | [34]:3.0 | [35]:4.0 | [55]:3.0 | [6]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[12, 33, 34, 35, 55,  6]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.200(2743)[0m | [32mExpert 41: 6.800(2728)[0m | [32mExpert  7: 6.600(2803)[0m | [32mExpert 38: 6.600(2716)[0m | 
[32mExpert 63: 6.600(2800)[0m | [32mExpert 55: 6.000(2773)[0m | [32mExpert 45: 5.400(2740)[0m | [32mExpert 44: 5.000(2737)[0m | 
[32mExpert 10: 4.800(2626)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 13: 4.200(2635)[0m | [32mExpert 17: 4.200(2647)[0m | 
[32mExpert 19: 3.600(2653)[0m | [32mExpert 22: 3.600(2665)[0m | [32mExpert 29: 3.600(2686)[0m | [32mExpert 35: 3.600(2707)[0m | 
[32mExpert 33: 3.400(2701)[0m | [32mExpert 16: 3.200(2644)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert  9: 2.800(2809)[0m | 
[32mExpert 11: 2.800(2629)[0m | [32mExpert  4: 2.800(2722)[0m | [32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | 
[32mExpert  8: 2.400(2806)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 34: 2.200(2704)[0m | [32mExpert 21: 2.000(2662)[0m | 
[32mExpert 32: 2.000(2698)[0m | [32mExpert 47: 1.800(2746)[0m | [32mExpert 50: 1.800(2758)[0m | [32mExpert 54: 1.800(2770)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2629, 2722, 2755, 2680, 2806, 2623, 2704, 2662, 2698, 2746, 2758, 2770]
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  4,  5,  8, 11, 21, 27, 32, 34, 47, 50, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:8.0 | [16]:2.0 | [32]:3.0 | [50]:7.0 | [55]:4.0 | [26]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[6]:6.0 | [12]:3.0 | [17]:9.0 | [22]:7.0 | [49]:6.0 | [40]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[8]:3.0 | [25]:1.0 | [33]:4.0 | [47]:3.0 | [50]:3.0 | [19]:5.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[3]:2.0 | [33]:16.0 | [39]:4.0 | [51]:5.0 | [59]:5.0 | [41]:9.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[0]:3.0 | [4]:3.0 | [5]:3.0 | [7]:3.0 | [53]:12.0 | [60]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[10]:2.0 | [41]:11.0 | [45]:16.0 | [57]:10.0 | [61]:1.0 | [12]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[10, 41, 45, 57, 61, 12]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 8.800(2954)[0m | [32mExpert  6: 7.600(3026)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 49: 6.800(2990)[0m | 
[32mExpert 16: 6.600(2882)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert 14: 5.600(2876)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert 25: 4.600(2912)[0m | [32mExpert 48: 4.600(2987)[0m | 
[32mExpert 11: 4.400(2867)[0m | [32mExpert 26: 4.400(2915)[0m | [32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | 
[32mExpert 15: 3.600(2879)[0m | [32mExpert 37: 3.400(2951)[0m | [32mExpert 61: 3.000(3032)[0m | [32mExpert  9: 2.800(3047)[0m | 
[32mExpert 17: 2.800(2885)[0m | [32mExpert 19: 2.800(2891)[0m | [32mExpert 33: 2.800(2939)[0m | [32mExpert 50: 2.600(2996)[0m | 
[32mExpert 41: 2.400(2966)[0m | [32mExpert 31: 2.200(2933)[0m | [32mExpert 39: 2.000(2957)[0m | [32mExpert 43: 2.000(2972)[0m | 
[32mExpert 47: 2.000(2984)[0m | [32mExpert 21: 1.800(2900)[0m | [32mExpert  7: 1.600(3041)[0m | [32mExpert  8: 1.600(3044)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2885, 2891, 2939, 2996, 2966, 2933, 2957, 2972, 2984, 2900, 3041, 3044]
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8, 17, 19, 21, 31, 33, 39, 41, 43, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[26]:7.0 | [31]:1.0 | [35]:8.0 | [45]:5.0 | [48]:7.0 | [18]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[0]:7.0 | [4]:1.0 | [57]:3.0 | [59]:11.0 | [63]:4.0 | [22]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[9]:4.0 | [30]:2.0 | [33]:3.0 | [34]:2.0 | [61]:4.0 | [50]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E50 â•‘[0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[24]:8.0 | [32]:7.0 | [38]:4.0 | [40]:7.0 | [59]:3.0 | [52]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[2]:3.0 | [15]:9.0 | [31]:4.0 | [42]:3.0 | [57]:5.0 | [1]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[9]:4.0 | [27]:1.0 | [40]:7.0 | [50]:9.0 | [63]:5.0 | [4]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 9, 27, 40, 50, 63,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 9.000(4205)[0m | [32mExpert 44: 6.600(4193)[0m | [32mExpert 14: 5.800(4094)[0m | [32mExpert 17: 5.800(4103)[0m | 
[32mExpert  9: 5.000(4265)[0m | [32mExpert 53: 5.000(4223)[0m | [32mExpert 21: 4.800(4118)[0m | [32mExpert 25: 4.800(4130)[0m | 
[32mExpert 12: 4.600(4088)[0m | [32mExpert 15: 4.600(4097)[0m | [32mExpert 41: 4.200(4184)[0m | [32mExpert 42: 4.200(4187)[0m | 
[32mExpert 54: 4.200(4226)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert 13: 4.000(4091)[0m | 
[32mExpert  6: 3.800(4244)[0m | [32mExpert 19: 3.800(4109)[0m | [32mExpert 26: 3.800(4133)[0m | [32mExpert 27: 3.800(4136)[0m | 
[32mExpert 28: 3.600(4139)[0m | [32mExpert  5: 3.200(4211)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert 52: 3.000(4220)[0m | 
[32mExpert 30: 2.800(4148)[0m | [32mExpert  0: 2.800(4076)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 55: 2.600(4229)[0m | 
[32mExpert 50: 2.600(4214)[0m | [32mExpert 23: 2.200(4124)[0m | [32mExpert 37: 2.200(4169)[0m | [32mExpert  8: 2.200(4262)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4139, 4211, 4250, 4220, 4148, 4076, 4106, 4229, 4214, 4124, 4169, 4262]
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  5,  8, 18, 23, 28, 30, 37, 50, 52, 55, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:6.0 | [17]:2.0 | [22]:7.0 | [32]:3.0 | [61]:4.0 | [5]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[7]:4.0 | [9]:2.0 | [27]:4.0 | [32]:6.0 | [33]:4.0 | [10]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[8]:2.0 | [12]:5.0 | [42]:5.0 | [44]:9.0 | [55]:4.0 | [35]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:4.0 | [6]:6.0 | [44]:6.0 | [50]:4.0 | [62]:7.0 | [10]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[12]:7.0 | [16]:7.0 | [25]:5.0 | [38]:4.0 | [50]:7.0 | [26]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[16]:10.0 | [25]:5.0 | [28]:2.0 | [50]:5.0 | [61]:9.0 | [26]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[16, 25, 28, 50, 61, 26]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[23]:9.0 | [42]:1.0 | [44]:8.0 | [45]:6.0 | [48]:2.0 | [39]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[9]:8.0 | [26]:9.0 | [34]:6.0 | [48]:8.0 | [54]:2.0 | [27]:5.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:6.0 | [20]:6.0 | [26]:7.0 | [31]:6.0 | [33]:11.0 | [46]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[6]:4.0 | [35]:8.0 | [44]:3.0 | [59]:5.0 | [63]:11.0 | [60]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[3]:6.0 | [17]:4.0 | [21]:7.0 | [27]:2.0 | [36]:5.0 | [14]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[1]:6.0 | [14]:7.0 | [28]:6.0 | [48]:9.0 | [62]:7.0 | [35]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[13]:4.0 | [34]:6.0 | [42]:8.0 | [44]:6.0 | [55]:3.0 | [2]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[17]:7.0 | [27]:5.0 | [29]:7.0 | [32]:7.0 | [41]:5.0 | [20]:9.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[17, 27, 29, 32, 41, 20]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.200(2743)[0m | [32mExpert 41: 6.800(2728)[0m | [32mExpert  7: 6.600(2803)[0m | [32mExpert 38: 6.600(2716)[0m | 
[32mExpert 63: 6.600(2800)[0m | [32mExpert 55: 6.000(2773)[0m | [32mExpert 45: 5.400(2740)[0m | [32mExpert 44: 5.000(2737)[0m | 
[32mExpert 10: 4.800(2626)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 19: 4.400(2653)[0m | [32mExpert 13: 4.200(2635)[0m | 
[32mExpert 17: 4.200(2647)[0m | [32mExpert 33: 4.200(2701)[0m | [32mExpert 22: 3.600(2665)[0m | [32mExpert 29: 3.600(2686)[0m | 
[32mExpert 35: 3.600(2707)[0m | [32mExpert  8: 3.200(2806)[0m | [32mExpert 16: 3.200(2644)[0m | [32mExpert 48: 3.000(2749)[0m | 
[32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | [32mExpert  4: 2.800(2722)[0m | [32mExpert  5: 2.600(2755)[0m | 
[32mExpert 27: 2.600(2680)[0m | [32mExpert 47: 2.600(2746)[0m | [32mExpert 50: 2.600(2758)[0m | [32mExpert  1: 2.200(2623)[0m | 
[32mExpert 34: 2.200(2704)[0m | [32mExpert 21: 2.000(2662)[0m | [32mExpert 32: 2.000(2698)[0m | [32mExpert 54: 1.800(2770)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2809, 2629, 2722, 2755, 2680, 2746, 2758, 2623, 2704, 2662, 2698, 2770]
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  4,  5,  9, 11, 21, 27, 32, 34, 47, 50, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:5.0 | [27]:7.0 | [31]:4.0 | [39]:7.0 | [47]:7.0 | [28]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[1]:4.0 | [4]:7.0 | [11]:8.0 | [13]:7.0 | [48]:4.0 | [44]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:7.0 | [10]:7.0 | [34]:3.0 | [55]:8.0 | [63]:7.0 | [60]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[9]:7.0 | [10]:4.0 | [16]:7.0 | [45]:7.0 | [49]:7.0 | [20]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:11.0 | [30]:5.0 | [42]:7.0 | [49]:5.0 | [52]:8.0 | [59]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[18]:8.0 | [22]:7.0 | [23]:6.0 | [31]:6.0 | [32]:4.0 | [52]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[18, 22, 23, 31, 32, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 8.800(2954)[0m | [32mExpert  6: 7.600(3026)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 49: 6.800(2990)[0m | 
[32mExpert 16: 6.600(2882)[0m | [32mExpert 36: 6.200(2948)[0m | [32mExpert 14: 5.600(2876)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert 25: 4.600(2912)[0m | [32mExpert 48: 4.600(2987)[0m | 
[32mExpert 11: 4.400(2867)[0m | [32mExpert 26: 4.400(2915)[0m | [32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | 
[32mExpert 61: 3.800(3032)[0m | [32mExpert  9: 3.600(3047)[0m | [32mExpert 15: 3.600(2879)[0m | [32mExpert 33: 3.600(2939)[0m | 
[32mExpert 37: 3.400(2951)[0m | [32mExpert 50: 3.400(2996)[0m | [32mExpert 17: 2.800(2885)[0m | [32mExpert 19: 2.800(2891)[0m | 
[32mExpert 41: 2.400(2966)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 31: 2.200(2933)[0m | [32mExpert 34: 2.200(2942)[0m | 
[32mExpert 39: 2.000(2957)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 47: 2.000(2984)[0m | [32mExpert 21: 1.800(2900)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2951, 2996, 2885, 2891, 2966, 2930, 2933, 2942, 2957, 2972, 2984, 2900]
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 17, 19, 21, 30, 31, 34, 37, 39, 41, 43, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[15]:5.0 | [26]:8.0 | [35]:9.0 | [61]:6.0 | [63]:9.0 | [45]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[19]:7.0 | [37]:4.0 | [46]:7.0 | [55]:7.0 | [59]:12.0 | [22]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[12]:2.0 | [26]:6.0 | [36]:7.0 | [37]:5.0 | [48]:6.0 | [14]:7.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[25]:2.0 | [32]:8.0 | [40]:8.0 | [45]:3.0 | [53]:5.0 | [60]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[3]:6.0 | [10]:7.0 | [23]:7.0 | [45]:5.0 | [58]:5.0 | [24]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:7.0 | [14]:5.0 | [49]:6.0 | [60]:2.0 | [63]:6.0 | [58]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2, 14, 49, 60, 63, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
[90mTop 20 Experts:[0m
[32mExpert 48: 9.000(4205)[0m | [32mExpert 44: 7.400(4193)[0m | [32mExpert 14: 5.800(4094)[0m | [32mExpert 17: 5.800(4103)[0m | 
[32mExpert 12: 5.400(4088)[0m | [32mExpert  9: 5.000(4265)[0m | [32mExpert 42: 5.000(4187)[0m | [32mExpert 53: 5.000(4223)[0m | 
[32mExpert 21: 4.800(4118)[0m | [32mExpert 25: 4.800(4130)[0m | [32mExpert 15: 4.600(4097)[0m | [32mExpert 41: 4.200(4184)[0m | 
[32mExpert 54: 4.200(4226)[0m | [32mExpert 56: 4.200(4232)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert 13: 4.000(4091)[0m | 
[32mExpert  6: 3.800(4244)[0m | [32mExpert 19: 3.800(4109)[0m | [32mExpert 26: 3.800(4133)[0m | [32mExpert 27: 3.800(4136)[0m | 
[32mExpert 28: 3.600(4139)[0m | [32mExpert 55: 3.400(4229)[0m | [32mExpert  5: 3.200(4211)[0m | [32mExpert 61: 3.200(4250)[0m | 
[32mExpert  8: 3.000(4262)[0m | [32mExpert 52: 3.000(4220)[0m | [32mExpert 30: 2.800(4148)[0m | [32mExpert  0: 2.800(4076)[0m | 
[32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert 23: 2.200(4124)[0m | [32mExpert 35: 2.200(4163)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4139, 4229, 4211, 4250, 4262, 4220, 4148, 4076, 4106, 4214, 4124, 4163]
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  5,  8, 18, 23, 28, 30, 35, 50, 52, 55, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:7.0 | [22]:8.0 | [38]:5.0 | [42]:5.0 | [49]:2.0 | [12]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[3]:5.0 | [18]:5.0 | [54]:2.0 | [60]:2.0 | [62]:6.0 | [27]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[13]:6.0 | [17]:7.0 | [26]:4.0 | [41]:6.0 | [52]:4.0 | [38]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[9]:3.0 | [20]:1.0 | [33]:10.0 | [43]:4.0 | [56]:5.0 | [42]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[13]:6.0 | [33]:1.0 | [46]:7.0 | [54]:7.0 | [58]:1.0 | [5]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[16]:11.0 | [18]:2.0 | [47]:4.0 | [58]:4.0 | [62]:5.0 | [19]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[16, 18, 47, 58, 62, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:3.0 | [6]:7.0 | [34]:3.0 | [46]:2.0 | [55]:4.0 | [3]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[17]:5.0 | [25]:2.0 | [38]:7.0 | [43]:7.0 | [48]:9.0 | [27]:6.0 | 
---------------------------------------
return EAMC[2]
Transformerã€RNNå’ŒEnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:2.0 | [24]:4.0 | [51]:2.0 | [52]:6.0 | [61]:5.0 | [9]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[15]:7.0 | [19]:5.0 | [34]:2.0 | [47]:6.0 | [48]:4.0 | [10]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[1]:4.0 | [4]:3.0 | [9]:6.0 | [16]:4.0 | [51]:5.0 | [54]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[16]:4.0 | [26]:4.0 | [29]:9.0 | [42]:5.0 | [57]:6.0 | [63]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[17]:4.0 | [24]:1.0 | [33]:4.0 | [56]:7.0 | [63]:4.0 | [57]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[11]:3.0 | [33]:6.0 | [34]:4.0 | [43]:3.0 | [55]:4.0 | [21]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[11, 33, 34, 43, 55, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 7.400(2803)[0m | [32mExpert 63: 7.400(2800)[0m | [32mExpert 46: 7.200(2743)[0m | [32mExpert 41: 6.800(2728)[0m | 
[32mExpert 55: 6.800(2773)[0m | [32mExpert 38: 6.600(2716)[0m | [32mExpert 10: 5.600(2626)[0m | [32mExpert 45: 5.400(2740)[0m | 
[32mExpert 44: 5.000(2737)[0m | [32mExpert 12: 4.400(2632)[0m | [32mExpert 19: 4.400(2653)[0m | [32mExpert 13: 4.200(2635)[0m | 
[32mExpert 17: 4.200(2647)[0m | [32mExpert 33: 4.200(2701)[0m | [32mExpert 22: 3.600(2665)[0m | [32mExpert 29: 3.600(2686)[0m | 
[32mExpert 35: 3.600(2707)[0m | [32mExpert  8: 3.200(2806)[0m | [32mExpert 16: 3.200(2644)[0m | [32mExpert 34: 3.000(2704)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | [32mExpert  4: 2.800(2722)[0m | 
[32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 47: 2.600(2746)[0m | [32mExpert 50: 2.600(2758)[0m | 
[32mExpert 60: 2.400(2791)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert 21: 2.000(2662)[0m | [32mExpert 32: 2.000(2698)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2749, 2809, 2629, 2722, 2755, 2680, 2746, 2758, 2791, 2623, 2662, 2698]
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  4,  5,  9, 11, 21, 27, 32, 47, 48, 50, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[20]:2.0 | [32]:4.0 | [40]:3.0 | [43]:7.0 | [55]:5.0 | [58]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[12]:4.0 | [17]:10.0 | [22]:8.0 | [33]:4.0 | [41]:2.0 | [62]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[2]:2.0 | [8]:4.0 | [17]:5.0 | [33]:5.0 | [47]:4.0 | [45]:7.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[3]:3.0 | [12]:3.0 | [33]:17.0 | [39]:5.0 | [51]:6.0 | [59]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[0]:4.0 | [4]:4.0 | [5]:4.0 | [7]:4.0 | [34]:3.0 | [60]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[12]:4.0 | [45]:17.0 | [47]:2.0 | [57]:11.0 | [61]:2.0 | [19]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[12, 45, 47, 57, 61, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 8.800(2954)[0m | [32mExpert  6: 7.600(3026)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 36: 7.000(2948)[0m | 
[32mExpert 49: 6.800(2990)[0m | [32mExpert 16: 6.600(2882)[0m | [32mExpert 14: 6.400(2876)[0m | [32mExpert 48: 5.400(2987)[0m | 
[32mExpert 26: 5.200(2915)[0m | [32mExpert 23: 5.000(2906)[0m | [32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | 
[32mExpert 25: 4.600(2912)[0m | [32mExpert 11: 4.400(2867)[0m | [32mExpert 37: 4.200(2951)[0m | [32mExpert 52: 4.000(3002)[0m | 
[32mExpert  0: 4.000(2858)[0m | [32mExpert 61: 3.800(3032)[0m | [32mExpert  9: 3.600(3047)[0m | [32mExpert 15: 3.600(2879)[0m | 
[32mExpert 33: 3.600(2939)[0m | [32mExpert 50: 3.400(2996)[0m | [32mExpert 17: 2.800(2885)[0m | [32mExpert 19: 2.800(2891)[0m | 
[32mExpert 41: 2.400(2966)[0m | [32mExpert 30: 2.200(2930)[0m | [32mExpert 31: 2.200(2933)[0m | [32mExpert 34: 2.200(2942)[0m | 
[32mExpert 39: 2.000(2957)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 47: 2.000(2984)[0m | [32mExpert 12: 1.800(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2939, 2996, 2885, 2891, 2966, 2930, 2933, 2942, 2957, 2972, 2984, 2870]
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 12, 17, 19, 30, 31, 33, 34, 39, 41, 43, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[18]:6.0 | [20]:2.0 | [23]:1.0 | [34]:4.0 | [45]:7.0 | [48]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[0]:8.0 | [4]:2.0 | [36]:3.0 | [57]:4.0 | [63]:5.0 | [47]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[30]:3.0 | [33]:4.0 | [34]:3.0 | [53]:2.0 | [61]:5.0 | [9]:5.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[24]:9.0 | [32]:9.0 | [38]:5.0 | [59]:4.0 | [60]:6.0 | [18]:4.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 17 MLP ==
[0m
[2]:4.0 | [15]:10.0 | [31]:5.0 | [42]:4.0 | [57]:6.0 | [60]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[9]:5.0 | [27]:2.0 | [28]:2.0 | [50]:10.0 | [63]:7.0 | [21]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 9, 27, 28, 50, 63, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 9.000(4205)[0m | [32mExpert 44: 7.400(4193)[0m | [32mExpert 17: 6.600(4103)[0m | [32mExpert 14: 5.800(4094)[0m | 
[32mExpert 12: 5.400(4088)[0m | [32mExpert  9: 5.000(4265)[0m | [32mExpert 41: 5.000(4184)[0m | [32mExpert 42: 5.000(4187)[0m | 
[32mExpert 53: 5.000(4223)[0m | [32mExpert 13: 4.800(4091)[0m | [32mExpert 21: 4.800(4118)[0m | [32mExpert 25: 4.800(4130)[0m | 
[32mExpert 15: 4.600(4097)[0m | [32mExpert 26: 4.600(4133)[0m | [32mExpert 54: 4.200(4226)[0m | [32mExpert 56: 4.200(4232)[0m | 
[32mExpert 10: 4.000(4082)[0m | [32mExpert  6: 3.800(4244)[0m | [32mExpert 19: 3.800(4109)[0m | [32mExpert 27: 3.800(4136)[0m | 
[32mExpert 52: 3.800(4220)[0m | [32mExpert 28: 3.600(4139)[0m | [32mExpert 55: 3.400(4229)[0m | [32mExpert  5: 3.200(4211)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert  8: 3.000(4262)[0m | [32mExpert 30: 2.800(4148)[0m | [32mExpert  0: 2.800(4076)[0m | 
[32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert 23: 2.200(4124)[0m | [32mExpert 35: 2.200(4163)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4220, 4139, 4229, 4211, 4250, 4262, 4148, 4076, 4106, 4214, 4124, 4163]
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  5,  8, 18, 23, 28, 30, 35, 50, 52, 55, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:7.0 | [22]:9.0 | [32]:4.0 | [42]:6.0 | [61]:5.0 | [58]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[7]:5.0 | [9]:3.0 | [30]:4.0 | [32]:7.0 | [33]:5.0 | [10]:9.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[12]:6.0 | [17]:8.0 | [35]:3.0 | [44]:10.0 | [55]:5.0 | [42]:6.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:5.0 | [6]:7.0 | [33]:11.0 | [50]:5.0 | [62]:8.0 | [44]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[12]:8.0 | [16]:8.0 | [25]:6.0 | [50]:8.0 | [61]:1.0 | [11]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[6]:6.0 | [16]:12.0 | [25]:6.0 | [50]:6.0 | [61]:10.0 | [28]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 6, 16, 25, 50, 61, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[23]:10.0 | [41]:4.0 | [44]:9.0 | [48]:3.0 | [59]:3.0 | [45]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[9]:9.0 | [26]:10.0 | [31]:3.0 | [51]:5.0 | [52]:3.0 | [48]:10.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 30
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[15]:4.0 | [26]:8.0 | [30]:2.0 | [33]:12.0 | [46]:4.0 | [8]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[1]:5.0 | [31]:3.0 | [35]:9.0 | [44]:4.0 | [60]:8.0 | [13]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[3]:7.0 | [14]:5.0 | [17]:5.0 | [49]:2.0 | [51]:6.0 | [62]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[2]:3.0 | [10]:3.0 | [14]:8.0 | [36]:4.0 | [37]:2.0 | [48]:10.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[9]:1.0 | [20]:3.0 | [42]:9.0 | [44]:7.0 | [52]:4.0 | [31]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[23]:3.0 | [27]:6.0 | [41]:6.0 | [48]:3.0 | [59]:4.0 | [32]:8.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[23, 27, 41, 48, 59, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 7.400(2803)[0m | [32mExpert 63: 7.400(2800)[0m | [32mExpert 46: 7.200(2743)[0m | [32mExpert 41: 6.800(2728)[0m | 
[32mExpert 55: 6.800(2773)[0m | [32mExpert 38: 6.600(2716)[0m | [32mExpert 45: 6.200(2740)[0m | [32mExpert 10: 5.600(2626)[0m | 
[32mExpert 17: 5.000(2647)[0m | [32mExpert 33: 5.000(2701)[0m | [32mExpert 44: 5.000(2737)[0m | [32mExpert 12: 4.400(2632)[0m | 
[32mExpert 19: 4.400(2653)[0m | [32mExpert 13: 4.200(2635)[0m | [32mExpert  8: 4.000(2806)[0m | [32mExpert 22: 3.600(2665)[0m | 
[32mExpert 29: 3.600(2686)[0m | [32mExpert 35: 3.600(2707)[0m | [32mExpert 47: 3.400(2746)[0m | [32mExpert 16: 3.200(2644)[0m | 
[32mExpert 34: 3.000(2704)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | 
[32mExpert  4: 2.800(2722)[0m | [32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 50: 2.600(2758)[0m | 
[32mExpert 60: 2.400(2791)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert  2: 2.000(2656)[0m | [32mExpert 21: 2.000(2662)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2749, 2809, 2629, 2722, 2755, 2680, 2758, 2791, 2623, 2656, 2662]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  4,  5,  9, 11, 21, 27, 34, 48, 50, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:4.0 | [11]:6.0 | [39]:8.0 | [46]:3.0 | [62]:4.0 | [34]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[13]:8.0 | [30]:8.0 | [47]:3.0 | [48]:5.0 | [52]:3.0 | [39]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[4]:3.0 | [10]:8.0 | [13]:4.0 | [16]:3.0 | [50]:4.0 | [32]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E4 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[14]:1.0 | [18]:4.0 | [25]:5.0 | [42]:4.0 | [61]:2.0 | [33]:18.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:12.0 | [34]:4.0 | [40]:2.0 | [49]:6.0 | [61]:2.0 | [58]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[4]:4.0 | [12]:5.0 | [23]:7.0 | [37]:6.0 | [45]:18.0 | [34]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 4, 12, 23, 37, 45, 34]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 8.800(2954)[0m | [32mExpert  6: 7.600(3026)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 36: 7.000(2948)[0m | 
[32mExpert 49: 6.800(2990)[0m | [32mExpert 16: 6.600(2882)[0m | [32mExpert 14: 6.400(2876)[0m | [32mExpert 48: 5.400(2987)[0m | 
[32mExpert 26: 5.200(2915)[0m | [32mExpert 23: 5.000(2906)[0m | [32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | 
[32mExpert 25: 4.600(2912)[0m | [32mExpert 61: 4.600(3032)[0m | [32mExpert  9: 4.400(3047)[0m | [32mExpert 11: 4.400(2867)[0m | 
[32mExpert 33: 4.400(2939)[0m | [32mExpert 37: 4.200(2951)[0m | [32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | 
[32mExpert 15: 3.600(2879)[0m | [32mExpert 50: 3.400(2996)[0m | [32mExpert 30: 3.000(2930)[0m | [32mExpert 34: 3.000(2942)[0m | 
[32mExpert 17: 2.800(2885)[0m | [32mExpert 19: 2.800(2891)[0m | [32mExpert 41: 2.400(2966)[0m | [32mExpert 31: 2.200(2933)[0m | 
[32mExpert 53: 2.200(3005)[0m | [32mExpert 39: 2.000(2957)[0m | [32mExpert 43: 2.000(2972)[0m | [32mExpert 47: 2.000(2984)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2879, 2996, 2930, 2942, 2885, 2891, 2966, 2933, 3005, 2957, 2972, 2984]
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 15, 17, 19, 30, 31, 34, 39, 41, 43, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:5.0 | [45]:8.0 | [48]:9.0 | [54]:4.0 | [58]:4.0 | [15]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[0]:9.0 | [7]:5.0 | [19]:8.0 | [27]:6.0 | [46]:8.0 | [47]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[11]:5.0 | [17]:4.0 | [26]:7.0 | [40]:2.0 | [47]:3.0 | [53]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E53 â•‘[0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[18]:5.0 | [32]:10.0 | [33]:5.0 | [37]:3.0 | [53]:6.0 | [9]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[9]:3.0 | [23]:8.0 | [26]:7.0 | [28]:4.0 | [29]:2.0 | [10]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:8.0 | [50]:11.0 | [56]:5.0 | [58]:5.0 | [63]:8.0 | [42]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2, 50, 56, 58, 63, 42]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 9.000(4205)[0m | [32mExpert 44: 8.200(4193)[0m | [32mExpert 17: 7.400(4103)[0m | [32mExpert 12: 6.200(4088)[0m | 
[32mExpert 14: 5.800(4094)[0m | [32mExpert 42: 5.800(4187)[0m | [32mExpert  9: 5.000(4265)[0m | [32mExpert 41: 5.000(4184)[0m | 
[32mExpert 53: 5.000(4223)[0m | [32mExpert 13: 4.800(4091)[0m | [32mExpert 21: 4.800(4118)[0m | [32mExpert 25: 4.800(4130)[0m | 
[32mExpert 15: 4.600(4097)[0m | [32mExpert 26: 4.600(4133)[0m | [32mExpert 54: 4.200(4226)[0m | [32mExpert 55: 4.200(4229)[0m | 
[32mExpert 56: 4.200(4232)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert  6: 3.800(4244)[0m | [32mExpert 19: 3.800(4109)[0m | 
[32mExpert 27: 3.800(4136)[0m | [32mExpert 52: 3.800(4220)[0m | [32mExpert 28: 3.600(4139)[0m | [32mExpert  5: 3.200(4211)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert  8: 3.000(4262)[0m | [32mExpert 35: 3.000(4163)[0m | [32mExpert 30: 2.800(4148)[0m | 
[32mExpert  0: 2.800(4076)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert 23: 2.200(4124)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4136, 4220, 4139, 4211, 4250, 4262, 4163, 4148, 4076, 4106, 4214, 4124]
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  5,  8, 18, 23, 27, 28, 30, 35, 50, 52, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:7.0 | [22]:10.0 | [40]:5.0 | [42]:7.0 | [58]:7.0 | [60]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[3]:6.0 | [13]:5.0 | [18]:6.0 | [38]:4.0 | [60]:3.0 | [1]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[2]:2.0 | [15]:4.0 | [17]:9.0 | [21]:6.0 | [58]:2.0 | [56]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 22 MLP ==
[0m
[3]:3.0 | [6]:8.0 | [11]:6.0 | [32]:3.0 | [49]:6.0 | [58]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[3]:6.0 | [9]:3.0 | [45]:6.0 | [47]:6.0 | [54]:8.0 | [58]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[8]:2.0 | [10]:5.0 | [32]:2.0 | [33]:3.0 | [47]:5.0 | [0]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 8, 10, 32, 33, 47,  0]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:8.0 | [19]:3.0 | [38]:7.0 | [52]:6.0 | [62]:3.0 | [46]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[11]:6.0 | [17]:6.0 | [45]:2.0 | [57]:9.0 | [59]:4.0 | [62]:3.0 | 
---------------------------------------
return EAMC[2]
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:8.0 | [15]:5.0 | [28]:2.0 | [33]:13.0 | [50]:6.0 | [26]:9.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[10]:6.0 | [11]:3.0 | [21]:2.0 | [29]:3.0 | [38]:9.0 | [2]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[3]:8.0 | [10]:3.0 | [17]:6.0 | [36]:6.0 | [42]:5.0 | [29]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[14]:9.0 | [36]:5.0 | [46]:2.0 | [48]:11.0 | [62]:8.0 | [28]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[2]:6.0 | [7]:7.0 | [20]:4.0 | [34]:7.0 | [55]:4.0 | [13]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[1]:3.0 | [17]:8.0 | [29]:8.0 | [32]:9.0 | [59]:5.0 | [13]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 1, 17, 29, 32, 59, 13]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 7.400(2803)[0m | [32mExpert 63: 7.400(2800)[0m | [32mExpert 46: 7.200(2743)[0m | [32mExpert 41: 6.800(2728)[0m | 
[32mExpert 55: 6.800(2773)[0m | [32mExpert 38: 6.600(2716)[0m | [32mExpert 10: 6.400(2626)[0m | [32mExpert 45: 6.200(2740)[0m | 
[32mExpert 13: 5.000(2635)[0m | [32mExpert 17: 5.000(2647)[0m | [32mExpert 33: 5.000(2701)[0m | [32mExpert 44: 5.000(2737)[0m | 
[32mExpert 12: 4.400(2632)[0m | [32mExpert 19: 4.400(2653)[0m | [32mExpert  8: 4.000(2806)[0m | [32mExpert 16: 4.000(2644)[0m | 
[32mExpert  4: 3.600(2722)[0m | [32mExpert 22: 3.600(2665)[0m | [32mExpert 29: 3.600(2686)[0m | [32mExpert 35: 3.600(2707)[0m | 
[32mExpert 47: 3.400(2746)[0m | [32mExpert 50: 3.400(2758)[0m | [32mExpert 34: 3.000(2704)[0m | [32mExpert 48: 3.000(2749)[0m | 
[32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | [32mExpert 32: 2.800(2698)[0m | [32mExpert  5: 2.600(2755)[0m | 
[32mExpert 27: 2.600(2680)[0m | [32mExpert 60: 2.400(2791)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert  2: 2.000(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2746, 2758, 2704, 2749, 2809, 2629, 2698, 2755, 2680, 2791, 2623, 2656]
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  5,  9, 11, 27, 32, 34, 47, 48, 50, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:7.0 | [27]:8.0 | [28]:9.0 | [39]:9.0 | [47]:8.0 | [31]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[1]:5.0 | [11]:9.0 | [13]:9.0 | [30]:9.0 | [48]:6.0 | [4]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:8.0 | [10]:9.0 | [12]:5.0 | [34]:4.0 | [63]:8.0 | [60]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E60 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[9]:8.0 | [16]:8.0 | [20]:6.0 | [45]:8.0 | [49]:8.0 | [10]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:13.0 | [30]:6.0 | [42]:8.0 | [52]:9.0 | [59]:7.0 | [49]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[18]:9.0 | [22]:8.0 | [23]:8.0 | [31]:7.0 | [52]:4.0 | [21]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[18, 22, 23, 31, 52, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 8.800(2954)[0m | [32mExpert  6: 7.600(3026)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 36: 7.000(2948)[0m | 
[32mExpert 49: 6.800(2990)[0m | [32mExpert 16: 6.600(2882)[0m | [32mExpert 14: 6.400(2876)[0m | [32mExpert 26: 6.000(2915)[0m | 
[32mExpert 48: 5.400(2987)[0m | [32mExpert 11: 5.200(2867)[0m | [32mExpert 23: 5.000(2906)[0m | [32mExpert 55: 5.000(3011)[0m | 
[32mExpert  5: 4.600(2993)[0m | [32mExpert 25: 4.600(2912)[0m | [32mExpert 61: 4.600(3032)[0m | [32mExpert  9: 4.400(3047)[0m | 
[32mExpert 33: 4.400(2939)[0m | [32mExpert 37: 4.200(2951)[0m | [32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | 
[32mExpert 15: 3.600(2879)[0m | [32mExpert 17: 3.600(2885)[0m | [32mExpert 50: 3.400(2996)[0m | [32mExpert 30: 3.000(2930)[0m | 
[32mExpert 34: 3.000(2942)[0m | [32mExpert 53: 3.000(3005)[0m | [32mExpert 19: 2.800(2891)[0m | [32mExpert 47: 2.800(2984)[0m | 
[32mExpert 41: 2.400(2966)[0m | [32mExpert 31: 2.200(2933)[0m | [32mExpert 39: 2.000(2957)[0m | [32mExpert 43: 2.000(2972)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2879, 2885, 2996, 2930, 2942, 3005, 2891, 2984, 2966, 2933, 2957, 2972]
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 15, 17, 19, 30, 31, 34, 39, 41, 43, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[15]:7.0 | [26]:9.0 | [60]:2.0 | [61]:7.0 | [63]:10.0 | [53]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[22]:8.0 | [39]:1.0 | [46]:9.0 | [55]:8.0 | [59]:13.0 | [37]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[12]:3.0 | [25]:6.0 | [26]:8.0 | [43]:3.0 | [62]:1.0 | [36]:8.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E43 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[0]:1.0 | [25]:3.0 | [32]:11.0 | [45]:4.0 | [57]:4.0 | [41]:9.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[3]:7.0 | [8]:1.0 | [10]:9.0 | [13]:2.0 | [58]:6.0 | [14]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[2]:9.0 | [20]:1.0 | [45]:1.0 | [49]:7.0 | [60]:3.0 | [11]:1.0 | EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4112
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1305,20000002b] (16MB) STATE(0) TENSOR[4111,4112,4110,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12

---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 2, 20, 45, 49, 60, 11]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 9.000(4205)[0m | [32mExpert 17: 8.200(4103)[0m | [32mExpert 44: 8.200(4193)[0m | [32mExpert 12: 6.200(4088)[0m | 
[32mExpert 14: 5.800(4094)[0m | [32mExpert 42: 5.800(4187)[0m | [32mExpert 21: 5.600(4118)[0m | [32mExpert 15: 5.400(4097)[0m | 
[32mExpert  9: 5.000(4265)[0m | [32mExpert 41: 5.000(4184)[0m | [32mExpert 53: 5.000(4223)[0m | [32mExpert 56: 5.000(4232)[0m | 
[32mExpert 13: 4.800(4091)[0m | [32mExpert 25: 4.800(4130)[0m | [32mExpert 26: 4.600(4133)[0m | [32mExpert 54: 4.200(4226)[0m | 
[32mExpert 55: 4.200(4229)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert  6: 3.800(4244)[0m | [32mExpert 19: 3.800(4109)[0m | 
[32mExpert 27: 3.800(4136)[0m | [32mExpert 52: 3.800(4220)[0m | [32mExpert 28: 3.600(4139)[0m | [32mExpert  5: 3.200(4211)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert  8: 3.000(4262)[0m | [32mExpert 35: 3.000(4163)[0m | [32mExpert 30: 2.800(4148)[0m | 
[32mExpert  0: 2.800(4076)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | [32mExpert  2: 2.200(4112)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4136, 4220, 4139, 4211, 4250, 4262, 4163, 4148, 4076, 4106, 4214, 4112]
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4112[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  2,  5,  8, 18, 27, 28, 30, 35, 50, 52, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:8.0 | [38]:6.0 | [41]:10.0 | [42]:8.0 | [49]:3.0 | [45]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[0]:1.0 | [3]:7.0 | [15]:10.0 | [24]:1.0 | [54]:3.0 | [41]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[0]:3.0 | [26]:5.0 | [37]:3.0 | [41]:7.0 | [52]:5.0 | [32]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:11.0 | [19]:1.0 | [27]:1.0 | [39]:1.0 | [56]:6.0 | [22]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[1]:5.0 | [5]:6.0 | [24]:2.0 | [46]:8.0 | [54]:9.0 | [19]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[16]:13.0 | [24]:15.0 | [29]:2.0 | [44]:4.0 | [45]:5.0 | [25]:7.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[16, 24, 29, 44, 45, 25]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:9.0 | [7]:2.0 | [13]:3.0 | [28]:2.0 | [33]:7.0 | [34]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[10]:7.0 | [24]:2.0 | [38]:8.0 | [40]:1.0 | [48]:11.0 | [39]:3.0 | 
---------------------------------------
return EAMC[2]
GNNåœ¨EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2623
[1m[33mEnqueueTask: [0m[32mTask: node: ID[524,100000013] (16MB) STATE(0) TENSOR[2622,2623,2621,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2656
[1m[33mEnqueueTask: [0m[32mTask: node: ID[525,200000013] (16MB) STATE(0) TENSOR[2655,2656,2654,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 30
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:3.0 | [24]:5.0 | [27]:5.0 | [54]:4.0 | [60]:4.0 | [19]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[5]:2.0 | [10]:7.0 | [15]:8.0 | [19]:6.0 | [47]:7.0 | [37]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[4]:4.0 | [18]:4.0 | [19]:2.0 | [30]:2.0 | [47]:3.0 | [60]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[17]:2.0 | [29]:10.0 | [38]:2.0 | [42]:6.0 | [57]:7.0 | [8]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[36]:3.0 | [48]:3.0 | [56]:8.0 | [60]:2.0 | [62]:3.0 | [33]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[24]:4.0 | [40]:1.0 | [43]:4.0 | [49]:2.0 | [58]:2.0 | [61]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[24, 40, 43, 49, 58, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 8.200(2803)[0m | [32mExpert 63: 8.200(2800)[0m | [32mExpert 10: 7.200(2626)[0m | [32mExpert 46: 7.200(2743)[0m | 
[32mExpert 41: 6.800(2728)[0m | [32mExpert 55: 6.800(2773)[0m | [32mExpert 38: 6.600(2716)[0m | [32mExpert 45: 6.200(2740)[0m | 
[32mExpert 12: 5.200(2632)[0m | [32mExpert 13: 5.000(2635)[0m | [32mExpert 17: 5.000(2647)[0m | [32mExpert 33: 5.000(2701)[0m | 
[32mExpert 44: 5.000(2737)[0m | [32mExpert 19: 4.400(2653)[0m | [32mExpert  8: 4.000(2806)[0m | [32mExpert 16: 4.000(2644)[0m | 
[32mExpert 34: 3.800(2704)[0m | [32mExpert  4: 3.600(2722)[0m | [32mExpert 22: 3.600(2665)[0m | [32mExpert 29: 3.600(2686)[0m | 
[32mExpert 35: 3.600(2707)[0m | [32mExpert 47: 3.400(2746)[0m | [32mExpert 50: 3.400(2758)[0m | [32mExpert 60: 3.200(2791)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | [32mExpert 32: 2.800(2698)[0m | 
[32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert  1: 2.200(2623)[0m | [32mExpert  2: 2.000(2656)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2746, 2758, 2791, 2749, 2809, 2629, 2698, 2755, 2680, 2623, 2656]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2623[0m â†’ GPU 0
Prefetching [1;36mTensor 2656[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  1,  2,  5,  9, 11, 27, 32, 35, 47, 48, 50, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[12]:3.0 | [26]:7.0 | [51]:3.0 | [52]:3.0 | [54]:5.0 | [56]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[17]:11.0 | [22]:9.0 | [34]:3.0 | [41]:3.0 | [60]:3.0 | [40]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[20]:1.0 | [29]:5.0 | [39]:3.0 | [47]:5.0 | [54]:3.0 | [18]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[6]:2.0 | [24]:2.0 | [26]:2.0 | [33]:19.0 | [62]:1.0 | [63]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[19]:1.0 | [45]:2.0 | [50]:3.0 | [51]:3.0 | [53]:13.0 | [54]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[2]:3.0 | [24]:1.0 | [39]:1.0 | [43]:3.0 | [45]:19.0 | [55]:3.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 2, 24, 39, 43, 45, 55]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 8.800(2954)[0m | [32mExpert 36: 7.800(2948)[0m | [32mExpert  6: 7.600(3026)[0m | [32mExpert  4: 7.400(2960)[0m | 
[32mExpert 26: 6.800(2915)[0m | [32mExpert 49: 6.800(2990)[0m | [32mExpert 16: 6.600(2882)[0m | [32mExpert 14: 6.400(2876)[0m | 
[32mExpert 25: 5.400(2912)[0m | [32mExpert 48: 5.400(2987)[0m | [32mExpert 11: 5.200(2867)[0m | [32mExpert 23: 5.000(2906)[0m | 
[32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | [32mExpert 61: 4.600(3032)[0m | [32mExpert  9: 4.400(3047)[0m | 
[32mExpert 33: 4.400(2939)[0m | [32mExpert 37: 4.200(2951)[0m | [32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | 
[32mExpert 15: 3.600(2879)[0m | [32mExpert 17: 3.600(2885)[0m | [32mExpert 50: 3.400(2996)[0m | [32mExpert 30: 3.000(2930)[0m | 
[32mExpert 34: 3.000(2942)[0m | [32mExpert 53: 3.000(3005)[0m | [32mExpert 19: 2.800(2891)[0m | [32mExpert 43: 2.800(2972)[0m | 
[32mExpert 47: 2.800(2984)[0m | [32mExpert 12: 2.600(2870)[0m | [32mExpert 41: 2.400(2966)[0m | [32mExpert 31: 2.200(2933)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2879, 2885, 2996, 2930, 2942, 3005, 2891, 2972, 2984, 2870, 2966, 2933]
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 12, 15, 17, 19, 30, 31, 34, 41, 43, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[7]:2.0 | [12]:1.0 | [19]:1.0 | [30]:9.0 | [41]:6.0 | [6]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[13]:2.0 | [22]:9.0 | [29]:2.0 | [30]:7.0 | [59]:14.0 | [1]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[2]:2.0 | [6]:9.0 | [9]:6.0 | [21]:3.0 | [38]:11.0 | [61]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[0]:2.0 | [31]:2.0 | [35]:4.0 | [48]:6.0 | [57]:5.0 | [12]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[1]:4.0 | [4]:1.0 | [12]:1.0 | [34]:1.0 | [53]:2.0 | [16]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[9]:6.0 | [27]:3.0 | [31]:2.0 | [40]:8.0 | [44]:3.0 | [63]:9.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 9, 27, 31, 40, 44, 63]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 9.000(4205)[0m | [32mExpert 17: 8.200(4103)[0m | [32mExpert 44: 8.200(4193)[0m | [32mExpert 12: 6.200(4088)[0m | 
[32mExpert 14: 5.800(4094)[0m | [32mExpert 41: 5.800(4184)[0m | EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[32mExpert 42: 5.800(4187)[0m | [32mExpert 21: 5.600(4118)[0m | 
[32mExpert 15: 5.400(4097)[0m | [32mExpert 26: 5.400(4133)[0m | [32mExpert  9: 5.000(4265)[0m | [32mExpert 53: 5.000(4223)[0m | 
[32mExpert 56: 5.000(4232)[0m | [32mExpert 13: 4.800(4091)[0m | [32mExpert 25: 4.800(4130)[0m | [32mExpert 52: 4.600(4220)[0m | 
[32mExpert 54: 4.200(4226)[0m | [32mExpert 55: 4.200(4229)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert  6: 3.800(4244)[0m | 
[32mExpert 19: 3.800(4109)[0m | [32mExpert 27: 3.800(4136)[0m | [32mExpert  0: 3.600(4076)[0m | [32mExpert 28: 3.600(4139)[0m | 
[32mExpert  5: 3.200(4211)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert  8: 3.000(4262)[0m | [32mExpert 35: 3.000(4163)[0m | 
[32mExpert 37: 3.000(4169)[0m | [32mExpert 30: 2.800(4148)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4109, 4136, 4076, 4139, 4211, 4250, 4262, 4163, 4169, 4148, 4106, 4214]
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  5,  8, 18, 19, 27, 28, 30, 35, 37, 50, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:8.0 | [17]:3.0 | [32]:5.0 | [33]:3.0 | [41]:11.0 | [21]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[3]:8.0 | [7]:6.0 | [32]:8.0 | [33]:6.0 | [59]:2.0 | [28]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[6]:5.0 | [12]:7.0 | [39]:2.0 | [44]:11.0 | [63]:2.0 | [8]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[6]:9.0 | [34]:5.0 | [35]:4.0 | [41]:3.0 | [62]:9.0 | [4]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[4]:1.0 | [21]:4.0 | [34]:4.0 | [50]:9.0 | [55]:1.0 | [12]:9.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[1]:3.0 | [16]:14.0 | [22]:6.0 | [44]:5.0 | [48]:2.0 | [25]:8.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 1, 16, 22, 44, 48, 25]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[23]:11.0 | [26]:1.0 | [41]:5.0 | [44]:10.0 | [59]:4.0 | [50]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[9]:10.0 | [15]:2.0 | [26]:11.0 | [31]:4.0 | [48]:12.0 | [33]:1.0 | 
---------------------------------------
return EAMC[2]
æ—¶EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2719
[1m[33mEnqueueTask: [0m[32mTask: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 31

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[20]:7.0 | [33]:14.0 | [42]:2.0 | [47]:5.0 | [59]:2.0 | [18]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[23]:2.0 | [25]:5.0 | [31]:4.0 | [37]:6.0 | [60]:9.0 | [18]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[8]:4.0 | [14]:6.0 | [16]:5.0 | [23]:3.0 | [32]:2.0 | [19]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[2]:4.0 | [5]:2.0 | [7]:4.0 | [19]:3.0 | [48]:12.0 | [58]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[4]:4.0 | [11]:3.0 | [29]:2.0 | [44]:8.0 | [55]:5.0 | [47]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[1]:4.0 | [20]:10.0 | [22]:3.0 | [26]:3.0 | [57]:3.0 | [25]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 1, 20, 22, 26, 57, 25]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 8.200(2803)[0m | [32mExpert 63: 8.200(2800)[0m | [32mExpert 10: 7.200(2626)[0m | [32mExpert 46: 7.200(2743)[0m | 
[32mExpert 41: 6.800(2728)[0m | [32mExpert 55: 6.800(2773)[0m | [32mExpert 38: 6.600(2716)[0m | [32mExpert 45: 6.200(2740)[0m | 
[32mExpert 12: 5.200(2632)[0m | [32mExpert 13: 5.000(2635)[0m | [32mExpert 17: 5.000(2647)[0m | [32mExpert 33: 5.000(2701)[0m | 
[32mExpert 44: 5.000(2737)[0m | [32mExpert 19: 4.400(2653)[0m | [32mExpert 29: 4.400(2686)[0m | [32mExpert 47: 4.200(2746)[0m | 
[32mExpert  8: 4.000(2806)[0m | [32mExpert 16: 4.000(2644)[0m | [32mExpert 34: 3.800(2704)[0m | [32mExpert  4: 3.600(2722)[0m | 
[32mExpert 22: 3.600(2665)[0m | [32mExpert 35: 3.600(2707)[0m | [32mExpert 50: 3.400(2758)[0m | [32mExpert 60: 3.200(2791)[0m | 
[32mExpert 48: 3.000(2749)[0m | [32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | [32mExpert 32: 2.800(2698)[0m | 
[32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 54: 2.600(2770)[0m | [32mExpert 39: 2.400(2719)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2665, 2707, 2758, 2791, 2749, 2809, 2629, 2698, 2755, 2680, 2770, 2719]
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2719[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5,  9, 11, 22, 27, 32, 35, 39, 48, 50, 54, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:5.0 | [34]:5.0 | [35]:3.0 | [44]:5.0 | [46]:4.0 | [63]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[28]:2.0 | [30]:10.0 | [39]:8.0 | [40]:9.0 | [47]:4.0 | [16]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[13]:5.0 | [16]:4.0 | [17]:6.0 | [19]:6.0 | [32]:3.0 | [23]:1.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[18]:5.0 | [25]:6.0 | [27]:3.0 | [33]:20.0 | [59]:7.0 | [13]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:14.0 | [10]:4.0 | [11]:2.0 | [17]:4.0 | [22]:3.0 | [40]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[3]:6.0 | [4]:5.0 | [12]:6.0 | [45]:20.0 | [59]:4.0 | [50]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 3,  4, 12, 45, 59, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 9.600(2954)[0m | [32mExpert  6: 8.400(3026)[0m | [32mExpert 36: 7.800(2948)[0m | [32mExpert  4: 7.400(2960)[0m | 
[32mExpert 26: 6.800(2915)[0m | [32mExpert 49: 6.800(2990)[0m | [32mExpert 16: 6.600(2882)[0m | [32mExpert 14: 6.400(2876)[0m | 
[32mExpert 25: 5.400(2912)[0m | [32mExpert 48: 5.400(2987)[0m | [32mExpert 61: 5.400(3032)[0m | [32mExpert  9: 5.200(3047)[0m | 
[32mExpert 11: 5.200(2867)[0m | [32mExpert 23: 5.000(2906)[0m | [32mExpert 55: 5.000(3011)[0m | [32mExpert  5: 4.600(2993)[0m | 
[32mExpert 33: 4.400(2939)[0m | [32mExpert 37: 4.200(2951)[0m | [32mExpert 52: 4.000(3002)[0m | [32mExpert  0: 4.000(2858)[0m | 
[32mExpert 15: 3.600(2879)[0m | [32mExpert 17: 3.600(2885)[0m | [32mExpert 50: 3.400(2996)[0m | [32mExpert 30: 3.000(2930)[0m | 
[32mExpert 34: 3.000(2942)[0m | [32mExpert 53: 3.000(3005)[0m | [32mExpert 19: 2.800(2891)[0m | [32mExpert 43: 2.800(2972)[0m | 
[32mExpert 47: 2.800(2984)[0m | [32mExpert 12: 2.600(2870)[0m | [32mExpert 21: 2.600(2900)[0m | [32mExpert 41: 2.400(2966)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2879, 2885, 2996, 2930, 2942, 3005, 2891, 2972, 2984, 2870, 2900, 2966]
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15: 12, 15, 17, 19, 21, 30, 34, 41, 43, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[34]:5.0 | [45]:9.0 | [48]:10.0 | [54]:5.0 | [58]:5.0 | [35]:10.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[7]:6.0 | [18]:4.0 | [27]:7.0 | [31]:2.0 | [61]:3.0 | [19]:9.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[14]:8.0 | [17]:5.0 | [31]:3.0 | [37]:6.0 | [49]:8.0 | [41]:3.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[3]:2.0 | [8]:3.0 | [19]:2.0 | [33]:6.0 | [49]:5.0 | [12]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[5]:4.0 | [24]:7.0 | [27]:3.0 | [43]:5.0 | [48]:3.0 | [26]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[1]:5.0 | [19]:5.0 | [24]:3.0 | [36]:4.0 | [56]:6.0 | [59]:4.0EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 1, 19, 24, 36, 56, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 44: 9.000(4193)[0m | [32mExpert 48: 9.000(4205)[0m | [32mExpert 17: 8.200(4103)[0m | [32mExpert 12: 7.000(4088)[0m | 
[32mExpert 14: 5.800(4094)[0m | [32mExpert 41: 5.800(4184)[0m | [32mExpert 42: 5.800(4187)[0m | [32mExpert 21: 5.600(4118)[0m | 
[32mExpert 15: 5.400(4097)[0m | [32mExpert 26: 5.400(4133)[0m | [32mExpert  9: 5.000(4265)[0m | [32mExpert 53: 5.000(4223)[0m | 
[32mExpert 56: 5.000(4232)[0m | [32mExpert 13: 4.800(4091)[0m | [32mExpert 25: 4.800(4130)[0m | [32mExpert  6: 4.600(4244)[0m | 
[32mExpert 52: 4.600(4220)[0m | [32mExpert 54: 4.200(4226)[0m | [32mExpert 55: 4.200(4229)[0m | [32mExpert 10: 4.000(4082)[0m | 
[32mExpert  8: 3.800(4262)[0m | [32mExpert 19: 3.800(4109)[0m | [32mExpert 27: 3.800(4136)[0m | [32mExpert  0: 3.600(4076)[0m | 
[32mExpert 28: 3.600(4139)[0m | [32mExpert  5: 3.200(4211)[0m | [32mExpert 61: 3.200(4250)[0m | [32mExpert 35: 3.000(4163)[0m | 
[32mExpert 37: 3.000(4169)[0m | [32mExpert 30: 2.800(4148)[0m | [32mExpert 18: 2.800(4106)[0m | [32mExpert 50: 2.600(4214)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4262, 4109, 4136, 4076, 4139, 4211, 4250, 4163, 4169, 4148, 4106, 4214]
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  5,  8, 18, 19, 27, 28, 30, 35, 37, 50, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[24]:7.0 | [29]:3.0 | [40]:6.0 | [42]:9.0 | [63]:3.0 | [44]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[1]:5.0 | [20]:4.0 | [38]:5.0 | [48]:3.0 | [58]:4.0 | [13]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[1]:3.0 | [5]:4.0 | [15]:5.0 | [28]:4.0 | [50]:3.0 | [6]:6.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E28 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[4]:4.0 | [14]:2.0 | [32]:4.0 | [54]:2.0 | [58]:5.0 | [31]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[8]:5.0 | [27]:2.0 | [29]:3.0 | [62]:4.0 | [63]:2.0 | [34]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[1]:4.0 | [35]:3.0 | [47]:6.0 | [56]:2.0 | [62]:6.0 | [30]:5.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[ 1, 35, 47, 56, 62, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[16]:2.0 | [33]:8.0 | [38]:8.0 | [46]:4.0 | [61]:5.0 | [35]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[13]:3.0 | [14]:4.0 | [35]:2.0 | [47]:3.0 | [63]:8.0 | [19]:2.0 | 
---------------------------------------
return EAMC[2]
åºEnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2719
[1m[33mEnqueueTask: [0m[32mTask: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
EnqueuePrefetch: 2858
[1m[33mEnqueueTask: [0m[32mTask: node: ID[913,1f] (16MB) STATE(0) TENSOR[2857,2858,2856,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 32
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:3.0 | [24]:6.0 | [32]:4.0 | [35]:4.0 | [53]:4.0 | [17]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[4]:3.0 | [16]:2.0 | [28]:2.0 | [30]:2.0 | [40]:3.0 | [25]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[8]:5.0 | [20]:3.0 | [28]:2.0 | [43]:4.0 | [59]:3.0 | [57]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[1]:7.0 | [7]:5.0 | [24]:2.0 | [48]:13.0 | [62]:9.0 | [19]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[4]:5.0 | [7]:8.0 | [11]:4.0 | [20]:5.0 | [34]:8.0 | [52]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[2]:6.0 | [20]:11.0 | [25]:6.0 | [29]:9.0 | [57]:4.0 | [3]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 2, 20, 25, 29, 57,  3]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 8.200(2803)[0m | [32mExpert 63: 8.200(2800)[0m | [32mExpert 10: 7.200(2626)[0m | [32mExpert 46: 7.200(2743)[0m | 
[32mExpert 41: 6.800(2728)[0m | [32mExpert 55: 6.800(2773)[0m | [32mExpert 38: 6.600(2716)[0m | [32mExpert 45: 6.200(2740)[0m | 
[32mExpert 17: 5.800(2647)[0m | [32mExpert 13: 5.800(2635)[0m | [32mExpert 19: 5.200(2653)[0m | [32mExpert 12: 5.200(2632)[0m | 
[32mExpert 33: 5.000(2701)[0m | [32mExpert 44: 5.000(2737)[0m | [32mExpert 16: 4.800(2644)[0m | [32mExpert 29: 4.400(2686)[0m | 
[32mExpert 47: 4.200(2746)[0m | [32mExpert  8: 4.000(2806)[0m | [32mExpert 34: 3.800(2704)[0m | [32mExpert  4: 3.600(2722)[0m | 
[32mExpert 22: 3.600(2665)[0m | [32mExpert 32: 3.600(2698)[0m | [32mExpert 35: 3.600(2707)[0m | [32mExpert 50: 3.400(2758)[0m | 
[32mExpert 60: 3.200(2791)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert  9: 2.800(2809)[0m | [32mExpert 11: 2.800(2629)[0m | 
[32mExpert  5: 2.600(2755)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 54: 2.600(2770)[0m | [32mExpert 39: 2.400(2719)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2665, 2698, 2707, 2758, 2791, 2749, 2809, 2629, 2755, 2680, 2770, 2719]
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2719[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5,  9, 11, 22, 27, 32, 35, 39, 48, 50, 54, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[13]:1.0 | [27]:9.0 | [44]:6.0 | [47]:9.0 | [49]:4.0 | [39]:10.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[1]:6.0 | [9]:4.0 | [11]:10.0 | [53]:2.0 | [57]:5.0 | [16]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:9.0 | [11]:4.0 | [27]:4.0 | [51]:2.0 | [63]:9.0 | [14]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E11 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:6.0 | [16]:9.0 | [22]:2.0 | [35]:3.0 | [49]:9.0 | [33]:21.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:15.0 | [27]:7.0 | [30]:7.0 | [42]:9.0 | [52]:10.0 | [48]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[3]:7.0 | [18]:10.0 | [22]:9.0 | [45]:21.0 | [63]:2.0 | [16]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[ 3, 18, 22, 45, 63, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 9.600(2954)[0m | [32mExpert  6: 8.400(3026)[0m | [32mExpert 36: 7.800(2948)[0m | [32mExpert 49: 7.600(2990)[0m | 
[32mExpert  4: 7.400(2960)[0m | [32mExpert 14: 7.200(2876)[0m | [32mExpert 26: 6.800(2915)[0m | [32mExpert 16: 6.600(2882)[0m | 
[32mExpert 25: 5.400(2912)[0m | [32mExpert 48: 5.400(2987)[0m | [32mExpert 61: 5.400(3032)[0m | [32mExpert  9: 5.200(3047)[0m | 
[32mExpert 11: 5.200(2867)[0m | [32mExpert 37: 5.000(2951)[0m | [32mExpert 23: 5.000(2906)[0m | [32mExpert 55: 5.000(3011)[0m | 
[32mExpert  5: 4.600(2993)[0m | [32mExpert 17: 4.400(2885)[0m | [32mExpert 33: 4.400(2939)[0m | [32mExpert 52: 4.000(3002)[0m | 
[32mExpert  0: 4.000(2858)[0m | [32mExpert 15: 3.600(2879)[0m | [32mExpert 50: 3.400(2996)[0m | [32mExpert 41: 3.200(2966)[0m | 
[32mExpert 30: 3.000(2930)[0m | [32mExpert 31: 3.000(2933)[0m | [32mExpert 34: 3.000(2942)[0m | [32mExpert 53: 3.000(3005)[0m | 
[32mExpert 19: 2.800(2891)[0m | [32mExpert 43: 2.800(2972)[0m | [32mExpert 47: 2.800(2984)[0m | [32mExpert 12: 2.600(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2858, 2879, 2996, 2966, 2930, 2933, 2942, 3005, 2891, 2972, 2984, 2870]
Prefetching [1;36mTensor 2858[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  0, 12, 15, 19, 30, 31, 34, 41, 43, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[16]:1.0 | [22]:2.0 | [55]:1.0 | [61]:8.0 | [63]:11.0 | [11]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[5]:4.0 | [20]:5.0 | [22]:10.0 | [55]:9.0 | [59]:15.0 | [45]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[9]:7.0 | [14]:9.0 | [25]:7.0 | [37]:7.0 | [49]:9.0 | [48]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[19]:3.0 | [28]:3.0 | [30]:12.0 | [57]:6.0 | [61]:3.0 | [63]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[5]:5.0 | [19]:4.0 | [27]:4.0 | [50]:5.0 | [51]:3.0 | [48]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[1]:6.0 | [14]:6.0 | [19]:6.0 | [43]:3.0 | [44]:4.0 | [9]:7.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 1, 14, 19, 43, 44,  9]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[90mTop 20 Experts:[0m
[32mExpert 44: 9.000(4193)[0m | [32mExpert 48: 9.000(4205)[0m | [32mExpert 17: 8.200(4103)[0m | [32mExpert 12: 7.000(4088)[0m | 
[32mExpert 15: 6.200(4097)[0m | [32mExpert 14: 5.800(4094)[0m | [32mExpert 41: 5.800(4184)[0m | [32mExpert 42: 5.800(4187)[0m | 
[32mExpert 21: 5.600(4118)[0m | [32mExpert  6: 5.400(4244)[0m | [32mExpert 26: 5.400(4133)[0m | [32mExpert  9: 5.000(4265)[0m | 
[32mExpert 53: 5.000(4223)[0m | [32mExpert 56: 5.000(4232)[0m | [32mExpert 13: 4.800(4091)[0m | [32mExpert 25: 4.800(4130)[0m | 
[32mExpert 52: 4.600(4220)[0m | [32mExpert 28: 4.400(4139)[0m | [32mExpert 54: 4.200(4226)[0m | [32mExpert 55: 4.200(4229)[0m | 
[32mExpert  5: 4.000(4211)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert  8: 3.800(4262)[0m | [32mExpert 19: 3.800(4109)[0m | 
[32mExpert 27: 3.800(4136)[0m | [32mExpert  0: 3.600(4076)[0m | [32mExpert 50: 3.400(4214)[0m | [32mExpert 61: 3.200(4250)[0m | 
[32mExpert 35: 3.000(4163)[0m | [32mExpert 37: 3.000(4169)[0m | [32mExpert  1: 2.800(4079)[0m | [32mExpert 30: 2.800(4148)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4211, 4082, 4262, 4109, 4136, 4076, 4214, 4250, 4163, 4169, 4079, 4148]
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  8, 10, 19, 27, 30, 35, 37, 50, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:9.0 | [5]:9.0 | [32]:6.0 | [39]:7.0 | [44]:4.0 | [63]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[13]:7.0 | [16]:2.0 | [27]:6.0 | [58]:5.0 | [62]:7.0 | [61]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[5]:5.0 | [18]:3.0 | [33]:1.0 | [41]:8.0 | [44]:12.0 | [32]:2.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:6.0 | [17]:4.0 | [33]:12.0 | [34]:6.0 | [49]:7.0 | [62]:10.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[5]:7.0 | [13]:7.0 | [14]:2.0 | [31]:2.0 | [34]:6.0 | [50]:10.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[12]:5.0 | [15]:3.0 | [16]:15.0 | [36]:6.0 | [46]:1.0 | [2]:1.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[12, 15, 16, 36, 46,  2]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:10.0 | [9]:2.0 | [33]:9.0 | [41]:6.0 | [50]:3.0 | [61]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[7]:1.0 | [28]:3.0 | [39]:4.0 | [48]:13.0 | [62]:4.0 | [17]:7.0 | 
---------------------------------------
return EAMC[2]
é¢„æµ‹EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2680
[1m[33mEnqueueTask: [0m[32mTask: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2719
[1m[33mEnqueueTask: [0m[32mTask: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[550,1b00000013] (16MB) STATE(0) TENSOR[2679,2680,2678,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2858
[1m[33mEnqueueTask: [0m[32mTask: node: ID[913,1f] (16MB) STATE(0) TENSOR[2857,2858,2856,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3005
[1m[33mEnqueueTask: [0m[32mTask: node: ID[966,350000001f] (16MB) STATE(0) TENSOR[3004,3005,3003,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 33
Prefetch Node: task: Task: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[10]:2.0 | [17]:6.0 | [32]:5.0 | [33]:15.0 | [48]:3.0 | [22]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 2 MLP ==
[0m
[6]:5.0 | [9]:2.0 | [39]:2.0 | [40]:4.0 | [55]:2.0 | [25]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 3 MLP ==
[0m
[20]:4.0 | [39]:3.0 | [40]:2.0 | [61]:2.0 | [63]:3.0 | [37]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 4 MLP ==
[0m
[1]:8.0 | [28]:8.0 | [48]:14.0 | [50]:3.0 | [62]:10.0 | [58]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 5 MLP ==
[0m
[2]:7.0 | [3]:3.0 | [6]:4.0 | [7]:9.0 | [46]:3.0 | [4]:6.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 6 MLP ==
[0m
[2]:7.0 | [17]:9.0 | [20]:12.0 | [30]:2.0 | [47]:4.0 | [29]:10.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch6 topk= tensor([[ 2, 17, 20, 30, 47, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 9.000(2803)[0m | [32mExpert 63: 9.000(2800)[0m | [32mExpert 10: 7.200(2626)[0m | [32mExpert 46: 7.200(2743)[0m | 
[32mExpert 41: 6.800(2728)[0m | [32mExpert 55: 6.800(2773)[0m | [32mExpert 38: 6.600(2716)[0m | [32mExpert 45: 6.200(2740)[0m | 
[32mExpert 17: 5.800(2647)[0m | [32mExpert 13: 5.800(2635)[0m | [32mExpert 19: 5.200(2653)[0m | [32mExpert 12: 5.200(2632)[0m | 
[32mExpert 33: 5.000(2701)[0m | [32mExpert 44: 5.000(2737)[0m | [32mExpert 16: 4.800(2644)[0m | [32mExpert 29: 4.400(2686)[0m | 
[32mExpert 47: 4.200(2746)[0m | [32mExpert  8: 4.000(2806)[0m | [32mExpert 34: 3.800(2704)[0m | [32mExpert  4: 3.600(2722)[0m | 
[32mExpert 11: 3.600(2629)[0m | [32mExpert 22: 3.600(2665)[0m | [32mExpert 32: 3.600(2698)[0m | [32mExpert 35: 3.600(2707)[0m | 
[32mExpert 27: 3.400(2680)[0m | [32mExpert 50: 3.400(2758)[0m | [32mExpert 60: 3.200(2791)[0m | [32mExpert 48: 3.000(2749)[0m | 
[32mExpert  9: 2.800(2809)[0m | [32mExpert  5: 2.600(2755)[0m | [32mExpert 54: 2.600(2770)[0m | [32mExpert 39: 2.400(2719)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2629, 2665, 2698, 2707, 2680, 2758, 2791, 2749, 2809, 2755, 2770, 2719]
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2680[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
Prefetching [1;36mTensor 2719[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  5,  9, 11, 22, 27, 32, 35, 39, 48, 50, 54, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[27]:10.0 | [28]:10.0 | [37]:2.0 | [44]:7.0 | [47]:10.0 | [49]:5.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 8 MLP ==
[0m
[1]:7.0 | [9]:5.0 | [11]:11.0 | [40]:10.0 | [57]:6.0 | [53]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 9 MLP ==
[0m
[7]:10.0 | [14]:3.0 | [27]:5.0 | [44]:6.0 | [63]:10.0 | [22]:4.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E22 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[16]:10.0 | [33]:22.0 | [35]:4.0 | [45]:9.0 | [49]:10.0 | [56]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 11 MLP ==
[0m
[2]:16.0 | [30]:8.0 | [42]:10.0 | [48]:7.0 | [52]:11.0 | [29]:1.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 12 MLP ==
[0m
[11]:1.0 | [16]:3.0 | [18]:11.0 | [22]:10.0 | [52]:5.0 | [1]:4.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch12 topk= tensor([[11, 16, 18, 22, 52,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 9.600(2954)[0m | [32mExpert  6: 8.400(3026)[0m | [32mExpert 49: 8.400(2990)[0m | [32mExpert 14: 8.000(2876)[0m | 
[32mExpert 36: 7.800(2948)[0m | [32mExpert  4: 7.400(2960)[0m | [32mExpert 26: 6.800(2915)[0m | [32mExpert 16: 6.600(2882)[0m | 
[32mExpert 25: 6.200(2912)[0m | [32mExpert 48: 6.200(2987)[0m | [32mExpert  9: 6.000(3047)[0m | [32mExpert 37: 5.800(2951)[0m | 
[32mExpert 61: 5.400(3032)[0m | [32mExpert 11: 5.200(2867)[0m | [32mExpert 23: 5.000(2906)[0m | [32mExpert 55: 5.000(3011)[0m | 
[32mExpert  5: 4.600(2993)[0m | [32mExpert 17: 4.400(2885)[0m | [32mExpert 33: 4.400(2939)[0m | [32mExpert 52: 4.000(3002)[0m | 
[32mExpert  0: 4.000(2858)[0m | [32mExpert 15: 3.600(2879)[0m | [32mExpert 50: 3.400(2996)[0m | [32mExpert 41: 3.200(2966)[0m | 
[32mExpert 30: 3.000(2930)[0m | [32mExpert 31: 3.000(2933)[0m | [32mExpert 34: 3.000(2942)[0m | [32mExpert 53: 3.000(3005)[0m | 
[32mExpert 19: 2.800(2891)[0m | [32mExpert 43: 2.800(2972)[0m | [32mExpert 47: 2.800(2984)[0m | [32mExpert 12: 2.600(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2858, 2879, 2996, 2966, 2930, 2933, 2942, 3005, 2891, 2972, 2984, 2870]
Prefetching [1;36mTensor 2858[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 3005[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  0, 12, 15, 19, 30, 31, 34, 41, 43, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[26]:10.0 | [30]:10.0 | [36]:8.0 | [61]:9.0 | [63]:12.0 | [16]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 14 MLP ==
[0m
[22]:11.0 | [35]:3.0 | [38]:4.0 | [55]:10.0 | [59]:16.0 | [14]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 15 MLP ==
[0m
[7]:3.0 | [14]:10.0 | [36]:9.0 | [39]:3.0 | [48]:8.0 | [9]:8.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 16 MLP ==
[0m
[35]:5.0 | [45]:5.0 | [47]:4.0 | [57]:7.0 | [61]:4.0 | [30]:13.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 17 MLP ==
[0m
[11]:4.0 | [19]:5.0 | [30]:1.0 | [38]:4.0 | [50]:6.0 | [46]:3.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 18 MLP ==
[0m
[5]:3.0 | [29]:1.0 | [44]:5.0 | [47]:7.0 | [55]:3.0 | [7]:2.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch18 topk= tensor([[ 5, 29, 44, 47, 55,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4214
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1353,320000002b] (16MB) STATE(0) TENSOR[4213,4214,4212,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 44: 9.800(4193)[0m | [32mExpert 48: 9.000(4205)[0m | [32mExpert 17: 8.200(4103)[0m | [32mExpert 12: 7.000(4088)[0m | 
[32mExpert 41: 6.600(4184)[0m | [32mExpert 15: 6.200(4097)[0m | [32mExpert 14: 5.800(4094)[0m | [32mExpert 42: 5.800(4187)[0m | 
[32mExpert 21: 5.600(4118)[0m | [32mExpert  6: 5.400(4244)[0m | [32mExpert 26: 5.400(4133)[0m | [32mExpert  9: 5.000(4265)[0m | 
[32mExpert 53: 5.000(4223)[0m | [32mExpert 56: 5.000(4232)[0m | [32mExpert 13: 4.800(4091)[0m | [32mExpert  5: 4.800(4211)[0m | 
[32mExpert 25: 4.800(4130)[0m | [32mExpert 52: 4.600(4220)[0m | [32mExpert 28: 4.400(4139)[0m | [32mExpert 54: 4.200(4226)[0m | 
[32mExpert 55: 4.200(4229)[0m | [32mExpert 10: 4.000(4082)[0m | [32mExpert  8: 3.800(4262)[0m | [32mExpert 19: 3.800(4109)[0m | 
[32mExpert 27: 3.800(4136)[0m | [32mExpert  0: 3.600(4076)[0m | [32mExpert 18: 3.600(4106)[0m | [32mExpert 50: 3.400(4214)[0m | 
[32mExpert 61: 3.200(4250)[0m | [32mExpert 35: 3.000(4163)[0m | [32mExpert 37: 3.000(4169)[0m | [32mExpert  1: 2.800(4079)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4229, 4082, 4262, 4109, 4136, 4076, 4106, 4214, 4250, 4163, 4169, 4079]
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4214[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  8, 10, 18, 19, 27, 35, 37, 50, 55, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:10.0 | [8]:2.0 | [27]:2.0 | [39]:8.0 | [49]:4.0 | [38]:7.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 20 MLP ==
[0m
[3]:9.0 | [13]:8.0 | [54]:4.0 | [61]:3.0 | [62]:8.0 | [24]:2.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 21 MLP ==
[0m
[18]:4.0 | [32]:3.0 | [41]:9.0 | [52]:6.0 | [60]:1.0 | [44]:13.0 | 
---------------------------------------
return EAMC[2]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E18 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:12.0 | [17]:5.0 | [19]:2.0 | [22]:4.0 | [56]:7.0 | [33]:13.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 23 MLP ==
[0m
[1]:6.0 | [5]:8.0 | [19]:2.0 | [30]:3.0 | [34]:7.0 | [50]:11.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 24 MLP ==
[0m
[15]:4.0 | [16]:16.0 | [18]:3.0 | [24]:16.0 | [44]:6.0 | [12]:6.0 | 
---------------------------------------
return EAMC[2]
Begin prefetch24 topk= tensor([[15, 16, 18, 24, 44, 12]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:3.0 | [9]:3.0 | [13]:4.0 | [28]:3.0 | [33]:10.0 | [20]:4.0 | 
---------------------------------------
return EAMC[2]

[1;36m== Layer 26 MLP ==
[0m
[7]:2.0 | [10]:8.0 | [38]:9.0 | [39]:5.0 | [48]:14.0 | [43]:8.0 | 
---------------------------------------
return EAMC[3]
ä»»åŠ¡
Prefilling time: 2.039717674255371 seconds
Decoding time: 9.93166708946228 seconds
Decoding iterations: 32
Decoding time per iteration: 0.31036459654569626 seconds
Input tokens: 127
input:  æ ¹æ®ä»¥ä¸‹çº¿ç´¢ç”Ÿæˆåˆ›æ„å†…å®¹ï¼š
1. ç”¨'åŒºå—é“¾+ç¢³ä¸­å’Œ'æ¦‚å¿µè®¾è®¡ä¸€ä¸ªDAppäº¤äº’æµç¨‹å›¾
2. ä¸ºç§‘å¹»å°è¯´ã€ŠæœˆçƒAIæ®–æ°‘åœ°ã€‹ç¼–å†™æ•…äº‹å¤§çº²ï¼ˆ3å¹•å‰§ç»“æ„ï¼‰
3. å°†å¤è¯—'å¤§æ¼ å­¤çƒŸç›´'è½¬å†™æˆç°ä»£è¯—æ­Œå¹¶é…50å­—è§†è§‰ç”»é¢æè¿°
4. è®¾è®¡ä¸€ä¸ªå“²å­¦æ‚–è®ºï¼šå½“è¶…çº§AIçš„æ•ˆç”¨å‡½æ•°ä¸äººç±»ä¼¦ç†å†²çªæ—¶ï¼ˆæ¨¡ä»¿ç”µè½¦éš¾é¢˜ï¼‰
5. ç”¨emoji+çŸ­å¥æè¿°'å…ƒå®‡å®™å©šç¤¼'çš„æ ¸å¿ƒä½“éªŒï¼ˆé™20ä¸ªå­—ç¬¦ï¼‰
è¦æ±‚ï¼šæ¯ä¸ªäº§å‡ºéœ€åŒ…å«åˆ›æ–°æ€§å’Œå¯å®æ–½æ€§è¯´æ˜ã€‚
inputs ...
torch.Size([1, 148])
outputs_text ...

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:1.0 | [26]:1.0 | [56]:1.0 | [57]:1.0 | [60]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[3]:1.0 | [35]:1.0 | [38]:1.0 | [62]:1.0 | [63]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[4]:1.0 | [9]:1.0 | [11]:1.0 | [25]:1.0 | [54]:1.0 | [12]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[11]:1.0 | [21]:1.0 | [31]:1.0 | [33]:1.0 | [49]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[19]:1.0 | [20]:1.0 | [47]:1.0 | [49]:1.0 | [52]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[13]:1.0 | [21]:1.0 | [22]:1.0 | [42]:1.0 | [47]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[13, 21, 22, 42, 47, 32],
        [19, 24, 37, 46, 56, 39],
        [19, 24, 36, 40, 46, 58],
        [ 2,  5, 14, 19, 24,  4],
        [ 2,  4,  7, 14, 44, 53],
        [ 2, 14, 29, 53, 57,  4],
        [ 2,  3,  4, 14, 29, 53],
        [12, 16, 35, 50, 56, 18],
        [ 1, 23, 39, 42, 45, 32],
        [16, 37, 46, 50, 56, 19],
        [ 5, 12, 19, 28, 43, 35],
        [ 6, 19, 46, 50, 56,  5],
        [ 7, 19, 26, 44, 49, 24],
        [ 6, 23, 24, 36, 58, 33],
        [ 3, 27, 29, 38, 41, 57],
        [ 6, 33, 34, 42, 55, 39],
        [ 3, 26, 27, 30, 41, 59],
        [ 3, 30, 31, 57, 59, 32],
        [ 6, 16, 18, 33, 56, 12],
        [ 2,  5, 29, 33, 53, 57],
        [ 2,  4,  7, 29, 44, 26],
        [ 7,  8, 24, 44, 58, 33],
        [ 6, 27, 32, 41, 57, 14],
        [ 3, 17, 29, 32, 48,  4],
        [ 2,  4, 14, 44, 57, 29],
        [ 2, 14, 17, 38, 53, 33],
        [ 2, 14, 17, 29, 38,  4],
        [12, 16, 46, 50, 56, 37],
        [19, 27, 37, 46, 56, 39],
        [16, 18, 19, 34, 56, 11],
        [18, 19, 24, 34, 56, 12],
        [ 7, 10, 19, 44, 49, 24],
        [ 2,  3, 29, 38, 57, 41],
        [ 3, 29, 33, 47, 57, 38],
        [ 6, 23, 33, 46, 56, 36],
        [13, 27, 38, 48, 63, 41],
        [ 3, 27, 38, 47, 48, 41],
        [26, 30, 38, 44, 62, 48],
        [ 3, 30, 38, 48, 57, 62],
        [ 3, 38, 42, 47, 48, 63],
        [ 6, 29, 33, 47, 56, 16],
        [ 4,  7, 14, 26, 44, 33],
        [ 4,  7, 14, 29, 44, 24],
        [ 2,  4, 29, 33, 53, 38],
        [ 2, 25, 26, 33, 57, 14],
        [ 2,  4, 14, 29, 33, 53],
        [12, 16, 18, 23, 56, 50],
        [ 6, 23, 28, 37, 51, 33],
        [ 2, 28, 29, 33, 38, 57],
        [28, 29, 33, 38, 57, 53],
        [ 2, 25, 28, 38, 53, 33],
        [11, 12, 16, 18, 56, 50],
        [11, 37, 46, 50, 56, 16],
        [ 1, 19, 37, 39, 42, 51],
        [11, 18, 34, 50, 56, 19],
        [11, 18, 34, 50, 56, 19],
        [ 0,  7, 19, 44, 52, 24],
        [13, 26, 36, 41, 57, 27],
        [ 3, 26, 29, 33, 38,  4],
        [ 5,  6, 23, 33, 35, 24],
        [ 6, 23, 26, 41, 45,  8],
        [ 1, 27, 41, 45, 63,  6],
        [ 1,  6, 15, 31, 45, 48],
        [17, 22, 27, 38, 45, 13],
        [ 9, 25, 31, 38, 45, 22],
        [ 6, 12, 16, 18, 33, 35],
        [ 7, 14, 26, 44, 61, 34],
        [ 2,  7, 14, 26, 44, 33],
        [ 7, 34, 44, 49, 58, 33],
        [36, 41, 57, 59, 63, 58],
        [ 3, 29, 38, 57, 63, 33],
        [18, 34, 35, 54, 55, 12],
        [ 7, 14, 26, 44, 49, 34],
        [ 6,  8, 14, 28, 51, 26],
        [ 6,  8, 14, 28, 51, 32],
        [14, 26, 28, 29, 51, 38],
        [ 2, 10, 29, 38, 57, 14],
        [ 2, 10, 28, 29, 38, 14],
        [ 2,  5,  7, 14, 44, 24],
        [11, 16, 46, 50, 56, 18],
        [19, 37, 39, 42, 51, 13],
        [11, 16, 35, 50, 56, 34],
        [11, 18, 34, 50, 56, 19],
        [ 2,  4,  7, 29, 44, 19],
        [ 7,  8, 24, 44, 58,  4],
        [ 2,  3, 29, 53, 57, 27],
        [ 5, 26, 33, 47, 53, 48],
        [ 2,  5, 26, 53, 60, 38],
        [ 2,  5, 31, 53, 60, 32],
        [ 5,  6, 12, 16, 35, 33],
        [ 0,  5, 26, 49, 52, 19],
        [ 8, 15, 25, 57, 58, 53],
        [ 3, 15, 21, 27, 38, 53],
        [15, 21, 33, 36, 54, 43],
        [ 2, 26, 31, 53, 62, 30],
        [ 2, 25, 30, 31, 53, 57],
        [ 2, 25, 30, 47, 53, 17],
        [25, 34, 43, 49, 55,  7],
        [ 3, 15, 21, 53, 57, 59],
        [ 2, 30, 31, 53, 60,  3],
        [ 2, 30, 53, 60, 62, 31],
        [ 0,  5, 12, 18, 54, 43],
        [12, 16, 18, 23, 34, 33],
        [ 2,  7, 44, 53, 58, 60],
        [26, 27, 38, 53, 57, 41],
        [ 1, 17, 27, 32, 38, 13],
        [17, 30, 33, 47, 53, 38],
        [11, 12, 16, 18, 33, 56],
        [11, 37, 46, 50, 56, 16],
        [19, 37, 50, 51, 56, 46],
        [11, 16, 33, 50, 56,  1],
        [ 1, 11, 34, 50, 56, 16],
        [ 7, 19, 24, 44, 49, 58],
        [13, 32, 38, 41, 60,  2],
        [ 2, 14, 29, 32, 38, 13],
        [ 6, 33, 34, 35, 55, 42],
        [ 8, 14, 26, 38, 57, 36],
        [ 2, 14, 28, 38, 57,  3],
        [ 2,  5,  7, 14, 44, 24],
        [ 5,  6, 23, 24, 35, 58],
        [ 6, 26, 27, 41, 57, 32],
        [ 3, 32, 38, 41, 63, 29],
        [ 3, 14, 15, 38, 47, 48],
        [ 6, 12, 16, 33, 56, 18],
        [ 2, 33, 36, 43, 53, 38],
        [ 2,  5, 14, 33, 53, 38],
        [12, 16, 23, 33, 56, 35],
        [ 0, 14, 26, 43, 49,  8],
        [ 8, 14, 25, 28, 51, 49],
        [ 6, 14, 25, 28, 51, 17],
        [ 8, 14, 28, 36, 51, 25],
        [14, 28, 38, 51, 60, 26],
        [ 2, 14, 25, 28, 51, 38],
        [11, 12, 16, 50, 56, 28],
        [11, 16, 46, 50, 56, 37],
        [ 0,  2,  7, 14, 19, 52],
        [12, 19, 35, 50, 56, 16],
        [ 0,  8, 19, 28, 36, 49],
        [ 2,  4, 14, 44, 53,  7],
        [ 0,  8, 28, 43, 52, 26],
        [ 0,  7, 28, 43, 58,  8],
        [ 2, 36, 53, 57, 60, 31],
        [ 2, 31, 34, 55, 60, 53],
        [10, 22, 26, 52, 59, 60],
        [ 2,  7, 31, 44, 53, 57],
        [ 2, 31, 53, 59, 60, 52],
        [ 2,  5, 14, 24, 53, 44],
        [11, 12, 16, 18, 50, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert  7: 2.000(2803)[0m | [32mExpert 63: 2.000(2800)[0m | [32mExpert 10: 1.800(2626)[0m | [32mExpert 55: 1.600(2773)[0m | 
[32mExpert 41: 1.400(2728)[0m | [32mExpert 45: 1.400(2740)[0m | [32mExpert 46: 1.400(2743)[0m | [32mExpert 17: 1.200(2647)[0m | 
[32mExpert 19: 1.200(2653)[0m | [32mExpert 38: 1.200(2716)[0m | [32mExpert 44: 1.200(2737)[0m | [32mExpert 12: 1.000(2632)[0m | 
[32mExpert 13: 1.000(2635)[0m | [32mExpert 27: 1.000(2680)[0m | [32mExpert 29: 1.000(2686)[0m | [32mExpert 33: 1.000(2701)[0m | 
[32mExpert 47: 1.000(2746)[0m | [32mExpert  8: 0.800(2806)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 16: 0.800(2644)[0m | 
[32mExpert 22: 0.800(2665)[0m | [32mExpert 34: 0.800(2704)[0m | [32mExpert 35: 0.800(2707)[0m | [32mExpert 50: 0.800(2758)[0m | 
[32mExpert  4: 0.600(2722)[0m | [32mExpert  5: 0.600(2755)[0m | [32mExpert  9: 0.600(2809)[0m | [32mExpert 14: 0.600(2638)[0m | 
[32mExpert 32: 0.600(2698)[0m | [32mExpert 39: 0.600(2719)[0m | [32mExpert 48: 0.600(2749)[0m | [32mExpert 54: 0.600(2770)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2719
[1m[33mEnqueueTask: [0m[32mTask: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
[2665, 2704, 2707, 2758, 2722, 2755, 2809, 2638, 2698, 2719, 2749, 2770]
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2719[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
Prefetching [1;36mTensor 2770[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  9, 14, 22, 32, 34, 35, 39, 48, 50, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[28]:1.0 | [43]:1.0 | [44]:1.0 | [58]:1.0 | [62]:1.0 | [18]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[2]:1.0 | [11]:1.0 | [30]:1.0 | [39]:1.0 | [54]:1.0 | [47]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[12]:1.0 | [13]:1.0 | [22]:1.0 | [27]:1.0 | [31]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E4 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E14 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E22 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E39 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E50 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E54 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[2]:1.0 | [9]:1.0 | [13]:1.0 | [42]:1.0 | [47]:1.0 | [31]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[10]:1.0 | [11]:1.0 | [17]:1.0 | [18]:1.0 | [27]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[4]:1.0 | [30]:1.0 | [37]:1.0 | [50]:1.0 | [59]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
tensor([[ 4, 30, 37, 50, 59,  3],
        [12, 15, 29, 43, 48, 44],
        [11, 30, 44, 50, 57, 12],
        [ 1, 11, 32, 44, 57, 30],
        [ 0, 34, 44, 55, 57, 30],
        [18, 33, 44, 53, 57, 26],
        [18, 32, 44, 52, 57, 63],
        [29, 38, 41, 44, 57, 47],
        [26, 31, 32, 37, 56, 47],
        [ 4, 28, 29, 38, 41, 46],
        [10, 13, 41, 42, 44, 29],
        [10, 13, 29, 41, 44, 42],
        [10, 41, 44, 55, 57, 30],
        [12, 28, 41, 44, 61, 10],
        [18, 22, 26, 31, 62, 61],
        [ 9, 12, 26, 41, 57, 16],
        [ 5, 12, 16, 26, 63, 56],
        [16, 18, 22, 26, 31, 62],
        [11, 16, 22, 26, 48, 62],
        [ 1, 11, 18, 52, 57, 62],
        [ 0, 13, 34, 44, 57, 11],
        [ 2, 13, 44, 53, 57, 37],
        [12, 23, 28, 37, 61, 16],
        [18, 22, 31, 52, 62, 23],
        [ 1, 16, 18, 33, 44, 62],
        [ 1, 16, 18, 44, 52, 57],
        [18, 22, 44, 52, 57, 16],
        [ 7, 29, 38, 43, 46, 42],
        [ 4, 23, 28, 37, 62, 48],
        [38, 41, 44, 47, 57,  7],
        [ 7,  9, 41, 44, 57, 30],
        [13, 30, 43, 44, 57, 49],
        [11, 22, 31, 33, 63, 53],
        [11, 18, 22, 44, 52, 16],
        [12, 13, 28, 41, 61, 44],
        [12, 22, 31, 61, 63, 16],
        [18, 22, 23, 52, 63, 61],
        [ 5, 20, 33, 59, 61, 62],
        [ 1, 18, 31, 33, 63, 16],
        [18, 22, 31, 52, 63, 16],
        [16, 22, 31, 44, 52, 11],
        [ 0, 34, 44, 57, 59, 13],
        [ 0, 13, 34, 44, 57, 30],
        [18, 28, 44, 52, 57,  8],
        [ 3,  4, 37, 44, 47, 57],
        [ 8, 18, 32, 44, 57, 52],
        [28, 30, 41, 44, 57, 12],
        [23, 28, 37, 44, 46, 57],
        [23, 28, 33, 44, 50, 18],
        [ 8, 16, 18, 44, 52, 28],
        [ 1, 11, 18, 44, 57, 33],
        [ 7,  8, 38, 44, 57, 30],
        [29, 38, 42, 43, 46,  7],
        [ 4, 23, 28, 37, 62, 16],
        [38, 41, 44, 47, 57,  7],
        [ 7,  9, 41, 44, 57, 47],
        [13, 30, 34, 44, 57, 10],
        [12, 13, 44, 50, 59, 61],
        [18, 31, 44, 52, 57, 62],
        [12, 28, 41, 44, 61, 13],
        [ 3,  4, 12, 37, 61, 41],
        [ 4, 23, 31, 56, 63, 59],
        [ 3, 33, 37, 56, 59,  5],
        [ 5, 22, 31, 33, 63, 35],
        [ 3,  5, 33, 35, 40, 59],
        [22, 25, 44, 52, 57, 31],
        [30, 34, 44, 51, 57,  3],
        [ 1, 20, 30, 44, 57, 50],
        [10, 13, 44, 53, 57, 43],
        [31, 44, 50, 53, 57, 13],
        [18, 31, 44, 52, 57,  8],
        [ 9, 17, 30, 44, 57, 47],
        [44, 47, 51, 57, 59, 30],
        [23, 37, 44, 51, 57,  6],
        [ 6, 23, 37, 44, 57, 51],
        [ 6, 44, 50, 53, 57, 30],
        [18, 44, 50, 53, 63, 57],
        [18, 44, 50, 52, 63, 57],
        [ 1, 18, 33, 44, 52, 30],
        [ 7, 29, 38, 43, 46, 42],
        [ 4, 23, 28, 37, 62, 56],
        [38, 41, 44, 47, 57, 29],
        [ 9, 41, 44, 47, 57, 29],
        [13, 34, 41, 44, 57,  0],
        [ 2, 13, 44, 53, 57, 41],
        [16, 18, 22, 31, 53, 26],
        [12, 33, 47, 56, 59, 20],
        [ 5, 20, 33, 55, 59, 61],
        [18, 22, 31, 52, 63, 33],
        [ 7, 13, 41, 42, 44, 10],
        [ 2, 13, 14, 41, 60,  4],
        [13, 21, 33, 51, 53,  2],
        [21, 22, 23, 52, 63, 25],
        [11, 13, 21, 25, 63, 14],
        [ 1,  3, 21, 26, 59, 51],
        [ 1, 18, 21, 33, 63, 26],
        [ 1, 18, 21, 52, 63, 22],
        [ 9, 10, 13, 14, 15, 47],
        [11, 21, 31, 52, 63, 25],
        [11, 26, 33, 52, 63, 18],
        [ 1, 11, 14, 21, 63, 18],
        [14, 17, 24, 36, 60,  3],
        [28, 30, 41, 44, 57, 61],
        [13, 30, 34, 44, 57, 43],
        [ 5, 12, 44, 61, 63, 16],
        [ 5, 22, 33, 52, 63, 35],
        [11, 18, 22, 31, 52, 32],
        [ 7, 11, 38, 52, 57,  8],
        [ 7, 29, 38, 43, 46, 42],
        [ 4, 23, 28, 37, 62, 16],
        [38, 41, 44, 47, 57, 29],
        [ 9, 41, 44, 47, 57, 29],
        [13, 30, 41, 44, 57, 43],
        [12, 23, 31, 33, 62, 28],
        [11, 18, 31, 33, 62, 52],
        [ 9, 10, 28, 44, 57, 11],
        [ 3, 37, 44, 53, 57,  5],
        [11, 18, 44, 50, 52, 30],
        [ 0, 13, 41, 44, 57, 30],
        [12, 13, 41, 44, 61, 10],
        [ 4, 12, 23, 59, 61,  3],
        [22, 26, 31, 62, 63, 52],
        [16, 18, 22, 31, 52, 21],
        [16, 18, 22, 25, 52, 44],
        [13, 33, 50, 53, 57,  1],
        [ 1, 16, 18, 33, 52, 57],
        [28, 30, 41, 44, 57, 48],
        [ 3,  6, 44, 54, 57, 20],
        [23, 27, 37, 44, 46,  2],
        [ 6, 23, 27, 37, 44, 28],
        [ 6, 23, 37, 44, 57,  2],
        [ 6, 32, 44, 50, 62, 33],
        [ 6, 11, 32, 33, 44, 38],
        [ 7, 16, 38, 41, 57,  8],
        [ 7, 29, 38, 41, 46, 57],
        [ 1, 30, 44, 57, 60,  0],
        [30, 39, 41, 44, 57, 60],
        [ 2, 30, 37, 44, 57,  6],
        [ 1, 18, 21, 44, 52, 57],
        [17, 30, 44, 57, 60, 51],
        [20, 30, 44, 51, 57, 10],
        [ 1, 44, 53, 55, 57, 26],
        [ 9, 44, 51, 53, 57, 55],
        [ 9, 17, 51, 55, 57, 53],
        [ 1, 16, 44, 53, 55, 20],
        [ 1, 11, 18, 52, 57, 26],
        [ 0,  1, 18, 44, 57, 30],
        [ 7, 38, 42, 43, 47, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 2.200(2954)[0m | [32mExpert 14: 2.000(2876)[0m | [32mExpert  6: 1.800(3026)[0m | [32mExpert 36: 1.800(2948)[0m | 
[32mExpert 49: 1.800(2990)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 26: 1.600(2915)[0m | [32mExpert 48: 1.600(2987)[0m | 
[32mExpert 16: 1.400(2882)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | [32mExpert  4: 1.200(2960)[0m | 
[32mExpert 61: 1.200(3032)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 23: 0.800(2906)[0m | 
[32mExpert 33: 0.800(2939)[0m | [32mExpert 52: 0.800(3002)[0m | [32mExpert 55: 0.800(3011)[0m | [32mExpert  5: 0.600(2993)[0m | 
[32mExpert  7: 0.600(3041)[0m | [32mExpert 12: 0.600(2870)[0m | [32mExpert 15: 0.600(2879)[0m | [32mExpert 19: 0.600(2891)[0m | 
[32mExpert 21: 0.600(2900)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 31: 0.600(2933)[0m | [32mExpert 34: 0.600(2942)[0m | 
[32mExpert 39: 0.600(2957)[0m | [32mExpert 41: 0.600(2966)[0m | [32mExpert 43: 0.600(2972)[0m | [32mExpert 47: 0.600(2984)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3041, 2870, 2879, 2891, 2900, 2930, 2933, 2942, 2957, 2966, 2972, 2984]
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7, 12, 15, 19, 21, 30, 31, 34, 39, 41, 43, 47 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:1.0 | [24]:1.0 | [34]:1.0 | [36]:1.0 | [47]:1.0 | [58]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[5]:1.0 | [7]:1.0 | [23]:1.0 | [27]:1.0 | [51]:1.0 | [24]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[5]:1.0 | [14]:1.0 | [48]:1.0 | [52]:1.0 | [55]:1.0 | [36]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E7 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E12 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E15 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E31 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E39 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E41 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E43 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[9]:1.0 | [13]:1.0 | [26]:1.0 | [33]:1.0 | [63]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[0]:1.0 | [11]:1.0 | [18]:1.0 | [26]:1.0 | [43]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[2]:1.0 | [5]:1.0 | [39]:1.0 | [56]:1.0 | [61]:1.0 | [49]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 2,  5, 39, 56, 61, 49],
        [18, 30, 31, 40, 53, 63],
        [17, 18, 37, 43, 48, 31],
        [14, 17, 35, 37, 57, 19],
        [17, 18, 35, 37, 47, 40],
        [ 5, 17, 35, 37, 47, 18],
        [ 8, 18, 35, 37, 47, 14],
        [ 8, 18, 37, 40, 46, 17],
        [14, 18, 39, 50, 59, 42],
        [13, 18, 22, 30, 46, 59],
        [ 8, 18, 37, 46, 53, 40],
        [18, 27, 37, 40, 46, 53],
        [ 1, 18, 31, 33, 37, 40],
        [18, 27, 37, 40, 46, 30],
        [ 2, 14, 47, 49, 63,  5],
        [18, 41, 42, 47, 63, 31],
        [ 4, 16, 36, 41, 49,  1],
        [29, 41, 47, 49, 58, 55],
        [10, 14, 29, 47, 57, 35],
        [ 1, 10, 14, 37, 47, 44],
        [ 4, 17, 33, 41, 55, 37],
        [ 4, 17, 34, 37, 41, 40],
        [ 2,  4, 52, 58, 63, 36],
        [ 2, 14, 47, 49, 58, 63],
        [ 5, 14, 39, 43, 47, 33],
        [14, 19, 35, 47, 50, 58],
        [ 1,  8, 14, 35, 47, 44],
        [18, 30, 46, 57, 59,  8],
        [13, 22, 23, 50, 52, 28],
        [ 8, 18, 37, 50, 57, 23],
        [17, 37, 51, 53, 57, 60],
        [ 4, 18, 31, 40, 41, 42],
        [ 2,  4,  5, 37, 44, 12],
        [ 5, 10, 14, 37, 44, 49],
        [ 4, 18, 27, 37, 40, 53],
        [ 0,  2,  4, 44, 49, 39],
        [ 2,  4,  5, 11, 49, 47],
        [ 1,  4,  5, 36, 59, 33],
        [ 4,  5, 33, 42, 47, 55],
        [ 4,  5, 14, 47, 60,  0],
        [29, 37, 44, 49, 57, 27],
        [ 1, 33, 36, 37, 43, 17],
        [17, 27, 33, 37, 43, 21],
        [19, 27, 37, 44, 47, 35],
        [ 1,  5, 32, 37, 56, 36],
        [ 1, 14, 35, 37, 47, 58],
        [17, 18, 37, 51, 57, 34],
        [ 6, 13, 22, 37, 52, 17],
        [ 1,  5, 37, 47, 52, 14],
        [ 1, 36, 37, 44, 47,  5],
        [35, 37, 44, 47, 50, 14],
        [35, 37, 47, 57, 58, 46],
        [18, 30, 46, 57, 59,  8],
        [13, 22, 23, 28, 52, 50],
        [ 8, 18, 46, 50, 53, 28],
        [18, 37, 40, 46, 53, 50],
        [18, 37, 40, 55, 62, 23],
        [ 1, 24, 32, 37, 56, 28],
        [ 1, 10, 18, 37, 44, 49],
        [18, 30, 37, 40, 53, 61],
        [ 1, 24, 36, 42, 56, 18],
        [ 2, 16, 41, 49, 56, 42],
        [21, 36, 42, 56, 58,  4],
        [15, 16, 47, 49, 56, 59],
        [ 0,  4, 36, 47, 56, 15],
        [35, 37, 44, 49, 57,  1],
        [ 1,  9, 33, 36, 37, 39],
        [ 1,  7, 33, 37, 55, 39],
        [ 1, 18, 27, 37, 40, 34],
        [ 1, 23, 24, 32, 37, 27],
        [ 1, 10, 14, 35, 47, 49],
        [ 1, 20, 29, 37, 43, 45],
        [ 1, 17, 33, 37, 38, 43],
        [ 6, 13, 22, 36, 52, 37],
        [13, 22, 24, 37, 52, 43],
        [ 1, 17, 37, 43, 52, 35],
        [ 1,  5, 14, 37, 43, 48],
        [ 1, 14, 19, 37, 47, 44],
        [ 1, 33, 35, 47, 55, 58],
        [18, 30, 46, 57, 59,  8],
        [ 4, 13, 22, 23, 28, 42],
        [ 8, 18, 37, 50, 53, 23],
        [18, 37, 40, 46, 53, 35],
        [12, 17, 33, 37, 40,  4],
        [12, 34, 37, 38, 40,  4],
        [ 5, 17, 27, 38, 43, 12],
        [27, 30, 32, 58, 59, 28],
        [ 1, 30, 33, 36, 56, 59],
        [14, 19, 27, 44, 47, 17],
        [18, 27, 40, 51, 53, 25],
        [25, 27, 31, 33, 62, 24],
        [ 4, 27, 32, 38, 56, 34],
        [ 2,  4, 11, 45, 49, 44],
        [ 4, 11, 27, 44, 62, 48],
        [ 1,  5, 30, 56, 59, 33],
        [ 5, 14, 16, 19, 27,  2],
        [14, 20, 27, 44, 45, 16],
        [ 4, 27, 28, 31, 34, 40],
        [ 4, 11, 26, 27, 48, 41],
        [ 5, 27, 43, 44, 48, 47],
        [19, 47, 54, 55, 58, 33],
        [ 4,  8, 26, 28, 47, 58],
        [17, 27, 37, 57, 63, 51],
        [18, 27, 33, 37, 40, 31],
        [ 1,  2, 27, 37, 56,  4],
        [ 5, 14, 27, 44, 49,  2],
        [19, 44, 47, 49, 54, 43],
        [30, 32, 35, 37, 57, 47],
        [18, 30, 46, 57, 59,  8],
        [13, 22, 23, 50, 52,  4],
        [ 8, 18, 35, 37, 50, 53],
        [18, 37, 40, 46, 53, 35],
        [17, 18, 31, 33, 37, 40],
        [ 1,  2, 14, 32, 58, 63],
        [ 2, 10, 14, 49, 58, 38],
        [17, 18, 31, 37, 63, 27],
        [ 1, 36, 37, 43, 56, 38],
        [ 1, 10, 14, 47, 58, 37],
        [18, 33, 40, 47, 55, 37],
        [18, 24, 30, 34, 40, 23],
        [ 1, 24, 32, 36, 56,  2],
        [ 2, 44, 47, 49, 63, 58],
        [ 5, 14, 24, 44, 47, 10],
        [39, 44, 47, 49, 57, 35],
        [17, 28, 39, 43, 48, 47],
        [ 5, 19, 35, 47, 55, 13],
        [18, 37, 51, 52, 57, 17],
        [ 1, 31, 33, 36, 52, 37],
        [ 6, 13, 22, 43, 52, 59],
        [ 6, 22, 35, 43, 52, 28],
        [ 6, 17, 22, 35, 52, 37],
        [ 1,  6, 10, 14, 52, 47],
        [ 1,  2, 35, 44, 52, 14],
        [ 8, 18, 23, 35, 57, 50],
        [ 8, 18, 30, 35, 46, 59],
        [17, 18, 31, 35, 37, 19],
        [17, 18, 31, 35, 37, 46],
        [17, 32, 35, 37, 43, 44],
        [17, 33, 35, 44, 54, 30],
        [17, 30, 31, 35, 37, 20],
        [17, 18, 31, 37, 43, 33],
        [17, 29, 47, 55, 56, 43],
        [17, 34, 37, 43, 48, 31],
        [ 1, 17, 20, 31, 43, 37],
        [ 7, 17, 29, 43, 54, 55],
        [17, 35, 43, 47, 54, 37],
        [17, 32, 35, 47, 55,  1],
        [30, 35, 37, 46, 57, 17]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 44: 2.600(4193)[0m | EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
[32mExpert 17: 1.800(4103)[0m | [32mExpert 41: 1.800(4184)[0m | [32mExpert 48: 1.800(4205)[0m | 
[32mExpert 12: 1.400(4088)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert  9: 1.200(4265)[0m | [32mExpert 13: 1.200(4091)[0m | 
[32mExpert 14: 1.200(4094)[0m | [32mExpert 21: 1.200(4118)[0m | [32mExpert 42: 1.200(4187)[0m | [32mExpert 52: 1.200(4220)[0m | 
[32mExpert  5: 1.000(4211)[0m | [32mExpert 15: 1.000(4097)[0m | [32mExpert 26: 1.000(4133)[0m | [32mExpert 53: 1.000(4223)[0m | 
[32mExpert 55: 1.000(4229)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 18: 0.800(4106)[0m | [32mExpert 25: 0.800(4130)[0m | 
[32mExpert 27: 0.800(4136)[0m | [32mExpert 28: 0.800(4139)[0m | [32mExpert 54: 0.800(4226)[0m | [32mExpert  0: 0.600(4076)[0m | 
[32mExpert  1: 0.600(4079)[0m | [32mExpert  8: 0.600(4262)[0m | [32mExpert 10: 0.600(4082)[0m | [32mExpert 19: 0.600(4109)[0m | 
[32mExpert 30: 0.600(4148)[0m | [32mExpert 32: 0.600(4154)[0m | [32mExpert 35: 0.600(4163)[0m | [32mExpert 37: 0.600(4169)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4136, 4139, 4226, 4076, 4079, 4262, 4082, 4109, 4148, 4154, 4163, 4169]
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  8, 10, 19, 27, 28, 30, 32, 35, 37, 54 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[5]:1.0 | [6]:1.0 | [23]:1.0 | [44]:1.0 | [54]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[1]:1.0 | [20]:1.0 | [26]:1.0 | [36]:1.0 | [38]:1.0 | [57]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[16]:1.0 | [19]:1.0 | [21]:1.0 | [53]:1.0 | [54]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E28 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E30 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E54 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[0]:1.0 | [3]:1.0 | [5]:1.0 | [8]:1.0 | [55]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[0]:1.0 | [3]:1.0 | [5]:1.0 | [45]:1.0 | [47]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[10]:1.0 | [24]:1.0 | [47]:1.0 | [62]:1.0 | [63]:1.0 | [5]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[10, 24, 47, 62, 63,  5],
        [22, 36, 40, 42, 50, 25],
        [ 2, 22, 24, 28, 36, 40],
        [ 0,  2, 24, 28, 36, 50],
        [ 2, 16, 24, 28, 36, 40],
        [ 7, 18, 24, 36, 58, 32],
        [ 3, 18, 24, 36, 55, 20],
        [ 1,  2, 24, 28, 61, 36],
        [34, 37, 42, 50, 61, 12],
        [ 8, 10, 33, 52, 53, 48],
        [ 2, 28, 32, 58, 61, 16],
        [ 1,  2, 24, 28, 42, 50],
        [ 2, 16, 24, 40, 57, 43],
        [ 1,  7, 24, 50, 61, 42],
        [ 7, 15, 16, 24, 36, 32],
        [ 7, 16, 24, 32, 42, 57],
        [ 7, 15, 24, 35, 57, 36],
        [ 7, 15, 24, 36, 52, 54],
        [16, 18, 24, 28, 31, 20],
        [16, 18, 24, 31, 32, 29],
        [16, 22, 24, 28, 32, 57],
        [16, 24, 32, 40, 57, 25],
        [ 8, 10, 32, 33, 53, 20],
        [15, 16, 18, 20, 24,  3],
        [15, 16, 18, 24, 46, 20],
        [16, 18, 20, 24, 28,  3],
        [ 3, 16, 18, 20, 62, 52],
        [27, 50, 52, 58, 61,  4],
        [ 6, 33, 48, 52, 62, 10],
        [25, 27, 28, 58, 60, 52],
        [16, 19, 28, 31, 37, 50],
        [16, 25, 28, 40, 57, 32],
        [ 2,  7, 16, 18, 24, 36],
        [ 2, 18, 19, 24, 28, 29],
        [ 7, 24, 28, 50, 63, 25],
        [ 2,  7, 24, 47, 63, 15],
        [ 0,  2,  7, 16, 24, 47],
        [ 0,  7, 24, 30, 35,  8],
        [ 2,  7, 15, 24, 47,  0],
        [ 0,  7, 15, 24, 47,  2],
        [16, 18, 19, 28, 31, 29],
        [19, 24, 33, 36, 53, 27],
        [19, 21, 22, 24, 28, 16],
        [ 2, 19, 24, 28, 36, 18],
        [23, 24, 26, 33, 36, 62],
        [ 9, 26, 27, 45, 52,  3],
        [19, 21, 24, 28, 37, 61],
        [ 8, 10, 24, 33, 36, 23],
        [18, 21, 23, 24, 33, 15],
        [18, 23, 24, 26, 28, 48],
        [18, 19, 23, 24, 26, 27],
        [ 8,  9, 10, 26, 53, 52],
        [ 6, 28, 50, 52, 61,  8],
        [26, 33, 47, 52, 62, 48],
        [50, 52, 58, 60, 61, 26],
        [16, 19, 24, 31, 37, 28],
        [ 1, 16, 24, 28, 40, 22],
        [ 7, 24, 36, 47, 62, 19],
        [19, 24, 36, 42, 50, 18],
        [ 1, 28, 42, 50, 61, 24],
        [ 1,  7, 24, 36, 63, 10],
        [ 7, 17, 24, 42, 63, 13],
        [ 5,  6, 23, 35, 63, 47],
        [ 5,  6, 24, 60, 63, 25],
        [ 6, 24, 25, 27, 63, 52],
        [18, 19, 24, 28, 31, 16],
        [16, 19, 24, 33, 36, 38],
        [ 8, 16, 19, 24, 28, 58],
        [16, 19, 24, 28, 40, 44],
        [ 7, 19, 22, 24, 36, 28],
        [ 3, 18, 19, 24, 28,  9],
        [ 4, 19, 24, 28, 31, 16],
        [16, 19, 24, 30, 36, 22],
        [10, 24, 33, 36, 50, 53],
        [24, 26, 33, 36, 53, 60],
        [19, 22, 24, 28, 36, 15],
        [ 7, 15, 18, 24, 36, 19],
        [ 2, 15, 18, 19, 24, 49],
        [ 3,  8, 10, 18, 52, 24],
        [ 8, 28, 50, 52, 61,  6],
        [ 6, 33, 48, 52, 62, 35],
        [ 8, 52, 53, 58, 61, 10],
        [16, 24, 28, 31, 37, 29],
        [16, 22, 24, 28, 42,  1],
        [16, 21, 22, 24, 57, 32],
        [ 7, 15, 16, 24, 36, 18],
        [ 8, 26, 39, 53, 61, 56],
        [ 4, 23, 24, 36, 53, 47],
        [15, 16, 18, 24, 28,  7],
        [ 2, 28, 37, 47, 50, 24],
        [ 2, 17, 24, 28, 40,  1],
        [ 1,  2,  7, 16, 53, 43],
        [ 2, 16, 24, 29, 59, 20],
        [ 2,  7, 16, 24, 43, 40],
        [23, 24, 26, 35, 49, 62],
        [ 2, 16, 21, 44, 59,  7],
        [ 2, 16, 44, 45, 59, 24],
        [ 2, 16, 25, 40, 44, 24],
        [ 2, 11, 16, 43, 44,  7],
        [ 2, 18, 24, 43, 44, 16],
        [ 9, 18, 20, 24, 44,  8],
        [16, 20, 24, 45, 58, 49],
        [16, 21, 24, 28, 37, 61],
        [19, 28, 40, 47, 50, 24],
        [ 7, 35, 36, 47, 62, 24],
        [ 7, 15, 18, 24, 43,  2],
        [ 2, 18, 24, 28, 47, 43],
        [ 8, 20, 45, 49, 53, 24],
        [ 8, 28, 50, 52, 61, 62],
        [ 6, 13, 33, 35, 52, 62],
        [ 8, 10, 52, 53, 58, 61],
        [16, 24, 28, 31, 37, 19],
        [16, 21, 24, 28, 40, 22],
        [ 7,  8, 24, 33, 53, 36],
        [12, 18, 24, 41, 58, 16],
        [16, 21, 24, 36, 40, 28],
        [16, 21, 24, 33, 36, 12],
        [12, 18, 24, 31, 58, 16],
        [ 1, 16, 21, 24, 40, 50],
        [ 1,  7, 16, 24, 50, 61],
        [ 7, 24, 33, 47, 62, 36],
        [ 1,  7, 16, 20, 24, 32],
        [ 1,  7, 15, 20, 24, 18],
        [ 1, 15, 18, 20, 24,  9],
        [ 2,  7, 20, 24, 45, 58],
        [ 3, 18, 20, 24, 45, 58],
        [12, 21, 24, 37, 61, 16],
        [21, 24, 33, 36, 40, 30],
        [10, 23, 33, 36, 47, 30],
        [23, 24, 33, 36, 52, 53],
        [ 2,  3, 16, 33, 36, 40],
        [ 8, 20, 23, 33, 35, 18],
        [ 3, 18, 21, 23, 45, 20],
        [ 8, 45, 51, 52, 53,  5],
        [ 8, 28, 50, 52, 61, 27],
        [16, 21, 24, 28, 36, 19],
        [16, 19, 28, 31, 37, 43],
        [ 2, 16, 28, 33, 36, 40],
        [16, 21, 31, 44, 45, 58],
        [ 4, 16, 21, 31, 44, 19],
        [16, 21, 28, 36, 40, 22],
        [ 2,  7, 18, 24, 36, 16],
        [16, 24, 31, 36, 43, 22],
        [ 4, 11, 16, 31, 43, 36],
        [ 2, 18, 23, 24, 54,  9],
        [ 2,  3,  9, 18, 24, 36],
        [ 3,  9, 45, 52, 53,  4],
        [ 8, 37, 45, 50, 61, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[1]:1.0 | [11]:1.0 | [38]:1.0 | [39]:1.0 | [45]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[9]:1.0 | [34]:1.0 | [54]:1.0 | [56]:1.0 | [57]:1.0 | [14]:1.0 | 
---------------------------------------
return EAMC[3]
write out information.

EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2719
[1m[33mEnqueueTask: [0m[32mTask: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2749
[1m[33mEnqueueTask: [0m[32mTask: node: ID[571,3000000013] (16MB) STATE(0) TENSOR[2748,2749,2747,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[562,2700000013] (16MB) STATE(0) TENSOR[2718,2719,2717,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2984
[1m[33mEnqueueTask: [0m[32mTask: node: ID[960,2f0000001f] (16MB) STATE(0) TENSOR[2983,2984,2982,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[3]:1.0 | [11]:1.0 | [31]:1.0 | [50]:1.0 | [57]:2.0 | [47]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[8]:1.0 | [37]:1.0 | [59]:1.0 | [62]:2.0 | [63]:2.0 | [13]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[0]:1.0 | [5]:1.0 | [22]:1.0 | [46]:1.0 | [48]:1.0 | [21]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[3]:1.0 | [18]:1.0 | [22]:1.0 | [34]:1.0 | [60]:1.0 | [13]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[12]:1.0 | [18]:1.0 | [39]:1.0 | [42]:1.0 | [50]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[11]:1.0 | [37]:1.0 | [46]:1.0 | [50]:1.0 | [56]:1.0 | [16]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[11, 37, 46, 50, 56, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 44: 2.000(2737)[0m | [32mExpert  7: 2.000(2803)[0m | [32mExpert 63: 2.000(2800)[0m | [32mExpert 12: 1.800(2632)[0m | 
[32mExpert 13: 1.800(2635)[0m | [32mExpert 27: 1.800(2680)[0m | [32mExpert 10: 1.800(2626)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert 55: 1.600(2773)[0m | [32mExpert 41: 1.400(2728)[0m | [32mExpert 45: 1.400(2740)[0m | [32mExpert 46: 1.400(2743)[0m | 
[32mExpert 17: 1.200(2647)[0m | [32mExpert 19: 1.200(2653)[0m | [32mExpert 38: 1.200(2716)[0m | [32mExpert 31: 1.000(2695)[0m | 
[32mExpert 29: 1.000(2686)[0m | [32mExpert 33: 1.000(2701)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert  8: 0.800(2806)[0m | 
[32mExpert 11: 0.800(2629)[0m | [32mExpert 16: 0.800(2644)[0m | [32mExpert 34: 0.800(2704)[0m | [32mExpert 35: 0.800(2707)[0m | 
[32mExpert 50: 0.800(2758)[0m | [32mExpert  4: 0.600(2722)[0m | [32mExpert  5: 0.600(2755)[0m | [32mExpert  9: 0.600(2809)[0m | 
[32mExpert 14: 0.600(2638)[0m | [32mExpert 32: 0.600(2698)[0m | [32mExpert 39: 0.600(2719)[0m | [32mExpert 48: 0.600(2749)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2629, 2644, 2704, 2707, 2758, 2722, 2755, 2809, 2638, 2698, 2719, 2749]
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
Prefetching [1;36mTensor 2719[0m â†’ GPU 0
Prefetching [1;36mTensor 2749[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  9, 11, 14, 16, 32, 34, 35, 39, 48, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:1.0 | [38]:1.0 | [41]:1.0 | [42]:1.0 | [50]:1.0 | [26]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[6]:1.0 | [33]:1.0 | [45]:1.0 | [46]:1.0 | [55]:1.0 | [8]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[35]:1.0 | [41]:1.0 | [45]:1.0 | [46]:1.0 | [48]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E48 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[17]:1.0 | [30]:1.0 | [41]:1.0 | [55]:1.0 | [60]:1.0 | [53]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[8]:1.0 | [28]:1.0 | [43]:1.0 | [47]:1.0 | [54]:2.0 | [35]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[29]:1.0 | [38]:1.0 | [42]:1.0 | [43]:1.0 | [46]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[29, 38, 42, 43, 46, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 14: 2.800(2876)[0m | [32mExpert 36: 2.600(2948)[0m | [32mExpert 48: 2.400(2987)[0m | [32mExpert 38: 2.200(2954)[0m | 
[32mExpert  6: 1.800(3026)[0m | [32mExpert 49: 1.800(2990)[0m | [32mExpert 52: 1.600(3002)[0m | [32mExpert 55: 1.600(3011)[0m | 
[32mExpert  9: 1.600(3047)[0m | [32mExpert 26: 1.600(2915)[0m | [32mExpert  5: 1.400(2993)[0m | [32mExpert 16: 1.400(2882)[0m | 
[32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | [32mExpert  4: 1.200(2960)[0m | [32mExpert 61: 1.200(3032)[0m | 
[32mExpert 11: 1.000(2867)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 23: 0.800(2906)[0m | [32mExpert 33: 0.800(2939)[0m | 
[32mExpert  7: 0.600(3041)[0m | [32mExpert 12: 0.600(2870)[0m | [32mExpert 15: 0.600(2879)[0m | [32mExpert 19: 0.600(2891)[0m | 
[32mExpert 21: 0.600(2900)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 31: 0.600(2933)[0m | [32mExpert 34: 0.600(2942)[0m | 
[32mExpert 39: 0.600(2957)[0m | [32mExpert 41: 0.600(2966)[0m | [32mExpert 43: 0.600(2972)[0m | [32mExpert 47: 0.600(2984)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3041, 2870, 2879, 2891, 2900, 2930, 2933, 2942, 2957, 2966, 2972, 2984]
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2984[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7, 12, 15, 19, 21, 30, 31, 34, 39, 41, 43, 47 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:1.0 | [21]:1.0 | [29]:1.0 | [33]:1.0 | [44]:1.0 | [1]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[9]:1.0 | [15]:1.0 | [28]:1.0 | [30]:1.0 | [33]:1.0 | [25]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[0]:1.0 | [4]:1.0 | [6]:1.0 | [16]:1.0 | [49]:1.0 | [50]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[15]:1.0 | [16]:1.0 | [17]:1.0 | [24]:1.0 | [41]:1.0 | [33]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[15]:1.0 | [25]:1.0 | [26]:2.0 | [40]:1.0 | [62]:1.0 | [55]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[18]:1.0 | [30]:1.0 | [46]:1.0 | [57]:1.0 | [59]:1.0 | [3]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[18, 30, 46, 57, 59,  3]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4136
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1330,1b0000002b] (16MB) STATE(0) TENSOR[4135,4136,4134,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4163
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1338,230000002b] (16MB) STATE(0) TENSOR[4162,4163,4161,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[90mTop 20 Experts:[0m
[32mExpert 44: 2.600(4193)[0m | [32mExpert 21: 2.000(4118)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 17: 1.800(4103)[0m | 
[32mExpert 41: 1.800(4184)[0m | [32mExpert 48: 1.800(4205)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 54: 1.600(4226)[0m | 
[32mExpert 19: 1.400(4109)[0m | [32mExpert 12: 1.400(4088)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert  9: 1.200(4265)[0m | 
[32mExpert 13: 1.200(4091)[0m | [32mExpert 14: 1.200(4094)[0m | [32mExpert 42: 1.200(4187)[0m | [32mExpert 52: 1.200(4220)[0m | 
[32mExpert 16: 1.000(4100)[0m | [32mExpert  5: 1.000(4211)[0m | [32mExpert 15: 1.000(4097)[0m | [32mExpert 26: 1.000(4133)[0m | 
[32mExpert 55: 1.000(4229)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 18: 0.800(4106)[0m | [32mExpert 25: 0.800(4130)[0m | 
[32mExpert 27: 0.800(4136)[0m | [32mExpert  0: 0.600(4076)[0m | [32mExpert  1: 0.600(4079)[0m | [32mExpert  8: 0.600(4262)[0m | 
[32mExpert 10: 0.600(4082)[0m | [32mExpert 30: 0.600(4148)[0m | [32mExpert 32: 0.600(4154)[0m | [32mExpert 35: 0.600(4163)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4229, 4232, 4106, 4130, 4136, 4076, 4079, 4262, 4082, 4148, 4154, 4163]
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4136[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4163[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  8, 10, 18, 25, 27, 30, 32, 35, 55, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:1.0 | [19]:1.0 | [24]:1.0 | [41]:1.0 | [47]:1.0 | [30]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[15]:1.0 | [22]:1.0 | [25]:1.0 | [44]:1.0 | [50]:1.0 | [43]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[14]:1.0 | [17]:1.0 | [27]:1.0 | [48]:1.0 | [51]:1.0 | [62]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E27 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[11]:2.0 | [21]:1.0 | [33]:1.0 | [55]:2.0 | [60]:1.0 | [34]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[7]:1.0 | [12]:1.0 | [22]:1.0 | [23]:1.0 | [57]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[8]:1.0 | [28]:1.0 | [50]:1.0 | [52]:1.0 | [61]:1.0 | [60]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 8, 28, 50, 52, 61, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:1.0 | [10]:1.0 | [12]:1.0 | [45]:2.0 | [57]:1.0 | [1]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[26]:1.0 | [30]:1.0 | [34]:2.0 | [51]:1.0 | [56]:2.0 | [42]:1.0 | 
---------------------------------------
return EAMC[3]

EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2891
[1m[33mEnqueueTask: [0m[32mTask: node: ID[932,130000001f] (16MB) STATE(0) TENSOR[2890,2891,2889,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[11]:2.0 | [18]:1.0 | [31]:2.0 | [50]:2.0 | [57]:3.0 | [47]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[8]:2.0 | [27]:1.0 | [38]:2.0 | [62]:3.0 | [63]:3.0 | [29]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[0]:2.0 | [5]:2.0 | [21]:2.0 | [46]:2.0 | [48]:2.0 | [22]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[3]:2.0 | [18]:2.0 | [22]:2.0 | [34]:2.0 | [60]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[12]:2.0 | [18]:2.0 | [29]:1.0 | [39]:2.0 | [50]:2.0 | [42]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[11]:2.0 | [16]:2.0 | [37]:2.0 | [46]:2.0 | [56]:2.0 | [50]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[11, 16, 37, 46, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 2.200(2728)[0m | [32mExpert 45: 2.200(2740)[0m | [32mExpert 46: 2.200(2743)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert  7: 2.000(2803)[0m | [32mExpert 63: 2.000(2800)[0m | [32mExpert 12: 1.800(2632)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 27: 1.800(2680)[0m | [32mExpert 10: 1.800(2626)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 35: 1.600(2707)[0m | 
[32mExpert 55: 1.600(2773)[0m | [32mExpert 48: 1.400(2749)[0m | [32mExpert  1: 1.200(2623)[0m | [32mExpert 17: 1.200(2647)[0m | 
[32mExpert 19: 1.200(2653)[0m | [32mExpert 38: 1.200(2716)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 29: 1.000(2686)[0m | 
[32mExpert 33: 1.000(2701)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert  8: 0.800(2806)[0m | [32mExpert 11: 0.800(2629)[0m | 
[32mExpert 16: 0.800(2644)[0m | [32mExpert 34: 0.800(2704)[0m | [32mExpert 50: 0.800(2758)[0m | [32mExpert  4: 0.600(2722)[0m | 
[32mExpert  5: 0.600(2755)[0m | [32mExpert  9: 0.600(2809)[0m | [32mExpert 14: 0.600(2638)[0m | [32mExpert 32: 0.600(2698)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2746, 2806, 2629, 2644, 2704, 2758, 2722, 2755, 2809, 2638, 2698]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  8,  9, 11, 14, 16, 32, 33, 34, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:2.0 | [38]:2.0 | [41]:2.0 | [42]:2.0 | [50]:2.0 | [8]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[8]:2.0 | [33]:2.0 | [45]:2.0 | [46]:2.0 | [55]:2.0 | [6]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[1]:2.0 | [35]:2.0 | [41]:2.0 | [45]:2.0 | [46]:2.0 | [48]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[30]:2.0 | [41]:2.0 | [55]:2.0 | [59]:1.0 | [60]:2.0 | [17]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[8]:2.0 | [28]:2.0 | [43]:2.0 | [47]:2.0 | [54]:3.0 | [16]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[29]:2.0 | [38]:2.0 | [41]:2.0 | [42]:2.0 | [46]:2.0 | [57]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[29, 38, 41, 42, 46, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 14: 2.800(2876)[0m | [32mExpert  6: 2.600(3026)[0m | [32mExpert 36: 2.600(2948)[0m | [32mExpert 49: 2.600(2990)[0m | 
[32mExpert 48: 2.400(2987)[0m | [32mExpert 16: 2.200(2882)[0m | [32mExpert 38: 2.200(2954)[0m | [32mExpert  4: 2.000(2960)[0m | 
[32mExpert 52: 1.600(3002)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 26: 1.600(2915)[0m | 
[32mExpert  5: 1.400(2993)[0m | [32mExpert 50: 1.400(2996)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | 
[32mExpert  0: 1.200(2858)[0m | [32mExpert 61: 1.200(3032)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 17: 1.000(2885)[0m | 
[32mExpert 23: 0.800(2906)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  7: 0.600(3041)[0m | [32mExpert 12: 0.600(2870)[0m | 
[32mExpert 15: 0.600(2879)[0m | [32mExpert 19: 0.600(2891)[0m | [32mExpert 21: 0.600(2900)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 31: 0.600(2933)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 39: 0.600(2957)[0m | [32mExpert 41: 0.600(2966)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2906, 2939, 3041, 2870, 2879, 2891, 2900, 2930, 2933, 2942, 2957, 2966]
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2891[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7, 12, 15, 19, 21, 23, 30, 31, 33, 34, 39, 41 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:2.0 | [21]:2.0 | [29]:2.0 | [33]:2.0 | [44]:2.0 | [41]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[9]:2.0 | [28]:2.0 | [30]:2.0 | [33]:2.0 | [50]:1.0 | [25]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[0]:2.0 | [6]:2.0 | [15]:1.0 | [16]:2.0 | [49]:2.0 | [19]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E15 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[15]:2.0 | [17]:2.0 | [24]:2.0 | [41]:2.0 | [58]:1.0 | [33]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[15]:2.0 | [25]:2.0 | [28]:1.0 | [40]:2.0 | [57]:1.0 | [55]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[17]:1.0 | [18]:2.0 | [30]:2.0 | [37]:1.0 | [46]:2.0 | [21]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[17, 18, 30, 37, 46, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[90mTop 20 Experts:[0m
[32mExpert 17: 2.600(4103)[0m | [32mExpert 44: 2.600(4193)[0m | [32mExpert 48: 2.600(4205)[0m | [32mExpert 14: 2.000(4094)[0m | 
[32mExpert 21: 2.000(4118)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 41: 1.800(4184)[0m | [32mExpert 27: 1.600(4136)[0m | 
[32mExpert 28: 1.600(4139)[0m | [32mExpert 54: 1.600(4226)[0m | [32mExpert 19: 1.400(4109)[0m | [32mExpert 12: 1.400(4088)[0m | 
[32mExpert 51: 1.200(4217)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert  9: 1.200(4265)[0m | [32mExpert 13: 1.200(4091)[0m | 
[32mExpert 42: 1.200(4187)[0m | [32mExpert 52: 1.200(4220)[0m | [32mExpert 16: 1.000(4100)[0m | [32mExpert 62: 1.000(4253)[0m | 
[32mExpert  5: 1.000(4211)[0m | [32mExpert 15: 1.000(4097)[0m | [32mExpert 26: 1.000(4133)[0m | [32mExpert 55: 1.000(4229)[0m | 
[32mExpert 56: 1.000(4232)[0m | [32mExpert 18: 0.800(4106)[0m | [32mExpert 25: 0.800(4130)[0m | [32mExpert  0: 0.600(4076)[0m | 
[32mExpert  1: 0.600(4079)[0m | [32mExpert  8: 0.600(4262)[0m | [32mExpert 10: 0.600(4082)[0m | [32mExpert 30: 0.600(4148)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4211, 4097, 4133, 4229, 4232, 4106, 4130, 4076, 4079, 4262, 4082, 4148]
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  8, 10, 15, 18, 25, 26, 30, 55, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:2.0 | [19]:2.0 | [24]:2.0 | [41]:2.0 | [47]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[15]:2.0 | [22]:2.0 | [25]:2.0 | [44]:2.0 | [50]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[14]:2.0 | [27]:2.0 | [48]:2.0 | [54]:2.0 | [62]:2.0 | [17]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 22 MLP ==
[0m
[21]:2.0 | [37]:1.0 | [39]:1.0 | [55]:3.0 | [60]:2.0 | [46]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[7]:2.0 | [23]:2.0 | [32]:1.0 | [40]:2.0 | [57]:2.0 | [3]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[19]:1.0 | [28]:2.0 | [37]:1.0 | [50]:2.0 | [61]:2.0 | [58]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[19, 28, 37, 50, 61, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:2.0 | [10]:2.0 | [12]:2.0 | [57]:2.0 | [63]:1.0 | [21]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[26]:2.0 | [30]:2.0 | [34]:3.0 | [36]:1.0 | [56]:3.0 | [32]:1.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2698
[1m[33mEnqueueTask: [0m[32mTask: node: ID[555,2000000013] (16MB) STATE(0) TENSOR[2697,2698,2696,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2957
[1m[33mEnqueueTask: [0m[32mTask: node: ID[952,270000001f] (16MB) STATE(0) TENSOR[2956,2957,2955,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[0]:1.0 | [9]:1.0 | [13]:1.0 | [37]:1.0 | [52]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[22]:1.0 | [35]:2.0 | [42]:1.0 | [58]:1.0 | [63]:4.0 | [14]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[0]:3.0 | [7]:1.0 | [42]:1.0 | [48]:3.0 | [62]:1.0 | [17]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[10]:1.0 | [18]:3.0 | [34]:3.0 | [38]:1.0 | [59]:1.0 | [60]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[18]:3.0 | [38]:1.0 | [39]:3.0 | [41]:1.0 | [50]:3.0 | [42]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[6]:1.0 | [19]:1.0 | [37]:3.0 | [46]:3.0 | [56]:3.0 | [1]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 6, 19, 37, 46, 56,  1]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 3.000(2728)[0m | [32mExpert 45: 3.000(2740)[0m | [32mExpert 46: 3.000(2743)[0m | [32mExpert 35: 2.400(2707)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert  7: 2.000(2803)[0m | 
[32mExpert 63: 2.000(2800)[0m | [32mExpert 12: 1.800(2632)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 27: 1.800(2680)[0m | 
[32mExpert 10: 1.800(2626)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 55: 1.600(2773)[0m | [32mExpert 17: 1.200(2647)[0m | 
[32mExpert 19: 1.200(2653)[0m | [32mExpert 38: 1.200(2716)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 29: 1.000(2686)[0m | 
[32mExpert 33: 1.000(2701)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert  8: 0.800(2806)[0m | [32mExpert 11: 0.800(2629)[0m | 
[32mExpert 16: 0.800(2644)[0m | [32mExpert 34: 0.800(2704)[0m | [32mExpert 50: 0.800(2758)[0m | [32mExpert  4: 0.600(2722)[0m | 
[32mExpert  5: 0.600(2755)[0m | [32mExpert  9: 0.600(2809)[0m | [32mExpert 14: 0.600(2638)[0m | [32mExpert 32: 0.600(2698)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2746, 2806, 2629, 2644, 2704, 2758, 2722, 2755, 2809, 2638, 2698]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2698[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  8,  9, 11, 14, 16, 32, 33, 34, 47, 50 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:2.0 | [26]:2.0 | [38]:3.0 | [41]:3.0 | [50]:3.0 | [16]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[8]:3.0 | [32]:1.0 | [45]:3.0 | [46]:3.0 | [49]:1.0 | [33]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[19]:1.0 | [38]:1.0 | [41]:3.0 | [45]:3.0 | [46]:3.0 | [53]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[30]:3.0 | [41]:3.0 | [50]:1.0 | [57]:1.0 | [59]:2.0 | [55]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[23]:1.0 | [28]:3.0 | [31]:1.0 | [43]:3.0 | [44]:1.0 | [47]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[4]:2.0 | [28]:1.0 | [29]:3.0 | [37]:2.0 | [41]:3.0 | [62]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 4, 28, 29, 37, 41, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 3.400(3026)[0m | [32mExpert 49: 3.400(2990)[0m | [32mExpert 16: 3.000(2882)[0m | [32mExpert 14: 2.800(2876)[0m | 
[32mExpert 36: 2.600(2948)[0m | [32mExpert 48: 2.400(2987)[0m | [32mExpert 38: 2.200(2954)[0m | [32mExpert  0: 2.000(2858)[0m | 
[32mExpert  4: 2.000(2960)[0m | [32mExpert 52: 1.600(3002)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | 
[32mExpert 26: 1.600(2915)[0m | [32mExpert  5: 1.400(2993)[0m | [32mExpert 15: 1.400(2879)[0m | [32mExpert 19: 1.400(2891)[0m | 
[32mExpert 50: 1.400(2996)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | [32mExpert 61: 1.200(3032)[0m | 
[32mExpert 11: 1.000(2867)[0m | [32mExpert 17: 1.000(2885)[0m | [32mExpert 23: 0.800(2906)[0m | [32mExpert 33: 0.800(2939)[0m | 
[32mExpert  7: 0.600(3041)[0m | [32mExpert 12: 0.600(2870)[0m | [32mExpert 21: 0.600(2900)[0m | [32mExpert 30: 0.600(2930)[0m | 
[32mExpert 31: 0.600(2933)[0m | [32mExpert 34: 0.600(2942)[0m | [32mExpert 39: 0.600(2957)[0m | [32mExpert 41: 0.600(2966)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2867, 2885, 2906, 2939, 3041, 2870, 2900, 2930, 2933, 2942, 2957, 2966]
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
Prefetching [1;36mTensor 2957[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7, 11, 12, 17, 21, 23, 30, 31, 33, 34, 39, 41 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[5]:1.0 | [6]:3.0 | [18]:1.0 | [29]:3.0 | [44]:3.0 | [17]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[9]:3.0 | [26]:1.0 | [28]:3.0 | [49]:1.0 | [56]:1.0 | [7]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[10]:1.0 | [16]:3.0 | [49]:3.0 | [50]:2.0 | [58]:1.0 | [19]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[5]:1.0 | [16]:2.0 | [21]:1.0 | [24]:3.0 | [41]:3.0 | [53]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[3]:1.0 | [5]:1.0 | [25]:3.0 | [40]:3.0 | [62]:2.0 | [35]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[13]:1.0 | [18]:3.0 | [22]:1.0 | [46]:3.0 | [52]:1.0 | [8]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[13, 18, 22, 46, 52,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 3.400(4103)[0m | [32mExpert 48: 3.400(4205)[0m | [32mExpert 14: 2.800(4094)[0m | [32mExpert 44: 2.600(4193)[0m | 
[32mExpert 27: 2.400(4136)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert 21: 2.000(4118)[0m | [32mExpert 62: 1.800(4253)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 41: 1.800(4184)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 19: 1.400(4109)[0m | 
[32mExpert 12: 1.400(4088)[0m | EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4262
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1311,80000002b] (16MB) STATE(0) TENSOR[4261,4262,4260,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4148
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1333,1e0000002b] (16MB) STATE(0) TENSOR[4147,4148,4146,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
[32mExpert 51: 1.200(4217)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert  9: 1.200(4265)[0m | 
[32mExpert 13: 1.200(4091)[0m | [32mExpert 42: 1.200(4187)[0m | [32mExpert 52: 1.200(4220)[0m | [32mExpert 16: 1.000(4100)[0m | 
[32mExpert  5: 1.000(4211)[0m | [32mExpert 15: 1.000(4097)[0m | [32mExpert 26: 1.000(4133)[0m | [32mExpert 55: 1.000(4229)[0m | 
[32mExpert 56: 1.000(4232)[0m | [32mExpert 18: 0.800(4106)[0m | [32mExpert 25: 0.800(4130)[0m | [32mExpert  0: 0.600(4076)[0m | 
[32mExpert  1: 0.600(4079)[0m | [32mExpert  8: 0.600(4262)[0m | [32mExpert 10: 0.600(4082)[0m | [32mExpert 30: 0.600(4148)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4211, 4097, 4133, 4229, 4232, 4106, 4130, 4076, 4079, 4262, 4082, 4148]
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4262[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4148[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  8, 10, 15, 18, 25, 26, 30, 55, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[3]:1.0 | [14]:3.0 | [24]:3.0 | [31]:1.0 | [53]:1.0 | [29]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[6]:1.0 | [15]:3.0 | [43]:2.0 | [55]:1.0 | [60]:1.0 | [38]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[2]:1.0 | [17]:3.0 | [21]:2.0 | [23]:1.0 | [48]:3.0 | [58]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 22 MLP ==
[0m
[2]:1.0 | [11]:3.0 | [21]:3.0 | [55]:4.0 | [58]:1.0 | [3]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[13]:1.0 | [22]:2.0 | [35]:1.0 | [47]:2.0 | [54]:1.0 | [33]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[10]:2.0 | [23]:1.0 | [33]:1.0 | [48]:1.0 | [52]:2.0 | [36]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[10, 23, 33, 48, 52, 36]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:3.0 | [25]:1.0 | [38]:2.0 | [47]:1.0 | [62]:1.0 | [52]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[20]:1.0 | [29]:1.0 | [38]:1.0 | [49]:1.0 | [59]:1.0 | [62]:1.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:1.0 | [20]:1.0 | [26]:2.0 | [52]:2.0 | [56]:2.0 | [9]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[35]:3.0 | [38]:3.0 | [42]:2.0 | [57]:1.0 | [63]:5.0 | [0]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[0]:4.0 | [5]:3.0 | [7]:2.0 | [22]:3.0 | [42]:2.0 | [54]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[13]:2.0 | [18]:4.0 | [26]:1.0 | [34]:4.0 | [59]:2.0 | [29]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[38]:2.0 | [39]:4.0 | [40]:1.0 | [41]:2.0 | [50]:4.0 | [10]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[12]:1.0 | [19]:2.0 | [28]:1.0 | [35]:1.0 | [56]:4.0 | [46]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[12, 19, 28, 35, 56, 46]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 3.800(2728)[0m | [32mExpert 45: 3.800(2740)[0m | [32mExpert 46: 3.800(2743)[0m | [32mExpert 35: 2.400(2707)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 19: 2.000(2653)[0m | [32mExpert 38: 2.000(2716)[0m | 
[32mExpert 44: 2.000(2737)[0m | [32mExpert  7: 2.000(2803)[0m | [32mExpert 63: 2.000(2800)[0m | [32mExpert 12: 1.800(2632)[0m | 
[32mExpert 13: 1.800(2635)[0m | [32mExpert 27: 1.800(2680)[0m | [32mExpert 10: 1.800(2626)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert 55: 1.600(2773)[0m | [32mExpert 17: 1.200(2647)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 29: 1.000(2686)[0m | 
[32mExpert 33: 1.000(2701)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert 53: 0.800(2767)[0m | [32mExpert  8: 0.800(2806)[0m | 
[32mExpert 11: 0.800(2629)[0m | [32mExpert 16: 0.800(2644)[0m | [32mExpert 34: 0.800(2704)[0m | [32mExpert 50: 0.800(2758)[0m | 
[32mExpert  4: 0.600(2722)[0m | [32mExpert  5: 0.600(2755)[0m | [32mExpert  9: 0.600(2809)[0m | [32mExpert 14: 0.600(2638)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2746, 2767, 2806, 2629, 2644, 2704, 2758, 2722, 2755, 2809, 2638]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  8,  9, 11, 14, 16, 33, 34, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:3.0 | [26]:3.0 | [41]:4.0 | [42]:3.0 | [50]:4.0 | [17]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[6]:3.0 | [8]:4.0 | [18]:1.0 | [46]:4.0 | [49]:2.0 | [45]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[17]:1.0 | [33]:1.0 | [38]:2.0 | [41]:4.0 | [46]:4.0 | [45]:4.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:4.0 | [41]:4.0 | [50]:2.0 | [51]:1.0 | [57]:2.0 | [55]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[5]:1.0 | [28]:4.0 | [43]:4.0 | [53]:1.0 | [54]:4.0 | [34]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[29]:4.0 | [30]:2.0 | [41]:4.0 | [42]:3.0 | [57]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[29, 30, 41, 42, 57, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 49: 4.200(2990)[0m | [32mExpert 16: 3.800(2882)[0m | [32mExpert  6: 3.400(3026)[0m | [32mExpert 14: 2.800(2876)[0m | 
[32mExpert 36: 2.600(2948)[0m | [32mExpert 48: 2.400(2987)[0m | [32mExpert 19: 2.200(2891)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 38: 2.200(2954)[0m | [32mExpert  0: 2.000(2858)[0m | [32mExpert  4: 2.000(2960)[0m | [32mExpert 52: 1.600(3002)[0m | 
[32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 26: 1.600(2915)[0m | [32mExpert  5: 1.400(2993)[0m | 
[32mExpert 15: 1.400(2879)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | [32mExpert 61: 1.200(3032)[0m | 
[32mExpert 10: 1.000(2864)[0m | [32mExpert 58: 1.000(3020)[0m | [32mExpert 11: 1.000(2867)[0m | [32mExpert 17: 1.000(2885)[0m | 
[32mExpert 23: 0.800(2906)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  7: 0.600(3041)[0m | [32mExpert 12: 0.600(2870)[0m | 
[32mExpert 21: 0.600(2900)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 31: 0.600(2933)[0m | [32mExpert 34: 0.600(2942)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2864, 3020, 2867, 2885, 2906, 2939, 3041, 2870, 2900, 2930, 2933, 2942]
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7, 10, 11, 12, 17, 21, 23, 30, 31, 33, 34, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[29]:4.0 | [30]:1.0 | [33]:3.0 | [41]:2.0 | [44]:4.0 | [40]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[9]:4.0 | [28]:4.0 | [30]:3.0 | [33]:3.0 | [50]:2.0 | [63]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[0]:3.0 | [6]:3.0 | [8]:1.0 | [16]:4.0 | [38]:1.0 | [58]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E58 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[15]:3.0 | [17]:3.0 | [24]:4.0 | [41]:4.0 | [50]:1.0 | [32]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[25]:4.0 | [40]:4.0 | [52]:1.0 | [55]:3.0 | [57]:2.0 | [36]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[8]:2.0 | [18]:4.0 | [21]:2.0 | [46]:4.0 | [53]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 8, 18, 21, 46, 53, 40]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4229
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1358,370000002b] (16MB) STATE(0) TENSOR[4228,4229,4227,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
[90mTop 20 Experts:[0m
[32mExpert 17: 4.200(4103)[0m | [32mExpert 48: 4.200(4205)[0m | [32mExpert 14: 2.800(4094)[0m | [32mExpert 21: 2.800(4118)[0m | 
[32mExpert 44: 2.600(4193)[0m | [32mExpert 27: 2.400(4136)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert 62: 1.800(4253)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 41: 1.800(4184)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 19: 1.400(4109)[0m | 
[32mExpert 12: 1.400(4088)[0m | [32mExpert  2: 1.200(4112)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 51: 1.200(4217)[0m | 
[32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert  9: 1.200(4265)[0m | [32mExpert 13: 1.200(4091)[0m | 
[32mExpert 42: 1.200(4187)[0m | [32mExpert 52: 1.200(4220)[0m | [32mExpert 16: 1.000(4100)[0m | [32mExpert  5: 1.000(4211)[0m | 
[32mExpert 15: 1.000(4097)[0m | [32mExpert 26: 1.000(4133)[0m | [32mExpert 55: 1.000(4229)[0m | [32mExpert 56: 1.000(4232)[0m | 
[32mExpert 18: 0.800(4106)[0m | [32mExpert 25: 0.800(4130)[0m | [32mExpert  0: 0.600(4076)[0m | [32mExpert  1: 0.600(4079)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4187, 4220, 4100, 4211, 4097, 4133, 4229, 4232, 4106, 4130, 4076, 4079]
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4229[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5, 15, 16, 18, 25, 26, 42, 52, 55, 56 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:2.0 | [14]:4.0 | [17]:1.0 | [41]:3.0 | [47]:3.0 | [55]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[15]:4.0 | [17]:1.0 | [25]:3.0 | [32]:1.0 | [50]:3.0 | [29]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[9]:1.0 | [14]:3.0 | [48]:4.0 | [55]:1.0 | [61]:1.0 | [12]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[5]:2.0 | [21]:4.0 | [33]:2.0 | [40]:1.0 | [60]:3.0 | [55]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[7]:3.0 | [23]:3.0 | [38]:1.0 | [50]:1.0 | [57]:3.0 | [51]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[16]:1.0 | [25]:1.0 | [28]:3.0 | [58]:2.0 | [61]:3.0 | [60]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[16, 25, 28, 58, 61, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:4.0 | [12]:3.0 | [23]:1.0 | [35]:1.0 | [45]:3.0 | [58]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[1]:1.0 | [12]:1.0 | [27]:1.0 | [30]:3.0 | [51]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[3]
1. EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3032
[1m[33mEnqueueTask: [0m[32mTask: node: ID[974,3d0000001f] (16MB) STATE(0) TENSOR[3031,3032,3030,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2867
[1m[33mEnqueueTask: [0m[32mTask: node: ID[924,b0000001f] (16MB) STATE(0) TENSOR[2866,2867,2865,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2933
[1m[33mEnqueueTask: [0m[32mTask: node: ID[944,1f0000001f] (16MB) STATE(0) TENSOR[2932,2933,2931,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:2.0 | [26]:3.0 | [44]:2.0 | [45]:1.0 | [46]:1.0 | [11]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[21]:1.0 | [35]:4.0 | [38]:4.0 | [42]:3.0 | [60]:2.0 | [63]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[3]:1.0 | [14]:1.0 | [17]:2.0 | [42]:3.0 | [46]:3.0 | [7]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[2]:1.0 | [10]:2.0 | [15]:1.0 | [29]:3.0 | [59]:3.0 | [37]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[35]:1.0 | [38]:3.0 | [41]:3.0 | [42]:4.0 | [44]:1.0 | [15]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[6]:2.0 | [19]:3.0 | [20]:1.0 | [27]:1.0 | [41]:1.0 | [46]:5.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 6, 19, 20, 27, 41, 46]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 4.600(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 46: 4.600(2743)[0m | [32mExpert 38: 2.800(2716)[0m | 
[32mExpert 35: 2.400(2707)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 17: 2.000(2647)[0m | 
[32mExpert 19: 2.000(2653)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert  7: 2.000(2803)[0m | [32mExpert 63: 2.000(2800)[0m | 
[32mExpert 12: 1.800(2632)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 27: 1.800(2680)[0m | [32mExpert 33: 1.800(2701)[0m | 
[32mExpert 10: 1.800(2626)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 55: 1.600(2773)[0m | [32mExpert 31: 1.000(2695)[0m | 
[32mExpert 29: 1.000(2686)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert 53: 0.800(2767)[0m | [32mExpert  8: 0.800(2806)[0m | 
[32mExpert 11: 0.800(2629)[0m | [32mExpert 16: 0.800(2644)[0m | [32mExpert 34: 0.800(2704)[0m | [32mExpert 50: 0.800(2758)[0m | 
[32mExpert  4: 0.600(2722)[0m | [32mExpert  5: 0.600(2755)[0m | [32mExpert  9: 0.600(2809)[0m | [32mExpert 14: 0.600(2638)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2686, 2746, 2767, 2806, 2629, 2644, 2704, 2758, 2722, 2755, 2809, 2638]
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  8,  9, 11, 14, 16, 29, 34, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:1.0 | [11]:1.0 | [23]:1.0 | [46]:1.0 | [50]:5.0 | [39]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[13]:1.0 | [40]:1.0 | [46]:5.0 | [49]:3.0 | [52]:1.0 | [8]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[4]:1.0 | [10]:1.0 | [16]:1.0 | [19]:2.0 | [46]:5.0 | [55]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E4 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E16 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[25]:1.0 | [33]:1.0 | [41]:5.0 | [42]:2.0 | [61]:1.0 | [59]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[2]:1.0 | [34]:2.0 | [40]:1.0 | [49]:1.0 | [59]:1.0 | [16]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[12]:1.0 | [16]:1.0 | [23]:1.0 | [37]:3.0 | [45]:2.0 | [61]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[12, 16, 23, 37, 45, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.600(2882)[0m | [32mExpert  6: 4.200(3026)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert 38: 3.000(2954)[0m | 
[32mExpert  0: 2.800(2858)[0m | [32mExpert 14: 2.800(2876)[0m | [32mExpert 36: 2.600(2948)[0m | [32mExpert 48: 2.400(2987)[0m | 
[32mExpert 19: 2.200(2891)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert  4: 2.000(2960)[0m | [32mExpert 58: 1.800(3020)[0m | 
[32mExpert 52: 1.600(3002)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 26: 1.600(2915)[0m | 
[32mExpert  5: 1.400(2993)[0m | [32mExpert 15: 1.400(2879)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | 
[32mExpert  8: 1.200(3044)[0m | [32mExpert 61: 1.200(3032)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 11: 1.000(2867)[0m | 
[32mExpert 17: 1.000(2885)[0m | [32mExpert 23: 0.800(2906)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  7: 0.600(3041)[0m | 
[32mExpert 12: 0.600(2870)[0m | [32mExpert 21: 0.600(2900)[0m | [32mExpert 30: 0.600(2930)[0m | [32mExpert 31: 0.600(2933)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3044, 3032, 2864, 2867, 2885, 2906, 2939, 3041, 2870, 2900, 2930, 2933]
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 3032[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2867[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
Prefetching [1;36mTensor 2933[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8, 10, 11, 12, 17, 21, 23, 30, 31, 33, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[10]:1.0 | [15]:1.0 | [26]:1.0 | [45]:1.0 | [48]:1.0 | [24]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[0]:1.0 | [5]:2.0 | [19]:1.0 | [46]:1.0 | [59]:1.0 | [23]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[11]:1.0 | [17]:1.0 | [26]:1.0 | [40]:1.0 | [61]:1.0 | [52]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E11 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E61 â•‘[0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[5]:2.0 | [20]:1.0 | [32]:2.0 | [37]:1.0 | [53]:2.0 | [33]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[2]:1.0 | [3]:2.0 | [10]:1.0 | [23]:1.0 | [28]:2.0 | [24]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[2]:2.0 | [50]:1.0 | [52]:2.0 | [58]:1.0 | [63]:1.0 | [8]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 2, 50, 52, 58, 63,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 5.000(4205)[0m | [32mExpert 17: 4.200(4103)[0m | [32mExpert 14: 3.600(4094)[0m | [32mExpert 21: 2.800(4118)[0m | 
[32mExpert 44: 2.600(4193)[0m | [32mExpert 27: 2.400(4136)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert 12: 2.200(4088)[0m | 
[32mExpert  9: 2.000(4265)[0m | [32mExpert 62: 1.800(4253)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 55: 1.800(4229)[0m | 
[32mExpert 41: 1.800(4184)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 19: 1.400(4109)[0m | [32mExpert  2: 1.200(4112)[0m | 
[32mExpert 23: 1.200(4124)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | 
[32mExpert 13: 1.200(4091)[0m | [32mExpert 42: 1.200(4187)[0m | [32mExpert 52: 1.200(4220)[0m | [32mExpert 16: 1.000(4100)[0m | 
[32mExpert 61: 1.000(4250)[0m | [32mExpert  5: 1.000(4211)[0m | [32mExpert 15: 1.000(4097)[0m | [32mExpert 26: 1.000(4133)[0m | 
[32mExpert 56: 1.000(4232)[0m | [32mExpert 18: 0.800(4106)[0m | [32mExpert 25: 0.800(4130)[0m | [32mExpert  0: 0.600(4076)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4091, 4187, 4220, 4100, 4250, 4211, 4097, 4133, 4232, 4106, 4130, 4076]
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  5, 13, 15, 16, 18, 25, 26, 42, 52, 56, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:2.0 | [22]:1.0 | [42]:1.0 | [58]:1.0 | [62]:1.0 | [12]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[13]:1.0 | [18]:1.0 | [29]:3.0 | [36]:2.0 | [60]:2.0 | [53]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[2]:2.0 | [10]:1.0 | [17]:4.0 | [21]:3.0 | [55]:2.0 | [52]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[3]:3.0 | [6]:1.0 | [11]:4.0 | [33]:3.0 | [58]:2.0 | [32]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[0]:2.0 | [3]:3.0 | [45]:2.0 | [46]:1.0 | [54]:2.0 | [47]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[8]:2.0 | [10]:3.0 | [24]:2.0 | [33]:2.0 | [58]:3.0 | [16]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 8, 10, 24, 33, 58, 16]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:1.0 | [23]:2.0 | [38]:3.0 | [52]:2.0 | [62]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[11]:1.0 | [17]:1.0 | [57]:2.0 | [59]:2.0 | [62]:2.0 | [26]:3.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2930
[1m[33mEnqueueTask: [0m[32mTask: node: ID[943,1e0000001f] (16MB) STATE(0) TENSOR[2929,2930,2928,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[1]:1.0 | [7]:1.0 | [8]:3.0 | [26]:4.0 | [59]:1.0 | [2]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[10]:1.0 | [21]:2.0 | [29]:2.0 | [38]:5.0 | [43]:1.0 | [11]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[3]:2.0 | [10]:1.0 | [17]:3.0 | [29]:1.0 | [36]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[1]:1.0 | [14]:2.0 | [28]:1.0 | [46]:1.0 | [62]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[2]:1.0 | [13]:1.0 | [34]:1.0 | [35]:2.0 | [55]:1.0 | [20]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[3]:1.0 | [20]:2.0 | [29]:1.0 | [32]:2.0 | [48]:1.0 | [4]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 3, 20, 29, 32, 48,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.400(2743)[0m | [32mExpert 41: 4.600(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 19: 2.800(2653)[0m | 
[32mExpert 38: 2.800(2716)[0m | [32mExpert 10: 2.600(2626)[0m | [32mExpert 35: 2.400(2707)[0m | [32mExpert 55: 2.400(2773)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert  7: 2.000(2803)[0m | [32mExpert 63: 2.000(2800)[0m | [32mExpert 12: 1.800(2632)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 27: 1.800(2680)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert  4: 1.400(2722)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 29: 1.000(2686)[0m | [32mExpert 47: 1.000(2746)[0m | 
[32mExpert 53: 0.800(2767)[0m | [32mExpert  8: 0.800(2806)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 34: 0.800(2704)[0m | 
[32mExpert 50: 0.800(2758)[0m | [32mExpert  5: 0.600(2755)[0m | [32mExpert  9: 0.600(2809)[0m | [32mExpert 14: 0.600(2638)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2722, 2695, 2686, 2746, 2767, 2806, 2629, 2704, 2758, 2755, 2809, 2638]
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  8,  9, 11, 14, 29, 31, 34, 47, 50, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:2.0 | [27]:1.0 | [39]:2.0 | [47]:1.0 | [49]:1.0 | [28]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[9]:1.0 | [11]:2.0 | [13]:2.0 | [15]:1.0 | [52]:2.0 | [24]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[7]:1.0 | [10]:2.0 | [34]:1.0 | [60]:1.0 | [63]:1.0 | [23]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:1.0 | [16]:1.0 | [20]:1.0 | [33]:2.0 | [49]:1.0 | [25]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[2]:2.0 | [13]:1.0 | [33]:1.0 | [42]:1.0 | [62]:1.0 | [16]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[18]:1.0 | [21]:1.0 | [22]:1.0 | [45]:3.0 | [62]:2.0 | [31]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[18, 21, 22, 45, 62, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.600(2882)[0m | [32mExpert  6: 4.200(3026)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert 38: 3.000(2954)[0m | 
[32mExpert  0: 2.800(2858)[0m | [32mExpert 14: 2.800(2876)[0m | [32mExpert 36: 2.600(2948)[0m | [32mExpert 52: 2.400(3002)[0m | 
[32mExpert 26: 2.400(2915)[0m | [32mExpert 48: 2.400(2987)[0m | [32mExpert 19: 2.200(2891)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert  4: 2.000(2960)[0m | [32mExpert 61: 2.000(3032)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 11: 1.800(2867)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert  5: 1.400(2993)[0m | 
[32mExpert 15: 1.400(2879)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | [32mExpert  8: 1.200(3044)[0m | 
[32mExpert 40: 1.200(2963)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 23: 0.800(2906)[0m | [32mExpert 33: 0.800(2939)[0m | 
[32mExpert  7: 0.600(3041)[0m | [32mExpert 12: 0.600(2870)[0m | [32mExpert 21: 0.600(2900)[0m | [32mExpert 30: 0.600(2930)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2879, 2912, 2951, 3044, 2963, 2864, 2906, 2939, 3041, 2870, 2900, 2930]
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2930[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8, 10, 12, 15, 21, 23, 25, 30, 33, 37, 40 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[26]:2.0 | [55]:1.0 | [60]:1.0 | [61]:1.0 | [63]:1.0 | [24]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[5]:3.0 | [37]:1.0 | [46]:2.0 | [55]:1.0 | [59]:2.0 | [47]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[11]:2.0 | [26]:2.0 | [32]:1.0 | [36]:2.0 | [43]:1.0 | [61]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[25]:1.0 | [30]:2.0 | [32]:3.0 | [36]:1.0 | [45]:1.0 | [53]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[3]:3.0 | [10]:2.0 | [45]:1.0 | [58]:1.0 | [61]:1.0 | [50]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[2]:3.0 | [14]:1.0 | [44]:1.0 | [49]:2.0 | [58]:2.0 | [60]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 2, 14, 44, 49, 58, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 5.000(4103)[0m | [32mExpert 48: 5.000(4205)[0m | [32mExpert 14: 3.600(4094)[0m | [32mExpert 21: 3.600(4118)[0m | 
[32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4133
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1329,1a0000002b] (16MB) STATE(0) TENSOR[4132,4133,4131,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4106
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1321,120000002b] (16MB) STATE(0) TENSOR[4105,4106,4104,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4130
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1328,190000002b] (16MB) STATE(0) TENSOR[4129,4130,4128,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
[32mExpert 27: 2.400(4136)[0m | [32mExpert 54: 2.400(4226)[0m | 
[32mExpert 12: 2.200(4088)[0m | [32mExpert  2: 2.000(4112)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | 
[32mExpert 62: 1.800(4253)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 41: 1.800(4184)[0m | [32mExpert 28: 1.600(4139)[0m | 
[32mExpert 10: 1.400(4082)[0m | [32mExpert 19: 1.400(4109)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 51: 1.200(4217)[0m | 
[32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert 13: 1.200(4091)[0m | [32mExpert 42: 1.200(4187)[0m | 
[32mExpert 16: 1.000(4100)[0m | [32mExpert 61: 1.000(4250)[0m | [32mExpert  5: 1.000(4211)[0m | [32mExpert 15: 1.000(4097)[0m | 
[32mExpert 26: 1.000(4133)[0m | [32mExpert 56: 1.000(4232)[0m | [32mExpert 18: 0.800(4106)[0m | [32mExpert 25: 0.800(4130)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4238, 4244, 4091, 4187, 4100, 4250, 4211, 4097, 4133, 4232, 4106, 4130]
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4133[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4106[0m â†’ GPU 0
Prefetching [1;36mTensor 4130[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 13, 15, 16, 18, 25, 26, 42, 56, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[8]:1.0 | [9]:3.0 | [38]:1.0 | [42]:2.0 | [56]:1.0 | [6]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[13]:2.0 | [15]:5.0 | [18]:2.0 | [29]:4.0 | [60]:3.0 | [43]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:1.0 | [10]:2.0 | [17]:5.0 | [26]:1.0 | [41]:1.0 | [18]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E18 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E26 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[6]:2.0 | [8]:2.0 | [22]:1.0 | [42]:1.0 | [56]:1.0 | [33]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[5]:2.0 | [32]:2.0 | [46]:2.0 | [50]:2.0 | [54]:3.0 | [58]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[12]:1.0 | [15]:1.0 | [16]:3.0 | [24]:3.0 | [58]:4.0 | [19]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[12, 15, 16, 24, 58, 19]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:2.0 | [13]:1.0 | [23]:3.0 | [37]:1.0 | [54]:2.0 | [43]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[7]:1.0 | [10]:1.0 | [17]:2.0 | [33]:1.0 | [48]:2.0 | [46]:1.0 | 
---------------------------------------
return EAMC[3]
DAppäº¤äº’EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2806
[1m[33mEnqueueTask: [0m[32mTask: node: ID[531,800000013] (16MB) STATE(0) TENSOR[2805,2806,2804,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2758
[1m[33mEnqueueTask: [0m[32mTask: node: ID[573,3200000013] (16MB) STATE(0) TENSOR[2757,2758,2756,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2755
[1m[33mEnqueueTask: [0m[32mTask: node: ID[528,500000013] (16MB) STATE(0) TENSOR[2754,2755,2753,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3041
[1m[33mEnqueueTask: [0m[32mTask: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2870
[1m[33mEnqueueTask: [0m[32mTask: node: ID[925,c0000001f] (16MB) STATE(0) TENSOR[2869,2870,2868,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[920,70000001f] (16MB) STATE(0) TENSOR[3040,3041,3039,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[10]:1.0 | [21]:1.0 | [32]:1.0 | [41]:1.0 | [59]:2.0 | [37]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[4]:1.0 | [12]:1.0 | [22]:2.0 | [32]:1.0 | [55]:1.0 | [39]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[20]:1.0 | [29]:2.0 | [43]:1.0 | [61]:1.0 | [63]:1.0 | [39]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[12]:1.0 | [24]:1.0 | [43]:1.0 | [50]:1.0 | [62]:2.0 | [31]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[6]:1.0 | [7]:1.0 | [30]:1.0 | [46]:1.0 | [61]:1.0 | [28]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[2]:1.0 | [3]:2.0 | [14]:1.0 | [20]:3.0 | [53]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 2,  3, 14, 20, 53, 44]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.400(2743)[0m | [32mExpert 41: 4.600(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 10: 3.400(2626)[0m | 
[32mExpert  7: 2.800(2803)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert 38: 2.800(2716)[0m | [32mExpert 63: 2.800(2800)[0m | 
[32mExpert 35: 2.400(2707)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  1: 2.000(2623)[0m | 
[32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 12: 1.800(2632)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 27: 1.800(2680)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | [32mExpert 60: 1.400(2791)[0m | [32mExpert 23: 1.000(2668)[0m | 
[32mExpert 31: 1.000(2695)[0m | [32mExpert 29: 1.000(2686)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert 53: 0.800(2767)[0m | 
[32mExpert  8: 0.800(2806)[0m | [32mExpert 11: 0.800(2629)[0m | [32mExpert 50: 0.800(2758)[0m | [32mExpert  5: 0.600(2755)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2722, 2791, 2668, 2695, 2686, 2746, 2767, 2806, 2629, 2758, 2755]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2806[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2758[0m â†’ GPU 0
Prefetching [1;36mTensor 2755[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  5,  8, 11, 23, 29, 31, 34, 47, 50, 53, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:1.0 | [5]:3.0 | [9]:1.0 | [47]:2.0 | [49]:2.0 | [15]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[2]:2.0 | [9]:2.0 | [11]:3.0 | [38]:1.0 | [57]:1.0 | [17]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[9]:1.0 | [12]:2.0 | [14]:1.0 | [27]:2.0 | [51]:1.0 | [6]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[8]:1.0 | [10]:2.0 | [33]:3.0 | [35]:1.0 | [49]:2.0 | [22]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[2]:3.0 | [16]:4.0 | [42]:2.0 | [59]:2.0 | [62]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[1]:1.0 | [16]:2.0 | [18]:2.0 | [33]:1.0 | [45]:4.0 | [30]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 1, 16, 18, 33, 45, 30]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.600(2882)[0m | [32mExpert  6: 4.200(3026)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert 36: 3.400(2948)[0m | 
[32mExpert 26: 3.200(2915)[0m | [32mExpert 38: 3.000(2954)[0m | [32mExpert  0: 2.800(2858)[0m | [32mExpert 14: 2.800(2876)[0m | 
[32mExpert 61: 2.800(3032)[0m | [32mExpert 11: 2.600(2867)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert 48: 2.400(2987)[0m | 
[32mExpert 19: 2.200(2891)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert  4: 2.000(2960)[0m | [32mExpert 58: 1.800(3020)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert  5: 1.400(2993)[0m | 
[32mExpert 15: 1.400(2879)[0m | [32mExpert 43: 1.400(2972)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | 
[32mExpert  8: 1.200(3044)[0m | [32mExpert 40: 1.200(2963)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 32: 1.000(2936)[0m | 
[32mExpert 23: 0.800(2906)[0m | [32mExpert 33: 0.800(2939)[0m | [32mExpert  7: 0.600(3041)[0m | [32mExpert 12: 0.600(2870)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2879, 2972, 2912, 2951, 3044, 2963, 2864, 2936, 2906, 2939, 3041, 2870]
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3041[0m â†’ GPU 0
Prefetching [1;36mTensor 2870[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  7,  8, 10, 12, 15, 23, 25, 32, 33, 37, 40, 43 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[36]:2.0 | [38]:1.0 | [47]:2.0 | [48]:2.0 | [63]:2.0 | [24]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[20]:1.0 | [35]:1.0 | [38]:1.0 | [55]:2.0 | [59]:3.0 | [19]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[1]:1.0 | [11]:3.0 | [14]:2.0 | [40]:2.0 | [57]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E40 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:1.0 | [30]:3.0 | [32]:4.0 | [61]:1.0 | [63]:2.0 | [26]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[30]:1.0 | [38]:1.0 | [50]:2.0 | [51]:1.0 | [61]:2.0 | [10]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[2]:4.0 | [5]:2.0 | [32]:1.0 | [47]:1.0 | [58]:3.0 | [55]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 2,  5, 32, 47, 58, 55]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 5.800(4103)[0m | [32mExpert 48: 5.000(4205)[0m | [32mExpert 14: 3.600(4094)[0m | [32mExpert 21: 3.600(4118)[0m | 
[32mExpert 41: 2.600(4184)[0m | [32mExpert 44: 2.600(4193)[0m | EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
[32mExpert 55: 2.600(4229)[0m | [32mExpert 27: 2.400(4136)[0m | 
[32mExpert 54: 2.400(4226)[0m | [32mExpert 10: 2.200(4082)[0m | [32mExpert 12: 2.200(4088)[0m | [32mExpert  2: 2.000(4112)[0m | 
[32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 62: 1.800(4253)[0m | [32mExpert 26: 1.800(4133)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 18: 1.600(4106)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert  0: 1.400(4076)[0m | 
[32mExpert 19: 1.400(4109)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 51: 1.200(4217)[0m | [32mExpert 58: 1.200(4238)[0m | 
[32mExpert  6: 1.200(4244)[0m | [32mExpert 13: 1.200(4091)[0m | [32mExpert 42: 1.200(4187)[0m | [32mExpert 16: 1.000(4100)[0m | 
[32mExpert 61: 1.000(4250)[0m | [32mExpert  5: 1.000(4211)[0m | [32mExpert 15: 1.000(4097)[0m | [32mExpert 56: 1.000(4232)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4109, 4124, 4217, 4238, 4244, 4091, 4187, 4100, 4250, 4211, 4097, 4232]
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 13, 15, 16, 19, 23, 42, 51, 56, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:1.0 | [5]:2.0 | [9]:4.0 | [27]:1.0 | [39]:1.0 | [6]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[13]:3.0 | [27]:1.0 | [29]:5.0 | [58]:1.0 | [60]:4.0 | [61]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[1]:1.0 | [2]:3.0 | [18]:2.0 | [19]:2.0 | [21]:4.0 | [17]:6.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E19 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:3.0 | [17]:1.0 | [34]:2.0 | [47]:1.0 | [49]:1.0 | [56]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[8]:1.0 | [30]:1.0 | [45]:3.0 | [46]:3.0 | [47]:4.0 | [33]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[2]:1.0 | [15]:2.0 | [24]:4.0 | [34]:1.0 | [36]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 2, 15, 24, 34, 36, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:3.0 | [29]:1.0 | [33]:1.0 | [47]:2.0 | [54]:3.0 | [34]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[7]:2.0 | [10]:2.0 | [11]:2.0 | [17]:3.0 | [63]:1.0 | [48]:3.0 | 
---------------------------------------
return EAMC[3]
æµç¨‹EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2809
[1m[33mEnqueueTask: [0m[32mTask: node: ID[532,900000013] (16MB) STATE(0) TENSOR[2808,2809,2807,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2791
[1m[33mEnqueueTask: [0m[32mTask: node: ID[583,3c00000013] (16MB) STATE(0) TENSOR[2790,2791,2789,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2761
[1m[33mEnqueueTask: [0m[32mTask: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2788
[1m[33mEnqueueTask: [0m[32mTask: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[574,3300000013] (16MB) STATE(0) TENSOR[2760,2761,2759,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2936
[1m[33mEnqueueTask: [0m[32mTask: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2906
[1m[33mEnqueueTask: [0m[32mTask: node: ID[936,170000001f] (16MB) STATE(0) TENSOR[2905,2906,2904,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[945,200000001f] (16MB) STATE(0) TENSOR[2935,2936,2934,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:2.0 | [10]:2.0 | [32]:2.0 | [48]:1.0 | [59]:3.0 | [29]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[12]:2.0 | [30]:1.0 | [36]:1.0 | [40]:1.0 | [54]:1.0 | [26]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[20]:2.0 | [29]:3.0 | [32]:1.0 | [43]:2.0 | [59]:1.0 | [37]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[7]:1.0 | [24]:2.0 | [28]:2.0 | [55]:1.0 | [62]:3.0 | [48]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[6]:2.0 | [7]:2.0 | [30]:2.0 | [46]:2.0 | [61]:2.0 | [28]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[2]:2.0 | [14]:2.0 | [20]:4.0 | [48]:2.0 | [53]:2.0 | [38]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 2, 14, 20, 48, 53, 38]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.400(2743)[0m | [32mExpert 41: 4.600(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 10: 3.400(2626)[0m | 
[32mExpert  7: 2.800(2803)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert 38: 2.800(2716)[0m | [32mExpert 63: 2.800(2800)[0m | 
[32mExpert 12: 2.600(2632)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 35: 2.400(2707)[0m | [32mExpert 55: 2.400(2773)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert 13: 1.800(2635)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | [32mExpert  9: 1.400(2809)[0m | [32mExpert 14: 1.400(2638)[0m | 
[32mExpert 60: 1.400(2791)[0m | [32mExpert 51: 1.200(2761)[0m | [32mExpert 23: 1.000(2668)[0m | [32mExpert 31: 1.000(2695)[0m | 
[32mExpert 29: 1.000(2686)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert  6: 0.800(2788)[0m | [32mExpert 53: 0.800(2767)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2722, 2809, 2638, 2791, 2761, 2668, 2695, 2686, 2746, 2788, 2767]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2809[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2791[0m â†’ GPU 0
Prefetching [1;36mTensor 2761[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2788[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  6,  9, 14, 23, 29, 31, 34, 47, 51, 53, 60 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:4.0 | [9]:2.0 | [27]:2.0 | [47]:3.0 | [49]:3.0 | [1]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[1]:1.0 | [9]:3.0 | [11]:4.0 | [38]:2.0 | [57]:2.0 | [13]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[9]:2.0 | [11]:1.0 | [12]:3.0 | [51]:2.0 | [63]:2.0 | [60]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E9 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E60 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:3.0 | [22]:2.0 | [33]:4.0 | [34]:1.0 | [35]:2.0 | [45]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[2]:4.0 | [13]:2.0 | [16]:5.0 | [42]:3.0 | [62]:3.0 | [33]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[1]:2.0 | [18]:3.0 | [22]:2.0 | [30]:4.0 | [45]:5.0 | [57]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 1, 18, 22, 30, 45, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.600(2882)[0m | [32mExpert  6: 4.200(3026)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert 14: 3.600(2876)[0m | 
[32mExpert 11: 3.400(2867)[0m | [32mExpert 36: 3.400(2948)[0m | [32mExpert 26: 3.200(2915)[0m | [32mExpert 38: 3.000(2954)[0m | 
[32mExpert  0: 2.800(2858)[0m | [32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert 48: 2.400(2987)[0m | 
[32mExpert 19: 2.200(2891)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 40: 2.000(2963)[0m | [32mExpert  4: 2.000(2960)[0m | 
[32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | 
[32mExpert  5: 1.400(2993)[0m | [32mExpert 15: 1.400(2879)[0m | [32mExpert 41: 1.400(2966)[0m | [32mExpert 43: 1.400(2972)[0m | 
[32mExpert 25: 1.400(2912)[0m | [32mExpert 37: 1.400(2951)[0m | [32mExpert  8: 1.200(3044)[0m | [32mExpert  1: 1.000(2861)[0m | 
[32mExpert 10: 1.000(2864)[0m | [32mExpert 32: 1.000(2936)[0m | [32mExpert 57: 1.000(3017)[0m | [32mExpert 23: 0.800(2906)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2993, 2879, 2966, 2972, 2912, 2951, 3044, 2861, 2864, 2936, 3017, 2906]
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2951[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2936[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 2906[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  5,  8, 10, 15, 23, 25, 32, 37, 41, 43, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[14]:1.0 | [36]:3.0 | [47]:3.0 | [55]:2.0 | [63]:3.0 | [10]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[5]:4.0 | [20]:2.0 | [38]:2.0 | [47]:2.0 | [59]:4.0 | [19]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[11]:4.0 | [14]:3.0 | [32]:2.0 | [37]:1.0 | [42]:1.0 | [44]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E37 â•‘[0m
EnqueuePrefetch: 4076
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1303,2b] (16MB) STATE(0) TENSOR[4075,4076,4074,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4097
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1318,f0000002b] (16MB) STATE(0) TENSOR[4096,4097,4095,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[13]:2.0 | [26]:3.0 | [28]:1.0 | [30]:4.0 | [45]:2.0 | [63]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[9]:1.0 | [30]:2.0 | [47]:1.0 | [50]:3.0 | [61]:3.0 | [51]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[14]:2.0 | [19]:1.0 | [35]:1.0 | [47]:2.0 | [50]:2.0 | [28]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[14, 19, 35, 47, 50, 28]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 6.600(4103)[0m | [32mExpert 48: 5.000(4205)[0m | [32mExpert 21: 4.400(4118)[0m | [32mExpert 14: 3.600(4094)[0m | 
[32mExpert  2: 2.800(4112)[0m | [32mExpert 41: 2.600(4184)[0m | [32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | 
[32mExpert 18: 2.400(4106)[0m | [32mExpert 27: 2.400(4136)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert 10: 2.200(4082)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert 12: 2.200(4088)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | 
[32mExpert 62: 1.800(4253)[0m | [32mExpert 26: 1.800(4133)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 28: 1.600(4139)[0m | 
[32mExpert  0: 1.400(4076)[0m | [32mExpert  1: 1.400(4079)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 51: 1.200(4217)[0m | 
[32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert 13: 1.200(4091)[0m | [32mExpert 42: 1.200(4187)[0m | 
[32mExpert 16: 1.000(4100)[0m | [32mExpert 61: 1.000(4250)[0m | [32mExpert  5: 1.000(4211)[0m | [32mExpert 15: 1.000(4097)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4076, 4079, 4124, 4217, 4238, 4244, 4091, 4187, 4100, 4250, 4211, 4097]
Prefetching [1;36mTensor 4076[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
Prefetching [1;36mTensor 4097[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  0,  1,  5,  6, 13, 15, 16, 23, 42, 51, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:5.0 | [12]:2.0 | [19]:3.0 | [27]:2.0 | [38]:2.0 | [39]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[27]:2.0 | [29]:6.0 | [31]:1.0 | [44]:3.0 | [53]:2.0 | [13]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:2.0 | [1]:2.0 | [18]:3.0 | [26]:2.0 | [56]:1.0 | [41]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E0 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E1 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[8]:4.0 | [17]:2.0 | [51]:1.0 | [56]:3.0 | [58]:3.0 | [5]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[1]:1.0 | [33]:3.0 | [45]:4.0 | [46]:4.0 | [61]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[15]:3.0 | [23]:2.0 | [24]:5.0 | [45]:2.0 | [62]:2.0 | [36]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[15, 23, 24, 45, 62, 36]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[17]:1.0 | [18]:1.0 | [33]:2.0 | [47]:3.0 | [54]:4.0 | [19]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[10]:3.0 | [17]:4.0 | [49]:2.0 | [56]:4.0 | [63]:2.0 | [29]:2.0 | 
---------------------------------------
return EAMC[3]
å›¾EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2788
[1m[33mEnqueueTask: [0m[32mTask: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[2]:3.0 | [32]:3.0 | [48]:2.0 | [50]:3.0 | [62]:1.0 | [49]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[2]:1.0 | [6]:1.0 | [30]:2.0 | [40]:2.0 | [54]:2.0 | [28]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[20]:3.0 | [28]:1.0 | [37]:2.0 | [43]:3.0 | [57]:1.0 | [32]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[1]:2.0 | [24]:3.0 | [28]:3.0 | [32]:1.0 | [62]:4.0 | [48]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[2]:2.0 | [6]:3.0 | [30]:3.0 | [46]:3.0 | [61]:3.0 | [7]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[2]:3.0 | [14]:3.0 | [20]:5.0 | [33]:1.0 | [47]:2.0 | [29]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 2, 14, 20, 33, 47, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.400(2743)[0m | [32mExpert 41: 4.600(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 63: 3.600(2800)[0m | 
[32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | [32mExpert  7: 2.800(2803)[0m | [32mExpert 19: 2.800(2653)[0m | 
[32mExpert 38: 2.800(2716)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 35: 2.400(2707)[0m | [32mExpert 55: 2.400(2773)[0m | 
[32mExpert  9: 2.200(2809)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert 60: 2.200(2791)[0m | [32mExpert  1: 2.000(2623)[0m | 
[32mExpert 51: 2.000(2761)[0m | [32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 33: 1.800(2701)[0m | [32mExpert 11: 1.600(2629)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | 
[32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | [32mExpert 14: 1.400(2638)[0m | [32mExpert 23: 1.000(2668)[0m | 
[32mExpert 31: 1.000(2695)[0m | [32mExpert 29: 1.000(2686)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert  6: 0.800(2788)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2629, 2644, 2665, 2704, 2722, 2638, 2668, 2695, 2686, 2746, 2788]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2788[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  6, 11, 14, 16, 22, 23, 29, 31, 33, 34, 47 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[10]:1.0 | [27]:3.0 | [44]:2.0 | [47]:4.0 | [49]:4.0 | [9]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[2]:3.0 | [9]:4.0 | [11]:5.0 | [38]:3.0 | [49]:4.0 | [17]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[7]:2.0 | [9]:3.0 | [11]:2.0 | [23]:2.0 | [60]:3.0 | [51]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E11 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:4.0 | [33]:5.0 | [34]:2.0 | [35]:3.0 | [45]:2.0 | [16]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[13]:3.0 | [16]:6.0 | [33]:3.0 | [52]:1.0 | [53]:2.0 | [54]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[18]:4.0 | [22]:3.0 | [32]:1.0 | [44]:1.0 | [57]:4.0 | [52]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[18, 22, 32, 44, 57, 52]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.600(2882)[0m | [32mExpert 14: 4.400(2876)[0m | [32mExpert  6: 4.200(3026)[0m | [32mExpert 11: 4.200(2867)[0m | 
[32mExpert 49: 4.200(2990)[0m | [32mExpert 36: 3.400(2948)[0m | [32mExpert 26: 3.200(2915)[0m | [32mExpert 38: 3.000(2954)[0m | 
[32mExpert  0: 2.800(2858)[0m | [32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert 48: 2.400(2987)[0m | 
[32mExpert 19: 2.200(2891)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 37: 2.200(2951)[0m | [32mExpert 40: 2.000(2963)[0m | 
[32mExpert  4: 2.000(2960)[0m | [32mExpert 32: 1.800(2936)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | 
[32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert  5: 1.400(2993)[0m | [32mExpert 15: 1.400(2879)[0m | 
[32mExpert 41: 1.400(2966)[0m | [32mExpert 43: 1.400(2972)[0m | [32mExpert 25: 1.400(2912)[0m | [32mExpert  8: 1.200(3044)[0m | 
[32mExpert  1: 1.000(2861)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 44: 1.000(2975)[0m | [32mExpert 57: 1.000(3017)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3011, 3047, 2993, 2879, 2966, 2972, 2912, 3044, 2861, 2864, 2975, 3017]
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  5,  8,  9, 10, 15, 25, 41, 43, 44, 55, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:2.0 | [23]:1.0 | [57]:1.0 | [61]:2.0 | [63]:4.0 | [55]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[5]:5.0 | [31]:1.0 | [37]:2.0 | [55]:3.0 | [59]:5.0 | [50]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[4]:2.0 | [25]:1.0 | [32]:3.0 | [37]:2.0 | [42]:2.0 | [8]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E8 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[22]:1.0 | [25]:2.0 | [26]:4.0 | [30]:5.0 | [45]:3.0 | [36]:2.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4217
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1354,330000002b] (16MB) STATE(0) TENSOR[4216,4217,4215,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 17 MLP ==
[0m
[27]:1.0 | [45]:2.0 | [51]:3.0 | [58]:2.0 | [61]:4.0 | [7]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[0]:1.0 | [1]:1.0 | [8]:4.0 | [35]:2.0 | [47]:3.0 | [14]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 0,  1,  8, 35, 47, 14]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 6.600(4103)[0m | [32mExpert 48: 5.000(4205)[0m | [32mExpert 21: 4.400(4118)[0m | [32mExpert 14: 3.600(4094)[0m | 
[32mExpert 41: 3.400(4184)[0m | [32mExpert 18: 3.200(4106)[0m | [32mExpert  2: 2.800(4112)[0m | [32mExpert 26: 2.600(4133)[0m | 
[32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | [32mExpert 27: 2.400(4136)[0m | [32mExpert 54: 2.400(4226)[0m | 
[32mExpert  0: 2.200(4076)[0m | [32mExpert  1: 2.200(4079)[0m | [32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | 
[32mExpert 12: 2.200(4088)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 62: 1.800(4253)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 23: 1.200(4124)[0m | 
[32mExpert 51: 1.200(4217)[0m | [32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert 13: 1.200(4091)[0m | 
[32mExpert 42: 1.200(4187)[0m | [32mExpert 16: 1.000(4100)[0m | [32mExpert 61: 1.000(4250)[0m | [32mExpert  5: 1.000(4211)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4223, 4232, 4139, 4124, 4217, 4238, 4244, 4091, 4187, 4100, 4250, 4211]
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4217[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 13, 16, 23, 28, 42, 51, 53, 56, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:6.0 | [24]:4.0 | [38]:3.0 | [49]:1.0 | [56]:2.0 | [4]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[15]:6.0 | [24]:1.0 | [25]:4.0 | [43]:4.0 | [44]:4.0 | [54]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:3.0 | [18]:4.0 | [26]:3.0 | [48]:5.0 | [51]:2.0 | [41]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E51 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[7]:1.0 | [8]:5.0 | [12]:1.0 | [22]:2.0 | [56]:4.0 | [61]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[1]:2.0 | [24]:1.0 | [33]:4.0 | [46]:5.0 | [51]:2.0 | [32]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[15]:4.0 | [16]:4.0 | [18]:1.0 | [24]:6.0 | [45]:3.0 | [29]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[15, 16, 18, 24, 45, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:1.0 | [17]:2.0 | [18]:2.0 | [33]:3.0 | [47]:4.0 | [37]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[7]:3.0 | [10]:4.0 | [48]:4.0 | [56]:5.0 | [58]:1.0 | [33]:2.0 | 
---------------------------------------
return EAMC[3]
è®¾è®¡EnqueuePrefetch: 2668
[1m[33mEnqueueTask: [0m[32mTask: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2638
[1m[33mEnqueueTask: [0m[32mTask: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2788
[1m[33mEnqueueTask: [0m[32mTask: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[546,1700000013] (16MB) STATE(0) TENSOR[2667,2668,2666,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[537,e00000013] (16MB) STATE(0) TENSOR[2637,2638,2636,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[23]:1.0 | [32]:4.0 | [49]:2.0 | [56]:3.0 | [59]:4.0 | [10]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[11]:2.0 | [14]:2.0 | [30]:3.0 | [32]:2.0 | [55]:2.0 | [9]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[20]:4.0 | [28]:2.0 | [37]:3.0 | [59]:2.0 | [60]:1.0 | [61]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[20]:1.0 | [28]:4.0 | [50]:2.0 | [58]:1.0 | [62]:5.0 | [1]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[6]:4.0 | [7]:4.0 | [23]:1.0 | [30]:4.0 | [46]:4.0 | [41]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[2]:4.0 | [4]:2.0 | [7]:1.0 | [29]:3.0 | [44]:2.0 | [33]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 2,  4,  7, 29, 44, 33]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.400(2743)[0m | [32mExpert 41: 4.600(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert  7: 3.600(2803)[0m | 
[32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | [32mExpert  9: 3.000(2809)[0m | 
[32mExpert 60: 3.000(2791)[0m | [32mExpert 51: 2.800(2761)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert 38: 2.800(2716)[0m | 
[32mExpert 27: 2.600(2680)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 35: 2.400(2707)[0m | [32mExpert 55: 2.400(2773)[0m | 
[32mExpert 48: 2.200(2749)[0m | [32mExpert  1: 2.000(2623)[0m | [32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert 23: 1.800(2668)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 33: 1.800(2701)[0m | [32mExpert 16: 1.600(2644)[0m | 
[32mExpert 22: 1.600(2665)[0m | [32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | [32mExpert 14: 1.400(2638)[0m | 
[32mExpert 31: 1.000(2695)[0m | [32mExpert 29: 1.000(2686)[0m | [32mExpert 47: 1.000(2746)[0m | [32mExpert  6: 0.800(2788)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2668, 2635, 2701, 2644, 2665, 2704, 2722, 2638, 2695, 2686, 2746, 2788]
Prefetching [1;36mTensor 2668[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2638[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2788[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4,  6, 13, 14, 16, 22, 23, 29, 31, 33, 34, 47 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[0]:2.0 | [1]:2.0 | [9]:4.0 | [10]:2.0 | [47]:5.0 | [20]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[15]:2.0 | [17]:3.0 | [29]:1.0 | [40]:2.0 | [49]:5.0 | [9]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[9]:4.0 | [23]:3.0 | [36]:1.0 | [40]:1.0 | [43]:1.0 | [14]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E14 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E23 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[24]:1.0 | [33]:6.0 | [35]:4.0 | [45]:3.0 | [56]:1.0 | [49]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[16]:7.0 | [21]:1.0 | [33]:4.0 | [53]:3.0 | [54]:6.0 | [2]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[1]:3.0 | [18]:5.0 | [22]:4.0 | [44]:2.0 | [57]:5.0 | [8]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 1, 18, 22, 44, 57,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 4.600(2882)[0m | [32mExpert 14: 4.400(2876)[0m | [32mExpert  6: 4.200(3026)[0m | [32mExpert 11: 4.200(2867)[0m | 
[32mExpert 49: 4.200(2990)[0m | [32mExpert 36: 3.400(2948)[0m | [32mExpert 26: 3.200(2915)[0m | [32mExpert 37: 3.000(2951)[0m | 
[32mExpert 38: 3.000(2954)[0m | [32mExpert  0: 2.800(2858)[0m | [32mExpert  4: 2.800(2960)[0m | [32mExpert 61: 2.800(3032)[0m | 
[32mExpert 32: 2.600(2936)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert 48: 2.400(2987)[0m | [32mExpert 19: 2.200(2891)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 40: 2.000(2963)[0m | 
[32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 42: 1.600(2969)[0m | [32mExpert 55: 1.600(3011)[0m | 
[32mExpert  9: 1.600(3047)[0m | [32mExpert  5: 1.400(2993)[0m | [32mExpert 15: 1.400(2879)[0m | [32mExpert 41: 1.400(2966)[0m | 
[32mExpert 43: 1.400(2972)[0m | [32mExpert  1: 1.000(2861)[0m | [32mExpert 10: 1.000(2864)[0m | [32mExpert 44: 1.000(2975)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3020, 2885, 2969, 3011, 3047, 2993, 2879, 2966, 2972, 2861, 2864, 2975]
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  5,  9, 10, 15, 17, 41, 42, 43, 44, 55, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[11]:3.0 | [29]:5.0 | [38]:2.0 | [61]:3.0 | [63]:5.0 | [57]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[5]:6.0 | [35]:2.0 | [38]:3.0 | [50]:4.0 | [59]:6.0 | [9]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[4]:3.0 | [14]:4.0 | [32]:4.0 | [36]:3.0 | [44]:2.0 | [5]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E5 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[28]:2.0 | [30]:6.0 | [35]:1.0 | [36]:3.0 | [45]:4.0 | [61]:2.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4211
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1308,50000002b] (16MB) STATE(0) TENSOR[4210,4211,4209,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17

[1;36m== Layer 17 MLP ==
[0m
[7]:2.0 | [11]:2.0 | [45]:3.0 | [54]:1.0 | [61]:5.0 | [46]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[5]:3.0 | [29]:1.0 | [33]:1.0 | [35]:3.0 | [47]:4.0 | [55]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 5, 29, 33, 35, 47, 55]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 6.600(4103)[0m | [32mExpert 48: 5.800(4205)[0m | [32mExpert 21: 4.400(4118)[0m | [32mExpert 41: 4.200(4184)[0m | 
[32mExpert 18: 4.000(4106)[0m | [32mExpert 14: 3.600(4094)[0m | [32mExpert 26: 3.400(4133)[0m | [32mExpert  0: 3.000(4076)[0m | 
[32mExpert  2: 2.800(4112)[0m | [32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | [32mExpert 27: 2.400(4136)[0m | 
[32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | [32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | 
[32mExpert 12: 2.200(4088)[0m | [32mExpert 51: 2.000(4217)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | 
[32mExpert 62: 1.800(4253)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | 
[32mExpert 23: 1.200(4124)[0m | [32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert 13: 1.200(4091)[0m | 
[32mExpert 42: 1.200(4187)[0m | [32mExpert 16: 1.000(4100)[0m | [32mExpert 61: 1.000(4250)[0m | [32mExpert  5: 1.000(4211)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4253, 4223, 4232, 4139, 4124, 4238, 4244, 4091, 4187, 4100, 4250, 4211]
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4211[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  5,  6, 13, 16, 23, 28, 42, 53, 56, 58, 61, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[9]:7.0 | [27]:3.0 | [38]:4.0 | [53]:2.0 | [56]:3.0 | [57]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[14]:1.0 | [15]:7.0 | [44]:5.0 | [55]:2.0 | [61]:2.0 | [41]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:4.0 | [18]:5.0 | [26]:4.0 | [48]:6.0 | [51]:3.0 | [32]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 22 MLP ==
[0m
[7]:2.0 | [8]:6.0 | [47]:2.0 | [51]:2.0 | [56]:5.0 | [34]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[1]:3.0 | [28]:1.0 | [30]:2.0 | [46]:6.0 | [51]:3.0 | [32]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[15]:5.0 | [18]:2.0 | [24]:7.0 | [36]:4.0 | [45]:4.0 | [62]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[15, 18, 24, 36, 45, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[17]:3.0 | [18]:3.0 | [33]:4.0 | [37]:3.0 | [47]:5.0 | [7]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[7]:4.0 | [10]:5.0 | [48]:5.0 | [56]:6.0 | [58]:2.0 | [29]:3.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2734
[1m[33mEnqueueTask: [0m[32mTask: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2864
[1m[33mEnqueueTask: [0m[32mTask: node: ID[923,a0000001f] (16MB) STATE(0) TENSOR[2863,2864,2862,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[20]:2.0 | [25]:1.0 | [55]:1.0 | [57]:4.0 | [60]:2.0 | [43]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[15]:1.0 | [19]:1.0 | [34]:1.0 | [46]:1.0 | [47]:1.0 | [0]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[7]:4.0 | [9]:2.0 | [13]:1.0 | [22]:4.0 | [60]:2.0 | [55]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[34]:5.0 | [39]:1.0 | [52]:1.0 | [57]:1.0 | [59]:4.0 | [29]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[27]:1.0 | [39]:5.0 | [41]:5.0 | [43]:2.0 | [56]:1.0 | [12]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[12]:2.0 | [16]:3.0 | [33]:3.0 | [35]:2.0 | [56]:5.0 | [50]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[12, 16, 33, 35, 56, 50]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 5.400(2743)[0m | [32mExpert 41: 4.600(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert  9: 3.800(2809)[0m | 
[32mExpert  7: 3.600(2803)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | 
[32mExpert 60: 3.000(2791)[0m | [32mExpert 51: 2.800(2761)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert 38: 2.800(2716)[0m | 
[32mExpert 23: 2.600(2668)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 35: 2.400(2707)[0m | 
[32mExpert 55: 2.400(2773)[0m | [32mExpert 14: 2.200(2638)[0m | [32mExpert 48: 2.200(2749)[0m | [32mExpert  1: 2.000(2623)[0m | 
[32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 33: 1.800(2701)[0m | 
[32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | 
[32mExpert 43: 1.200(2734)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 40: 1.000(2725)[0m | [32mExpert 29: 1.000(2686)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2647, 2737, 2635, 2701, 2644, 2665, 2704, 2722, 2734, 2695, 2725, 2686]
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2734[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4, 13, 16, 17, 22, 29, 31, 33, 34, 40, 43, 44 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:4.0 | [12]:1.0 | [26]:4.0 | [42]:4.0 | [50]:6.0 | [41]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[6]:4.0 | [10]:1.0 | [45]:5.0 | [46]:6.0 | [49]:6.0 | [18]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[1]:3.0 | [38]:3.0 | [41]:5.0 | [46]:6.0 | [48]:3.0 | [58]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[30]:5.0 | [41]:6.0 | [53]:2.0 | [55]:5.0 | [60]:3.0 | [51]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[8]:3.0 | [16]:8.0 | [28]:5.0 | [47]:4.0 | [54]:7.0 | [43]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[10]:1.0 | [41]:5.0 | [42]:4.0 | [46]:3.0 | [57]:6.0 | [43]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[10, 41, 42, 46, 57, 43]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 14: 5.200(2876)[0m | [32mExpert 16: 4.600(2882)[0m | [32mExpert  6: 4.200(3026)[0m | [32mExpert 11: 4.200(2867)[0m | 
[32mExpert 36: 4.200(2948)[0m | [32mExpert 49: 4.200(2990)[0m | [32mExpert  4: 3.600(2960)[0m | [32mExpert 32: 3.400(2936)[0m | 
[32mExpert 26: 3.200(2915)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 38: 3.000(2954)[0m | [32mExpert  0: 2.800(2858)[0m | 
[32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert 48: 2.400(2987)[0m | [32mExpert  5: 2.200(2993)[0m | 
[32mExpert 19: 2.200(2891)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | 
[32mExpert 40: 2.000(2963)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | 
[32mExpert 42: 1.600(2969)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 15: 1.400(2879)[0m | 
[32mExpert 41: 1.400(2966)[0m | [32mExpert 43: 1.400(2972)[0m | [32mExpert  1: 1.000(2861)[0m | [32mExpert 10: 1.000(2864)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2963, 2975, 3020, 2885, 2969, 3011, 3047, 2879, 2966, 2972, 2861, 2864]
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
Prefetching [1;36mTensor 2864[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 10, 15, 17, 40, 41, 42, 43, 44, 55, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[21]:3.0 | [29]:6.0 | [33]:4.0 | [40]:2.0 | [41]:3.0 | [49]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[4]:1.0 | [28]:5.0 | [30]:4.0 | [50]:5.0 | [63]:2.0 | [9]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[6]:4.0 | [16]:5.0 | [33]:1.0 | [38]:2.0 | [49]:4.0 | [54]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[17]:4.0 | [24]:5.0 | [38]:1.0 | [41]:5.0 | [58]:2.0 | [15]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[25]:5.0 | [40]:5.0 | [52]:2.0 | [55]:4.0 | [57]:3.0 | [2]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[18]:5.0 | [40]:2.0 | [46]:5.0 | [51]:1.0 | [53]:2.0 | [57]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[18, 40, 46, 51, 53, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 17: 6.600(4103)[0m | [32mExpert 48: 6.600(4205)[0m | [32mExpert 18: 4.800(4106)[0m | [32mExpert 21: 4.400(4118)[0m | 
[32mExpert 26: 4.200(4133)[0m | [32mExpert 41: 4.200(4184)[0m | [32mExpert  0: 3.800(4076)[0m | [32mExpert 14: 3.600(4094)[0m | 
[32mExpert  2: 2.800(4112)[0m | [32mExpert 51: 2.800(4217)[0m | [32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | 
[32mExpert 27: 2.400(4136)[0m | EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
[32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | [32mExpert 10: 2.200(4082)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert 12: 2.200(4088)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | 
[32mExpert 62: 1.800(4253)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | 
[32mExpert 32: 1.400(4154)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | 
[32mExpert 13: 1.200(4091)[0m | [32mExpert 42: 1.200(4187)[0m | [32mExpert 16: 1.000(4100)[0m | [32mExpert 61: 1.000(4250)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4253, 4223, 4232, 4139, 4154, 4124, 4238, 4244, 4091, 4187, 4100, 4250]
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6, 13, 16, 23, 28, 32, 42, 53, 56, 58, 61, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:5.0 | [17]:2.0 | [41]:4.0 | [47]:4.0 | [61]:1.0 | [55]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[15]:8.0 | [22]:3.0 | [25]:5.0 | [44]:6.0 | [50]:4.0 | [0]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[12]:2.0 | [14]:4.0 | [37]:1.0 | [48]:7.0 | [61]:2.0 | [42]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:5.0 | [33]:5.0 | [40]:2.0 | [55]:6.0 | [60]:4.0 | [37]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[7]:4.0 | [23]:4.0 | [38]:2.0 | [40]:3.0 | [46]:7.0 | [6]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[16]:5.0 | [19]:3.0 | [28]:4.0 | [37]:2.0 | [51]:1.0 | [61]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[16, 19, 28, 37, 51, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:5.0 | [12]:4.0 | [23]:4.0 | [49]:1.0 | [57]:3.0 | [2]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[22]:1.0 | [30]:4.0 | [34]:4.0 | [48]:6.0 | [56]:7.0 | [3]:1.0 | 
---------------------------------------
return EAMC[3]
ï¼š
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2734
[1m[33mEnqueueTask: [0m[32mTask: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[20]:3.0 | [31]:3.0 | [50]:4.0 | [57]:5.0 | [61]:1.0 | [49]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[8]:3.0 | [37]:2.0 | [59]:2.0 | [62]:4.0 | [63]:7.0 | [4]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[18]:1.0 | [22]:5.0 | [46]:4.0 | [48]:4.0 | [60]:3.0 | [21]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[3]:3.0 | [18]:5.0 | [22]:3.0 | [34]:6.0 | [60]:4.0 | [13]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[12]:4.0 | [18]:4.0 | [39]:6.0 | [41]:6.0 | [50]:5.0 | [43]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[16]:4.0 | [35]:3.0 | [46]:6.0 | [50]:4.0 | [56]:6.0 | [37]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[16, 35, 46, 50, 56, 37]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 6.200(2743)[0m | [32mExpert 41: 5.400(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert  9: 3.800(2809)[0m | 
[32mExpert 38: 3.600(2716)[0m | [32mExpert  7: 3.600(2803)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | 
[32mExpert 10: 3.400(2626)[0m | [32mExpert 48: 3.000(2749)[0m | [32mExpert 60: 3.000(2791)[0m | [32mExpert  1: 2.800(2623)[0m | 
[32mExpert 51: 2.800(2761)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert 23: 2.600(2668)[0m | [32mExpert 27: 2.600(2680)[0m | 
[32mExpert 11: 2.400(2629)[0m | [32mExpert 35: 2.400(2707)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 14: 2.200(2638)[0m | 
[32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 33: 1.800(2701)[0m | 
[32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | 
[32mExpert 43: 1.200(2734)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 40: 1.000(2725)[0m | [32mExpert 29: 1.000(2686)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2647, 2737, 2635, 2701, 2644, 2665, 2704, 2722, 2734, 2695, 2725, 2686]
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2734[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4, 13, 16, 17, 22, 29, 31, 33, 34, 40, 43, 44 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[6]:3.0 | [8]:5.0 | [26]:5.0 | [41]:6.0 | [42]:5.0 | [50]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[6]:5.0 | [8]:6.0 | [45]:6.0 | [46]:7.0 | [55]:3.0 | [25]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[1]:4.0 | [38]:4.0 | [41]:6.0 | [46]:7.0 | [48]:4.0 | [35]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[30]:6.0 | [41]:7.0 | [53]:3.0 | [55]:6.0 | [60]:4.0 | [17]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[8]:4.0 | [28]:6.0 | [35]:2.0 | [43]:6.0 | [47]:5.0 | [16]:9.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[7]:1.0 | [29]:5.0 | [42]:5.0 | [43]:3.0 | [46]:4.0 | [41]:6.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 7, 29, 42, 43, 46, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 5.400(2882)[0m | [32mExpert 14: 5.200(2876)[0m | [32mExpert  6: 5.000(3026)[0m | [32mExpert 49: 5.000(2990)[0m | 
[32mExpert 11: 4.200(2867)[0m | [32mExpert 36: 4.200(2948)[0m | [32mExpert 38: 3.800(2954)[0m | [32mExpert  4: 3.600(2960)[0m | 
[32mExpert 32: 3.400(2936)[0m | [32mExpert 26: 3.200(2915)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert  0: 2.800(2858)[0m | 
[32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert 48: 2.400(2987)[0m | [32mExpert  5: 2.200(2993)[0m | 
[32mExpert 19: 2.200(2891)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | 
[32mExpert 40: 2.000(2963)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | 
[32mExpert 42: 1.600(2969)[0m | [32mExpert 33: 1.600(2939)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | 
[32mExpert 15: 1.400(2879)[0m | [32mExpert 41: 1.400(2966)[0m | [32mExpert 43: 1.400(2972)[0m | [32mExpert  1: 1.000(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2963, 2975, 3020, 2885, 2969, 2939, 3011, 3047, 2879, 2966, 2972, 2861]
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 15, 17, 33, 40, 41, 42, 43, 44, 55, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:2.0 | [18]:2.0 | [29]:7.0 | [33]:5.0 | [44]:5.0 | [21]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[9]:7.0 | [28]:6.0 | [30]:5.0 | [33]:4.0 | [50]:6.0 | [56]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[0]:4.0 | [6]:5.0 | [16]:6.0 | [19]:3.0 | [49]:5.0 | [38]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[15]:5.0 | [17]:5.0 | [24]:6.0 | [41]:6.0 | [58]:3.0 | [16]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[25]:6.0 | [26]:3.0 | [40]:6.0 | [55]:5.0 | [57]:4.0 | [52]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[18]:6.0 | [30]:3.0 | [46]:6.0 | [48]:1.0 | [53]:3.0 | [21]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[18, 30, 46, 48, 53, 21]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 7.400(4205)[0m | [32mExpert 17: 6.600(4103)[0m | [32mExpert 18: 4.800(4106)[0m | [32mExpert 14: 4.400(4094)[0m | 
[32mExpert 21: 4.400(4118)[0m | [32mExpert 26: 4.200(4133)[0m | [32mExpert 41: 4.200(4184)[0m | [32mExpert  0: 3.800(4076)[0m | 
[32mExpert 12: 3.000(4088)[0m | [32mExpert  2: 2.800(4112)[0m | [32mExpert 51: 2.800(4217)[0m | [32mExpert 44: 2.600(4193)[0m | 
[32mExpert 55: 2.600(4229)[0m | EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4169
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1340,250000002b] (16MB) STATE(0) TENSOR[4168,4169,4167,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
[32mExpert 27: 2.400(4136)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | 
[32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 42: 2.000(4187)[0m | 
[32mExpert 52: 2.000(4220)[0m | [32mExpert 61: 1.800(4250)[0m | [32mExpert 62: 1.800(4253)[0m | [32mExpert 53: 1.800(4223)[0m | 
[32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 32: 1.400(4154)[0m | [32mExpert 37: 1.400(4169)[0m | 
[32mExpert 23: 1.200(4124)[0m | [32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert 13: 1.200(4091)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4220, 4250, 4253, 4223, 4232, 4139, 4154, 4169, 4124, 4238, 4244, 4091]
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4169[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6, 13, 23, 28, 32, 37, 52, 53, 56, 58, 61, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:6.0 | [19]:4.0 | [24]:5.0 | [41]:5.0 | [47]:5.0 | [9]:8.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[15]:9.0 | [22]:4.0 | [25]:6.0 | [43]:5.0 | [50]:5.0 | [53]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[12]:3.0 | [14]:5.0 | [27]:3.0 | [37]:2.0 | [48]:8.0 | [62]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E37 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E62 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:6.0 | [23]:1.0 | [37]:3.0 | [55]:7.0 | [60]:5.0 | [11]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[7]:5.0 | [22]:3.0 | [23]:5.0 | [32]:5.0 | [57]:4.0 | [41]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[2]:2.0 | [16]:6.0 | [28]:5.0 | [37]:3.0 | [58]:5.0 | [61]:5.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 2, 16, 28, 37, 58, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[2]:4.0 | [10]:6.0 | [12]:5.0 | [40]:1.0 | [57]:4.0 | [49]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[7]:5.0 | [26]:4.0 | [30]:5.0 | [34]:5.0 | [48]:7.0 | [3]:2.0 | 
---------------------------------------
return EAMC[3]
åˆ›æ„EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2734
[1m[33mEnqueueTask: [0m[32mTask: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2686
[1m[33mEnqueueTask: [0m[32mTask: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[552,1d00000013] (16MB) STATE(0) TENSOR[2685,2686,2684,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
EnqueuePrefetch: 2963
[1m[33mEnqueueTask: [0m[32mTask: node: ID[953,280000001f] (16MB) STATE(0) TENSOR[2962,2963,2961,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2879
[1m[33mEnqueueTask: [0m[32mTask: node: ID[928,f0000001f] (16MB) STATE(0) TENSOR[2878,2879,2877,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2861
[1m[33mEnqueueTask: [0m[32mTask: node: ID[914,10000001f] (16MB) STATE(0) TENSOR[2860,2861,2859,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:2.0 | [10]:4.0 | [22]:1.0 | [32]:5.0 | [33]:1.0 | [23]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[27]:2.0 | [42]:4.0 | [57]:2.0 | [61]:1.0 | [63]:8.0 | [7]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[20]:5.0 | [28]:3.0 | [33]:1.0 | [59]:3.0 | [63]:2.0 | [50]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[12]:2.0 | [24]:4.0 | [53]:1.0 | [54]:1.0 | [62]:6.0 | [25]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[6]:5.0 | [7]:5.0 | [19]:2.0 | [30]:5.0 | [35]:3.0 | [3]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[2]:5.0 | [19]:4.0 | [29]:4.0 | [53]:3.0 | [57]:1.0 | [14]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 2, 19, 29, 53, 57, 14]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 41: 6.200(2728)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 38: 4.400(2716)[0m | 
[32mExpert  9: 3.800(2809)[0m | [32mExpert 48: 3.800(2749)[0m | [32mExpert  1: 3.600(2623)[0m | [32mExpert  7: 3.600(2803)[0m | 
[32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | [32mExpert 35: 3.200(2707)[0m | 
[32mExpert 60: 3.000(2791)[0m | [32mExpert 51: 2.800(2761)[0m | [32mExpert 19: 2.800(2653)[0m | [32mExpert 23: 2.600(2668)[0m | 
[32mExpert 27: 2.600(2680)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 14: 2.200(2638)[0m | 
[32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 33: 1.800(2701)[0m | 
[32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | 
[32mExpert 43: 1.200(2734)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 40: 1.000(2725)[0m | [32mExpert 29: 1.000(2686)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2647, 2737, 2635, 2701, 2644, 2665, 2704, 2722, 2734, 2695, 2725, 2686]
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2734[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2686[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4, 13, 16, 17, 22, 29, 31, 33, 34, 40, 43, 44 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[9]:5.0 | [10]:3.0 | [11]:2.0 | [29]:1.0 | [47]:6.0 | [1]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[9]:6.0 | [15]:3.0 | [17]:4.0 | [49]:7.0 | [53]:1.0 | [57]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[9]:5.0 | [14]:3.0 | [23]:4.0 | [26]:1.0 | [49]:1.0 | [51]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[4]:1.0 | [32]:1.0 | [49]:4.0 | [56]:2.0 | [59]:4.0 | [37]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[2]:6.0 | [15]:1.0 | [16]:10.0 | [54]:8.0 | [56]:1.0 | [43]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[1]:4.0 | [33]:2.0 | [44]:3.0 | [45]:6.0 | [57]:7.0 | [18]:6.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 1, 33, 44, 45, 57, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 6.200(2882)[0m | [32mExpert  6: 5.800(3026)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 14: 5.200(2876)[0m | 
[32mExpert 38: 4.600(2954)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 36: 4.200(2948)[0m | [32mExpert  0: 3.600(2858)[0m | 
[32mExpert  4: 3.600(2960)[0m | [32mExpert 32: 3.400(2936)[0m | [32mExpert 26: 3.200(2915)[0m | [32mExpert 19: 3.000(2891)[0m | 
[32mExpert 37: 3.000(2951)[0m | [32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert 48: 2.400(2987)[0m | 
[32mExpert  5: 2.200(2993)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | 
[32mExpert 40: 2.000(2963)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | 
[32mExpert 42: 1.600(2969)[0m | [32mExpert 33: 1.600(2939)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | 
[32mExpert 15: 1.400(2879)[0m | [32mExpert 41: 1.400(2966)[0m | [32mExpert 43: 1.400(2972)[0m | [32mExpert  1: 1.000(2861)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2963, 2975, 3020, 2885, 2969, 2939, 3011, 3047, 2879, 2966, 2972, 2861]
Prefetching [1;36mTensor 2963[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2879[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2861[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  1,  9, 15, 17, 33, 40, 41, 42, 43, 44, 55, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:4.0 | [11]:4.0 | [29]:8.0 | [57]:3.0 | [63]:6.0 | [42]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[5]:7.0 | [38]:4.0 | [48]:1.0 | [55]:4.0 | [59]:7.0 | [58]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[15]:2.0 | [32]:5.0 | [36]:4.0 | [40]:3.0 | [57]:2.0 | [14]:5.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E15 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E40 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[1]:1.0 | [13]:3.0 | [28]:3.0 | [30]:7.0 | [36]:4.0 | [61]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[37]:1.0 | [41]:2.0 | [45]:4.0 | [50]:4.0 | [61]:6.0 | [19]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[5]:4.0 | [14]:4.0 | [18]:7.0 | [29]:2.0 | [48]:2.0 | [47]:5.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 5, 14, 18, 29, 48, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4091
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1316,d0000002b] (16MB) STATE(0) TENSOR[4090,4091,4089,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
[90mTop 20 Experts:[0m
[32mExpert 48: 8.200(4205)[0m | [32mExpert 17: 6.600(4103)[0m | [32mExpert 14: 5.200(4094)[0m | [32mExpert 18: 4.800(4106)[0m | 
[32mExpert 21: 4.400(4118)[0m | [32mExpert 26: 4.200(4133)[0m | [32mExpert 41: 4.200(4184)[0m | [32mExpert  0: 3.800(4076)[0m | 
[32mExpert 12: 3.800(4088)[0m | [32mExpert 27: 3.200(4136)[0m | [32mExpert  2: 2.800(4112)[0m | [32mExpert 51: 2.800(4217)[0m | 
[32mExpert 62: 2.600(4253)[0m | [32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | [32mExpert 54: 2.400(4226)[0m | 
[32mExpert  1: 2.200(4079)[0m | [32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 37: 2.200(4169)[0m | 
[32mExpert  9: 2.000(4265)[0m | [32mExpert 42: 2.000(4187)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 61: 1.800(4250)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 32: 1.400(4154)[0m | 
[32mExpert 23: 1.200(4124)[0m | [32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | [32mExpert 13: 1.200(4091)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4265, 4187, 4220, 4250, 4223, 4232, 4139, 4154, 4124, 4238, 4244, 4091]
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
Prefetching [1;36mTensor 4091[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  9, 13, 23, 28, 32, 42, 52, 53, 56, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:2.0 | [9]:9.0 | [27]:4.0 | [38]:5.0 | [39]:3.0 | [2]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[15]:10.0 | [27]:3.0 | [44]:7.0 | [53]:4.0 | [61]:3.0 | [39]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:5.0 | [16]:2.0 | [18]:6.0 | [26]:5.0 | [41]:4.0 | [2]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 22 MLP ==
[0m
[7]:3.0 | [8]:7.0 | [17]:3.0 | [51]:3.0 | [56]:6.0 | [59]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[13]:2.0 | [30]:3.0 | [32]:6.0 | [33]:5.0 | [46]:8.0 | [51]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[2]:3.0 | [16]:7.0 | [24]:8.0 | [36]:5.0 | [45]:5.0 | [7]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 2, 16, 24, 36, 45,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:7.0 | [13]:2.0 | [18]:4.0 | [47]:6.0 | [54]:5.0 | [9]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[7]:6.0 | [10]:6.0 | [17]:5.0 | [46]:2.0 | [48]:8.0 | [40]:1.0 | 
---------------------------------------
return EAMC[3]
å†…å®¹EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2734
[1m[33mEnqueueTask: [0m[32mTask: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2752
[1m[33mEnqueueTask: [0m[32mTask: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:3.0 | [23]:3.0 | [48]:3.0 | [49]:4.0 | [59]:5.0 | [39]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[26]:2.0 | [30]:4.0 | [36]:2.0 | [54]:3.0 | [55]:3.0 | [4]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[20]:6.0 | [28]:4.0 | [32]:3.0 | [37]:4.0 | [59]:4.0 | [11]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[7]:2.0 | [24]:5.0 | [28]:5.0 | [55]:2.0 | [62]:7.0 | [25]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[2]:3.0 | [6]:6.0 | [19]:3.0 | [30]:6.0 | [46]:5.0 | [41]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[2]:6.0 | [14]:5.0 | [19]:5.0 | [20]:6.0 | [29]:5.0 | [53]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 2, 14, 19, 20, 29, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 41: 6.200(2728)[0m | [32mExpert  9: 4.600(2809)[0m | [32mExpert 45: 4.600(2740)[0m | 
[32mExpert 38: 4.400(2716)[0m | [32mExpert 48: 3.800(2749)[0m | [32mExpert  1: 3.600(2623)[0m | [32mExpert 51: 3.600(2761)[0m | 
[32mExpert  7: 3.600(2803)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 23: 3.400(2668)[0m | 
[32mExpert 10: 3.400(2626)[0m | [32mExpert 35: 3.200(2707)[0m | [32mExpert 14: 3.000(2638)[0m | [32mExpert 60: 3.000(2791)[0m | 
[32mExpert 19: 2.800(2653)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 55: 2.400(2773)[0m | 
[32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 33: 1.800(2701)[0m | 
[32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | 
[32mExpert 43: 1.200(2734)[0m | [32mExpert 49: 1.200(2752)[0m | [32mExpert 31: 1.000(2695)[0m | [32mExpert 40: 1.000(2725)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2647, 2737, 2635, 2701, 2644, 2665, 2704, 2722, 2734, 2752, 2695, 2725]
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2734[0m â†’ GPU 0
Prefetching [1;36mTensor 2752[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4, 13, 16, 17, 22, 31, 33, 34, 40, 43, 44, 49 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[7]:1.0 | [9]:6.0 | [10]:4.0 | [47]:7.0 | [49]:5.0 | [44]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[2]:4.0 | [9]:7.0 | [15]:4.0 | [17]:5.0 | [49]:8.0 | [61]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[9]:6.0 | [23]:5.0 | [26]:2.0 | [51]:5.0 | [60]:4.0 | [14]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[27]:1.0 | [33]:7.0 | [34]:3.0 | [45]:4.0 | [59]:5.0 | [49]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[13]:4.0 | [16]:11.0 | [33]:5.0 | [43]:8.0 | [54]:9.0 | [2]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[18]:7.0 | [22]:5.0 | [28]:2.0 | [44]:4.0 | [57]:8.0 | [8]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[18, 22, 28, 44, 57,  8]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 6.200(2882)[0m | [32mExpert 14: 6.000(2876)[0m | [32mExpert  6: 5.800(3026)[0m | [32mExpert 49: 5.800(2990)[0m | 
[32mExpert 36: 5.000(2948)[0m | [32mExpert 38: 4.600(2954)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 32: 4.200(2936)[0m | 
[32mExpert  0: 3.600(2858)[0m | [32mExpert  4: 3.600(2960)[0m | [32mExpert 26: 3.200(2915)[0m | [32mExpert 19: 3.000(2891)[0m | 
[32mExpert 37: 3.000(2951)[0m | [32mExpert 40: 2.800(2963)[0m | [32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | 
[32mExpert 48: 2.400(2987)[0m | [32mExpert  5: 2.200(2993)[0m | [32mExpert 15: 2.200(2879)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 57: 1.800(3017)[0m | 
[32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 42: 1.600(2969)[0m | [32mExpert 33: 1.600(2939)[0m | 
[32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 41: 1.400(2966)[0m | [32mExpert 43: 1.400(2972)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 3044, 2975, 3017, 3020, 2885, 2969, 2939, 3011, 3047, 2966, 2972]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8,  9, 17, 25, 33, 41, 42, 43, 44, 55, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:5.0 | [11]:5.0 | [29]:9.0 | [55]:4.0 | [57]:4.0 | [60]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[5]:8.0 | [37]:3.0 | [38]:5.0 | [55]:5.0 | [59]:8.0 | [50]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[0]:5.0 | [4]:4.0 | [15]:3.0 | [32]:6.0 | [36]:5.0 | [48]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[5]:3.0 | [28]:4.0 | [36]:5.0 | [41]:7.0 | [45]:5.0 | [30]:8.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[24]:2.0 | [45]:5.0 | [50]:5.0 | [58]:3.0 | [61]:7.0 | [48]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[8]:5.0 | [18]:8.0 | [35]:4.0 | [47]:6.0 | [48]:3.0 | [14]:5.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 8, 18, 35, 47, 48, 14]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 8.200(4205)[0m | [32mExpert 17: 6.600(4103)[0m | [32mExpert 18: 5.600(4106)[0m | [32mExpert 14: 5.200(4094)[0m | 
[32mExpert 26: 5.000(4133)[0m | [32mExpert 41: 5.000(4184)[0m | [32mExpert  0: 4.600(4076)[0m | [32mExpert 21: 4.400(4118)[0m | 
[32mExpert 12: 3.800(4088)[0m | [32mExpert  2: 3.600(4112)[0m | [32mExpert 27: 3.200(4136)[0m | [32mExpert 51: 2.800(4217)[0m | 
[32mExpert 62: 2.600(4253)[0m | EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
[32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | [32mExpert 54: 2.400(4226)[0m | 
[32mExpert  1: 2.200(4079)[0m | [32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 37: 2.200(4169)[0m | 
[32mExpert  9: 2.000(4265)[0m | [32mExpert 42: 2.000(4187)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 16: 1.800(4100)[0m | 
[32mExpert 61: 1.800(4250)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | 
[32mExpert 32: 1.400(4154)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4265, 4187, 4220, 4100, 4250, 4223, 4232, 4139, 4154, 4124, 4238, 4244]
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  9, 16, 23, 28, 32, 42, 52, 53, 56, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[4]:3.0 | [9]:10.0 | [38]:6.0 | [49]:2.0 | [53]:3.0 | [24]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[13]:5.0 | [15]:11.0 | [44]:8.0 | [54]:2.0 | [55]:3.0 | [24]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:6.0 | [18]:7.0 | [26]:6.0 | [41]:5.0 | [48]:9.0 | [51]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 22 MLP ==
[0m
[7]:4.0 | [8]:8.0 | [17]:4.0 | [46]:2.0 | [56]:7.0 | [55]:8.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[1]:4.0 | [13]:3.0 | [23]:6.0 | [33]:6.0 | [46]:9.0 | [62]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[24]:9.0 | [36]:6.0 | [45]:6.0 | [51]:2.0 | [62]:4.0 | [61]:6.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[24, 36, 45, 51, 62, 61]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:3.0 | [10]:8.0 | [18]:5.0 | [47]:7.0 | [54]:6.0 | [17]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[10]:7.0 | [29]:4.0 | [32]:2.0 | [51]:3.0 | [56]:8.0 | [17]:6.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2734
[1m[33mEnqueueTask: [0m[32mTask: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2752
[1m[33mEnqueueTask: [0m[32mTask: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2939
[1m[33mEnqueueTask: [0m[32mTask: node: ID[946,210000001f] (16MB) STATE(0) TENSOR[2938,2939,2937,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2966
[1m[33mEnqueueTask: [0m[32mTask: node: ID[954,290000001f] (16MB) STATE(0) TENSOR[2965,2966,2964,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[20]:4.0 | [55]:2.0 | [56]:4.0 | [57]:6.0 | [60]:3.0 | [46]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[15]:2.0 | [19]:2.0 | [46]:2.0 | [47]:2.0 | [51]:1.0 | [24]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[7]:5.0 | [9]:3.0 | [13]:2.0 | [22]:6.0 | [42]:4.0 | [46]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[26]:2.0 | [34]:7.0 | [41]:1.0 | [57]:2.0 | [59]:5.0 | [13]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[10]:2.0 | [17]:1.0 | [27]:2.0 | [39]:7.0 | [41]:8.0 | [56]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[6]:3.0 | [12]:3.0 | [19]:6.0 | [35]:4.0 | [43]:1.0 | [24]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 6, 12, 19, 35, 43, 24]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.000(2743)[0m | [32mExpert 41: 6.200(2728)[0m | [32mExpert  9: 5.400(2809)[0m | [32mExpert 45: 4.600(2740)[0m | 
[32mExpert 38: 4.400(2716)[0m | [32mExpert 51: 4.400(2761)[0m | [32mExpert 23: 4.200(2668)[0m | [32mExpert 14: 3.800(2638)[0m | 
[32mExpert 48: 3.800(2749)[0m | [32mExpert 60: 3.800(2791)[0m | [32mExpert  1: 3.600(2623)[0m | [32mExpert  7: 3.600(2803)[0m | 
[32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | [32mExpert 35: 3.200(2707)[0m | 
[32mExpert 19: 2.800(2653)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 55: 2.400(2773)[0m | 
[32mExpert 17: 2.000(2647)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 33: 1.800(2701)[0m | 
[32mExpert 26: 1.600(2677)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 34: 1.600(2704)[0m | 
[32mExpert  4: 1.400(2722)[0m | [32mExpert 43: 1.200(2734)[0m | [32mExpert 49: 1.200(2752)[0m | [32mExpert 31: 1.000(2695)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2647, 2737, 2635, 2701, 2677, 2644, 2665, 2704, 2722, 2734, 2752, 2695]
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2734[0m â†’ GPU 0
Prefetching [1;36mTensor 2752[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4, 13, 16, 17, 22, 26, 31, 33, 34, 43, 44, 49 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:6.0 | [12]:2.0 | [26]:6.0 | [41]:7.0 | [50]:8.0 | [10]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[6]:6.0 | [8]:7.0 | [18]:3.0 | [45]:7.0 | [46]:8.0 | [27]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[17]:2.0 | [33]:2.0 | [38]:5.0 | [41]:7.0 | [46]:8.0 | [19]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[30]:7.0 | [41]:8.0 | [50]:3.0 | [51]:3.0 | [53]:4.0 | [59]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[8]:5.0 | [28]:7.0 | [34]:3.0 | [43]:9.0 | [47]:6.0 | [5]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[10]:2.0 | [13]:1.0 | [41]:7.0 | [42]:6.0 | [44]:5.0 | [12]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[10, 13, 41, 42, 44, 12]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 6.200(2882)[0m | [32mExpert 14: 6.000(2876)[0m | [32mExpert  6: 5.800(3026)[0m | [32mExpert 36: 5.800(2948)[0m | 
[32mExpert 49: 5.800(2990)[0m | [32mExpert 32: 5.000(2936)[0m | [32mExpert 38: 4.600(2954)[0m | [32mExpert  0: 4.400(2858)[0m | 
[32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 26: 3.200(2915)[0m | [32mExpert 48: 3.200(2987)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 40: 2.800(2963)[0m | 
[32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert  5: 2.200(2993)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 57: 1.800(3017)[0m | 
[32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 42: 1.600(2969)[0m | [32mExpert 33: 1.600(2939)[0m | 
[32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 41: 1.400(2966)[0m | [32mExpert 43: 1.400(2972)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2912, 3044, 2975, 3017, 3020, 2885, 2969, 2939, 3011, 3047, 2966, 2972]
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 2939[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2966[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8,  9, 17, 25, 33, 41, 42, 43, 44, 55, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[29]:10.0 | [33]:6.0 | [40]:3.0 | [41]:4.0 | [49]:2.0 | [19]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[28]:7.0 | [30]:6.0 | [50]:8.0 | [57]:1.0 | [63]:3.0 | [4]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[6]:6.0 | [33]:2.0 | [34]:1.0 | [38]:4.0 | [54]:2.0 | [16]:7.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E33 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[17]:6.0 | [22]:2.0 | [24]:7.0 | [41]:8.0 | [58]:4.0 | [38]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[25]:7.0 | [40]:7.0 | [52]:4.0 | [55]:6.0 | [57]:5.0 | [2]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[18]:9.0 | [40]:3.0 | [46]:7.0 | [51]:2.0 | [53]:4.0 | [41]:1.0 | EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4187
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1345,2a0000002b] (16MB) STATE(0) TENSOR[4186,4187,4185,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4244
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1309,60000002b] (16MB) STATE(0) TENSOR[4243,4244,4242,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 14
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29

---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[18, 40, 46, 51, 53, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 9.000(4205)[0m | [32mExpert 17: 6.600(4103)[0m | [32mExpert 18: 6.400(4106)[0m | [32mExpert 26: 5.800(4133)[0m | 
[32mExpert 41: 5.800(4184)[0m | [32mExpert  0: 5.400(4076)[0m | [32mExpert 14: 5.200(4094)[0m | [32mExpert 21: 4.400(4118)[0m | 
[32mExpert 12: 3.800(4088)[0m | [32mExpert  2: 3.600(4112)[0m | [32mExpert 51: 3.600(4217)[0m | [32mExpert 27: 3.200(4136)[0m | 
[32mExpert 62: 2.600(4253)[0m | [32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | [32mExpert 54: 2.400(4226)[0m | 
[32mExpert  1: 2.200(4079)[0m | [32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 37: 2.200(4169)[0m | 
[32mExpert  9: 2.000(4265)[0m | [32mExpert 42: 2.000(4187)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 16: 1.800(4100)[0m | 
[32mExpert 61: 1.800(4250)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | 
[32mExpert 32: 1.400(4154)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 58: 1.200(4238)[0m | [32mExpert  6: 1.200(4244)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4265, 4187, 4220, 4100, 4250, 4223, 4232, 4139, 4154, 4124, 4238, 4244]
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4187[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4244[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  6,  9, 16, 23, 28, 32, 42, 52, 53, 56, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[14]:7.0 | [17]:3.0 | [41]:6.0 | [47]:6.0 | [61]:2.0 | [55]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[0]:2.0 | [11]:1.0 | [15]:12.0 | [25]:7.0 | [44]:9.0 | [42]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[12]:4.0 | [14]:6.0 | [37]:3.0 | [42]:2.0 | [48]:10.0 | [39]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[21]:7.0 | [27]:1.0 | [40]:3.0 | [55]:9.0 | [60]:6.0 | [52]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[7]:6.0 | [23]:7.0 | [38]:3.0 | [50]:3.0 | [57]:5.0 | [40]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[16]:8.0 | [19]:4.0 | [28]:6.0 | [37]:4.0 | [61]:7.0 | [29]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[16, 19, 28, 37, 61, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[10]:9.0 | [12]:6.0 | [23]:5.0 | [49]:3.0 | [57]:5.0 | [2]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[22]:2.0 | [30]:6.0 | [34]:6.0 | [44]:1.0 | [48]:9.0 | [33]:3.0 | 
---------------------------------------
return EAMC[3]
ï¼šè®¾è®¡EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2734
[1m[33mEnqueueTask: [0m[32mTask: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2752
[1m[33mEnqueueTask: [0m[32mTask: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2695
[1m[33mEnqueueTask: [0m[32mTask: node: ID[554,1f00000013] (16MB) STATE(0) TENSOR[2694,2695,2693,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[566,2b00000013] (16MB) STATE(0) TENSOR[2733,2734,2732,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3008
[1m[33mEnqueueTask: [0m[32mTask: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2942
[1m[33mEnqueueTask: [0m[32mTask: node: ID[947,220000001f] (16MB) STATE(0) TENSOR[2941,2942,2940,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[10]:5.0 | [23]:4.0 | [32]:6.0 | [41]:2.0 | [59]:6.0 | [1]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[27]:3.0 | [39]:2.0 | [42]:5.0 | [59]:3.0 | [61]:2.0 | [53]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[28]:5.0 | [37]:5.0 | [58]:1.0 | [59]:5.0 | [61]:3.0 | [20]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[20]:2.0 | [24]:6.0 | [25]:3.0 | [50]:3.0 | [62]:8.0 | [61]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[7]:6.0 | [22]:1.0 | [23]:2.0 | [35]:4.0 | [36]:1.0 | [41]:9.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[2]:7.0 | [7]:2.0 | [19]:7.0 | [24]:2.0 | [44]:3.0 | [4]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 2,  7, 19, 24, 44,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.800(2743)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert  9: 5.400(2809)[0m | [32mExpert 38: 5.200(2716)[0m | 
[32mExpert 45: 4.600(2740)[0m | [32mExpert 51: 4.400(2761)[0m | [32mExpert 23: 4.200(2668)[0m | [32mExpert 14: 3.800(2638)[0m | 
[32mExpert 48: 3.800(2749)[0m | [32mExpert 60: 3.800(2791)[0m | [32mExpert  1: 3.600(2623)[0m | [32mExpert 19: 3.600(2653)[0m | 
[32mExpert  7: 3.600(2803)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | 
[32mExpert 35: 3.200(2707)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 33: 2.600(2701)[0m | 
[32mExpert 11: 2.400(2629)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 26: 1.600(2677)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | [32mExpert 34: 1.600(2704)[0m | 
[32mExpert  4: 1.400(2722)[0m | [32mExpert 43: 1.200(2734)[0m | [32mExpert 49: 1.200(2752)[0m | [32mExpert 31: 1.000(2695)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2629, 2773, 2737, 2635, 2677, 2644, 2665, 2704, 2722, 2734, 2752, 2695]
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2734[0m â†’ GPU 0
Prefetching [1;36mTensor 2752[0m â†’ GPU 0
Prefetching [1;36mTensor 2695[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4, 11, 13, 16, 22, 26, 31, 34, 43, 44, 49, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:4.0 | [4]:1.0 | [9]:7.0 | [10]:6.0 | [47]:8.0 | [0]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[2]:5.0 | [15]:5.0 | [17]:6.0 | [18]:4.0 | [29]:2.0 | [33]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[21]:1.0 | [23]:6.0 | [25]:1.0 | [40]:2.0 | [42]:1.0 | [36]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[10]:5.0 | [33]:8.0 | [35]:5.0 | [52]:1.0 | [56]:3.0 | [19]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[16]:12.0 | [21]:2.0 | [39]:1.0 | [53]:4.0 | [54]:10.0 | [30]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[0]:1.0 | [13]:2.0 | [34]:1.0 | [41]:8.0 | [44]:6.0 | [45]:7.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 0, 13, 34, 41, 44, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 7.000(2882)[0m | [32mExpert  6: 6.600(3026)[0m | [32mExpert 14: 6.000(2876)[0m | [32mExpert 36: 5.800(2948)[0m | 
[32mExpert 49: 5.800(2990)[0m | [32mExpert 38: 5.400(2954)[0m | [32mExpert 32: 5.000(2936)[0m | [32mExpert  0: 4.400(2858)[0m | 
[32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 26: 3.200(2915)[0m | [32mExpert 48: 3.200(2987)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 40: 2.800(2963)[0m | 
[32mExpert 61: 2.800(3032)[0m | [32mExpert 33: 2.400(2939)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert  5: 2.200(2993)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | 
[32mExpert 57: 1.800(3017)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 42: 1.600(2969)[0m | 
[32mExpert 54: 1.600(3008)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 34: 1.400(2942)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2912, 3044, 2975, 3017, 3020, 2885, 2969, 3008, 3011, 3047, 2942]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3008[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2942[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8,  9, 17, 25, 34, 42, 44, 50, 54, 55, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[12]:1.0 | [19]:2.0 | [23]:2.0 | [26]:3.0 | [38]:3.0 | [30]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[5]:9.0 | [29]:1.0 | [35]:3.0 | [38]:6.0 | [63]:4.0 | [59]:9.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[20]:1.0 | [21]:1.0 | [33]:3.0 | [38]:5.0 | [56]:1.0 | [2]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[1]:2.0 | [3]:1.0 | [22]:3.0 | [36]:6.0 | [52]:1.0 | [48]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[11]:3.0 | [21]:1.0 | [39]:1.0 | [54]:2.0 | [61]:8.0 | [45]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[5]:5.0 | [33]:2.0 | [40]:4.0 | [47]:7.0 | [55]:3.0 | [41]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 5, 33, 40, 47, 55, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 9.800(4205)[0m | [32mExpert 17: 6.600(4103)[0m | [32mExpert 18: 6.400(4106)[0m | [32mExpert 14: 6.000(4094)[0m | 
[32mExpert 26: 5.800(4133)[0m | [32mExpert 41: 5.800(4184)[0m | [32mExpert  0: 5.400(4076)[0m | [32mExpert 12: 4.600(4088)[0m | 
[32mExpert 21: 4.400(4118)[0m | [32mExpert  2: 3.600(4112)[0m | [32mExpert 51: 3.600(4217)[0m | [32mExpert 27: 3.200(4136)[0m | 
[32mExpert 37: 3.000(4169)[0m | EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4250
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1364,3d0000002b] (16MB) STATE(0) TENSOR[4249,4250,4248,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 15
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 30
[32mExpert 42: 2.800(4187)[0m | [32mExpert 62: 2.600(4253)[0m | [32mExpert 44: 2.600(4193)[0m | 
[32mExpert 55: 2.600(4229)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | [32mExpert 10: 2.200(4082)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 16: 1.800(4100)[0m | 
[32mExpert 61: 1.800(4250)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | 
[32mExpert 32: 1.400(4154)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 39: 1.200(4175)[0m | [32mExpert 58: 1.200(4238)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4109, 4265, 4220, 4100, 4250, 4223, 4232, 4139, 4154, 4124, 4175, 4238]
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4250[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  9, 16, 19, 23, 28, 32, 39, 52, 53, 56, 58, 61 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[17]:4.0 | [18]:1.0 | [21]:1.0 | [27]:5.0 | [38]:7.0 | [4]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[11]:2.0 | [14]:2.0 | [15]:13.0 | [26]:2.0 | [32]:2.0 | [27]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:7.0 | [37]:4.0 | [48]:11.0 | [57]:1.0 | [61]:3.0 | [18]:8.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E61 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[18]:1.0 | [28]:1.0 | [29]:1.0 | [39]:2.0 | [56]:8.0 | [35]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[20]:1.0 | [32]:7.0 | [46]:10.0 | [50]:4.0 | [57]:6.0 | [58]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[16]:9.0 | [22]:1.0 | [25]:2.0 | [28]:7.0 | [57]:1.0 | [10]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[16, 22, 25, 28, 57, 10]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[22]:1.0 | [23]:6.0 | [36]:1.0 | [49]:4.0 | [59]:1.0 | [2]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[7]:7.0 | [10]:8.0 | [31]:1.0 | [44]:2.0 | [48]:10.0 | [3]:3.0 | 
---------------------------------------
return EAMC[3]
ä¸€ä¸ªEnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2722
[1m[33mEnqueueTask: [0m[32mTask: node: ID[527,400000013] (16MB) STATE(0) TENSOR[2721,2722,2720,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3008
[1m[33mEnqueueTask: [0m[32mTask: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3047
[1m[33mEnqueueTask: [0m[32mTask: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[922,90000001f] (16MB) STATE(0) TENSOR[3046,3047,3045,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[20]:5.0 | [27]:1.0 | [45]:2.0 | [49]:5.0 | [62]:2.0 | [5]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[3]:2.0 | [14]:3.0 | [17]:1.0 | [22]:3.0 | [58]:2.0 | [2]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[4]:2.0 | [6]:1.0 | [12]:2.0 | [37]:6.0 | [54]:3.0 | [58]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[4]:1.0 | [9]:1.0 | [41]:2.0 | [47]:1.0 | [61]:2.0 | [29]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[32]:1.0 | [36]:2.0 | [51]:1.0 | [59]:1.0 | [60]:1.0 | [22]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[8]:1.0 | [24]:3.0 | [42]:2.0 | [44]:4.0 | [58]:1.0 | [7]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 8, 24, 42, 44, 58,  7]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.800(2743)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert  9: 5.400(2809)[0m | [32mExpert 38: 5.200(2716)[0m | 
[32mExpert 23: 5.000(2668)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 51: 4.400(2761)[0m | [32mExpert 14: 3.800(2638)[0m | 
[32mExpert 48: 3.800(2749)[0m | [32mExpert 60: 3.800(2791)[0m | [32mExpert  1: 3.600(2623)[0m | [32mExpert 19: 3.600(2653)[0m | 
[32mExpert  7: 3.600(2803)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | 
[32mExpert 35: 3.200(2707)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 33: 2.600(2701)[0m | 
[32mExpert 11: 2.400(2629)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 44: 2.000(2737)[0m | [32mExpert 40: 1.800(2725)[0m | 
[32mExpert 13: 1.800(2635)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 36: 1.600(2710)[0m | [32mExpert 16: 1.600(2644)[0m | 
[32mExpert 22: 1.600(2665)[0m | [32mExpert 34: 1.600(2704)[0m | [32mExpert  4: 1.400(2722)[0m | [32mExpert 21: 1.200(2662)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2629, 2773, 2737, 2725, 2635, 2677, 2710, 2644, 2665, 2704, 2722, 2662]
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2722[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  4, 11, 13, 16, 21, 22, 26, 34, 36, 40, 44, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[9]:8.0 | [10]:7.0 | [14]:1.0 | [33]:1.0 | [48]:1.0 | [4]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[14]:1.0 | [17]:7.0 | [18]:5.0 | [26]:1.0 | [52]:3.0 | [15]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[21]:2.0 | [25]:2.0 | [28]:1.0 | [37]:1.0 | [62]:1.0 | [47]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[31]:2.0 | [38]:1.0 | [48]:1.0 | [56]:4.0 | [61]:2.0 | [33]:9.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[25]:1.0 | [39]:2.0 | [50]:1.0 | [51]:1.0 | [53]:5.0 | [62]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[2]:1.0 | [13]:3.0 | [37]:4.0 | [44]:7.0 | [53]:1.0 | [45]:8.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 2, 13, 37, 44, 53, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 7.000(2882)[0m | [32mExpert  6: 6.600(3026)[0m | [32mExpert 38: 6.200(2954)[0m | [32mExpert 14: 6.000(2876)[0m | 
[32mExpert 36: 5.800(2948)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 32: 5.000(2936)[0m | [32mExpert  0: 4.400(2858)[0m | 
[32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 33: 3.200(2939)[0m | [32mExpert 26: 3.200(2915)[0m | 
[32mExpert 48: 3.200(2987)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 37: 3.000(2951)[0m | 
[32mExpert 40: 2.800(2963)[0m | [32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert  5: 2.200(2993)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | 
[32mExpert 57: 1.800(3017)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 42: 1.600(2969)[0m | 
[32mExpert 54: 1.600(3008)[0m | [32mExpert 55: 1.600(3011)[0m | [32mExpert  9: 1.600(3047)[0m | [32mExpert 21: 1.400(2900)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2912, 3044, 2975, 3017, 3020, 2885, 2969, 3008, 3011, 3047, 2900]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3008[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
Prefetching [1;36mTensor 3047[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8,  9, 17, 21, 25, 42, 44, 50, 54, 55, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[19]:3.0 | [22]:1.0 | [23]:3.0 | [26]:4.0 | [30]:3.0 | [49]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[32]:1.0 | [34]:1.0 | [49]:2.0 | [50]:9.0 | [63]:5.0 | [1]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[20]:2.0 | [33]:4.0 | [38]:6.0 | [46]:1.0 | [56]:2.0 | [29]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[1]:3.0 | [8]:1.0 | [22]:4.0 | [31]:1.0 | [58]:5.0 | [52]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[2]:4.0 | [21]:2.0 | [34]:1.0 | [37]:2.0 | [39]:2.0 | [60]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[4]:1.0 | [34]:1.0 | [40]:5.0 | [41]:3.0 | [63]:2.0 | [27]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 4, 34, 40, 41, 63, 27]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 10.600(4205)[0m | [32mExpert 18: 7.200(4106)[0m | [32mExpert 17: 6.600(4103)[0m | [32mExpert  0: 6.200(4076)[0m | 
[32mExpert 14: 6.000(4094)[0m | [32mExpert 26: 5.800(4133)[0m | EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 31
[32mExpert 41: 5.800(4184)[0m | [32mExpert 12: 4.600(4088)[0m | 
[32mExpert 21: 4.400(4118)[0m | [32mExpert 37: 3.800(4169)[0m | [32mExpert  2: 3.600(4112)[0m | [32mExpert 51: 3.600(4217)[0m | 
[32mExpert 27: 3.200(4136)[0m | [32mExpert 42: 2.800(4187)[0m | [32mExpert 61: 2.600(4250)[0m | [32mExpert 62: 2.600(4253)[0m | 
[32mExpert 44: 2.600(4193)[0m | [32mExpert 55: 2.600(4229)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | 
[32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | 
[32mExpert 16: 1.800(4100)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | 
[32mExpert 32: 1.400(4154)[0m | [32mExpert 23: 1.200(4124)[0m | [32mExpert 39: 1.200(4175)[0m | [32mExpert 58: 1.200(4238)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4082, 4109, 4265, 4220, 4100, 4223, 4232, 4139, 4154, 4124, 4175, 4238]
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  9, 10, 16, 19, 23, 28, 32, 39, 52, 53, 56, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[7]:1.0 | [16]:1.0 | [17]:5.0 | [31]:2.0 | [45]:1.0 | [56]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[11]:3.0 | [17]:2.0 | [27]:5.0 | [32]:3.0 | [33]:1.0 | [7]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:8.0 | [37]:5.0 | [48]:12.0 | [55]:3.0 | [57]:2.0 | [39]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E39 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[1]:1.0 | [10]:1.0 | [11]:6.0 | [29]:2.0 | [57]:1.0 | [54]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[9]:1.0 | [12]:2.0 | [32]:8.0 | [50]:5.0 | [57]:7.0 | [51]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[16]:10.0 | [22]:2.0 | [25]:3.0 | [28]:8.0 | [57]:2.0 | [40]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[16, 22, 25, 28, 57, 40]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[23]:7.0 | [36]:2.0 | [39]:2.0 | [49]:5.0 | [59]:2.0 | [26]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[3]:4.0 | [9]:2.0 | [44]:3.0 | [48]:11.0 | [61]:1.0 | [7]:8.0 | 
---------------------------------------
return EAMC[3]
åŸºäºEnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2665
[1m[33mEnqueueTask: [0m[32mTask: node: ID[545,1600000013] (16MB) STATE(0) TENSOR[2664,2665,2663,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3008
[1m[33mEnqueueTask: [0m[32mTask: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3011
[1m[33mEnqueueTask: [0m[32mTask: node: ID[968,370000001f] (16MB) STATE(0) TENSOR[3010,3011,3009,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[24]:1.0 | [27]:2.0 | [37]:3.0 | [41]:3.0 | [45]:3.0 | [43]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[10]:2.0 | [17]:2.0 | [34]:2.0 | [57]:3.0 | [60]:3.0 | [19]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[6]:2.0 | [13]:3.0 | [18]:2.0 | [19]:1.0 | [47]:1.0 | [56]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[17]:1.0 | [27]:1.0 | [29]:6.0 | [42]:1.0 | [57]:3.0 | [47]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[0]:1.0 | [15]:2.0 | [23]:3.0 | [36]:3.0 | [60]:2.0 | [48]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[7]:4.0 | [32]:3.0 | [43]:2.0 | [49]:1.0 | [58]:2.0 | [24]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 7, 32, 43, 49, 58, 24]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.800(2743)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert  9: 5.400(2809)[0m | [32mExpert 38: 5.200(2716)[0m | 
[32mExpert 23: 5.000(2668)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 51: 4.400(2761)[0m | [32mExpert 14: 3.800(2638)[0m | 
[32mExpert 48: 3.800(2749)[0m | [32mExpert 60: 3.800(2791)[0m | [32mExpert  1: 3.600(2623)[0m | [32mExpert 19: 3.600(2653)[0m | 
[32mExpert  7: 3.600(2803)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | 
[32mExpert 35: 3.200(2707)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 27: 2.600(2680)[0m | [32mExpert 33: 2.600(2701)[0m | 
[32mExpert 11: 2.400(2629)[0m | [32mExpert 55: 2.400(2773)[0m | [32mExpert 21: 2.000(2662)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert 25: 1.800(2674)[0m | [32mExpert 40: 1.800(2725)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert 47: 1.800(2746)[0m | 
[32mExpert 26: 1.600(2677)[0m | [32mExpert 36: 1.600(2710)[0m | [32mExpert 16: 1.600(2644)[0m | [32mExpert 22: 1.600(2665)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2629, 2773, 2662, 2737, 2674, 2725, 2635, 2746, 2677, 2710, 2644, 2665]
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2665[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 11, 13, 16, 21, 22, 25, 26, 36, 40, 44, 47, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:5.0 | [9]:9.0 | [12]:3.0 | [52]:1.0 | [54]:1.0 | [4]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[14]:2.0 | [33]:5.0 | [34]:1.0 | [35]:1.0 | [44]:1.0 | [18]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[2]:1.0 | [21]:3.0 | [47]:2.0 | [54]:1.0 | [61]:1.0 | [53]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[6]:1.0 | [24]:2.0 | [26]:1.0 | [33]:10.0 | [52]:2.0 | [10]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[19]:1.0 | [34]:4.0 | [39]:3.0 | [50]:2.0 | [62]:5.0 | [53]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[10]:3.0 | [13]:4.0 | [43]:4.0 | [55]:1.0 | [57]:9.0 | [45]:9.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[10, 13, 43, 55, 57, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 16: 7.000(2882)[0m | [32mExpert 38: 7.000(2954)[0m | [32mExpert  6: 6.600(3026)[0m | [32mExpert 14: 6.000(2876)[0m | 
[32mExpert 36: 5.800(2948)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 32: 5.000(2936)[0m | [32mExpert  0: 4.400(2858)[0m | 
[32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 33: 4.000(2939)[0m | [32mExpert 26: 3.200(2915)[0m | 
[32mExpert 48: 3.200(2987)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 37: 3.000(2951)[0m | 
[32mExpert 40: 2.800(2963)[0m | [32mExpert 61: 2.800(3032)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert  5: 2.200(2993)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | 
[32mExpert 57: 1.800(3017)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 20: 1.600(2897)[0m | 
[32mExpert 42: 1.600(2969)[0m | [32mExpert 54: 1.600(3008)[0m | [32mExpert 56: 1.600(3014)[0m | [32mExpert 55: 1.600(3011)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2996, 2912, 3044, 2975, 3017, 3020, 2885, 2897, 2969, 3008, 3014, 3011]
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3008[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 3011[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  8, 17, 20, 25, 42, 44, 50, 54, 55, 56, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:6.0 | [12]:2.0 | [19]:4.0 | [23]:4.0 | [26]:5.0 | [32]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[29]:2.0 | [34]:2.0 | [40]:1.0 | [53]:1.0 | [63]:6.0 | [32]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[2]:2.0 | [6]:7.0 | [21]:2.0 | [33]:5.0 | [61]:3.0 | [18]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[31]:2.0 | [32]:5.0 | [35]:2.0 | [52]:3.0 | [59]:1.0 | [48]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[2]:5.0 | [15]:3.0 | [21]:3.0 | [34]:2.0 | [39]:3.0 | [43]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[4]:2.0 | [31]:1.0 | [40]:6.0 | [41]:4.0 | [63]:3.0 | [18]:10.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 4, 31, 40, 41, 63, 18]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 1
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
[90mTop 20 Experts:[0m
[32mExpert 48: 11.400(4205)[0m | [32mExpert 18: 7.200(4106)[0m | [32mExpert  0: 7.000(4076)[0m | [32mExpert 17: 6.600(4103)[0m | 
[32mExpert 14: 6.000(4094)[0m | [32mExpert 26: 5.800(4133)[0m | [32mExpert 41: 5.800(4184)[0m | [32mExpert 12: 4.600(4088)[0m | 
[32mExpert 37: 4.600(4169)[0m | [32mExpert 21: 4.400(4118)[0m | [32mExpert  2: 3.600(4112)[0m | [32mExpert 51: 3.600(4217)[0m | 
[32mExpert 55: 3.400(4229)[0m | [32mExpert 27: 3.200(4136)[0m | [32mExpert 42: 2.800(4187)[0m | [32mExpert 61: 2.600(4250)[0m | 
[32mExpert 62: 2.600(4253)[0m | [32mExpert 44: 2.600(4193)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | 
[32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 39: 2.000(4175)[0m | [32mExpert  9: 2.000(4265)[0m | 
[32mExpert 52: 2.000(4220)[0m | [32mExpert 16: 1.800(4100)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | 
[32mExpert 57: 1.600(4235)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 32: 1.400(4154)[0m | [32mExpert 23: 1.200(4124)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4082, 4109, 4175, 4265, 4220, 4100, 4223, 4232, 4235, 4139, 4154, 4124]
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  9, 10, 16, 19, 23, 28, 32, 39, 52, 53, 56, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[1]:2.0 | [17]:6.0 | [22]:2.0 | [33]:1.0 | [41]:7.0 | [2]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[7]:2.0 | [11]:4.0 | [26]:3.0 | [32]:4.0 | [33]:2.0 | [56]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[12]:5.0 | [44]:1.0 | [48]:13.0 | [61]:4.0 | [63]:1.0 | [55]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 22 MLP ==
[0m
[29]:3.0 | [35]:2.0 | [50]:1.0 | [62]:1.0 | [63]:1.0 | [0]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[12]:3.0 | [44]:1.0 | [50]:6.0 | [55]:1.0 | [57]:8.0 | [58]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[16]:11.0 | [22]:3.0 | [40]:2.0 | [55]:1.0 | [57]:3.0 | [25]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[16, 22, 40, 55, 57, 25]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[23]:8.0 | [26]:2.0 | [36]:3.0 | [49]:6.0 | [59]:3.0 | [46]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[9]:3.0 | [26]:5.0 | [31]:2.0 | [44]:4.0 | [48]:12.0 | [15]:1.0 | 
---------------------------------------
return EAMC[3]
åŒºå—é“¾EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2773
[1m[33mEnqueueTask: [0m[32mTask: node: ID[578,3700000013] (16MB) STATE(0) TENSOR[2772,2773,2771,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2912
[1m[33mEnqueueTask: [0m[32mTask: node: ID[938,190000001f] (16MB) STATE(0) TENSOR[2911,2912,2910,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3008
[1m[33mEnqueueTask: [0m[32mTask: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:4.0 | [30]:1.0 | [31]:4.0 | [40]:1.0 | [41]:4.0 | [1]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[3]:3.0 | [18]:1.0 | [27]:4.0 | [37]:3.0 | [60]:4.0 | [43]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[3]:3.0 | [21]:4.0 | [32]:4.0 | [36]:2.0 | [49]:1.0 | [28]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[0]:1.0 | [1]:4.0 | [28]:6.0 | [36]:1.0 | [48]:4.0 | [62]:9.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[13]:2.0 | [29]:2.0 | [34]:2.0 | [35]:5.0 | [44]:2.0 | [49]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[3]:3.0 | [27]:2.0 | [29]:6.0 | [41]:2.0 | [63]:1.0 | [57]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 3, 27, 29, 41, 63, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.800(2743)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert  9: 5.400(2809)[0m | [32mExpert 38: 5.200(2716)[0m | 
[32mExpert 23: 5.000(2668)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 51: 4.400(2761)[0m | [32mExpert 14: 3.800(2638)[0m | 
[32mExpert 48: 3.800(2749)[0m | [32mExpert 60: 3.800(2791)[0m | [32mExpert  1: 3.600(2623)[0m | [32mExpert 19: 3.600(2653)[0m | 
[32mExpert  7: 3.600(2803)[0m | [32mExpert 63: 3.600(2800)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 10: 3.400(2626)[0m | 
[32mExpert 35: 3.200(2707)[0m | [32mExpert 21: 2.800(2662)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 27: 2.600(2680)[0m | 
[32mExpert 33: 2.600(2701)[0m | [32mExpert 47: 2.600(2746)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 55: 2.400(2773)[0m | 
[32mExpert 44: 2.000(2737)[0m | [32mExpert 25: 1.800(2674)[0m | [32mExpert 40: 1.800(2725)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert 26: 1.600(2677)[0m | [32mExpert 36: 1.600(2710)[0m | [32mExpert 53: 1.600(2767)[0m | [32mExpert 16: 1.600(2644)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2701, 2746, 2629, 2773, 2737, 2674, 2725, 2635, 2677, 2710, 2767, 2644]
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2773[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 11, 13, 16, 25, 26, 33, 36, 40, 44, 47, 53, 55 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[11]:3.0 | [27]:4.0 | [31]:1.0 | [39]:3.0 | [47]:9.0 | [49]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[1]:2.0 | [13]:4.0 | [39]:2.0 | [44]:2.0 | [51]:1.0 | [14]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[6]:2.0 | [7]:3.0 | [55]:2.0 | [60]:5.0 | [63]:3.0 | [27]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E55 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:7.0 | [16]:3.0 | [20]:2.0 | [33]:11.0 | [49]:6.0 | [9]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[2]:8.0 | [38]:1.0 | [42]:4.0 | [52]:2.0 | [62]:6.0 | [15]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[11]:1.0 | [18]:8.0 | [22]:6.0 | [45]:10.0 | [62]:3.0 | [31]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[11, 18, 22, 45, 62, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 7.400(3026)[0m | [32mExpert 16: 7.000(2882)[0m | [32mExpert 38: 7.000(2954)[0m | [32mExpert 14: 6.000(2876)[0m | 
[32mExpert 36: 5.800(2948)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 32: 5.000(2936)[0m | [32mExpert 33: 4.800(2939)[0m | 
[32mExpert  0: 4.400(2858)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 61: 3.600(3032)[0m | 
[32mExpert 26: 3.200(2915)[0m | [32mExpert 48: 3.200(2987)[0m | [32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | 
[32mExpert 37: 3.000(2951)[0m | [32mExpert 40: 2.800(2963)[0m | [32mExpert 52: 2.400(3002)[0m | [32mExpert  5: 2.200(2993)[0m | 
[32mExpert 21: 2.200(2900)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert 25: 2.200(2912)[0m | [32mExpert  2: 2.000(2894)[0m | 
[32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 57: 1.800(3017)[0m | [32mExpert 58: 1.800(3020)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 20: 1.600(2897)[0m | [32mExpert 42: 1.600(2969)[0m | [32mExpert 54: 1.600(3008)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2900, 2996, 2912, 2894, 3044, 2975, 3017, 3020, 2885, 2897, 2969, 3008]
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2912[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3008[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  8, 17, 20, 21, 25, 42, 44, 50, 54, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[6]:7.0 | [24]:5.0 | [26]:6.0 | [61]:4.0 | [63]:7.0 | [53]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[31]:2.0 | [44]:1.0 | [51]:2.0 | [55]:6.0 | [59]:10.0 | [37]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[14]:6.0 | [25]:2.0 | [36]:6.0 | [40]:4.0 | [48]:3.0 | [26]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[6]:2.0 | [25]:3.0 | [40]:1.0 | [57]:1.0 | [61]:4.0 | [30]:9.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[27]:2.0 | [32]:1.0 | [45]:7.0 | [46]:2.0 | [50]:6.0 | [9]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[2]:5.0 | [14]:6.0 | [39]:2.0 | [44]:2.0 | [49]:3.0 | [41]:5.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 2, 14, 39, 44, 49, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4124
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1326,170000002b] (16MB) STATE(0) TENSOR[4123,4124,4122,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
[90mTop 20 Experts:[0m
[32mExpert 48: 12.200(4205)[0m | [32mExpert 18: 7.200(4106)[0m | [32mExpert  0: 7.000(4076)[0m | [32mExpert 17: 6.600(4103)[0m | 
[32mExpert 14: 6.000(4094)[0m | [32mExpert 26: 5.800(4133)[0m | [32mExpert 41: 5.800(4184)[0m | [32mExpert 12: 5.400(4088)[0m | 
[32mExpert 37: 4.600(4169)[0m | [32mExpert 21: 4.400(4118)[0m | [32mExpert 55: 4.200(4229)[0m | [32mExpert  2: 3.600(4112)[0m | 
[32mExpert 51: 3.600(4217)[0m | [32mExpert 61: 3.400(4250)[0m | [32mExpert 44: 3.400(4193)[0m | [32mExpert 27: 3.200(4136)[0m | 
[32mExpert 42: 2.800(4187)[0m | [32mExpert 62: 2.600(4253)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | 
[32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 39: 2.000(4175)[0m | [32mExpert  9: 2.000(4265)[0m | 
[32mExpert 52: 2.000(4220)[0m | [32mExpert 16: 1.800(4100)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | 
[32mExpert 57: 1.600(4235)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 32: 1.400(4154)[0m | [32mExpert 23: 1.200(4124)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4082, 4109, 4175, 4265, 4220, 4100, 4223, 4232, 4235, 4139, 4154, 4124]
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4124[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  9, 10, 16, 19, 23, 28, 32, 39, 52, 53, 56, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[8]:2.0 | [17]:7.0 | [27]:6.0 | [35]:1.0 | [39]:4.0 | [53]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[18]:3.0 | [21]:1.0 | [23]:1.0 | [26]:4.0 | [61]:4.0 | [41]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:9.0 | [18]:9.0 | [41]:6.0 | [48]:14.0 | [60]:1.0 | [58]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 22 MLP ==
[0m
[6]:3.0 | [10]:2.0 | [14]:1.0 | [22]:3.0 | [43]:1.0 | [9]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[5]:3.0 | [13]:4.0 | [50]:7.0 | [52]:1.0 | [54]:4.0 | [58]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[12]:2.0 | [16]:12.0 | [18]:3.0 | [55]:2.0 | [57]:4.0 | [32]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[12, 16, 18, 55, 57, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:4.0 | [13]:3.0 | [23]:9.0 | [28]:1.0 | [33]:5.0 | [9]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[17]:7.0 | [38]:2.0 | [39]:1.0 | [48]:13.0 | [59]:3.0 | [7]:9.0 | 
---------------------------------------
return EAMC[3]
æŠ€æœ¯çš„EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2788
[1m[33mEnqueueTask: [0m[32mTask: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2677
[1m[33mEnqueueTask: [0m[32mTask: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2710
[1m[33mEnqueueTask: [0m[32mTask: node: ID[559,2400000013] (16MB) STATE(0) TENSOR[2709,2710,2708,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[549,1a00000013] (16MB) STATE(0) TENSOR[2676,2677,2675,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3008
[1m[33mEnqueueTask: [0m[32mTask: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[10]:6.0 | [33]:2.0 | [49]:6.0 | [56]:5.0 | [59]:7.0 | [35]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[2]:3.0 | [12]:3.0 | [36]:3.0 | [48]:1.0 | [55]:4.0 | [10]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[20]:8.0 | [21]:5.0 | [28]:7.0 | [36]:3.0 | [59]:6.0 | [54]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[24]:7.0 | [28]:7.0 | [36]:2.0 | [53]:2.0 | [62]:10.0 | [63]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[1]:1.0 | [2]:4.0 | [26]:1.0 | [34]:3.0 | [46]:6.0 | [61]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[1]:2.0 | [2]:8.0 | [3]:4.0 | [47]:3.0 | [57]:3.0 | [27]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 1,  2,  3, 47, 57, 27]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.800(2743)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert  9: 5.400(2809)[0m | [32mExpert 38: 5.200(2716)[0m | 
[32mExpert 23: 5.000(2668)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 60: 4.600(2791)[0m | [32mExpert  7: 4.400(2803)[0m | 
[32mExpert 51: 4.400(2761)[0m | [32mExpert 63: 4.400(2800)[0m | [32mExpert 14: 3.800(2638)[0m | [32mExpert 48: 3.800(2749)[0m | 
[32mExpert  1: 3.600(2623)[0m | [32mExpert 19: 3.600(2653)[0m | [32mExpert 12: 3.400(2632)[0m | [32mExpert 27: 3.400(2680)[0m | 
[32mExpert 10: 3.400(2626)[0m | [32mExpert 35: 3.200(2707)[0m | [32mExpert 55: 3.200(2773)[0m | [32mExpert 21: 2.800(2662)[0m | 
[32mExpert 17: 2.800(2647)[0m | [32mExpert 33: 2.600(2701)[0m | [32mExpert 47: 2.600(2746)[0m | [32mExpert 11: 2.400(2629)[0m | 
[32mExpert 44: 2.000(2737)[0m | [32mExpert 25: 1.800(2674)[0m | [32mExpert 40: 1.800(2725)[0m | [32mExpert 13: 1.800(2635)[0m | 
[32mExpert  6: 1.600(2788)[0m | [32mExpert 26: 1.600(2677)[0m | [32mExpert 36: 1.600(2710)[0m | [32mExpert 53: 1.600(2767)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2647, 2701, 2746, 2629, 2737, 2674, 2725, 2635, 2788, 2677, 2710, 2767]
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2746[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2788[0m â†’ GPU 0
Prefetching [1;36mTensor 2677[0m â†’ GPU 0
Prefetching [1;36mTensor 2710[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  6, 11, 13, 17, 25, 26, 33, 36, 40, 44, 47, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[1]:6.0 | [7]:2.0 | [9]:10.0 | [11]:4.0 | [31]:2.0 | [62]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[5]:1.0 | [13]:5.0 | [14]:4.0 | [31]:1.0 | [44]:3.0 | [33]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[12]:4.0 | [34]:2.0 | [49]:2.0 | [53]:3.0 | [55]:3.0 | [47]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E47 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:8.0 | [20]:3.0 | [33]:12.0 | [38]:2.0 | [54]:1.0 | [61]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[27]:2.0 | [33]:6.0 | [39]:4.0 | [53]:7.0 | [62]:7.0 | [51]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[0]:2.0 | [13]:5.0 | [45]:11.0 | [53]:2.0 | [61]:2.0 | [62]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 0, 13, 45, 53, 61, 62]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 7.400(3026)[0m | [32mExpert 16: 7.000(2882)[0m | [32mExpert 38: 7.000(2954)[0m | [32mExpert 14: 6.800(2876)[0m | 
[32mExpert 36: 6.600(2948)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 32: 5.000(2936)[0m | [32mExpert 33: 4.800(2939)[0m | 
[32mExpert  0: 4.400(2858)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 26: 4.000(2915)[0m | 
[32mExpert 48: 4.000(2987)[0m | [32mExpert 40: 3.600(2963)[0m | [32mExpert 61: 3.600(3032)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 19: 3.000(2891)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 52: 2.400(3002)[0m | 
[32mExpert  5: 2.200(2993)[0m | [32mExpert 21: 2.200(2900)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert  2: 2.000(2894)[0m | 
[32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 57: 1.800(3017)[0m | [32mExpert 58: 1.800(3020)[0m | 
[32mExpert 17: 1.800(2885)[0m | [32mExpert 20: 1.600(2897)[0m | [32mExpert 42: 1.600(2969)[0m | [32mExpert 54: 1.600(3008)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2993, 2900, 2996, 2894, 3044, 2975, 3017, 3020, 2885, 2897, 2969, 3008]
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3008[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  5,  8, 17, 20, 21, 42, 44, 50, 54, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[19]:5.0 | [22]:2.0 | [23]:5.0 | [26]:7.0 | [30]:4.0 | [17]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[14]:1.0 | [32]:3.0 | [55]:7.0 | [57]:2.0 | [63]:7.0 | [44]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[33]:6.0 | [40]:5.0 | [48]:4.0 | [56]:3.0 | [61]:4.0 | [46]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[1]:4.0 | [9]:2.0 | [22]:5.0 | [32]:6.0 | [40]:2.0 | [6]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[1]:1.0 | [2]:6.0 | [16]:1.0 | [34]:3.0 | [50]:7.0 | [57]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[4]:3.0 | [34]:2.0 | [40]:7.0 | [41]:6.0 | [63]:4.0 | [27]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 4, 34, 40, 41, 63, 27]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 32
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
[90mTop 20 Experts:[0m
[32mExpert 48: 13.000(4205)[0m | [32mExpert 18: 8.000(4106)[0m | [32mExpert  0: 7.800(4076)[0m | [32mExpert 17: 6.600(4103)[0m | 
[32mExpert 41: 6.600(4184)[0m | [32mExpert 14: 6.000(4094)[0m | [32mExpert 26: 5.800(4133)[0m | [32mExpert 12: 5.400(4088)[0m | 
[32mExpert 37: 4.600(4169)[0m | [32mExpert 21: 4.400(4118)[0m | [32mExpert 55: 4.200(4229)[0m | [32mExpert  2: 3.600(4112)[0m | 
[32mExpert 51: 3.600(4217)[0m | [32mExpert 61: 3.400(4250)[0m | [32mExpert 44: 3.400(4193)[0m | [32mExpert 27: 3.200(4136)[0m | 
[32mExpert 42: 2.800(4187)[0m | [32mExpert 62: 2.600(4253)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | 
[32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 39: 2.000(4175)[0m | [32mExpert 58: 2.000(4238)[0m | 
[32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 16: 1.800(4100)[0m | [32mExpert 53: 1.800(4223)[0m | 
[32mExpert 56: 1.800(4232)[0m | [32mExpert 57: 1.600(4235)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 32: 1.400(4154)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4082, 4109, 4175, 4238, 4265, 4220, 4100, 4223, 4232, 4235, 4139, 4154]
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  9, 10, 16, 19, 28, 32, 39, 52, 53, 56, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[7]:2.0 | [17]:8.0 | [25]:1.0 | [33]:2.0 | [39]:5.0 | [16]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[11]:5.0 | [26]:5.0 | [27]:6.0 | [32]:5.0 | [33]:3.0 | [16]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[12]:6.0 | [34]:1.0 | [36]:1.0 | [55]:5.0 | [61]:5.0 | [57]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E57 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[6]:4.0 | [10]:3.0 | [29]:4.0 | [44]:1.0 | [62]:2.0 | [63]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[12]:4.0 | [50]:8.0 | [51]:6.0 | [57]:9.0 | [58]:5.0 | [26]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[16]:13.0 | [22]:4.0 | [25]:5.0 | [28]:9.0 | [57]:5.0 | [32]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[16, 22, 25, 28, 57, 32]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[9]:4.0 | [23]:10.0 | [36]:4.0 | [39]:3.0 | [49]:7.0 | [44]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[9]:4.0 | [33]:4.0 | [44]:5.0 | [48]:14.0 | [61]:2.0 | [26]:6.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2752
[1m[33mEnqueueTask: [0m[32mTask: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2788
[1m[33mEnqueueTask: [0m[32mTask: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24
Prefetch Node: task: Task: node: ID[529,600000013] (16MB) STATE(0) TENSOR[2787,2788,2786,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
EnqueuePrefetch: 3002
[1m[33mEnqueueTask: [0m[32mTask: node: ID[965,340000001f] (16MB) STATE(0) TENSOR[3001,3002,3000,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[8]:4.0 | [23]:5.0 | [26]:5.0 | [44]:3.0 | [46]:3.0 | [13]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[31]:1.0 | [35]:5.0 | [52]:1.0 | [60]:5.0 | [63]:9.0 | [58]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[3]:4.0 | [14]:2.0 | [17]:4.0 | [29]:4.0 | [62]:2.0 | [10]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[2]:2.0 | [10]:3.0 | [14]:3.0 | [15]:2.0 | [48]:5.0 | [36]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[1]:2.0 | [42]:5.0 | [44]:3.0 | [54]:2.0 | [63]:1.0 | [55]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[6]:4.0 | [20]:7.0 | [27]:4.0 | [32]:4.0 | [41]:3.0 | [22]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 6, 20, 27, 32, 41, 22]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.800(2743)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert  9: 5.400(2809)[0m | [32mExpert 38: 5.200(2716)[0m | 
[32mExpert 23: 5.000(2668)[0m | [32mExpert 45: 4.600(2740)[0m | [32mExpert 60: 4.600(2791)[0m | [32mExpert  7: 4.400(2803)[0m | 
[32mExpert 51: 4.400(2761)[0m | [32mExpert 63: 4.400(2800)[0m | [32mExpert 12: 4.200(2632)[0m | [32mExpert 55: 4.000(2773)[0m | 
[32mExpert 14: 3.800(2638)[0m | [32mExpert 48: 3.800(2749)[0m | [32mExpert  1: 3.600(2623)[0m | [32mExpert 19: 3.600(2653)[0m | 
[32mExpert 27: 3.400(2680)[0m | [32mExpert 47: 3.400(2746)[0m | [32mExpert 10: 3.400(2626)[0m | [32mExpert 35: 3.200(2707)[0m | 
[32mExpert 21: 2.800(2662)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 33: 2.600(2701)[0m | [32mExpert 53: 2.400(2767)[0m | 
[32mExpert 11: 2.400(2629)[0m | [32mExpert 34: 2.400(2704)[0m | [32mExpert 49: 2.000(2752)[0m | [32mExpert 44: 2.000(2737)[0m | 
[32mExpert 25: 1.800(2674)[0m | [32mExpert 40: 1.800(2725)[0m | [32mExpert 13: 1.800(2635)[0m | [32mExpert  6: 1.600(2788)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2662, 2647, 2701, 2767, 2629, 2704, 2752, 2737, 2674, 2725, 2635, 2788]
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2752[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
Prefetching [1;36mTensor 2788[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9:  6, 11, 13, 17, 21, 25, 33, 34, 40, 44, 49, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[5]:5.0 | [11]:5.0 | [34]:1.0 | [46]:2.0 | [47]:10.0 | [39]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[13]:6.0 | [14]:5.0 | [24]:2.0 | [47]:2.0 | [52]:4.0 | [39]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[10]:3.0 | [12]:5.0 | [16]:2.0 | [24]:1.0 | [55]:4.0 | [32]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 10 MLP ==
[0m
[10]:9.0 | [13]:2.0 | [18]:1.0 | [25]:3.0 | [61]:4.0 | [7]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[2]:9.0 | [17]:2.0 | [34]:5.0 | [40]:2.0 | [49]:2.0 | [10]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[12]:3.0 | [23]:2.0 | [37]:5.0 | [45]:12.0 | [61]:3.0 | [47]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[12, 23, 37, 45, 61, 47]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 7.400(3026)[0m | [32mExpert 16: 7.000(2882)[0m | [32mExpert 38: 7.000(2954)[0m | [32mExpert 14: 6.800(2876)[0m | 
[32mExpert 36: 6.600(2948)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 33: 5.600(2939)[0m | [32mExpert 32: 5.000(2936)[0m | 
[32mExpert 48: 4.800(2987)[0m | [32mExpert  0: 4.400(2858)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 40: 4.400(2963)[0m | 
[32mExpert 61: 4.400(3032)[0m | [32mExpert 11: 4.200(2867)[0m | [32mExpert 26: 4.000(2915)[0m | [32mExpert 15: 3.000(2879)[0m | 
[32mExpert 19: 3.000(2891)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 37: 3.000(2951)[0m | [32mExpert 56: 2.400(3014)[0m | 
[32mExpert 52: 2.400(3002)[0m | [32mExpert  5: 2.200(2993)[0m | [32mExpert 21: 2.200(2900)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert  2: 2.000(2894)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 57: 1.800(3017)[0m | 
[32mExpert 58: 1.800(3020)[0m | [32mExpert 17: 1.800(2885)[0m | [32mExpert 20: 1.600(2897)[0m | [32mExpert 42: 1.600(2969)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [3002, 2993, 2900, 2996, 2894, 3044, 2975, 3017, 3020, 2885, 2897, 2969]
Prefetching [1;36mTensor 3002[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  5,  8, 17, 20, 21, 42, 44, 50, 52, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[15]:2.0 | [26]:8.0 | [45]:2.0 | [48]:3.0 | [58]:2.0 | [54]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[0]:2.0 | [7]:3.0 | [19]:4.0 | [23]:3.0 | [46]:3.0 | [59]:11.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[11]:5.0 | [17]:2.0 | [26]:4.0 | [40]:6.0 | [61]:5.0 | [52]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E17 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[20]:2.0 | [32]:7.0 | [33]:5.0 | [37]:2.0 | [53]:4.0 | [40]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[2]:7.0 | [3]:4.0 | [23]:2.0 | [28]:3.0 | [29]:1.0 | [15]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[2]:6.0 | [36]:1.0 | [50]:3.0 | [58]:4.0 | [63]:5.0 | [59]:2.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 2, 36, 50, 58, 63, 59]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4082
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1313,a0000002b] (16MB) STATE(0) TENSOR[4081,4082,4080,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 10
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 33
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
[90mTop 20 Experts:[0m
[32mExpert 48: 13.000(4205)[0m | [32mExpert 18: 8.000(4106)[0m | [32mExpert  0: 7.800(4076)[0m | [32mExpert 17: 6.600(4103)[0m | 
[32mExpert 41: 6.600(4184)[0m | [32mExpert 12: 6.200(4088)[0m | [32mExpert 14: 6.000(4094)[0m | [32mExpert 26: 5.800(4133)[0m | 
[32mExpert 55: 5.000(4229)[0m | [32mExpert 37: 4.600(4169)[0m | [32mExpert 21: 4.400(4118)[0m | [32mExpert 61: 4.200(4250)[0m | 
[32mExpert  2: 3.600(4112)[0m | [32mExpert 51: 3.600(4217)[0m | [32mExpert 44: 3.400(4193)[0m | [32mExpert 27: 3.200(4136)[0m | 
[32mExpert 42: 2.800(4187)[0m | [32mExpert 62: 2.600(4253)[0m | [32mExpert 57: 2.400(4235)[0m | [32mExpert 54: 2.400(4226)[0m | 
[32mExpert  1: 2.200(4079)[0m | [32mExpert 10: 2.200(4082)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 39: 2.000(4175)[0m | 
[32mExpert 58: 2.000(4238)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 16: 1.800(4100)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 32: 1.400(4154)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4079, 4082, 4109, 4175, 4238, 4265, 4220, 4100, 4223, 4232, 4139, 4154]
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4082[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  9, 10, 16, 19, 28, 32, 39, 52, 53, 56, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[6]:5.0 | [22]:3.0 | [42]:3.0 | [58]:2.0 | [62]:2.0 | [40]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[13]:6.0 | [18]:4.0 | [20]:2.0 | [36]:3.0 | [60]:5.0 | [10]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[2]:5.0 | [10]:3.0 | [17]:7.0 | [21]:5.0 | [55]:6.0 | [42]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E10 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[3]:4.0 | [6]:5.0 | [11]:7.0 | [32]:2.0 | [58]:4.0 | [40]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[0]:3.0 | [3]:4.0 | [45]:5.0 | [47]:5.0 | [54]:5.0 | [16]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[8]:3.0 | [10]:5.0 | [16]:14.0 | [33]:3.0 | [58]:6.0 | [53]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 8, 10, 16, 33, 58, 53]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:5.0 | [23]:11.0 | [38]:4.0 | [52]:3.0 | [62]:3.0 | [9]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[11]:3.0 | [17]:8.0 | [57]:3.0 | [59]:4.0 | [62]:3.0 | [26]:7.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2752
[1m[33mEnqueueTask: [0m[32mTask: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2897
[1m[33mEnqueueTask: [0m[32mTask: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 2
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 19
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[933,140000001f] (16MB) STATE(0) TENSOR[2896,2897,2895,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 13
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[7]:5.0 | [8]:5.0 | [26]:6.0 | [34]:1.0 | [59]:8.0 | [1]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[10]:4.0 | [21]:3.0 | [29]:3.0 | [38]:6.0 | [43]:3.0 | [60]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[3]:5.0 | [10]:3.0 | [17]:5.0 | [29]:5.0 | [36]:4.0 | [42]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[1]:5.0 | [14]:4.0 | [28]:8.0 | [46]:2.0 | [62]:11.0 | [48]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[2]:5.0 | [20]:3.0 | [34]:4.0 | [46]:7.0 | [55]:3.0 | [13]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[3]:5.0 | [20]:8.0 | [29]:7.0 | [32]:5.0 | [48]:3.0 | [14]:6.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 3, 20, 29, 32, 48, 14]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.800(2743)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert  9: 5.400(2809)[0m | [32mExpert 38: 5.200(2716)[0m | 
[32mExpert 23: 5.000(2668)[0m | [32mExpert 12: 5.000(2632)[0m | [32mExpert 55: 4.800(2773)[0m | [32mExpert 45: 4.600(2740)[0m | 
[32mExpert 60: 4.600(2791)[0m | [32mExpert  7: 4.400(2803)[0m | [32mExpert 51: 4.400(2761)[0m | [32mExpert 63: 4.400(2800)[0m | 
[32mExpert 10: 4.200(2626)[0m | [32mExpert 14: 3.800(2638)[0m | [32mExpert 48: 3.800(2749)[0m | [32mExpert  1: 3.600(2623)[0m | 
[32mExpert 19: 3.600(2653)[0m | [32mExpert 27: 3.400(2680)[0m | [32mExpert 47: 3.400(2746)[0m | [32mExpert 35: 3.200(2707)[0m | 
[32mExpert 21: 2.800(2662)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 33: 2.600(2701)[0m | [32mExpert 53: 2.400(2767)[0m | 
[32mExpert 11: 2.400(2629)[0m | [32mExpert 16: 2.400(2644)[0m | [32mExpert 34: 2.400(2704)[0m | [32mExpert 49: 2.000(2752)[0m | 
[32mExpert 44: 2.000(2737)[0m | [32mExpert 25: 1.800(2674)[0m | [32mExpert 40: 1.800(2725)[0m | [32mExpert 13: 1.800(2635)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2662, 2647, 2701, 2767, 2629, 2644, 2704, 2752, 2737, 2674, 2725, 2635]
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2752[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 11, 13, 16, 17, 21, 25, 33, 34, 40, 44, 49, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[7]:3.0 | [27]:5.0 | [39]:5.0 | [47]:11.0 | [49]:7.0 | [24]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[2]:6.0 | [13]:7.0 | [14]:6.0 | [15]:7.0 | [52]:5.0 | [11]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[7]:4.0 | [10]:4.0 | [23]:7.0 | [60]:6.0 | [63]:4.0 | [34]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E34 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[10]:10.0 | [16]:4.0 | [20]:4.0 | [25]:4.0 | [49]:7.0 | [61]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[2]:10.0 | [13]:5.0 | [33]:7.0 | [52]:3.0 | [62]:8.0 | [42]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[18]:9.0 | [22]:7.0 | [45]:13.0 | [52]:2.0 | [62]:5.0 | [31]:3.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[18, 22, 45, 52, 62, 31]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 7.400(3026)[0m | [32mExpert 16: 7.000(2882)[0m | [32mExpert 38: 7.000(2954)[0m | [32mExpert 14: 6.800(2876)[0m | 
[32mExpert 36: 6.600(2948)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 33: 5.600(2939)[0m | [32mExpert 40: 5.200(2963)[0m | 
[32mExpert 61: 5.200(3032)[0m | [32mExpert 32: 5.000(2936)[0m | [32mExpert 11: 5.000(2867)[0m | [32mExpert 26: 4.800(2915)[0m | 
[32mExpert 48: 4.800(2987)[0m | [32mExpert  0: 4.400(2858)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 52: 3.200(3002)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 37: 3.000(2951)[0m | 
[32mExpert 17: 2.600(2885)[0m | [32mExpert 56: 2.400(3014)[0m | [32mExpert  5: 2.200(2993)[0m | [32mExpert 21: 2.200(2900)[0m | 
[32mExpert 50: 2.200(2996)[0m | [32mExpert  2: 2.000(2894)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | 
[32mExpert 57: 1.800(3017)[0m | [32mExpert 58: 1.800(3020)[0m | [32mExpert 20: 1.600(2897)[0m | [32mExpert 42: 1.600(2969)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2885, 3014, 2993, 2900, 2996, 2894, 3044, 2975, 3017, 3020, 2897, 2969]
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
Prefetching [1;36mTensor 2897[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  5,  8, 17, 20, 21, 42, 44, 50, 56, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[26]:9.0 | [53]:2.0 | [55]:5.0 | [61]:5.0 | [63]:8.0 | [23]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[32]:4.0 | [37]:5.0 | [46]:4.0 | [55]:8.0 | [59]:12.0 | [38]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[26]:5.0 | [36]:7.0 | [42]:3.0 | [43]:2.0 | [48]:5.0 | [12]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E42 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[25]:4.0 | [32]:8.0 | [40]:4.0 | [45]:6.0 | [56]:1.0 | [30]:10.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[3]:5.0 | [10]:4.0 | [45]:8.0 | [50]:8.0 | [58]:4.0 | [46]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[2]:7.0 | [14]:7.0 | [44]:3.0 | [49]:4.0 | [60]:2.0 | [58]:5.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 2, 14, 44, 49, 60, 58]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4220
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1355,340000002b] (16MB) STATE(0) TENSOR[4219,4220,4218,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 11
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 34
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
[90mTop 20 Experts:[0m
[32mExpert 48: 13.000(4205)[0m | [32mExpert 18: 8.000(4106)[0m | [32mExpert  0: 7.800(4076)[0m | [32mExpert 17: 7.400(4103)[0m | 
[32mExpert 41: 6.600(4184)[0m | [32mExpert 12: 6.200(4088)[0m | [32mExpert 14: 6.000(4094)[0m | [32mExpert 26: 5.800(4133)[0m | 
[32mExpert 55: 5.800(4229)[0m | [32mExpert 21: 5.200(4118)[0m | [32mExpert 37: 4.600(4169)[0m | [32mExpert  2: 4.400(4112)[0m | 
[32mExpert 61: 4.200(4250)[0m | [32mExpert 42: 3.600(4187)[0m | [32mExpert 51: 3.600(4217)[0m | [32mExpert 44: 3.400(4193)[0m | 
[32mExpert 27: 3.200(4136)[0m | [32mExpert 10: 3.000(4082)[0m | [32mExpert 62: 2.600(4253)[0m | [32mExpert 57: 2.400(4235)[0m | 
[32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | [32mExpert 19: 2.200(4109)[0m | [32mExpert 39: 2.000(4175)[0m | 
[32mExpert 58: 2.000(4238)[0m | [32mExpert  9: 2.000(4265)[0m | [32mExpert 52: 2.000(4220)[0m | [32mExpert 16: 1.800(4100)[0m | 
[32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | [32mExpert 32: 1.400(4154)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4226, 4079, 4109, 4175, 4238, 4265, 4220, 4100, 4223, 4232, 4139, 4154]
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4220[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  9, 16, 19, 28, 32, 39, 52, 53, 54, 56, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[8]:3.0 | [9]:11.0 | [39]:6.0 | [42]:4.0 | [57]:2.0 | [17]:9.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[18]:5.0 | [21]:2.0 | [23]:2.0 | [27]:7.0 | [60]:6.0 | [53]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:10.0 | [10]:4.0 | [22]:1.0 | [41]:7.0 | [52]:2.0 | [32]:2.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E32 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E52 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[10]:4.0 | [12]:2.0 | [16]:1.0 | [46]:3.0 | [51]:4.0 | [5]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[18]:1.0 | [27]:1.0 | [28]:2.0 | [50]:9.0 | [54]:6.0 | [58]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[3]:1.0 | [15]:6.0 | [16]:15.0 | [18]:4.0 | [57]:6.0 | [45]:7.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 3, 15, 16, 18, 57, 45]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[6]:6.0 | [13]:4.0 | [23]:12.0 | [37]:4.0 | [55]:1.0 | [17]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[7]:10.0 | [17]:9.0 | [43]:1.0 | [48]:15.0 | [58]:3.0 | [25]:1.0 | 
---------------------------------------
return EAMC[3]
EnqueuePrefetch: 2707
[1m[33mEnqueueTask: [0m[32mTask: node: ID[558,2300000013] (16MB) STATE(0) TENSOR[2706,2707,2705,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2752
[1m[33mEnqueueTask: [0m[32mTask: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 16
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3020
[1m[33mEnqueueTask: [0m[32mTask: node: ID[971,3a0000001f] (16MB) STATE(0) TENSOR[3019,3020,3018,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25
Prefetch Node: task: Task: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 3
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 20
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 24

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[4]:2.0 | [12]:1.0 | [47]:3.0 | [51]:1.0 | [54]:1.0 | [22]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[0]:3.0 | [8]:4.0 | [15]:3.0 | [46]:3.0 | [47]:3.0 | [48]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[1]:1.0 | [15]:1.0 | [22]:7.0 | [24]:1.0 | [55]:2.0 | [56]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[16]:1.0 | [22]:4.0 | [39]:2.0 | [52]:2.0 | [57]:4.0 | [29]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[12]:5.0 | [27]:3.0 | [43]:4.0 | [54]:3.0 | [56]:3.0 | [53]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[12]:4.0 | [16]:5.0 | [18]:1.0 | [50]:5.0 | [54]:1.0 | [56]:7.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[12, 16, 18, 50, 54, 56]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 46: 7.800(2743)[0m | [32mExpert 41: 7.000(2728)[0m | [32mExpert 23: 5.800(2668)[0m | [32mExpert  9: 5.400(2809)[0m | 
[32mExpert 60: 5.400(2791)[0m | [32mExpert  7: 5.200(2803)[0m | [32mExpert 38: 5.200(2716)[0m | [32mExpert 63: 5.200(2800)[0m | 
[32mExpert 10: 5.000(2626)[0m | [32mExpert 12: 5.000(2632)[0m | [32mExpert 55: 4.800(2773)[0m | [32mExpert 45: 4.600(2740)[0m | 
[32mExpert 51: 4.400(2761)[0m | [32mExpert 14: 3.800(2638)[0m | [32mExpert 48: 3.800(2749)[0m | [32mExpert  1: 3.600(2623)[0m | 
[32mExpert 19: 3.600(2653)[0m | [32mExpert 27: 3.400(2680)[0m | [32mExpert 47: 3.400(2746)[0m | [32mExpert 34: 3.200(2704)[0m | 
[32mExpert 35: 3.200(2707)[0m | [32mExpert 21: 2.800(2662)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 33: 2.600(2701)[0m | 
[32mExpert 53: 2.400(2767)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 16: 2.400(2644)[0m | [32mExpert 49: 2.000(2752)[0m | 
[32mExpert 44: 2.000(2737)[0m | [32mExpert 25: 1.800(2674)[0m | [32mExpert 40: 1.800(2725)[0m | [32mExpert 13: 1.800(2635)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2707, 2662, 2647, 2701, 2767, 2629, 2644, 2752, 2737, 2674, 2725, 2635]
Prefetching [1;36mTensor 2707[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2752[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 11, 13, 16, 17, 21, 25, 33, 35, 40, 44, 49, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[8]:7.0 | [19]:1.0 | [21]:1.0 | [26]:7.0 | [42]:6.0 | [17]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[3]:1.0 | [10]:2.0 | [12]:1.0 | [20]:1.0 | [45]:8.0 | [6]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[1]:5.0 | [41]:8.0 | [48]:5.0 | [55]:5.0 | [58]:2.0 | [35]:4.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E35 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[11]:1.0 | [29]:1.0 | [30]:8.0 | [53]:5.0 | [60]:5.0 | [19]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[0]:1.0 | [7]:1.0 | [8]:6.0 | [35]:3.0 | [53]:8.0 | [28]:8.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[7]:2.0 | [13]:6.0 | [39]:1.0 | [42]:7.0 | [47]:2.0 | [29]:6.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[ 7, 13, 39, 42, 47, 29]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert  6: 7.400(3026)[0m | [32mExpert 36: 7.400(2948)[0m | [32mExpert 16: 7.000(2882)[0m | [32mExpert 38: 7.000(2954)[0m | 
[32mExpert 14: 6.800(2876)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 33: 5.600(2939)[0m | [32mExpert 26: 5.600(2915)[0m | 
[32mExpert 48: 5.600(2987)[0m | [32mExpert 40: 5.200(2963)[0m | [32mExpert 61: 5.200(3032)[0m | [32mExpert 32: 5.000(2936)[0m | 
[32mExpert 11: 5.000(2867)[0m | [32mExpert  0: 4.400(2858)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 52: 3.200(3002)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 37: 3.000(2951)[0m | 
[32mExpert 17: 2.600(2885)[0m | [32mExpert 42: 2.400(2969)[0m | [32mExpert 56: 2.400(3014)[0m | [32mExpert  5: 2.200(2993)[0m | 
[32mExpert 21: 2.200(2900)[0m | [32mExpert 43: 2.200(2972)[0m | [32mExpert 50: 2.200(2996)[0m | [32mExpert  2: 2.000(2894)[0m | 
[32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 57: 1.800(3017)[0m | [32mExpert 58: 1.800(3020)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2885, 2969, 3014, 2993, 2900, 2972, 2996, 2894, 3044, 2975, 3017, 3020]
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
Prefetching [1;36mTensor 3020[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  5,  8, 17, 21, 42, 43, 44, 50, 56, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[1]:3.0 | [19]:6.0 | [21]:5.0 | [31]:1.0 | [40]:4.0 | [26]:10.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[1]:2.0 | [4]:3.0 | [30]:7.0 | [50]:10.0 | [63]:8.0 | [15]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[13]:1.0 | [33]:7.0 | [38]:7.0 | [54]:3.0 | [62]:1.0 | [47]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 16 MLP ==
[0m
[22]:6.0 | [38]:3.0 | [39]:1.0 | [45]:7.0 | [58]:6.0 | [17]:7.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[52]:5.0 | [55]:7.0 | [56]:1.0 | [59]:1.0 | [60]:2.0 | [33]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[3]:2.0 | [20]:1.0 | [41]:7.0 | [51]:3.0 | [60]:3.0 | [4]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 3, 20, 41, 51, 60,  4]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 13.000(4205)[0m | [32mExpert  0: 8.600(4076)[0m | [32mExpert 18: 8.000(4106)[0m | [32mExpert 17: 7.400(4103)[0m | 
[32mExpert 41: 7.400(4184)[0m | [32mExpert 12: 6.200(4088)[0m | EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4175
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[1342,270000002b] (16MB) STATE(0) TENSOR[4174,4175,4173,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 12
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 35
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 28
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
[32mExpert 14: 6.000(4094)[0m | [32mExpert 26: 5.800(4133)[0m | 
[32mExpert 55: 5.800(4229)[0m | [32mExpert 21: 5.200(4118)[0m | [32mExpert 37: 4.600(4169)[0m | [32mExpert  2: 4.400(4112)[0m | 
[32mExpert 61: 4.200(4250)[0m | [32mExpert 10: 3.800(4082)[0m | [32mExpert 42: 3.600(4187)[0m | [32mExpert 51: 3.600(4217)[0m | 
[32mExpert 44: 3.400(4193)[0m | [32mExpert 27: 3.200(4136)[0m | [32mExpert 52: 2.800(4220)[0m | [32mExpert 62: 2.600(4253)[0m | 
[32mExpert 57: 2.400(4235)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | [32mExpert 19: 2.200(4109)[0m | 
[32mExpert 32: 2.200(4154)[0m | [32mExpert 39: 2.000(4175)[0m | [32mExpert 58: 2.000(4238)[0m | [32mExpert  9: 2.000(4265)[0m | 
[32mExpert 16: 1.800(4100)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4235, 4226, 4079, 4109, 4154, 4175, 4238, 4265, 4100, 4223, 4232, 4139]
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4175[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  9, 16, 19, 28, 32, 39, 53, 54, 56, 57, 58 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[17]:10.0 | [38]:8.0 | [47]:7.0 | [50]:1.0 | [52]:1.0 | [1]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[0]:3.0 | [9]:1.0 | [11]:6.0 | [26]:6.0 | [63]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:11.0 | [14]:7.0 | [24]:1.0 | [37]:6.0 | [39]:3.0 | [35]:1.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L21-E39 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 22 MLP ==
[0m
[5]:5.0 | [24]:1.0 | [27]:2.0 | [36]:1.0 | [57]:2.0 | [33]:6.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[6]:2.0 | [7]:7.0 | [38]:4.0 | [49]:1.0 | [50]:10.0 | [1]:5.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[2]:4.0 | [16]:16.0 | [29]:3.0 | [31]:1.0 | [37]:5.0 | [57]:7.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 2, 16, 29, 31, 37, 57]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[7]:4.0 | [9]:6.0 | [23]:13.0 | [39]:4.0 | [42]:1.0 | [41]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[1]:2.0 | [22]:3.0 | [48]:16.0 | [52]:1.0 | [54]:2.0 | [37]:1.0 | 
---------------------------------------
return EAMC[3]
DAppï¼Œç”¨äºEnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2662
[1m[33mEnqueueTask: [0m[32mTask: node: ID[544,1500000013] (16MB) STATE(0) TENSOR[2661,2662,2660,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2752
[1m[33mEnqueueTask: [0m[32mTask: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2635
[1m[33mEnqueueTask: [0m[32mTask: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
Prefetch Node: task: Task: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 17
Prefetch Node: task: Task: node: ID[536,d00000013] (16MB) STATE(0) TENSOR[2634,2635,2633,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3008
[1m[33mEnqueueTask: [0m[32mTask: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2900
[1m[33mEnqueueTask: [0m[32mTask: node: ID[934,150000001f] (16MB) STATE(0) TENSOR[2899,2900,2898,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
Prefetch Node: task: Task: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 6
Prefetch Node: task: Task: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 4
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 21
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 25

[1;36m== Layer 0 MLP ==
[0m

[1;36m== Layer 1 MLP ==
[0m
[24]:2.0 | [27]:3.0 | [37]:4.0 | [41]:5.0 | [55]:3.0 | [43]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 2 MLP ==
[0m
[9]:2.0 | [34]:3.0 | [44]:1.0 | [59]:4.0 | [61]:3.0 | [16]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 3 MLP ==
[0m
[6]:3.0 | [13]:4.0 | [19]:2.0 | [47]:2.0 | [59]:7.0 | [18]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 4 MLP ==
[0m
[17]:2.0 | [20]:3.0 | [23]:1.0 | [30]:1.0 | [57]:5.0 | [41]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 5 MLP ==
[0m
[23]:4.0 | [24]:1.0 | [48]:2.0 | [58]:1.0 | [60]:3.0 | [15]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 6 MLP ==
[0m
[7]:5.0 | [10]:1.0 | [49]:2.0 | [58]:3.0 | [61]:1.0 | [40]:1.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch6 topk= tensor([[ 7, 10, 49, 58, 61, 40]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [9]:[0m
[90mTop 20 Experts:[0m
[32mExpert 41: 7.800(2728)[0m | [32mExpert 46: 7.800(2743)[0m | [32mExpert 23: 5.800(2668)[0m | [32mExpert 55: 5.600(2773)[0m | 
[32mExpert  9: 5.400(2809)[0m | [32mExpert 60: 5.400(2791)[0m | [32mExpert  7: 5.200(2803)[0m | [32mExpert 38: 5.200(2716)[0m | 
[32mExpert 63: 5.200(2800)[0m | [32mExpert 10: 5.000(2626)[0m | [32mExpert 12: 5.000(2632)[0m | [32mExpert 45: 4.600(2740)[0m | 
[32mExpert 48: 4.600(2749)[0m | [32mExpert  1: 4.400(2623)[0m | [32mExpert 51: 4.400(2761)[0m | [32mExpert 35: 4.000(2707)[0m | 
[32mExpert 14: 3.800(2638)[0m | [32mExpert 19: 3.600(2653)[0m | [32mExpert 27: 3.400(2680)[0m | [32mExpert 47: 3.400(2746)[0m | 
[32mExpert 34: 3.200(2704)[0m | [32mExpert 21: 2.800(2662)[0m | [32mExpert 17: 2.800(2647)[0m | [32mExpert 33: 2.600(2701)[0m | 
[32mExpert 53: 2.400(2767)[0m | [32mExpert 11: 2.400(2629)[0m | [32mExpert 16: 2.400(2644)[0m | [32mExpert 49: 2.000(2752)[0m | 
[32mExpert 44: 2.000(2737)[0m | [32mExpert 25: 1.800(2674)[0m | [32mExpert 40: 1.800(2725)[0m | [32mExpert 13: 1.800(2635)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2704, 2662, 2647, 2701, 2767, 2629, 2644, 2752, 2737, 2674, 2725, 2635]
Prefetching [1;36mTensor 2704[0m â†’ GPU 0
Prefetching [1;36mTensor 2662[0m â†’ GPU 0
Prefetching [1;36mTensor 2647[0m â†’ GPU 0
Prefetching [1;36mTensor 2701[0m â†’ GPU 0
Prefetching [1;36mTensor 2767[0m â†’ GPU 0
Prefetching [1;36mTensor 2629[0m â†’ GPU 0
Prefetching [1;36mTensor 2644[0m â†’ GPU 0
Prefetching [1;36mTensor 2752[0m â†’ GPU 0
Prefetching [1;36mTensor 2737[0m â†’ GPU 0
Prefetching [1;36mTensor 2674[0m â†’ GPU 0
Prefetching [1;36mTensor 2725[0m â†’ GPU 0
Prefetching [1;36mTensor 2635[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer  9: 11, 13, 16, 17, 21, 25, 33, 34, 40, 44, 49, 53 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 7 MLP ==
[0m
[12]:4.0 | [48]:2.0 | [51]:1.0 | [52]:2.0 | [58]:2.0 | [54]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 8 MLP ==
[0m
[15]:8.0 | [18]:7.0 | [21]:1.0 | [34]:2.0 | [63]:1.0 | [29]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 9 MLP ==
[0m
[21]:4.0 | [25]:3.0 | [44]:2.0 | [54]:2.0 | [61]:2.0 | [53]:4.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E25 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E44 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L9-E53 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 10 MLP ==
[0m
[6]:2.0 | [26]:2.0 | [36]:1.0 | [48]:2.0 | [52]:3.0 | [24]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 11 MLP ==
[0m
[32]:1.0 | [39]:5.0 | [45]:1.0 | [50]:3.0 | [62]:9.0 | [19]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 12 MLP ==
[0m
[10]:4.0 | [13]:7.0 | [43]:5.0 | [50]:2.0 | [55]:2.0 | [41]:9.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch12 topk= tensor([[10, 13, 43, 50, 55, 41]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [15]:[0m
[90mTop 20 Experts:[0m
[32mExpert 38: 7.800(2954)[0m | [32mExpert  6: 7.400(3026)[0m | [32mExpert 36: 7.400(2948)[0m | [32mExpert 16: 7.000(2882)[0m | 
[32mExpert 14: 6.800(2876)[0m | [32mExpert 33: 6.400(2939)[0m | [32mExpert 49: 5.800(2990)[0m | [32mExpert 26: 5.600(2915)[0m | 
[32mExpert 48: 5.600(2987)[0m | [32mExpert 40: 5.200(2963)[0m | [32mExpert 61: 5.200(3032)[0m | [32mExpert 32: 5.000(2936)[0m | 
[32mExpert 11: 5.000(2867)[0m | [32mExpert  0: 4.400(2858)[0m | [32mExpert  4: 4.400(2960)[0m | [32mExpert 52: 3.200(3002)[0m | 
[32mExpert 15: 3.000(2879)[0m | [32mExpert 19: 3.000(2891)[0m | [32mExpert 25: 3.000(2912)[0m | [32mExpert 37: 3.000(2951)[0m | 
[32mExpert 17: 2.600(2885)[0m | [32mExpert 42: 2.400(2969)[0m | [32mExpert 54: 2.400(3008)[0m | [32mExpert 56: 2.400(3014)[0m | 
[32mExpert  5: 2.200(2993)[0m | [32mExpert 21: 2.200(2900)[0m | [32mExpert 43: 2.200(2972)[0m | [32mExpert 50: 2.200(2996)[0m | 
[32mExpert  2: 2.000(2894)[0m | [32mExpert  8: 2.000(3044)[0m | [32mExpert 44: 1.800(2975)[0m | [32mExpert 57: 1.800(3017)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [2885, 2969, 3008, 3014, 2993, 2900, 2972, 2996, 2894, 3044, 2975, 3017]
Prefetching [1;36mTensor 2885[0m â†’ GPU 0
Prefetching [1;36mTensor 2969[0m â†’ GPU 0
Prefetching [1;36mTensor 3008[0m â†’ GPU 0
Prefetching [1;36mTensor 3014[0m â†’ GPU 0
Prefetching [1;36mTensor 2993[0m â†’ GPU 0
Prefetching [1;36mTensor 2900[0m â†’ GPU 0
Prefetching [1;36mTensor 2972[0m â†’ GPU 0
Prefetching [1;36mTensor 2996[0m â†’ GPU 0
Prefetching [1;36mTensor 2894[0m â†’ GPU 0
Prefetching [1;36mTensor 3044[0m â†’ GPU 0
Prefetching [1;36mTensor 2975[0m â†’ GPU 0
Prefetching [1;36mTensor 3017[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 15:  2,  5,  8, 17, 21, 42, 43, 44, 50, 54, 56, 57 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 13 MLP ==
[0m
[4]:1.0 | [19]:7.0 | [23]:7.0 | [26]:11.0 | [51]:1.0 | [49]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 14 MLP ==
[0m
[1]:3.0 | [29]:3.0 | [32]:5.0 | [34]:3.0 | [40]:2.0 | [22]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 15 MLP ==
[0m
[6]:8.0 | [21]:3.0 | [29]:2.0 | [33]:8.0 | [62]:2.0 | [2]:3.0 | 
---------------------------------------
return EAMC[3]
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E2 â•‘[0m
EnqueuePrefetch: 4253
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1365,3e0000002b] (16MB) STATE(0) TENSOR[4252,4253,4251,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4235
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4226
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1357,360000002b] (16MB) STATE(0) TENSOR[4225,4226,4224,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4079
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1304,10000002b] (16MB) STATE(0) TENSOR[4078,4079,4077,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4109
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1322,130000002b] (16MB) STATE(0) TENSOR[4108,4109,4107,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4154
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4238
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4265
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1312,90000002b] (16MB) STATE(0) TENSOR[4264,4265,4263,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4100
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4223
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 4232
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1359,380000002b] (16MB) STATE(0) TENSOR[4231,4232,4230,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 4139
[1m[33mEnqueueTask: [0m[32mTask: node: ID[1331,1c0000002b] (16MB) STATE(0) TENSOR[4138,4139,4137,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[1360,390000002b] (16MB) STATE(0) TENSOR[4234,4235,4233,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[1335,200000002b] (16MB) STATE(0) TENSOR[4153,4154,4152,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 23
Prefetch Node: task: Task: node: ID[1361,3a0000002b] (16MB) STATE(0) TENSOR[4237,4238,4236,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 36
Prefetch Node: task: Task: node: ID[1319,100000002b] (16MB) STATE(0) TENSOR[4099,4100,4098,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 29
Prefetch Node: task: Task: node: ID[1356,350000002b] (16MB) STATE(0) TENSOR[4222,4223,4221,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 9
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[1;33mâ•‘ ğŸš€ é¢„å–å‘½ä¸­: L15-E21 â•‘[0m
[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;36m== Layer 16 MLP ==
[0m
[3]:2.0 | [23]:1.0 | [39]:2.0 | [48]:3.0 | [52]:4.0 | [31]:3.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 17 MLP ==
[0m
[4]:1.0 | [33]:2.0 | [44]:1.0 | [56]:2.0 | [60]:3.0 | [39]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 18 MLP ==
[0m
[4]:5.0 | [14]:8.0 | [29]:3.0 | [31]:2.0 | [41]:8.0 | [60]:4.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch18 topk= tensor([[ 4, 14, 29, 31, 41, 60]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;33mFetch Layer [21]:[0m
[90mTop 20 Experts:[0m
[32mExpert 48: 13.000(4205)[0m | [32mExpert  0: 9.400(4076)[0m | [32mExpert 18: 8.000(4106)[0m | [32mExpert 17: 7.400(4103)[0m | 
[32mExpert 41: 7.400(4184)[0m | [32mExpert 14: 6.800(4094)[0m | [32mExpert 12: 6.200(4088)[0m | [32mExpert 26: 5.800(4133)[0m | 
[32mExpert 55: 5.800(4229)[0m | [32mExpert 37: 5.400(4169)[0m | [32mExpert 21: 5.200(4118)[0m | [32mExpert  2: 4.400(4112)[0m | 
[32mExpert 61: 4.200(4250)[0m | [32mExpert 10: 3.800(4082)[0m | [32mExpert 42: 3.600(4187)[0m | [32mExpert 51: 3.600(4217)[0m | 
[32mExpert 44: 3.400(4193)[0m | [32mExpert 27: 3.200(4136)[0m | [32mExpert 39: 2.800(4175)[0m | [32mExpert 52: 2.800(4220)[0m | 
[32mExpert 62: 2.600(4253)[0m | [32mExpert 57: 2.400(4235)[0m | [32mExpert 54: 2.400(4226)[0m | [32mExpert  1: 2.200(4079)[0m | 
[32mExpert 19: 2.200(4109)[0m | [32mExpert 32: 2.200(4154)[0m | [32mExpert 58: 2.000(4238)[0m | [32mExpert  9: 2.000(4265)[0m | 
[32mExpert 16: 1.800(4100)[0m | [32mExpert 53: 1.800(4223)[0m | [32mExpert 56: 1.800(4232)[0m | [32mExpert 28: 1.600(4139)[0m | 

------------------------------------------------------------

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    [4253, 4235, 4226, 4079, 4109, 4154, 4238, 4265, 4100, 4223, 4232, 4139]
Prefetching [1;36mTensor 4253[0m â†’ GPU 0
Prefetching [1;36mTensor 4235[0m â†’ GPU 0
Prefetching [1;36mTensor 4226[0m â†’ GPU 0
Prefetching [1;36mTensor 4079[0m â†’ GPU 0
Prefetching [1;36mTensor 4109[0m â†’ GPU 0
Prefetching [1;36mTensor 4154[0m â†’ GPU 0
Prefetching [1;36mTensor 4238[0m â†’ GPU 0
Prefetching [1;36mTensor 4265[0m â†’ GPU 0
Prefetching [1;36mTensor 4100[0m â†’ GPU 0
Prefetching [1;36mTensor 4223[0m â†’ GPU 0
Prefetching [1;36mTensor 4232[0m â†’ GPU 0
Prefetching [1;36mTensor 4139[0m â†’ GPU 0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¢„å–ä¸“å®¶ä¿¡æ¯ (Layer/Expert) â”‚
â”‚ Layer 21:  1,  9, 16, 19, 28, 32, 53, 54, 56, 57, 58, 62 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 19 MLP ==
[0m
[17]:11.0 | [33]:3.0 | [38]:9.0 | [51]:1.0 | [52]:2.0 | [21]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 20 MLP ==
[0m
[11]:7.0 | [26]:7.0 | [28]:1.0 | [59]:1.0 | [63]:2.0 | [36]:4.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 21 MLP ==
[0m
[0]:12.0 | [31]:1.0 | [33]:1.0 | [36]:2.0 | [37]:7.0 | [7]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 22 MLP ==
[0m
[10]:5.0 | [15]:1.0 | [35]:3.0 | [36]:2.0 | [41]:1.0 | [59]:2.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 23 MLP ==
[0m
[43]:1.0 | [44]:2.0 | [49]:2.0 | [50]:11.0 | [56]:1.0 | [29]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 24 MLP ==
[0m
[4]:1.0 | [16]:17.0 | [31]:2.0 | [32]:3.0 | [57]:8.0 | [2]:5.0 | 
---------------------------------------
return EAMC[3]
Begin prefetch24 topk= tensor([[ 4, 16, 31, 32, 57,  2]], device='cuda:0')

[1;36m==================== Prefetch Experts ====================[0m

[1;35m==================== Real Fetch Operation ====================[0m
[94mAll Tensor IDs:[0m    []
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ— é¢„å–ä¸“å®¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1;36m== Layer 25 MLP ==
[0m
[9]:7.0 | [23]:14.0 | [37]:5.0 | [39]:5.0 | [59]:4.0 | [15]:1.0 | 
---------------------------------------
return EAMC[3]

[1;36m== Layer 26 MLP ==
[0m
[15]:2.0 | [22]:4.0 | [31]:3.0 | [37]:2.0 | [48]:17.0 | [21]:1.0 | 
---------------------------------------
return EAMC[3]
è¿½è¸ªEnqueuePrefetch: 2746
[1m[33mEnqueueTask: [0m[32mTask: node: ID[570,2f00000013] (16MB) STATE(0) TENSOR[2745,2746,2744,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2704
[1m[33mEnqueueTask: [0m[32mTask: node: ID[557,2200000013] (16MB) STATE(0) TENSOR[2703,2704,2702,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2767
[1m[33mEnqueueTask: [0m[32mTask: node: ID[576,3500000013] (16MB) STATE(0) TENSOR[2766,2767,2765,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2647
[1m[33mEnqueueTask: [0m[32mTask: node: ID[540,1100000013] (16MB) STATE(0) TENSOR[2646,2647,2645,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2737
[1m[33mEnqueueTask: [0m[32mTask: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2674
[1m[33mEnqueueTask: [0m[32mTask: node: ID[548,1900000013] (16MB) STATE(0) TENSOR[2673,2674,2672,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2701
[1m[33mEnqueueTask: [0m[32mTask: node: ID[556,2100000013] (16MB) STATE(0) TENSOR[2700,2701,2699,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2629
[1m[33mEnqueueTask: [0m[32mTask: node: ID[534,b00000013] (16MB) STATE(0) TENSOR[2628,2629,2627,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2644
[1m[33mEnqueueTask: [0m[32mTask: node: ID[539,1000000013] (16MB) STATE(0) TENSOR[2643,2644,2642,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2770
[1m[33mEnqueueTask: [0m[32mTask: node: ID[577,3600000013] (16MB) STATE(0) TENSOR[2769,2770,2768,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2752
[1m[33mEnqueueTask: [0m[32mTask: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2725
[1m[33mEnqueueTask: [0m[32mTask: node: ID[563,2800000013] (16MB) STATE(0) TENSOR[2724,2725,2723,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[567,2c00000013] (16MB) STATE(0) TENSOR[2736,2737,2735,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 18
Prefetch Node: task: Task: node: ID[572,3100000013] (16MB) STATE(0) TENSOR[2751,2752,2750,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 8
EnqueuePrefetch: 2951
[1m[33mEnqueueTask: [0m[32mTask: node: ID[950,250000001f] (16MB) STATE(0) TENSOR[2950,2951,2949,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2894
[1m[33mEnqueueTask: [0m[32mTask: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2885
[1m[33mEnqueueTask: [0m[32mTask: node: ID[930,110000001f] (16MB) STATE(0) TENSOR[2884,2885,2883,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2969
[1m[33mEnqueueTask: [0m[32mTask: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3008
[1m[33mEnqueueTask: [0m[32mTask: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3014
[1m[33mEnqueueTask: [0m[32mTask: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 2993
[1m[33mEnqueueTask: [0m[32mTask: node: ID[918,50000001f] (16MB) STATE(0) TENSOR[2992,2993,2991,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2972
[1m[33mEnqueueTask: [0m[32mTask: node: ID[956,2b0000001f] (16MB) STATE(0) TENSOR[2971,2972,2970,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2996
[1m[33mEnqueueTask: [0m[32mTask: node: ID[963,320000001f] (16MB) STATE(0) TENSOR[2995,2996,2994,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 3044
[1m[33mEnqueueTask: [0m[32mTask: node: ID[921,80000001f] (16MB) STATE(0) TENSOR[3043,3044,3042,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
EnqueuePrefetch: 2975
[1m[33mEnqueueTask: [0m[32mTask: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cpu;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0][0m
EnqueuePrefetch: 3017
[1m[33mEnqueueTask: [0m[32mTask: node: ID[970,390000001f] (16MB) STATE(0) TENSOR[3016,3017,3015,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cuda:0->cuda:0][0m
Prefetch Node: task: Task: node: ID[915,20000001f] (16MB) STATE(0) TENSOR[2893,2894,2892,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 22
Prefetch Node: task: Task: node: ID[955,2a0000001f] (16MB) STATE(0) TENSOR[2968,2969,2967,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 27
Prefetch Node: task: Task: node: ID[967,360000001f] (16MB) STATE(0) TENSOR[3007,3008,3006,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 7
Prefetch Node: task: Task: node: ID[969,380000001f] (16MB) STATE(0) TENSOR[3013,3014,3012,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 5
Prefetch Node: task: Task: node: ID[957,2c0000001f] (16MB) STATE(0) TENSOR[2974,2975,2973,] DEVICE[cuda:0;cuda:0;cpu];, on_demand: 0, priority: 1[cpu->cuda:0], prefetch_cnt: 26
