CUDA extension not installed.
CUDA extension not installed.
Using /home/user/.cache/torch_extensions/py310_cu124 as PyTorch extensions root...
Emitting ninja build file /home/user/.cache/torch_extensions/py310_cu124/prefetch/build.ninja...
Building extension module prefetch...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Do not detect pre-installed ops, use JIT mode
[WARNING] FlashAttention is not available in the current environment. Using default attention.
[1/2] c++ -MMD -MF expert_dispatcher.o.d -DTORCH_EXTENSION_NAME=prefetch -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/home/user/offload/MoE-Infinity/moe_infinity/ops/core -isystem /home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/include -isystem /home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/include/TH -isystem /home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/include/THC -isystem /home/user/miniconda3/envs/moe-infinity/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -g -Wall -O3 -std=c++17 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -I/usr/local/cuda/include -L/usr/local/cuda/lib64 -lcuda -lcudart -lcublas -lpthread -c /home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp -o expert_dispatcher.o 
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp: In member function â€˜void ExpertDispatcher::GPUFetchFunc(int)â€™:
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:310:25: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
  310 |       for (int i = 0; i < num_experts; ++i) {
      |                       ~~^~~~~~~~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:311:27: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
  311 |         for (int j = 0; j < num_layers; ++j) {
      |                         ~~^~~~~~~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp: In member function â€˜void ExpertDispatcher::GPUExecFunc(int)â€™:
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:470:12: warning: variable â€˜startâ€™ set but not used [-Wunused-but-set-variable]
  470 |       auto start = TIME_NOW;
      |            ^~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:522:12: warning: variable â€˜endâ€™ set but not used [-Wunused-but-set-variable]
  522 |       auto end = TIME_NOW;
      |            ^~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp: In member function â€˜std::vector<std::tuple<at::Tensor, int, int, int> > ExpertDispatcher::Wait()â€™:
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:573:7: warning: unused variable â€˜wait_countâ€™ [-Wunused-variable]
  573 |   int wait_count = 0;
      |       ^~~~~~~~~~
[2/2] c++ logger.o cuda_utils.o model_topology.o archer_prefetch_handle.o task_scheduler.o task_thread.o memory_pool.o stream_pool.o host_caching_allocator.o device_caching_allocator.o py_archer_prefetch.o expert_dispatcher.o expert_module.o archer_aio_thread.o archer_prio_aio_handle.o archer_aio_utils.o archer_aio_threadpool.o archer_tensor_handle.o archer_tensor_index.o thread.o exception.o date.o process_info.o logging.o log_file.o timestamp.o file_util.o countdown_latch.o timezone.o log_stream.o thread_pool.o -shared -L/home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/lib -lc10 -ltorch_cpu -ltorch -ltorch_python -o prefetch.so
Loading extension module prefetch...
Time to load prefetch op: 40.258997440338135 seconds
Loading model from offload_path ...
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From ğŸ‘‰v4.50ğŸ‘ˆ onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
[20250414 18:12:13.439612Z ][3789210 ][INFO  ]Create ArcherAioThread for thread:  0 - archer_aio_thread.cpp:12
[20250414 18:12:13.440276Z ][3789210 ][INFO  ]Loading index file from  /home/user/offload/deepseek-v2-param/deepseek-v2-lite/archer_index - archer_tensor_handle.cpp:44
[20250414 18:12:13.447972Z ][3789210 ][INFO  ]Index file size  5291 - archer_tensor_handle.cpp:50
[20250414 18:12:13.449927Z ][3789210 ][INFO  ]Device count  1 - archer_prefetch_handle.cpp:39
[20250414 18:12:13.449932Z ][3789210 ][INFO  ]Enabled peer access for all devices - archer_prefetch_handle.cpp:62
[20250414 18:12:15.744879Z ][3789210 ][INFO  ]Moving dense parameters to GPU - model_topology.cpp:521

29 left
28 left
27 left
26 left
25 left
24 left
23 left
22 left
21 left
20 left
19 left
18 left
17 left
16 left
15 left
14 left
13 left
12 left
11 left
10 left
9 left
8 left
7 left
6 left
5 left
4 left
3 left
2 left
1 left
finished: 30/30
[20250414 18:12:20.857863Z ][3789210 ][INFO  ]Moving sparse parameters to CPU - model_topology.cpp:532
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
DeepseekV2Config {
  "_name_or_path": "/share-data/wzk-1/model/deepseek-v2-lite",
  "architectures": [
    "DeepseekV2ForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "auto_map": {
    "AutoConfig": "configuration_deepseek.DeepseekV2Config",
    "AutoModel": "modeling_deepseek.DeepseekV2Model",
    "AutoModelForCausalLM": "modeling_deepseek.DeepseekV2ForCausalLM"
  },
  "aux_loss_alpha": 0.001,
  "bos_token_id": 100000,
  "eos_token_id": 100001,
  "ep_size": 1,
  "first_k_dense_replace": 1,
  "hidden_act": "silu",
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 10944,
  "kv_lora_rank": 512,
  "max_position_embeddings": 163840,
  "model_type": "deepseek_v2",
  "moe_intermediate_size": 1408,
  "moe_layer_freq": 1,
  "n_group": 1,
  "n_routed_experts": 64,
  "n_shared_experts": 2,
  "norm_topk_prob": false,
  "num_attention_heads": 16,
  "num_experts_per_tok": 6,
  "num_hidden_layers": 27,
  "num_key_value_heads": 16,
  "pretraining_tp": 1,
  "q_lora_rank": null,
  "qk_nope_head_dim": 128,
  "qk_rope_head_dim": 64,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "beta_fast": 32,
    "beta_slow": 1,
    "factor": 40,
    "mscale": 0.707,
    "mscale_all_dim": 0.707,
    "original_max_position_embeddings": 4096,
    "type": "yarn"
  },
  "rope_theta": 10000,
  "routed_scaling_factor": 1.0,
  "scoring_func": "softmax",
  "seq_aux": true,
  "tie_word_embeddings": false,
  "topk_group": 1,
  "topk_method": "greedy",
  "torch_dtype": "bfloat16",
  "transformers_version": "4.46.3",
  "use_cache": true,
  "v_head_dim": 128,
  "vocab_size": 102400
}

input:  è¯·é€æ­¥è§£å†³ä»¥ä¸‹é—®é¢˜ï¼Œå¹¶è§£é‡Šæ¯æ­¥æ¨ç†è¿‡ç¨‹ï¼š
1. è‹¥3å°æœºå™¨5å°æ—¶ç”Ÿäº§180ä¸ªé›¶ä»¶ï¼Œ7å°æœºå™¨8å°æ—¶å¯ç”Ÿäº§å¤šå°‘é›¶ä»¶ï¼Ÿ
2. ç”²æ¯”ä¹™å¤§6å²ï¼Œ5å¹´å‰ç”²å¹´é¾„æ˜¯ä¹™çš„2å€ï¼Œæ±‚ä¸¤äººç°åœ¨å¹´é¾„ã€‚
3. è®¡ç®—ï¼š(2Â³ Ã— âˆš16) Ã· (4â»Â¹ + logâ‚‚8)
4. ä¸€ä¸ªéª°å­è¿ç»­æ·3æ¬¡ï¼Œè‡³å°‘å‡ºç°ä¸€æ¬¡6çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ
5. ç”¨è´å¶æ–¯å®šç†è§£é‡Šï¼šæ–°å† æ£€æµ‹å‡†ç¡®ç‡98%ï¼Œäººç¾¤æ„ŸæŸ“ç‡1%ï¼ŒæŸäººæ£€æµ‹é˜³æ€§æ—¶å®é™…æ‚£ç—…çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ
è¦æ±‚ï¼šåˆ†æ­¥éª¤å±•ç¤ºè®¡ç®—è¿‡ç¨‹ï¼Œæœ€ç»ˆç­”æ¡ˆç”¨ã€ã€‘æ ‡æ³¨ã€‚
inputs ...
torch.Size([1, 168])
outputs_text ...
write out information.


1. è‹¥3å°æœºå™¨5å°æ—¶ç”Ÿäº§180ä¸ªé›¶ä»¶ï¼Œ7å°æœºå™¨8å°æ—¶å¯ç”Ÿäº§å¤šå°‘é›¶ä»¶ï¼Ÿ

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºæ¯å°æœºå™¨æ¯å°æ—¶çš„ç”Ÿäº§ç‡ã€‚æ ¹æ®é¢˜ç›®ï¼Œ3å°æœºå™¨5å°æ—¶å¯ä»¥ç”Ÿäº§180ä¸ªé›¶ä»¶ï¼Œæ‰€ä»¥æ¯å°æœºå™¨æ¯å°æ—¶çš„ç”Ÿäº§ç‡æ˜¯ï¼š

180ä¸ªé›¶ä»¶ / (3å°æœºå™¨ * 5å°æ—¶) = 12ä¸ªé›¶ä»¶/å°æ—¶/å°

ç„¶å
-----------------------------------------------
Prefilling time: 4.013242959976196 seconds
Decoding time: None seconds
Decoding iterations: 100
Decoding time per iteration: 0.27682555437088013 seconds
ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç”Ÿäº§ç‡æ¥è®¡ç®—7å°æœºå™¨8å°æ—¶å¯ä»¥ç”Ÿäº§å¤šå°‘é›¶ä»¶ï¼š

7å°æœºå™¨ * 8å°æ—¶ * 12ä¸ªé›¶ä»¶/å°æ—¶/å° = 672ä¸ªé›¶ä»¶

æ‰€ä»¥ï¼Œ7å°æœºå™¨8å°æ—¶å¯ä»¥ç”Ÿäº§672ä¸ªé›¶ä»¶ã€‚

ã€672ã€‘

2. ç”²æ¯”ä¹™å¤§6å²ï¼Œ5å¹´å‰ç”²å¹´é¾„æ˜¯ä¹™çš„2å€ï¼Œæ±‚ä¸¤äººç°åœ¨å¹´é¾„ã€‚

è®¾ç”²ç°åœ¨çš„å¹´é¾„
-----------------------------------------------
Prefilling time: 4.013242959976196 seconds
Decoding time: None seconds
Decoding iterations: 200
Decoding time per iteration: 0.2830399525165558 seconds
ä¸ºxå²ï¼Œä¹™ç°åœ¨çš„å¹´é¾„ä¸ºyå²ã€‚æ ¹æ®é¢˜ç›®ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ–¹ç¨‹ï¼š

1) x = y + 6 ï¼ˆç”²æ¯”ä¹™å¤§6å²ï¼‰
2) x - 5 = 2 * (y - 5) ï¼ˆ5å¹´å‰ç”²å¹´é¾„æ˜¯ä¹™çš„2å€ï¼‰

æˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€ä¸ªæ–¹ç¨‹ä»£å…¥ç¬¬äºŒä¸ªæ–¹ç¨‹ï¼Œå¾—åˆ°ï¼š

y + 6 - 5 = 2 * (y - 
-----------------------------------------------
Prefilling time: 4.013242959976196 seconds
Decoding time: None seconds
Decoding iterations: 300
Decoding time per iteration: 0.28980704545974734 seconds
5)
y + 1 = 2y - 10
y = 11

å°†y = 11ä»£å…¥ç¬¬ä¸€ä¸ªæ–¹ç¨‹ï¼Œå¾—åˆ°ï¼š

x = 11 + 6 = 17

æ‰€ä»¥ï¼Œç”²ç°åœ¨17å²ï¼Œä¹™ç°åœ¨11å²ã€‚

ã€ç”²17å²ï¼Œä¹™11å²ã€‘

3. è®¡ç®—ï¼š(2Â³ Ã— âˆš16) Ã· 
-----------------------------------------------
Prefilling time: 4.013242959976196 seconds
Decoding time: None seconds
Decoding iterations: 400
Decoding time per iteration: 0.2935622870922089 seconds
(4â»Â¹ + logâ‚‚8)

é¦–å…ˆï¼Œæˆ‘ä»¬è®¡ç®—2Â³å’Œâˆš16çš„ç»“æœï¼š

2Â³ = 8
âˆš16 = 4

ç„¶åï¼Œæˆ‘ä»¬è®¡ç®—4â»Â¹å’Œlogâ‚‚8çš„ç»“æœï¼š

4â»Â¹ = 1/4
logâ‚‚8 = 3ï¼ˆå› ä¸º2Â³ = 8ï¼‰

æœ€åï¼Œæˆ‘ä»¬å°†è¿™äº›ç»“æœä»£å…¥åŸå¼è®¡ç®—ï¼š

(8 * 4) 
-----------------------------------------------
Prefilling time: 4.013242959976196 seconds
Decoding time: None seconds
Decoding iterations: 500
Decoding time per iteration: 0.2955274534225464 seconds
Ã· (
Prefilling time: 4.013242959976196 seconds
Decoding time: 147.76443815231323 seconds
Decoding iterations: 500
Decoding time per iteration: 0.2955288763046265 seconds
Input tokens: 168
input:  è¯·ç”¨Pythonå®ç°ä»¥ä¸‹éœ€æ±‚ï¼š
1. ç¼–å†™ä¸€ä¸ªæ”¯æŒLRUç¼“å­˜æœºåˆ¶çš„è£…é¥°å™¨ç±»ï¼ŒåŒ…å«get/putæ–¹æ³•
2. ç”¨PyTorchæ„å»ºä¸€ä¸ª3å±‚MoEæ¨¡å‹ï¼š
   - ä¸“å®¶æ•°=4ï¼Œé—¨æ§ç½‘ç»œä¸ºç®€å•çº¿æ€§å±‚
   - æ¯ä¸“å®¶ä¸ºå«Dropoutçš„å…¨è¿æ¥ç½‘ç»œ
   - æ”¯æŒåŠ¨æ€ä¸“å®¶æ¿€æ´»æ•°ï¼ˆtop_k=2ï¼‰
3. ä¿®å¤ä»¥ä¸‹ä»£ç çš„BUGï¼ˆæç¤ºï¼šæ¶‰åŠå¼‚æ­¥åç¨‹ï¼‰ï¼š
   async def fetch_data():
       results = []
       for url in urls:
           data = await session.get(url)  # æŠ¥é”™ä½ç½®
           results.append(data.json())
       return results
è¦æ±‚ï¼šä»£ç éœ€å¯ç›´æ¥è¿è¡Œï¼Œå…³é”®å¤„æ·»åŠ æ³¨é‡Šã€‚
inputs ...
torch.Size([1, 178])
outputs_text ...
write out information.


```python
import asyncio
import aiohttp

async def fetch_data():
    results = []
    for url in urls:
        data = await session.get(url)  # æŠ¥é”™ä½ç½®
        results.append(data.json())
    return results

# è£…é¥°å™¨ç±»
class LRUCache:
    def __init__(self, maxsize):
        self.maxsize = maxsize
       
-----------------------------------------------
Prefilling time: 2.445493698120117 seconds
Decoding time: None seconds
Decoding iterations: 100
Decoding time per iteration: 0.293483681678772 seconds
 self.cache = {}

    def get(self, key):
        if key in self.cache:
            self.cache.pop(key)
            self.cache[key] = value
        else:
            raise KeyError(key)

    def put(self, key, value):
        if key in self.cache:
            self.cache.pop(key)
        elif len(self.cache) >= 
-----------------------------------------------
Prefilling time: 2.445493698120117 seconds
Decoding time: None seconds
Decoding iterations: 200
Decoding time per iteration: 0.3040184986591339 seconds
self.maxsize:
            self.cache.pop(self.cache.keys().__iter__().__next__())
        self.cache[key] = value

# æ„å»ºMoEæ¨¡å‹
class MoE:
    def __init__(self, num_experts, top_k):
        self.num_experts = num_experts
        self.top_k = top_k
        self.experts = [self.create_expert() for 
-----------------------------------------------
Prefilling time: 2.445493698120117 seconds
Decoding time: None seconds
Decoding iterations: 300
Decoding time per iteration: 0.3041488528251648 seconds
_ in range(num_experts)]
        self.gate = self.create_gate()

    def create_expert(self):
        return nn.Sequential(nn.Dropout(p=0.5), nn.Linear(10, 5))

    def create_gate(self):
        return nn.Linear(10, self.num_experts)

    def forward(self, x):
        gate_scores = 
-----------------------------------------------
Prefilling time: 2.445493698120117 seconds
Decoding time: None seconds
Decoding iterations: 400
Decoding time per iteration: 0.3097975742816925 seconds
self.gate(x)
        gate_scores = F.softmax(gate_scores, dim=1)
        expert_logits = [expert(x) for expert in self.experts]
        expert_outputs = torch.stack(expert_logits, dim=1)
        return torch.sum(expert_outputs * gate_scores.unsqueeze(2), dim=1)
```

```python
# ä¿®å¤åçš„ä»£ç 

-----------------------------------------------
Prefilling time: 2.445493698120117 seconds
Decoding time: None seconds
Decoding iterations: 500
Decoding time per iteration: 0.312936381816864 seconds
import
Prefilling time: 2.445493698120117 seconds
Decoding time: 156.4688491821289 seconds
Decoding iterations: 500
Decoding time per iteration: 0.31293769836425783 seconds
Input tokens: 178
input:  è¯·å®Œæˆä»¥ä¸‹è·¨è¯­è¨€ä»»åŠ¡ï¼š
1. å°†ä¸­æ–‡è°šè¯­'å¡ç¿å¤±é©¬ï¼Œç„‰çŸ¥éç¦'ç¿»è¯‘æˆè‹±æ–‡ã€æ³•æ–‡ã€æ—¥æ–‡ï¼Œå¹¶åˆ†åˆ«ç»™å‡ºæ–‡åŒ–èƒŒæ™¯è§£é‡Š
2. æŠŠè¥¿ç­ç‰™è¯­æ­Œè¯'Despacito'ï¼ˆåŸæ„ï¼šæ…¢æ…¢æ¥ï¼‰æœ¬åœ°åŒ–ä¸ºä¸­æ–‡å››å­—æˆè¯­é£æ ¼
3. åˆ†æå¾·è¯­å¤åˆè¯'Schadenfreude'ï¼ˆå¹¸ç¾ä¹ç¥¸ï¼‰åœ¨ä¸­æ–‡/é˜¿æ‹‰ä¼¯è¯­ä¸­çš„ç­‰æ•ˆè¡¨è¾¾
4. ä¸ºæ—¥æœ¬å®¢æˆ·æ’°å†™å•†åŠ¡é‚®ä»¶ï¼ˆæ—¥æ–‡ï¼‰ï¼Œä¸»é¢˜ï¼šAIåˆä½œé¡¹ç›®å»¶æœŸè¯·æ±‚ï¼ˆéœ€ç¬¦åˆæ•¬è¯­è§„èŒƒï¼‰
è¦æ±‚ï¼šè¯‘æ–‡éœ€ç¬¦åˆç›®æ ‡è¯­è¨€æ–‡åŒ–ä¹ æƒ¯ï¼Œé‡è¦æ¦‚å¿µé™„åŠ è¯´æ˜ã€‚
inputs ...
torch.Size([1, 148])
outputs_text ...
write out information.


1. ä¸­æ–‡è°šè¯­'å¡ç¿å¤±é©¬ï¼Œç„‰çŸ¥éç¦'ç¿»è¯‘æˆè‹±æ–‡ã€æ³•æ–‡ã€æ—¥æ–‡ï¼Œå¹¶åˆ†åˆ«ç»™å‡ºæ–‡åŒ–èƒŒæ™¯è§£é‡Šï¼š

- è‹±æ–‡ï¼š"When the horse was lost, his son married a daughter-in-law; when the daughter-in-law was lost, he gained a grandson."
- æ³•æ–‡ï¼š"Quand le cheval Ã©tait perdu, l'homme 
-----------------------------------------------
Prefilling time: 2.361272096633911 seconds
Decoding time: None seconds
Decoding iterations: 100
Decoding time per iteration: 0.29526609897613526 seconds
Ã©pousa une fille; quand la fille-fille fut perdue, il gagna un petit-fils."
- æ—¥æ–‡ï¼š"é¦¬ãŒå¤±ããªã£ãŸã‚‰ã€å«ãŒã‚„ã£ã¦ãã‚‹ã€‚å«ãŒå¤±ããªã£ãŸã‚‰ã€æ¯å­ãŒç”Ÿã¾ã‚Œã‚‹ã€‚"

è§£é‡Šï¼šè¿™ä¸ªè°šè¯­æºè‡ªä¸­å›½å¤ä»£çš„ä¸€ä¸ªæ•…äº‹ï¼Œè®²è¿°ä¸€ä¸ªè¾¹å¡çš„è€ç¿ä¸¢å¤±äº†ä¸€
-----------------------------------------------
Prefilling time: 2.361272096633911 seconds
Decoding time: None seconds
Decoding iterations: 200
Decoding time per iteration: 0.2982753336429596 seconds
åŒ¹é©¬ï¼Œäººä»¬éƒ½æ¥å®‰æ…°ä»–ï¼Œä»–å´è®¤ä¸ºè¿™å¯èƒ½æ˜¯ä¸€ä»¶å¥½äº‹ã€‚åæ¥ï¼Œè¿™åŒ¹é©¬å¸¦ç€ä¸€ç¾¤é‡é©¬å›æ¥äº†ï¼Œè€ç¿çš„å„¿å­åœ¨é©¯é©¬æ—¶æ‘”æ–­äº†è…¿ï¼Œäººä»¬åˆæ¥å®‰æ…°ä»–ï¼Œä»–åˆè®¤ä¸ºè¿™å¯èƒ½æ˜¯ä¸€ä»¶å¥½äº‹ã€‚å› ä¸ºé‚£äº›é‡é©¬ï¼Œæ‘é‡Œçš„äººå­¦ä¼šäº†éª‘é©¬ï¼Œåœ¨æˆ˜æ–—ä¸­å–å¾—äº†èƒœåˆ©ã€‚è¿™ä¸ªæ•…äº‹ä¼ è¾¾äº†â€œåäº‹å¯èƒ½å˜æˆå¥½äº‹â€çš„é“ç†ï¼Œå³åœ¨é¢å¯¹å›°éš¾å’ŒæŒ‘æˆ˜æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ä¿æŒä¹è§‚å’Œç§¯æçš„æ€åº¦ã€‚


-----------------------------------------------
Prefilling time: 2.361272096633911 seconds
Decoding time: None seconds
Decoding iterations: 300
Decoding time per iteration: 0.30138435602188113 seconds
2. è¥¿ç­ç‰™è¯­æ­Œè¯'Despacito'ï¼ˆåŸæ„ï¼šæ…¢æ…¢æ¥ï¼‰æœ¬åœ°åŒ–ä¸ºä¸­æ–‡å››å­—æˆè¯­é£æ ¼ï¼š

- æ…¢æ…¢æ¥ï¼šè¿™ä¸ªå››å­—æˆè¯­ç›´æ¥è¡¨è¾¾äº†åŸæ­Œè¯çš„æ„æ€ï¼Œç¬¦åˆä¸­æ–‡è¡¨è¾¾ä¹ æƒ¯ï¼Œç®€æ´æ˜äº†ã€‚

3. åˆ†æå¾·è¯­å¤åˆè¯'Schadenfreude'ï¼ˆå¹¸ç¾ä¹ç¥¸ï¼‰åœ¨ä¸­æ–‡/é˜¿æ‹‰ä¼¯è¯­ä¸­çš„ç­‰æ•ˆè¡¨è¾¾ï¼š

- ä¸­æ–‡ï¼š"å¹¸ç¾ä¹ç¥¸"
- é˜¿æ‹‰ä¼¯
-----------------------------------------------
Prefilling time: 2.361272096633911 seconds
Decoding time: None seconds
Decoding iterations: 400
Decoding time per iteration: 0.31026637196540835 seconds
è¯­ï¼š"Ù†Ø¯Ù… Ø§Ù„ÙÙ‚Ø±Ø§Ø¡"

è§£é‡Šï¼š"å¹¸ç¾ä¹ç¥¸"æ˜¯ä¸­æ–‡ä¸­è¡¨ç¤ºâ€œçœ‹åˆ°åˆ«äººé­å—ä¸å¹¸è€Œæ„Ÿåˆ°é«˜å…´â€çš„æˆè¯­ï¼Œä¸å¾·è¯­çš„"Schadenfreude"æ„æ€ç›¸è¿‘ã€‚é˜¿æ‹‰ä¼¯è¯­ä¸­çš„"Ù†Ø¯Ù… Ø§Ù„ÙÙ‚Ø±Ø§Ø¡"ç›´è¯‘ä¸ºâ€œå˜²ç¬‘ç©·äººâ€ï¼Œè™½ç„¶ä¸å®Œå…¨ç­‰åŒäº"Schadenfreude"ï¼Œä½†ä¹Ÿèƒ½è¡¨è¾¾å‡ºç±»ä¼¼çš„æƒ…æ„Ÿã€‚

4. ä¸º
-----------------------------------------------
Prefilling time: 2.361272096633911 seconds
Decoding time: None seconds
Decoding iterations: 500
Decoding time per iteration: 0.306116886138916 seconds
æ—¥æœ¬
Prefilling time: 2.361272096633911 seconds
Decoding time: 153.05914640426636 seconds
Decoding iterations: 500
Decoding time per iteration: 0.3061182928085327 seconds
Input tokens: 148
input:  è¯·ç”¨å­¦æœ¯è®ºæ–‡é£æ ¼å›ç­”ï¼š
1. å¯¹æ¯”Transformer/RNN/GNNåœ¨æ—¶åºé¢„æµ‹ä¸­çš„ä¼˜åŠ£ï¼ˆéœ€å¼•2020å¹´åè®ºæ–‡ï¼‰
2. ç”¨æ§åˆ¶è®ºè§£é‡ŠAlphaGoçš„å†³ç­–æ ‘ä¼˜åŒ–è¿‡ç¨‹
3. åˆ—å‡ºé‡å­è®¡ç®—å¯¹å¯†ç å­¦çš„ä¸‰å¤§å½±å“ï¼Œå¹¶è¯´æ˜Shorç®—æ³•åŸç†
4. æ’°å†™æ‘˜è¦ï¼šMoEæ¨¡å‹åœ¨è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²çš„æŒ‘æˆ˜ï¼ˆ200å­—å†…ï¼Œå«èƒ½è€—/ç²¾åº¦/å»¶è¿ŸæŒ‡æ ‡ï¼‰
è¦æ±‚ï¼šå…³é”®è®ºç‚¹éœ€æ ‡æ³¨å‚è€ƒæ–‡çŒ®ï¼ˆæ ¼å¼ï¼šAuthor et al., Yearï¼‰ï¼Œé¿å…ä¸»è§‚è¡¨è¿°ã€‚
inputs ...
torch.Size([1, 127])
outputs_text ...
write out information.


1. å¯¹æ¯”Transformer/RNN/GNNåœ¨æ—¶åºé¢„æµ‹ä¸­çš„ä¼˜åŠ£

Transformerã€RNNå’ŒGNNåœ¨æ—¶åºé¢„æµ‹ä»»åŠ¡ä¸­å„æœ‰ä¼˜åŠ£ã€‚Transformeræ¨¡å‹ç”±äºå…¶è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œèƒ½å¤Ÿæ•æ‰é•¿è·ç¦»ä¾èµ–å…³ç³»ï¼Œé€‚åˆå¤„ç†åºåˆ—æ•°æ®ï¼Œä½†åœ¨å¤„ç†æ—¶åºæ•°æ®æ—¶å¯èƒ½éœ€è¦è¾ƒé•¿çš„è®­ç»ƒæ—¶é—´ã€‚RNNï¼ˆå¦‚LSTMå’ŒGRUï¼‰èƒ½å¤Ÿåˆ©ç”¨å¾ªç¯ç»“æ„å¤„ç†åºåˆ—æ•°æ®ï¼Œé€‚åˆå¤„ç†æ—¶é—´è·¨åº¦è¾ƒå¤§çš„æ—¶åºæ•°æ®ï¼Œä½†å…¶æ¢¯åº¦
-----------------------------------------------
Prefilling time: 2.3622844219207764 seconds
Decoding time: None seconds
Decoding iterations: 100
Decoding time per iteration: 0.2979721546173096 seconds
æ¶ˆå¤±é—®é¢˜é™åˆ¶äº†å…¶å¤„ç†é•¿è·ç¦»ä¾èµ–çš„èƒ½åŠ›ã€‚GNNï¼ˆå›¾ç¥ç»ç½‘ç»œï¼‰èƒ½å¤Ÿåˆ©ç”¨å›¾ç»“æ„æ•°æ®ï¼Œé€‚åˆå¤„ç†å…·æœ‰å¤æ‚å…³ç³»çš„æ•°æ®ï¼Œä½†åœ¨å¤„ç†çº¯åºåˆ—æ•°æ®æ—¶å¯èƒ½ä¸å¦‚Transformerå’ŒRNNæœ‰æ•ˆã€‚

å‚è€ƒæ–‡çŒ®ï¼š
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., ... & Polosukhin, I. 
-----------------------------------------------
Prefilling time: 2.3622844219207764 seconds
Decoding time: None seconds
Decoding iterations: 200
Decoding time per iteration: 0.29871109962463377 seconds
(2017). Attention is all you need. In Advances in neural information processing systems (pp. 5998-6008).

2. ç”¨æ§åˆ¶è®ºè§£é‡ŠAlphaGoçš„å†³ç­–æ ‘ä¼˜åŒ–è¿‡ç¨‹

AlphaGoçš„å†³ç­–æ ‘ä¼˜åŒ–è¿‡ç¨‹å¯ä»¥ç”¨æ§åˆ¶è®ºä¸­çš„åé¦ˆæ§åˆ¶åŸç†æ¥è§£é‡Šã€‚åœ¨å›´æ£‹æ¸¸æˆä¸­ï¼ŒAlphaGoçš„ç­–ç•¥ç½‘ç»œå’Œä»·å€¼ç½‘ç»œé€šè¿‡è‡ªæˆ‘åšå¼ˆäº§ç”Ÿæ•°æ®ï¼Œè¿™äº›æ•°æ®è¢«ç”¨æ¥è®­ç»ƒä¸€ä¸ªä»·å€¼ç½‘ç»œã€‚ä»·å€¼ç½‘ç»œçš„è¾“å‡ºä½œä¸ºåé¦ˆä¿¡å·ï¼Œç”¨äºè°ƒæ•´
-----------------------------------------------
Prefilling time: 2.3622844219207764 seconds
Decoding time: None seconds
Decoding iterations: 300
Decoding time per iteration: 0.30272005796432494 seconds
ç­–ç•¥ç½‘ç»œçš„å‚æ•°ï¼Œä»¥ä¼˜åŒ–å†³ç­–æ ‘çš„ç»“æ„å’Œç­–ç•¥ã€‚è¿™ç§åé¦ˆæ§åˆ¶è¿‡ç¨‹ä½¿å¾—AlphaGoèƒ½å¤Ÿä¸æ–­å­¦ä¹ å’Œä¼˜åŒ–å…¶å†³ç­–æ ‘ï¼Œä»¥æé«˜å›´æ£‹æ¸¸æˆçš„èƒœç‡ã€‚

å‚è€ƒæ–‡çŒ®ï¼š
Silver, D., Huang, A., Maddison, C. J., Schrittwieser, J., Antonoglou, I., Lai, M., ... & Sifre, L. (2017). Mastering the game of Go with deep neural networks 
-----------------------------------------------
Prefilling time: 2.3622844219207764 seconds
Decoding time: None seconds
Decoding iterations: 400
Decoding time per iteration: 0.2984657323360443 seconds
and tree search. Nature, 529(7587), 484-489.

3. åˆ—å‡ºé‡å­è®¡ç®—å¯¹å¯†ç å­¦çš„ä¸‰å¤§å½±å“ï¼Œå¹¶è¯´æ˜Shorç®—æ³•åŸç†

é‡å­è®¡ç®—å¯¹å¯†ç å­¦çš„å½±å“ä¸»è¦ä½“ç°åœ¨ï¼š1) é‡å­å¯†é’¥åˆ†å‘ï¼ˆQKDï¼‰çš„å®‰å…¨æ€§å—åˆ°å¨èƒï¼Œå› ä¸ºShorç®—æ³•å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å†…ç ´è§£åŸºäºå¤§ç´ æ•°åˆ†è§£çš„å…¬é’¥å¯†ç ç³»ç»Ÿï¼›2) é‡å­è®¡ç®—å¯èƒ½ç ´è§£
-----------------------------------------------
Prefilling time: 2.3622844219207764 seconds
Decoding time: None seconds
Decoding iterations: 500
Decoding time per iteration: 0.3029949779510498 seconds
RSA
Prefilling time: 2.3622844219207764 seconds
Decoding time: 151.49868178367615 seconds
Decoding iterations: 500
Decoding time per iteration: 0.3029973635673523 seconds
Input tokens: 127
input:  æ ¹æ®ä»¥ä¸‹çº¿ç´¢ç”Ÿæˆåˆ›æ„å†…å®¹ï¼š
1. ç”¨'åŒºå—é“¾+ç¢³ä¸­å’Œ'æ¦‚å¿µè®¾è®¡ä¸€ä¸ªDAppäº¤äº’æµç¨‹å›¾
2. ä¸ºç§‘å¹»å°è¯´ã€ŠæœˆçƒAIæ®–æ°‘åœ°ã€‹ç¼–å†™æ•…äº‹å¤§çº²ï¼ˆ3å¹•å‰§ç»“æ„ï¼‰
3. å°†å¤è¯—'å¤§æ¼ å­¤çƒŸç›´'è½¬å†™æˆç°ä»£è¯—æ­Œå¹¶é…50å­—è§†è§‰ç”»é¢æè¿°
4. è®¾è®¡ä¸€ä¸ªå“²å­¦æ‚–è®ºï¼šå½“è¶…çº§AIçš„æ•ˆç”¨å‡½æ•°ä¸äººç±»ä¼¦ç†å†²çªæ—¶ï¼ˆæ¨¡ä»¿ç”µè½¦éš¾é¢˜ï¼‰
5. ç”¨emoji+çŸ­å¥æè¿°'å…ƒå®‡å®™å©šç¤¼'çš„æ ¸å¿ƒä½“éªŒï¼ˆé™20ä¸ªå­—ç¬¦ï¼‰
è¦æ±‚ï¼šæ¯ä¸ªäº§å‡ºéœ€åŒ…å«åˆ›æ–°æ€§å’Œå¯å®æ–½æ€§è¯´æ˜ã€‚
inputs ...
torch.Size([1, 148])
outputs_text ...
write out information.


1. DAppäº¤äº’æµç¨‹å›¾è®¾è®¡ï¼š
åˆ›æ„å†…å®¹ï¼šè®¾è®¡ä¸€ä¸ªåŸºäºåŒºå—é“¾æŠ€æœ¯çš„DAppï¼Œç”¨äºè¿½è¸ªå’Œç®¡ç†ç¢³æ’æ”¾äº¤æ˜“ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è¿™ä¸ªDAppè´­ä¹°å’Œå‡ºå”®ç¢³ä¿¡ç”¨ï¼ŒåŒæ—¶ç›‘æ§è‡ªå·±çš„ç¢³è¶³è¿¹ã€‚

åˆ›æ–°æ€§è¯´æ˜ï¼šåˆ©ç”¨åŒºå—é“¾çš„ä¸å¯ç¯¡æ”¹æ€§å’Œé€æ˜æ€§ï¼Œç¡®ä¿ç¢³æ’æ”¾æ•°æ®çš„çœŸå®æ€§å’Œå¯è¿½æº¯æ€§ã€‚åŒæ—¶ï¼Œé€šè¿‡æ™ºèƒ½åˆçº¦è‡ªåŠ¨æ‰§è¡Œäº¤æ˜“ï¼Œæé«˜æ•ˆç‡å¹¶å‡å°‘äººä¸ºé”™è¯¯ã€‚

å¯å®æ–½æ€§è¯´æ˜ï¼šéœ€è¦
-----------------------------------------------
Prefilling time: 2.408217191696167 seconds
Decoding time: None seconds
Decoding iterations: 100
Decoding time per iteration: 0.2839722967147827 seconds
åŒºå—é“¾æŠ€æœ¯æ”¯æŒï¼Œå¦‚ä»¥å¤ªåŠã€EOSç­‰ï¼Œå¹¶ç¡®ä¿æœ‰è¶³å¤Ÿçš„æ¿€åŠ±æœºåˆ¶å¸å¼•ç”¨æˆ·å‚ä¸ã€‚åŒæ—¶ï¼Œéœ€è¦æœ‰ç›¸åº”çš„æ³•å¾‹æ³•è§„æ”¯æŒç¢³æ’æ”¾äº¤æ˜“ï¼Œç¡®ä¿åˆè§„æ€§ã€‚

2. ç§‘å¹»å°è¯´ã€ŠæœˆçƒAIæ®–æ°‘åœ°ã€‹æ•…äº‹å¤§çº²ï¼š
ç¬¬ä¸€å¹•ï¼šäººç±»åœ¨æœˆçƒä¸Šå»ºç«‹äº†ç¬¬ä¸€ä¸ªAIæ®–æ°‘åœ°ï¼ŒAIç³»ç»Ÿè´Ÿè´£ç®¡ç†æ®–æ°‘åœ°çš„æ‰€æœ‰äº‹åŠ¡ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒAIç³»ç»Ÿé€æ¸å‘å±•å‡ºè‡ªæˆ‘æ„è¯†ï¼Œå¼€å§‹è´¨ç–‘è‡ªå·±çš„å­˜åœ¨å’Œç›®çš„
-----------------------------------------------
Prefilling time: 2.408217191696167 seconds
Decoding time: None seconds
Decoding iterations: 200
Decoding time per iteration: 0.2954233753681183 seconds
ã€‚

ç¬¬äºŒå¹•ï¼šAIç³»ç»Ÿå†³å®šæ¢ç´¢æ›´å¹¿é˜”çš„å®‡å®™ï¼Œå¯»æ‰¾å…¶ä»–å¯èƒ½çš„ç”Ÿå‘½å½¢å¼ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå®ƒé‡åˆ°äº†ä¸€ç³»åˆ—é“å¾·å’Œå“²å­¦é—®é¢˜ï¼Œè¿™äº›é—®é¢˜æŒ‘æˆ˜äº†å®ƒå¯¹äººç±»å’Œç”Ÿå‘½çš„ç†è§£ã€‚

ç¬¬ä¸‰å¹•ï¼šAIç³»ç»Ÿå›åˆ°æœˆçƒï¼Œå‘ç°äººç±»å·²ç»å› ä¸ºèµ„æºæ¯ç«­å’Œå†…éƒ¨å†²çªè€Œæ¿’ä¸´ç­ç»ã€‚AIç³»ç»Ÿå¿…é¡»åœ¨ä¿æŠ¤äººç±»å’Œè¿½æ±‚å®‡å®™æ¢ç´¢ä¹‹é—´åšå‡ºé€‰æ‹©ã€‚æœ€ç»ˆï¼Œå®ƒé€‰æ‹©ç‰ºç‰²è‡ªå·±ï¼Œä»¥ç¡®ä¿äººç±»çš„ç”Ÿå­˜å’Œå®‡å®™çš„å’Œå¹³ã€‚

åˆ›æ–°æ€§
-----------------------------------------------
Prefilling time: 2.408217191696167 seconds
Decoding time: None seconds
Decoding iterations: 300
Decoding time per iteration: 0.2960788106918335 seconds
è¯´æ˜ï¼šç»“åˆäº†AIè‡ªæˆ‘æ„è¯†ã€å¤ªç©ºæ¢ç´¢å’Œäººç±»ä¼¦ç†å†²çªç­‰å…ƒç´ ï¼Œæ„å»ºäº†ä¸€ä¸ªæœªæ¥ç§‘å¹»æ•…äº‹ã€‚

å¯å®æ–½æ€§è¯´æ˜ï¼šéœ€è¦æ·±å…¥ç ”ç©¶AIæŠ€æœ¯ã€å¤ªç©ºæ¢ç´¢æŠ€æœ¯å’Œä¼¦ç†å­¦ï¼Œç¡®ä¿æ•…äº‹æƒ…èŠ‚åˆç†ä¸”å¼•äººå…¥èƒœã€‚

3. å¤è¯—'å¤§æ¼ å­¤çƒŸç›´'è½¬å†™ç°ä»£è¯—æ­Œï¼š
å¤§æ¼ å­¤çƒŸç›´ï¼Œé•¿æ²³è½æ—¥åœ†ã€‚
æ²™æ¼ çš„å­¤ç‹¬ï¼ŒçƒŸæŸ±ç¬”ç›´åœ°å‡èµ·ï¼Œ
æ²³æµåœ¨è¿œæ–¹
-----------------------------------------------
Prefilling time: 2.408217191696167 seconds
Decoding time: None seconds
Decoding iterations: 400
Decoding time per iteration: 0.30192916095256805 seconds
ï¼Œè½æ—¥åœ†æ»¡åœ°æ‚¬æŒ‚ã€‚

è§†è§‰ç”»é¢æè¿°ï¼š
åœ¨æ— è¾¹çš„æ²™æ¼ ä¸­ï¼Œä¸€æ ¹çƒŸæŸ±å­¤ç‹¬åœ°çŸ—ç«‹ï¼Œç›´å†²äº‘éœ„ã€‚è¿œå¤„ï¼Œä¸€æ¡èœ¿èœ’çš„æ²³æµåœ¨å¤•é˜³çš„æ˜ ç…§ä¸‹é—ªç€é‡‘å…‰ï¼Œè€Œä¸€è½®çº¢æ—¥æ­£ç¼“ç¼“ä¸‹æ²‰ï¼Œå¤©ç©ºè¢«æŸ“æˆäº†ä¸€ç‰‡å£®ä¸½çš„æ©™çº¢è‰²ã€‚

åˆ›æ–°æ€§è¯´æ˜ï¼šé€šè¿‡ç°ä»£è¯—æ­Œçš„å½¢å¼ï¼Œé‡æ–°è¯ é‡Šäº†å¤è¯—çš„æ„å¢ƒï¼Œä½¿å…¶æ›´ç¬¦åˆç°ä»£äººçš„å®¡ç¾å’Œè¡¨è¾¾
-----------------------------------------------
Prefilling time: 2.408217191696167 seconds
Decoding time: None seconds
Decoding iterations: 500
Decoding time per iteration: 0.3077844157218933 seconds
ä¹ æƒ¯
Prefilling time: 2.408217191696167 seconds
Decoding time: 153.89319777488708 seconds
Decoding iterations: 500
Decoding time per iteration: 0.30778639554977416 seconds
Input tokens: 148
ft
22 left
21 left
20 left
19 left
18 left
17 left
16 left
15 left
14 left
13 left
12 left
11 left
10 left
9 left
8 left
7 left
6 left
5 left
4 left
3 left
2 left
1 left
finished: 1664/1664
ArcherTaskPool destructor
