CUDA extension not installed.
CUDA extension not installed.
Using /home/user/.cache/torch_extensions/py310_cu124 as PyTorch extensions root...
Emitting ninja build file /home/user/.cache/torch_extensions/py310_cu124/prefetch/build.ninja...
Building extension module prefetch...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Do not detect pre-installed ops, use JIT mode
[WARNING] FlashAttention is not available in the current environment. Using default attention.
[1/2] c++ -MMD -MF expert_dispatcher.o.d -DTORCH_EXTENSION_NAME=prefetch -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/home/user/offload/MoE-Infinity/moe_infinity/ops/core -isystem /home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/include -isystem /home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/include/TH -isystem /home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/include/THC -isystem /home/user/miniconda3/envs/moe-infinity/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -g -Wall -O3 -std=c++17 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -I/usr/local/cuda/include -L/usr/local/cuda/lib64 -lcuda -lcudart -lcublas -lpthread -c /home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp -o expert_dispatcher.o 
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp: In member function â€˜void ExpertDispatcher::SetExpertCachePriority()â€™:
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:262:21: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
  262 |   for (int i = 0; i < num_experts; ++i) {
      |                   ~~^~~~~~~~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:263:23: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
  263 |     for (int j = 0; j < num_layers; ++j) {
      |                     ~~^~~~~~~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:270:12: warning: unused variable â€˜is_cudaâ€™ [-Wunused-variable]
  270 |       bool is_cuda = node->device.is_cuda();
      |            ^~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:260:9: warning: unused variable â€˜min_priorityâ€™ [-Wunused-variable]
  260 |   float min_priority = std::numeric_limits<float>::max();;
      |         ^~~~~~~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp: In member function â€˜void ExpertDispatcher::GPUFetchFunc(int)â€™:
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:388:25: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
  388 |       for (int i = 0; i < num_experts; ++i) {
      |                       ~~^~~~~~~~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:389:27: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
  389 |         for (int j = 0; j < num_layers; ++j) {
      |                         ~~^~~~~~~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:398:41: warning: comparison of integer expressions of different signedness: â€˜uint64_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
  398 |               node->incache_visit_count < min_visit_count &&
      |               ~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp: In member function â€˜void ExpertDispatcher::GPUExecFunc(int)â€™:
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:488:12: warning: variable â€˜startâ€™ set but not used [-Wunused-but-set-variable]
  488 |       auto start = TIME_NOW;
      |            ^~~~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:540:12: warning: variable â€˜endâ€™ set but not used [-Wunused-but-set-variable]
  540 |       auto end = TIME_NOW;
      |            ^~~
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp: In member function â€˜std::vector<std::tuple<at::Tensor, int, int, int> > ExpertDispatcher::Wait()â€™:
/home/user/offload/MoE-Infinity/moe_infinity/ops/core/parallel/expert_dispatcher.cpp:591:7: warning: unused variable â€˜wait_countâ€™ [-Wunused-variable]
  591 |   int wait_count = 0;
      |       ^~~~~~~~~~
[2/2] c++ logger.o cuda_utils.o model_topology.o archer_prefetch_handle.o task_scheduler.o task_thread.o memory_pool.o stream_pool.o host_caching_allocator.o device_caching_allocator.o py_archer_prefetch.o expert_dispatcher.o expert_module.o archer_aio_thread.o archer_prio_aio_handle.o archer_aio_utils.o archer_aio_threadpool.o archer_tensor_handle.o archer_tensor_index.o thread.o exception.o date.o process_info.o logging.o log_file.o timestamp.o file_util.o countdown_latch.o timezone.o log_stream.o thread_pool.o -shared -L/home/user/miniconda3/envs/moe-infinity/lib/python3.10/site-packages/torch/lib -lc10 -ltorch_cpu -ltorch -ltorch_python -o prefetch.so
Loading extension module prefetch...
Time to load prefetch op: 41.65035009384155 seconds
Loading model from offload_path ...
DeepseekV2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From ğŸ‘‰v4.50ğŸ‘ˆ onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
[20250416 23:24:04.106221Z ][3412289 ][INFO  ]Create ArcherAioThread for thread:  0 - archer_aio_thread.cpp:12
[20250416 23:24:04.106799Z ][3412289 ][INFO  ]Loading index file from  /home/user/offload/deepseek-v2-param/deepseek-v2-lite/archer_index - archer_tensor_handle.cpp:44
[20250416 23:24:04.114427Z ][3412289 ][INFO  ]Index file size  5291 - archer_tensor_handle.cpp:50
[20250416 23:24:04.116424Z ][3412289 ][INFO  ]Device count  1 - archer_prefetch_handle.cpp:39
[20250416 23:24:04.116429Z ][3412289 ][INFO  ]Enabled peer access for all devices - archer_prefetch_handle.cpp:62
[20250416 23:24:06.279446Z ][3412289 ][INFO  ]Moving dense parameters to GPU - model_topology.cpp:521
29 left28 left27 left26 left25 left24 left23 left22 left21 left20 left19 left18 left17 left16 left15 left14 left13 left12 left11 left10 left9 left8 left7 left6 left5 left4 left3 left2 left1 left
finished: 30/30
[20250416 23:24:12.030430Z ][3412289 ][INFO  ]Moving sparse parameters to CPU - model_topology.cpp:532
1663 left1662 left1661 left1660 left1659 left1658 left1657 left1656 left1655 left1654 left1653 left1652 left1651 left1650 left1649 left1648 left1647 left1646 left1645 left1644 left1643 left1642 left1641 left1640 left1639 left1638 left1637 left1636 left1635 left1634 left1633 left1632 left1631 left1630 left1629 left1628 left1627 left1626 left1625 left1624 left1623 left1622 left1621 left1620 left1619 left1618 left1617 left1616 left1615 left1614 left1613 left1612 left1611 left1610 left1609 left1608 left1607 left1606 left1605 left1604 left1603 left1602 left1601 left1600 left1599 left1598 left1597 left1596 left1595 left1594 left1593 left1592 left1591 left1590 left1589 left1588 left1587 left1586 left1585 left1584 left1583 left1582 left1581 left1580 left1579 left1578 left1577 left1576 left1575 left1574 left1573 left1572 left1571 left1570 left1569 left1568 left1567 left1566 left1565 left1564 left1563 left1562 left1561 left1560 left1559 left1558 left1557 left1556 left1555 left1554 left1553 left1552 left1551 left1550 left1549 left1548 left1547 left1546 left1545 left1544 left1543 left1542 left1541 left1540 left1539 left1538 left1537 left1536 left1535 left1534 left1533 left1532 left1531 left1530 left1529 left1528 left1527 left1526 left1525 left1524 left1523 left1522 left1521 left1520 left1519 left1518 left1517 left1516 left1515 left1514 left1513 left1512 left1511 left1510 left1509 left1508 left1507 left1506 left1505 left1504 left1503 left1502 left1501 left1500 left1499 left1498 left1497 left1496 left1495 left1494 left1493 left1492 left1491 left1490 left1489 left1488 left1487 left1486 left1485 left1484 left1483 left1482 left1481 left1480 left1479 left1478 left1477 left1476 left1475 left1474 left1473 left1472 left1471 left1470 left1469 left1468 left1467 left1466 left1465 left1464 left1463 left1462 left1461 left1460 left1459 left1458 left1457 left1456 left1455 left1454 left1453 left1452 left1451 left1450 left1449 left1448 left1447 left1446 left1445 left1444 left1443 left1442 left1441 left1440 left1439 left1438 left1437 left1436 left1435 left1434 left1433 left1432 left1431 left1430 left1429 left1428 left1427 left1426 left1425 left1424 left1423 left1422 left1421 left1420 left1419 left1418 left1417 left1416 left1415 left1414 left1413 left1412 left1411 left1410 left1409 left1408 left1407 left1406 left1405 left1404 left1403 left1402 left1401 left1400 left1399 left1398 left1397 left1396 left1395 left1394 left1393 left1392 left1391 left1390 left1389 left1388 left1387 left1386 left1385 left1384 left1383 left1382 left1381 left1380 left1379 left1378 left1377 left1376 left1375 left1374 left1373 left1372 left1371 left1370 left1369 left1368 left1367 left1366 left1365 left1364 left1363 left1362 left1361 left1360 left1359 left1358 left1357 left1356 left1355 left1354 left1353 left1352 left1351 left1350 left1349 left1348 left1347 left1346 left1345 left1344 left1343 left1342 left1341 left1340 left1339 left1338 left1337 left1336 left1335 left1334 left1333 left1332 left1331 left1330 left1329 left1328 left1327 left1326 left1325 left1324 left1323 left1322 left1321 left1320 left1319 left1318 left1317 left1316 left1315 left1314 left1313 left1312 left1311 left1310 left1309 left1308 left1307 left1306 left1305 left1304 left1303 left1302 left1301 left1300 left1299 left1298 left1297 left1296 left1295 left1294 left1293 left1292 left1291 left1290 left1289 left1288 left1287 left1286 left1285 left1284 left1283 left1282 left1281 left1280 left1279 left1278 left1277 left1276 left1275 left1274 left1273 left1272 left1271 left1270 left1269 left1268 left1267 left1266 left1265 left1264 left1263 left1262 left1261 left1260 left1259 left1258 left1257 left1256 left1255 left1254 left1253 left1252 left1251 left1250 left1249 left1248 left1247 left1246 left1245 left1244 left1243 left1242 left1241 left1240 left1239 left1238 left1237 left1236 left1235 left1234 left1233 left1232 left1231 left1230 left1229 left1228 left1227 left1226 left1225 left1224 left1223 left1222 left1221 left1220 left1219 left1218 left1217 left1216 left1215 left1214 left1213 left1212 left1211 left1210 left1209 left1208 left1207 left1206 left1205 left1204 left1203 left1202 left1201 left1200 left1199 left1198 left1197 left1196 left1195 left1194 left1193 left1192 left1191 left1190 left1189 left1188 left1187 left1186 left1185 left1184 left1183 left1182 left1181 left1180 left1179 left1178 left1177 left1176 left1175 left1174 left1173 left1172 left1171 left1170 left1169 left1168 left1167 left1166 left1165 left1164 left1163 left1162 left1161 left1160 left1159 left1158 left1157 left1156 left1155 left1154 left1153 left1152 left1151 left1150 left1149 left1148 left1147 left1146 left1145 left1144 left1143 left1142 left1141 left1140 left1139 left1138 left1137 left1136 left1135 left1134 left1133 left1132 left1131 left1130 left1129 left1128 left1127 left1126 left1125 left1124 left1123 left1122 left1121 left1120 left1119 left1118 left1117 left1116 left1115 left1114 left1113 left1112 left1111 left1110 left1109 left1108 left1107 left1106 left1105 left1104 left1103 left1102 left1101 left1100 left1099 left1098 left1097 left1096 left1095 left1094 left1093 left1092 left1091 left1090 left1089 left1088 left1087 left1086 left1085 left1084 left1083 left1082 left1081 left1080 left1079 left1078 left1077 left1076 left1075 left1074 left1073 left1072 left1071 left1070 left1069 left1068 left1067 left1066 left1065 left1064 left1063 left1062 left1061 left1060 left1059 left1058 left1057 left1056 left1055 left1054 left1053 left1052 left1051 left1050 left1049 left1048 left1047 left1046 left1045 left1044 left1043 left1042 left1041 left1040 left1039 left1038 left1037 left1036 left1035 left1034 left1033 left1032 left1031 left1030 left1029 left1028 left1027 left1026 left1025 left1024 left1023 left1022 left1021 left1020 left1019 left1018 left1017 left1016 left1015 left1014 left1013 left1012 left1011 left1010 left1009 left1008 left1007 left1006 left1005 left1004 left1003 left1002 left1001 left1000 left999 left998 left997 left996 left995 left994 left993 left992 left991 left990 left989 left988 left987 left986 left985 left984 left983 left982 left981 left980 left979 left978 left977 left976 left975 left974 left973 left972 left971 left970 left969 left968 left967 left966 left965 left964 left963 left962 left961 left960 left959 left958 left957 left956 left955 left954 left953 left952 left951 left950 left949 left948 left947 left946 left945 left944 left943 left942 left941 left940 left939 left938 left937 left936 left935 left934 left933 left932 left931 left930 left929 left928 left927 left926 left925 left924 left923 left922 left921 left920 left919 left918 left917 left916 left915 left914 left913 left912 left911 left910 left909 left908 left907 left906 left905 left904 left903 left902 left901 left900 left899 left898 left897 left896 left895 left894 left893 left892 left891 left890 left889 left888 left887 left886 left885 left884 left883 left882 left881 left880 left879 left878 left877 left876 left875 left874 left873 left872 left871 left870 left869 left868 left867 left866 left865 left864 left863 left862 left861 left860 left859 left858 left857 left856 left855 left854 left853 left852 left851 left850 left849 left848 left847 left846 left845 left844 left843 left842 left841 left840 left839 left838 left837 left836 left835 left834 left833 left832 left831 left830 left829 left828 left827 left826 left825 left824 left823 left822 left821 left820 left819 left818 left817 left816 left815 left814 left813 left812 left811 left810 left809 left808 left807 left806 left805 left804 left803 left802 left801 left800 left799 left798 left797 left796 left795 left794 left793 left792 left791 left790 left789 left788 left787 left786 left785 left784 left783 left782 left781 left780 left779 left778 left777 left776 left775 left774 left773 left772 left771 left770 left769 left768 left767 left766 left765 left764 left763 left762 left761 left760 left759 left758 left757 left756 left755 left754 left753 left752 left751 left750 left749 left748 left747 left746 left745 left744 left743 left742 left741 left740 left739 left738 left737 left736 left735 left734 left733 left732 left731 left730 left729 left728 left727 left726 left725 left724 left723 left722 left721 left720 left719 left718 left717 left716 left715 left714 left713 left712 left711 left710 left709 left708 left707 left706 left705 left704 left703 left702 left701 left700 left699 left698 left697 left696 left695 left694 left693 left692 left691 left690 left689 left688 left687 left686 left685 left684 left683 left682 left681 left680 left679 left678 left677 left676 left675 left674 left673 left672 left671 left670 left669 left668 left667 left666 left665 left664 left663 left662 left661 left660 left659 left658 left657 left656 left655 left654 left653 left652 left651 left650 left649 left648 left647 left646 left645 left644 left643 left642 left641 left640 left639 left638 left637 left636 left635 left634 left633 left632 left631 left630 left629 left628 left627 left626 left625 left624 left623 left622 left621 left620 left619 left618 left617 left616 left615 left614 left613 left612 left611 left610 left609 left608 left607 left606 left605 left604 left603 left602 left601 left600 left599 left598 left597 left596 left595 left594 left593 left592 left591 left590 left589 left588 left587 left586 left585 left584 left583 left582 left581 left580 left579 left578 left577 left576 left575 left574 left573 left572 left571 left570 left569 left568 left567 left566 left565 left564 left563 left562 left561 left560 left559 left558 left557 left556 left555 left554 left553 left552 left551 left550 left549 left548 left547 left546 left545 left544 left543 left542 left541 left540 left539 left538 left537 left536 left535 left534 left533 left532 left531 left530 left529 left528 left527 left526 left525 left524 left523 left522 left521 left520 left519 left518 left517 left516 left515 left514 left513 left512 left511 left510 left509 left508 left507 left506 left505 left504 left503 left502 left501 left500 left499 left498 left497 left496 left495 left494 left493 left492 left491 left490 left489 left488 left487 left486 left485 left484 left483 left482 left481 left480 left479 left478 left477 left476 left475 left474 left473 left472 left471 left470 left469 left468 left467 left466 left465 left464 left463 left462 left461 left460 left459 left458 left457 left456 left455 left454 left453 left452 left451 left450 left449 left448 left447 left446 left445 left444 left443 left442 left441 left440 left439 left438 left437 left436 left435 left434 left433 left432 left431 left430 left429 left428 left427 left426 left425 left424 left423 left422 left421 left420 left419 left418 left417 left416 left415 left414 left413 left412 left411 left410 left409 left408 left407 left406 left405 left404 left403 left402 left401 left400 left399 left398 left397 left396 left395 left394 left393 left392 left391 left390 left389 left388 left387 left386 left385 left384 left383 left382 left381 left380 left379 left378 left377 left376 left375 left374 left373 left372 left371 left370 left369 left368 left367 left366 left365 left364 left363 left362 left361 left360 left359 left358 left357 left356 left355 left354 left353 left352 left351 left350 left349 left348 left347 left346 left345 left344 left343 left342 left341 left340 left339 left338 left337 left336 left335 left334 left333 left332 left331 left330 left329 left328 left327 left326 left325 left324 left323 left322 left321 left320 left319 left318 left317 left316 left315 left314 left313 left312 left311 left310 left309 left308 left307 left306 left305 left304 left303 left302 left301 left300 left299 left298 left297 left296 left295 left294 left293 left292 left291 left290 left289 left288 left287 left286 left285 left284 left283 left282 left281 left280 left279 left278 left277 left276 left275 left274 left273 left272 left271 left270 left269 left268 left267 left266 left265 left264 left263 left262 left261 left260 left259 left258 left257 left256 left255 left254 left253 left252 left251 left250 left249 left248 left247 left246 left245 left244 left243 left242 left241 left240 left239 left238 left237 left236 left235 left234 left233 left232 left231 left230 left229 left228 left227 left226 left225 left224 left223 left222 left221 left220 left219 left218 left217 left216 left215 left214 left213 left212 left211 left210 left209 left208 left207 left206 left205 left204 left203 left202 left201 left200 left199 left198 left197 left196 left195 left194 left193 left192 left191 left190 left189 left188 left187 left186 left185 left184 left183 left182 left181 left180 left179 left178 left177 left176 left175 left174 left173 left172 left171 left170 left169 left168 left167 left166 left165 left164 left163 left162 left161 left160 left159 left158 left157 left156 left155 left154 left153 left152 left151 left150 left149 left148 left147 left146 left145 left144 left143 left142 left141 left140 left139 left138 left137 left136 left135 left134 left133 left132 left131 left130 left129 left128 left127 left126 left125 left124 left123 left122 left121 left120 left119 left118 left117 left116 left115 left114 left113 left112 left111 left110 left109 left108 left107 left106 left105 left104 left103 left102 left101 left100 left99 left98 left97 left96 left95 left94 left93 left92 left91 left90 left89 left88 left87 left86 left85 left84 left83 left82 left81 left80 left79 left78 left77 left76 left75 left74 left73 left72 left71 left70 left69 left68 left67 left66 left65 left64 left63 left62 left61 left60 left59 left58 left57 left56 left55 left54 left53 left52 left51 left50 left49 left48 left47 left46 left45 left44 left43 left42 left41 left40 left39 left38 left37 left36 left35 left34 left33 left32 left31 left30 left29 left28 left27 left26 left25 left24 left23 leThe `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
DeepseekV2Config {
  "_name_or_path": "/share-data/wzk-1/model/deepseek-v2-lite",
  "architectures": [
    "DeepseekV2ForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "auto_map": {
    "AutoConfig": "configuration_deepseek.DeepseekV2Config",
    "AutoModel": "modeling_deepseek.DeepseekV2Model",
    "AutoModelForCausalLM": "modeling_deepseek.DeepseekV2ForCausalLM"
  },
  "aux_loss_alpha": 0.001,
  "bos_token_id": 100000,
  "eos_token_id": 100001,
  "ep_size": 1,
  "first_k_dense_replace": 1,
  "hidden_act": "silu",
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 10944,
  "kv_lora_rank": 512,
  "max_position_embeddings": 163840,
  "model_type": "deepseek_v2",
  "moe_intermediate_size": 1408,
  "moe_layer_freq": 1,
  "n_group": 1,
  "n_routed_experts": 64,
  "n_shared_experts": 2,
  "norm_topk_prob": false,
  "num_attention_heads": 16,
  "num_experts_per_tok": 6,
  "num_hidden_layers": 27,
  "num_key_value_heads": 16,
  "pretraining_tp": 1,
  "q_lora_rank": null,
  "qk_nope_head_dim": 128,
  "qk_rope_head_dim": 64,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "beta_fast": 32,
    "beta_slow": 1,
    "factor": 40,
    "mscale": 0.707,
    "mscale_all_dim": 0.707,
    "original_max_position_embeddings": 4096,
    "type": "yarn"
  },
  "rope_theta": 10000,
  "routed_scaling_factor": 1.0,
  "scoring_func": "softmax",
  "seq_aux": true,
  "tie_word_embeddings": false,
  "topk_group": 1,
  "topk_method": "greedy",
  "torch_dtype": "bfloat16",
  "transformers_version": "4.46.3",
  "use_cache": true,
  "v_head_dim": 128,
  "vocab_size": 102400
}

input:  è¯·é€æ­¥è§£å†³ä»¥ä¸‹é—®é¢˜ï¼Œå¹¶è§£é‡Šæ¯æ­¥æ¨ç†è¿‡ç¨‹ï¼š
1. è‹¥3å°æœºå™¨5å°æ—¶ç”Ÿäº§180ä¸ªé›¶ä»¶ï¼Œ7å°æœºå™¨8å°æ—¶å¯ç”Ÿäº§å¤šå°‘é›¶ä»¶ï¼Ÿ
2. ç”²æ¯”ä¹™å¤§6å²ï¼Œ5å¹´å‰ç”²å¹´é¾„æ˜¯ä¹™çš„2å€ï¼Œæ±‚ä¸¤äººç°åœ¨å¹´é¾„ã€‚
3. è®¡ç®—ï¼š(2Â³ Ã— âˆš16) Ã· (4â»Â¹ + logâ‚‚8)
4. ä¸€ä¸ªéª°å­è¿ç»­æ·3æ¬¡ï¼Œè‡³å°‘å‡ºç°ä¸€æ¬¡6çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ
5. ç”¨è´å¶æ–¯å®šç†è§£é‡Šï¼šæ–°å† æ£€æµ‹å‡†ç¡®ç‡98%ï¼Œäººç¾¤æ„ŸæŸ“ç‡1%ï¼ŒæŸäººæ£€æµ‹é˜³æ€§æ—¶å®é™…æ‚£ç—…çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ
è¦æ±‚ï¼šåˆ†æ­¥éª¤å±•ç¤ºè®¡ç®—è¿‡ç¨‹ï¼Œæœ€ç»ˆç­”æ¡ˆç”¨ã€ã€‘æ ‡æ³¨ã€‚
inputs ...
torch.Size([1, 168])
outputs_text ...
write out information.


1. è‹¥3å°æœºå™¨5å°æ—¶ç”Ÿäº§180ä¸ªé›¶ä»¶ï¼Œ7å°æœºå™¨8å°æ—¶å¯ç”Ÿäº§å¤šå°‘é›¶ä»¶ï¼Ÿ

é¦–å…ˆï¼Œ
Prefilling time: 3.4209775924682617 seconds
Decoding time: 9.004990577697754 seconds
Decoding iterations: 32
Decoding time per iteration: 0.2814059555530548 seconds
Input tokens: 168
input:  è¯·ç”¨Pythonå®ç°ä»¥ä¸‹éœ€æ±‚ï¼š
1. ç¼–å†™ä¸€ä¸ªæ”¯æŒLRUç¼“å­˜æœºåˆ¶çš„è£…é¥°å™¨ç±»ï¼ŒåŒ…å«get/putæ–¹æ³•
2. ç”¨PyTorchæ„å»ºä¸€ä¸ª3å±‚MoEæ¨¡å‹ï¼š
   - ä¸“å®¶æ•°=4ï¼Œé—¨æ§ç½‘ç»œä¸ºç®€å•çº¿æ€§å±‚
   - æ¯ä¸“å®¶ä¸ºå«Dropoutçš„å…¨è¿æ¥ç½‘ç»œ
   - æ”¯æŒåŠ¨æ€ä¸“å®¶æ¿€æ´»æ•°ï¼ˆtop_k=2ï¼‰
3. ä¿®å¤ä»¥ä¸‹ä»£ç çš„BUGï¼ˆæç¤ºï¼šæ¶‰åŠå¼‚æ­¥åç¨‹ï¼‰ï¼š
   async def fetch_data():
       results = []
       for url in urls:
           data = await session.get(url)  # æŠ¥é”™ä½ç½®
           results.append(data.json())
       return results
è¦æ±‚ï¼šä»£ç éœ€å¯ç›´æ¥è¿è¡Œï¼Œå…³é”®å¤„æ·»åŠ æ³¨é‡Šã€‚
inputs ...
torch.Size([1, 178])
outputs_text ...
write out information.


```python
import asyncio
import aiohttp

async def fetch_data():
    results = []
    for url in urls
Prefilling time: 2.284555435180664 seconds
Decoding time: 8.970127582550049 seconds
Decoding iterations: 32
Decoding time per iteration: 0.280316486954689 seconds
Input tokens: 178
input:  è¯·å®Œæˆä»¥ä¸‹è·¨è¯­è¨€ä»»åŠ¡ï¼š
1. å°†ä¸­æ–‡è°šè¯­'å¡ç¿å¤±é©¬ï¼Œç„‰çŸ¥éç¦'ç¿»è¯‘æˆè‹±æ–‡ã€æ³•æ–‡ã€æ—¥æ–‡ï¼Œå¹¶åˆ†åˆ«ç»™å‡ºæ–‡åŒ–èƒŒæ™¯è§£é‡Š
2. æŠŠè¥¿ç­ç‰™è¯­æ­Œè¯'Despacito'ï¼ˆåŸæ„ï¼šæ…¢æ…¢æ¥ï¼‰æœ¬åœ°åŒ–ä¸ºä¸­æ–‡å››å­—æˆè¯­é£æ ¼
3. åˆ†æå¾·è¯­å¤åˆè¯'Schadenfreude'ï¼ˆå¹¸ç¾ä¹ç¥¸ï¼‰åœ¨ä¸­æ–‡/é˜¿æ‹‰ä¼¯è¯­ä¸­çš„ç­‰æ•ˆè¡¨è¾¾
4. ä¸ºæ—¥æœ¬å®¢æˆ·æ’°å†™å•†åŠ¡é‚®ä»¶ï¼ˆæ—¥æ–‡ï¼‰ï¼Œä¸»é¢˜ï¼šAIåˆä½œé¡¹ç›®å»¶æœŸè¯·æ±‚ï¼ˆéœ€ç¬¦åˆæ•¬è¯­è§„èŒƒï¼‰
è¦æ±‚ï¼šè¯‘æ–‡éœ€ç¬¦åˆç›®æ ‡è¯­è¨€æ–‡åŒ–ä¹ æƒ¯ï¼Œé‡è¦æ¦‚å¿µé™„åŠ è¯´æ˜ã€‚
inputs ...
torch.Size([1, 148])
outputs_text ...
write out information.


1. ä¸­æ–‡è°šè¯­'å¡ç¿å¤±é©¬ï¼Œç„‰çŸ¥éç¦'ç¿»è¯‘æˆè‹±æ–‡ã€æ³•æ–‡ã€æ—¥æ–‡ï¼Œå¹¶åˆ†åˆ«
Prefilling time: 2.293259620666504 seconds
Decoding time: 8.923737525939941 seconds
Decoding iterations: 32
Decoding time per iteration: 0.27886679768562317 seconds
Input tokens: 148
input:  è¯·ç”¨å­¦æœ¯è®ºæ–‡é£æ ¼å›ç­”ï¼š
1. å¯¹æ¯”Transformer/RNN/GNNåœ¨æ—¶åºé¢„æµ‹ä¸­çš„ä¼˜åŠ£ï¼ˆéœ€å¼•2020å¹´åè®ºæ–‡ï¼‰
2. ç”¨æ§åˆ¶è®ºè§£é‡ŠAlphaGoçš„å†³ç­–æ ‘ä¼˜åŒ–è¿‡ç¨‹
3. åˆ—å‡ºé‡å­è®¡ç®—å¯¹å¯†ç å­¦çš„ä¸‰å¤§å½±å“ï¼Œå¹¶è¯´æ˜Shorç®—æ³•åŸç†
4. æ’°å†™æ‘˜è¦ï¼šMoEæ¨¡å‹åœ¨è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²çš„æŒ‘æˆ˜ï¼ˆ200å­—å†…ï¼Œå«èƒ½è€—/ç²¾åº¦/å»¶è¿ŸæŒ‡æ ‡ï¼‰
è¦æ±‚ï¼šå…³é”®è®ºç‚¹éœ€æ ‡æ³¨å‚è€ƒæ–‡çŒ®ï¼ˆæ ¼å¼ï¼šAuthor et al., Yearï¼‰ï¼Œé¿å…ä¸»è§‚è¡¨è¿°ã€‚
inputs ...
torch.Size([1, 127])
outputs_text ...
write out information.


1. å¯¹æ¯”Transformer/RNN/GNNåœ¨æ—¶åºé¢„æµ‹ä¸­çš„ä¼˜åŠ£

Transformerã€RNNå’ŒGNNåœ¨æ—¶åºé¢„æµ‹ä»»åŠ¡
Prefilling time: 2.1658878326416016 seconds
Decoding time: 9.32085657119751 seconds
Decoding iterations: 32
Decoding time per iteration: 0.2912767678499222 seconds
Input tokens: 127
input:  æ ¹æ®ä»¥ä¸‹çº¿ç´¢ç”Ÿæˆåˆ›æ„å†…å®¹ï¼š
1. ç”¨'åŒºå—é“¾+ç¢³ä¸­å’Œ'æ¦‚å¿µè®¾è®¡ä¸€ä¸ªDAppäº¤äº’æµç¨‹å›¾
2. ä¸ºç§‘å¹»å°è¯´ã€ŠæœˆçƒAIæ®–æ°‘åœ°ã€‹ç¼–å†™æ•…äº‹å¤§çº²ï¼ˆ3å¹•å‰§ç»“æ„ï¼‰
3. å°†å¤è¯—'å¤§æ¼ å­¤çƒŸç›´'è½¬å†™æˆç°ä»£è¯—æ­Œå¹¶é…50å­—è§†è§‰ç”»é¢æè¿°
4. è®¾è®¡ä¸€ä¸ªå“²å­¦æ‚–è®ºï¼šå½“è¶…çº§AIçš„æ•ˆç”¨å‡½æ•°ä¸äººç±»ä¼¦ç†å†²çªæ—¶ï¼ˆæ¨¡ä»¿ç”µè½¦éš¾é¢˜ï¼‰
5. ç”¨emoji+çŸ­å¥æè¿°'å…ƒå®‡å®™å©šç¤¼'çš„æ ¸å¿ƒä½“éªŒï¼ˆé™20ä¸ªå­—ç¬¦ï¼‰
è¦æ±‚ï¼šæ¯ä¸ªäº§å‡ºéœ€åŒ…å«åˆ›æ–°æ€§å’Œå¯å®æ–½æ€§è¯´æ˜ã€‚
inputs ...
torch.Size([1, 148])
outputs_text ...
write out information.


1. DAppäº¤äº’æµç¨‹å›¾è®¾è®¡ï¼š
åˆ›æ„å†…å®¹ï¼šè®¾è®¡ä¸€ä¸ªåŸºäºåŒºå—é“¾æŠ€æœ¯çš„DAppï¼Œç”¨äºè¿½è¸ªå’Œç®¡ç†ç¢³æ’æ”¾äº¤æ˜“ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡
Prefilling time: 2.2763478755950928 seconds
Decoding time: 8.412391662597656 seconds
Decoding iterations: 32
Decoding time per iteration: 0.26288723945617676 seconds
Input tokens: 148
ft22 left21 left20 left19 left18 left17 left16 left15 left14 left13 left12 left11 left10 left9 left8 left7 left6 left5 left4 left3 left2 left1 left
finished: 1664/1664
ArcherTaskPool destructor
